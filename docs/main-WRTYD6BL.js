var qA=Object.defineProperty,Dj=Object.defineProperties;var Sj=Object.getOwnPropertyDescriptors;var $A=Object.getOwnPropertySymbols,Aj=Object.getPrototypeOf,Rj=Object.prototype.hasOwnProperty,xj=Object.prototype.propertyIsEnumerable,Nj=Reflect.get;var HA=(n,e,t)=>e in n?qA(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,X=(n,e)=>{for(var t in e||={})Rj.call(e,t)&&HA(n,t,e[t]);if($A)for(var t of $A(e))xj.call(e,t)&&HA(n,t,e[t]);return n},it=(n,e)=>Dj(n,Sj(e));var Pj=(n,e)=>{for(var t in e)qA(n,t,{get:e[t],enumerable:!0})};var Er=(n,e,t)=>Nj(Aj(n),t,e);var g=(n,e,t)=>new Promise((r,i)=>{var s=c=>{try{a(t.next(c))}catch(l){i(l)}},o=c=>{try{a(t.throw(c))}catch(l){i(l)}},a=c=>c.done?r(c.value):Promise.resolve(c.value).then(s,o);a((t=t.apply(n,e)).next())});var zA=null;var Ey=1,WA=Symbol("SIGNAL");function Me(n){let e=zA;return zA=n,e}var GA={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function Mj(n){if(!(Cy(n)&&!n.dirty)&&!(!n.dirty&&n.lastCleanEpoch===Ey)){if(!n.producerMustRecompute(n)&&!Ty(n)){n.dirty=!1,n.lastCleanEpoch=Ey;return}n.producerRecomputeValue(n),n.dirty=!1,n.lastCleanEpoch=Ey}}function KA(n){return n&&(n.nextProducerIndex=0),Me(n)}function QA(n,e){if(Me(e),!(!n||n.producerNode===void 0||n.producerIndexOfThis===void 0||n.producerLastReadVersion===void 0)){if(Cy(n))for(let t=n.nextProducerIndex;t<n.producerNode.length;t++)by(n.producerNode[t],n.producerIndexOfThis[t]);for(;n.producerNode.length>n.nextProducerIndex;)n.producerNode.pop(),n.producerLastReadVersion.pop(),n.producerIndexOfThis.pop()}}function Ty(n){tf(n);for(let e=0;e<n.producerNode.length;e++){let t=n.producerNode[e],r=n.producerLastReadVersion[e];if(r!==t.version||(Mj(t),r!==t.version))return!0}return!1}function YA(n){if(tf(n),Cy(n))for(let e=0;e<n.producerNode.length;e++)by(n.producerNode[e],n.producerIndexOfThis[e]);n.producerNode.length=n.producerLastReadVersion.length=n.producerIndexOfThis.length=0,n.liveConsumerNode&&(n.liveConsumerNode.length=n.liveConsumerIndexOfThis.length=0)}function by(n,e){if(kj(n),tf(n),n.liveConsumerNode.length===1)for(let r=0;r<n.producerNode.length;r++)by(n.producerNode[r],n.producerIndexOfThis[r]);let t=n.liveConsumerNode.length-1;if(n.liveConsumerNode[e]=n.liveConsumerNode[t],n.liveConsumerIndexOfThis[e]=n.liveConsumerIndexOfThis[t],n.liveConsumerNode.length--,n.liveConsumerIndexOfThis.length--,e<n.liveConsumerNode.length){let r=n.liveConsumerIndexOfThis[e],i=n.liveConsumerNode[e];tf(i),i.producerIndexOfThis[r]=e}}function Cy(n){return n.consumerIsAlwaysLive||(n?.liveConsumerNode?.length??0)>0}function tf(n){n.producerNode??=[],n.producerIndexOfThis??=[],n.producerLastReadVersion??=[]}function kj(n){n.liveConsumerNode??=[],n.liveConsumerIndexOfThis??=[]}function Oj(){throw new Error}var Lj=Oj;function JA(n){Lj=n}function ce(n){return typeof n=="function"}function ca(n){let t=n(r=>{Error.call(r),r.stack=new Error().stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var nf=ca(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:
${t.map((r,i)=>`${i+1}) ${r.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=t});function Fl(n,e){if(n){let t=n.indexOf(e);0<=t&&n.splice(t,1)}}var Ct=class n{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(let s of t)s.remove(this);else t.remove(this);let{initialTeardown:r}=this;if(ce(r))try{r()}catch(s){e=s instanceof nf?s.errors:[s]}let{_finalizers:i}=this;if(i){this._finalizers=null;for(let s of i)try{XA(s)}catch(o){e=e??[],o instanceof nf?e=[...e,...o.errors]:e.push(o)}}if(e)throw new nf(e)}}add(e){var t;if(e&&e!==this)if(this.closed)XA(e);else{if(e instanceof n){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}}_hasParent(e){let{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){let{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){let{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&Fl(t,e)}remove(e){let{_finalizers:t}=this;t&&Fl(t,e),e instanceof n&&e._removeParent(this)}};Ct.EMPTY=(()=>{let n=new Ct;return n.closed=!0,n})();var Dy=Ct.EMPTY;function rf(n){return n instanceof Ct||n&&"closed"in n&&ce(n.remove)&&ce(n.add)&&ce(n.unsubscribe)}function XA(n){ce(n)?n():n.unsubscribe()}var tr={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var la={setTimeout(n,e,...t){let{delegate:r}=la;return r?.setTimeout?r.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){let{delegate:e}=la;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function sf(n){la.setTimeout(()=>{let{onUnhandledError:e}=tr;if(e)e(n);else throw n})}function Vl(){}var ZA=Sy("C",void 0,void 0);function eR(n){return Sy("E",void 0,n)}function tR(n){return Sy("N",n,void 0)}function Sy(n,e,t){return{kind:n,value:e,error:t}}var $s=null;function ua(n){if(tr.useDeprecatedSynchronousErrorHandling){let e=!$s;if(e&&($s={errorThrown:!1,error:null}),n(),e){let{errorThrown:t,error:r}=$s;if($s=null,t)throw r}}else n()}function nR(n){tr.useDeprecatedSynchronousErrorHandling&&$s&&($s.errorThrown=!0,$s.error=n)}var Hs=class extends Ct{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,rf(e)&&e.add(this)):this.destination=Uj}static create(e,t,r){return new da(e,t,r)}next(e){this.isStopped?Ry(tR(e),this):this._next(e)}error(e){this.isStopped?Ry(eR(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?Ry(ZA,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},Fj=Function.prototype.bind;function Ay(n,e){return Fj.call(n,e)}var xy=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(r){of(r)}}error(e){let{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(r){of(r)}else of(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){of(t)}}},da=class extends Hs{constructor(e,t,r){super();let i;if(ce(e)||!e)i={next:e??void 0,error:t??void 0,complete:r??void 0};else{let s;this&&tr.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&Ay(e.next,s),error:e.error&&Ay(e.error,s),complete:e.complete&&Ay(e.complete,s)}):i=e}this.destination=new xy(i)}};function of(n){tr.useDeprecatedSynchronousErrorHandling?nR(n):sf(n)}function Vj(n){throw n}function Ry(n,e){let{onStoppedNotification:t}=tr;t&&la.setTimeout(()=>t(n,e))}var Uj={closed:!0,next:Vl,error:Vj,complete:Vl};var ha=typeof Symbol=="function"&&Symbol.observable||"@@observable";function Tn(n){return n}function Ny(...n){return Py(n)}function Py(n){return n.length===0?Tn:n.length===1?n[0]:function(t){return n.reduce((r,i)=>i(r),t)}}var Oe=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){let r=new n;return r.source=this,r.operator=t,r}subscribe(t,r,i){let s=Bj(t)?t:new da(t,r,i);return ua(()=>{let{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(t){try{return this._subscribe(t)}catch(r){t.error(r)}}forEach(t,r){return r=rR(r),new r((i,s)=>{let o=new da({next:a=>{try{t(a)}catch(c){s(c),o.unsubscribe()}},error:s,complete:i});this.subscribe(o)})}_subscribe(t){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(t)}[ha](){return this}pipe(...t){return Py(t)(this)}toPromise(t){return t=rR(t),new t((r,i)=>{let s;this.subscribe(o=>s=o,o=>i(o),()=>r(s))})}}return n.create=e=>new n(e),n})();function rR(n){var e;return(e=n??tr.Promise)!==null&&e!==void 0?e:Promise}function jj(n){return n&&ce(n.next)&&ce(n.error)&&ce(n.complete)}function Bj(n){return n&&n instanceof Hs||jj(n)&&rf(n)}function My(n){return ce(n?.lift)}function Ie(n){return e=>{if(My(e))return e.lift(function(t){try{return n(t,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function Ee(n,e,t,r,i){return new ky(n,e,t,r,i)}var ky=class extends Hs{constructor(e,t,r,i,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=t?function(a){try{t(a)}catch(c){e.error(c)}}:super._next,this._error=i?function(a){try{i(a)}catch(c){e.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:t}=this;super.unsubscribe(),!t&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};function fa(){return Ie((n,e)=>{let t=null;n._refCount++;let r=Ee(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount){t=null;return}let i=n._connection,s=t;t=null,i&&(!s||i===s)&&i.unsubscribe(),e.unsubscribe()});n.subscribe(r),r.closed||(t=n.connect())})}var pa=class extends Oe{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,My(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){let e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new Ct;let t=this.getSubject();e.add(this.source.subscribe(Ee(t,void 0,()=>{this._teardown(),t.complete()},r=>{this._teardown(),t.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=Ct.EMPTY)}return e}refCount(){return fa()(this)}};var iR=ca(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var Wt=(()=>{class n extends Oe{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){let r=new af(this,this);return r.operator=t,r}_throwIfClosed(){if(this.closed)throw new iR}next(t){ua(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(t)}})}error(t){ua(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;let{observers:r}=this;for(;r.length;)r.shift().error(t)}})}complete(){ua(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){let{hasError:r,isStopped:i,observers:s}=this;return r||i?Dy:(this.currentObservers=null,s.push(t),new Ct(()=>{this.currentObservers=null,Fl(s,t)}))}_checkFinalizedStatuses(t){let{hasError:r,thrownError:i,isStopped:s}=this;r?t.error(i):s&&t.complete()}asObservable(){let t=new Oe;return t.source=this,t}}return n.create=(e,t)=>new af(e,t),n})(),af=class extends Wt{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.next)===null||r===void 0||r.call(t,e)}error(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.error)===null||r===void 0||r.call(t,e)}complete(){var e,t;(t=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||t===void 0||t.call(e)}_subscribe(e){var t,r;return(r=(t=this.source)===null||t===void 0?void 0:t.subscribe(e))!==null&&r!==void 0?r:Dy}};var Ft=class extends Wt{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){let{hasError:e,thrownError:t,_value:r}=this;if(e)throw t;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}};var bn=new Oe(n=>n.complete());function sR(n){return n&&ce(n.schedule)}function oR(n){return n[n.length-1]}function aR(n){return ce(oR(n))?n.pop():void 0}function Ui(n){return sR(oR(n))?n.pop():void 0}function cf(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function lR(n,e,t,r){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(d){try{l(r.next(d))}catch(h){o(h)}}function c(d){try{l(r.throw(d))}catch(h){o(h)}}function l(d){d.done?s(d.value):i(d.value).then(a,c)}l((r=r.apply(n,e||[])).next())})}function cR(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function qs(n){return this instanceof qs?(this.v=n,this):new qs(n)}function uR(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),i,s=[];return i={},a("next"),a("throw"),a("return",o),i[Symbol.asyncIterator]=function(){return this},i;function o(_){return function(w){return Promise.resolve(w).then(_,h)}}function a(_,w){r[_]&&(i[_]=function(C){return new Promise(function(A,L){s.push([_,C,A,L])>1||c(_,C)})},w&&(i[_]=w(i[_])))}function c(_,w){try{l(r[_](w))}catch(C){m(s[0][3],C)}}function l(_){_.value instanceof qs?Promise.resolve(_.value.v).then(d,h):m(s[0][2],_)}function d(_){c("next",_)}function h(_){c("throw",_)}function m(_,w){_(w),s.shift(),s.length&&c(s[0][0],s[0][1])}}function dR(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof cR=="function"?cR(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(s){t[s]=n[s]&&function(o){return new Promise(function(a,c){o=n[s](o),i(a,c,o.done,o.value)})}}function i(s,o,a,c){Promise.resolve(c).then(function(l){s({value:l,done:a})},o)}}var lf=n=>n&&typeof n.length=="number"&&typeof n!="function";function uf(n){return ce(n?.then)}function df(n){return ce(n[ha])}function hf(n){return Symbol.asyncIterator&&ce(n?.[Symbol.asyncIterator])}function ff(n){return new TypeError(`You provided ${n!==null&&typeof n=="object"?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function $j(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var pf=$j();function mf(n){return ce(n?.[pf])}function gf(n){return uR(this,arguments,function*(){let t=n.getReader();try{for(;;){let{value:r,done:i}=yield qs(t.read());if(i)return yield qs(void 0);yield yield qs(r)}}finally{t.releaseLock()}})}function _f(n){return ce(n?.getReader)}function xt(n){if(n instanceof Oe)return n;if(n!=null){if(df(n))return Hj(n);if(lf(n))return qj(n);if(uf(n))return zj(n);if(hf(n))return hR(n);if(mf(n))return Wj(n);if(_f(n))return Gj(n)}throw ff(n)}function Hj(n){return new Oe(e=>{let t=n[ha]();if(ce(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function qj(n){return new Oe(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}function zj(n){return new Oe(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,sf)})}function Wj(n){return new Oe(e=>{for(let t of n)if(e.next(t),e.closed)return;e.complete()})}function hR(n){return new Oe(e=>{Kj(n,e).catch(t=>e.error(t))})}function Gj(n){return hR(gf(n))}function Kj(n,e){var t,r,i,s;return lR(this,void 0,void 0,function*(){try{for(t=dR(n);r=yield t.next(),!r.done;){let o=r.value;if(e.next(o),e.closed)return}}catch(o){i={error:o}}finally{try{r&&!r.done&&(s=t.return)&&(yield s.call(t))}finally{if(i)throw i.error}}e.complete()})}function mn(n,e,t,r=0,i=!1){let s=e.schedule(function(){t(),i?n.add(this.schedule(null,r)):this.unsubscribe()},r);if(n.add(s),!i)return s}function yf(n,e=0){return Ie((t,r)=>{t.subscribe(Ee(r,i=>mn(r,n,()=>r.next(i),e),()=>mn(r,n,()=>r.complete(),e),i=>mn(r,n,()=>r.error(i),e)))})}function vf(n,e=0){return Ie((t,r)=>{r.add(n.schedule(()=>t.subscribe(r),e))})}function fR(n,e){return xt(n).pipe(vf(e),yf(e))}function pR(n,e){return xt(n).pipe(vf(e),yf(e))}function mR(n,e){return new Oe(t=>{let r=0;return e.schedule(function(){r===n.length?t.complete():(t.next(n[r++]),t.closed||this.schedule())})})}function gR(n,e){return new Oe(t=>{let r;return mn(t,e,()=>{r=n[pf](),mn(t,e,()=>{let i,s;try{({value:i,done:s}=r.next())}catch(o){t.error(o);return}s?t.complete():t.next(i)},0,!0)}),()=>ce(r?.return)&&r.return()})}function wf(n,e){if(!n)throw new Error("Iterable cannot be null");return new Oe(t=>{mn(t,e,()=>{let r=n[Symbol.asyncIterator]();mn(t,e,()=>{r.next().then(i=>{i.done?t.complete():t.next(i.value)})},0,!0)})})}function _R(n,e){return wf(gf(n),e)}function yR(n,e){if(n!=null){if(df(n))return fR(n,e);if(lf(n))return mR(n,e);if(uf(n))return pR(n,e);if(hf(n))return wf(n,e);if(mf(n))return gR(n,e);if(_f(n))return _R(n,e)}throw ff(n)}function lt(n,e){return e?yR(n,e):xt(n)}function oe(...n){let e=Ui(n);return lt(n,e)}function ma(n,e){let t=ce(n)?n:()=>n,r=i=>i.error(t());return new Oe(e?i=>e.schedule(r,0,i):r)}function Oy(n){return!!n&&(n instanceof Oe||ce(n.lift)&&ce(n.subscribe))}var ui=ca(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function Te(n,e){return Ie((t,r)=>{let i=0;t.subscribe(Ee(r,s=>{r.next(n.call(e,s,i++))}))})}var{isArray:Qj}=Array;function Yj(n,e){return Qj(e)?n(...e):n(e)}function vR(n){return Te(e=>Yj(n,e))}var{isArray:Jj}=Array,{getPrototypeOf:Xj,prototype:Zj,keys:eB}=Object;function wR(n){if(n.length===1){let e=n[0];if(Jj(e))return{args:e,keys:null};if(tB(e)){let t=eB(e);return{args:t.map(r=>e[r]),keys:t}}}return{args:n,keys:null}}function tB(n){return n&&typeof n=="object"&&Xj(n)===Zj}function IR(n,e){return n.reduce((t,r,i)=>(t[r]=e[i],t),{})}function Ul(...n){let e=Ui(n),t=aR(n),{args:r,keys:i}=wR(n);if(r.length===0)return lt([],e);let s=new Oe(nB(r,e,i?o=>IR(i,o):Tn));return t?s.pipe(vR(t)):s}function nB(n,e,t=Tn){return r=>{ER(e,()=>{let{length:i}=n,s=new Array(i),o=i,a=i;for(let c=0;c<i;c++)ER(e,()=>{let l=lt(n[c],e),d=!1;l.subscribe(Ee(r,h=>{s[c]=h,d||(d=!0,a--),a||r.next(t(s.slice()))},()=>{--o||r.complete()}))},r)},r)}}function ER(n,e,t){n?mn(t,n,e):e()}function TR(n,e,t,r,i,s,o,a){let c=[],l=0,d=0,h=!1,m=()=>{h&&!c.length&&!l&&e.complete()},_=C=>l<r?w(C):c.push(C),w=C=>{s&&e.next(C),l++;let A=!1;xt(t(C,d++)).subscribe(Ee(e,L=>{i?.(L),s?_(L):e.next(L)},()=>{A=!0},void 0,()=>{if(A)try{for(l--;c.length&&l<r;){let L=c.shift();o?mn(e,o,()=>w(L)):w(L)}m()}catch(L){e.error(L)}}))};return n.subscribe(Ee(e,_,()=>{h=!0,m()})),()=>{a?.()}}function mt(n,e,t=1/0){return ce(e)?mt((r,i)=>Te((s,o)=>e(r,s,i,o))(xt(n(r,i))),t):(typeof e=="number"&&(t=e),Ie((r,i)=>TR(r,i,n,t)))}function ga(n=1/0){return mt(Tn,n)}function bR(){return ga(1)}function _a(...n){return bR()(lt(n,Ui(n)))}function If(n){return new Oe(e=>{xt(n()).subscribe(e)})}function Fn(n,e){return Ie((t,r)=>{let i=0;t.subscribe(Ee(r,s=>n.call(e,s,i++)&&r.next(s)))})}function ji(n){return Ie((e,t)=>{let r=null,i=!1,s;r=e.subscribe(Ee(t,void 0,void 0,o=>{s=xt(n(o,ji(n)(e))),r?(r.unsubscribe(),r=null,s.subscribe(t)):i=!0})),i&&(r.unsubscribe(),r=null,s.subscribe(t))})}function CR(n,e,t,r,i){return(s,o)=>{let a=t,c=e,l=0;s.subscribe(Ee(o,d=>{let h=l++;c=a?n(c,d,h):(a=!0,d),r&&o.next(c)},i&&(()=>{a&&o.next(c),o.complete()})))}}function zs(n,e){return ce(e)?mt(n,e,1):mt(n,1)}function Bi(n){return Ie((e,t)=>{let r=!1;e.subscribe(Ee(t,i=>{r=!0,t.next(i)},()=>{r||t.next(n),t.complete()}))})}function di(n){return n<=0?()=>bn:Ie((e,t)=>{let r=0;e.subscribe(Ee(t,i=>{++r<=n&&(t.next(i),n<=r&&t.complete())}))})}function Ly(n){return Te(()=>n)}function Ef(n=rB){return Ie((e,t)=>{let r=!1;e.subscribe(Ee(t,i=>{r=!0,t.next(i)},()=>r?t.complete():t.error(n())))})}function rB(){return new ui}function jl(n){return Ie((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}function Tr(n,e){let t=arguments.length>=2;return r=>r.pipe(n?Fn((i,s)=>n(i,s,r)):Tn,di(1),t?Bi(e):Ef(()=>new ui))}function ya(n){return n<=0?()=>bn:Ie((e,t)=>{let r=[];e.subscribe(Ee(t,i=>{r.push(i),n<r.length&&r.shift()},()=>{for(let i of r)t.next(i);t.complete()},void 0,()=>{r=null}))})}function Fy(n,e){let t=arguments.length>=2;return r=>r.pipe(n?Fn((i,s)=>n(i,s,r)):Tn,ya(1),t?Bi(e):Ef(()=>new ui))}function Vy(n,e){return Ie(CR(n,e,arguments.length>=2,!0))}function Uy(...n){let e=Ui(n);return Ie((t,r)=>{(e?_a(n,t,e):_a(n,t)).subscribe(r)})}function Vn(n,e){return Ie((t,r)=>{let i=null,s=0,o=!1,a=()=>o&&!i&&r.complete();t.subscribe(Ee(r,c=>{i?.unsubscribe();let l=0,d=s++;xt(n(c,d)).subscribe(i=Ee(r,h=>r.next(e?e(c,h,d,l++):h),()=>{i=null,a()}))},()=>{o=!0,a()}))})}function jy(n){return Ie((e,t)=>{xt(n).subscribe(Ee(t,()=>t.complete(),Vl)),!t.closed&&e.subscribe(t)})}function Vt(n,e,t){let r=ce(n)||e||t?{next:n,error:e,complete:t}:n;return r?Ie((i,s)=>{var o;(o=r.subscribe)===null||o===void 0||o.call(r);let a=!0;i.subscribe(Ee(s,c=>{var l;(l=r.next)===null||l===void 0||l.call(r,c),s.next(c)},()=>{var c;a=!1,(c=r.complete)===null||c===void 0||c.call(r),s.complete()},c=>{var l;a=!1,(l=r.error)===null||l===void 0||l.call(r,c),s.error(c)},()=>{var c,l;a&&((c=r.unsubscribe)===null||c===void 0||c.call(r)),(l=r.finalize)===null||l===void 0||l.call(r)}))}):Tn}var cx="https://g.co/ng/security#xss",te=class extends Error{constructor(e,t){super(Rv(e,t)),this.code=e}};function Rv(n,e){return`${`NG0${Math.abs(n)}`}${e?": "+e:""}`}function eu(n){return{toString:n}.toString()}var Tf="__parameters__";function iB(n){return function(...t){if(n){let r=n(...t);for(let i in r)this[i]=r[i]}}}function lx(n,e,t){return eu(()=>{let r=iB(e);function i(...s){if(this instanceof i)return r.apply(this,s),this;let o=new i(...s);return a.annotation=o,a;function a(c,l,d){let h=c.hasOwnProperty(Tf)?c[Tf]:Object.defineProperty(c,Tf,{value:[]})[Tf];for(;h.length<=d;)h.push(null);return(h[d]=h[d]||[]).push(o),c}}return t&&(i.prototype=Object.create(t.prototype)),i.prototype.ngMetadataName=n,i.annotationCls=i,i})}var Ut=globalThis;function Ue(n){for(let e in n)if(n[e]===Ue)return e;throw Error("Could not find renamed property on target object.")}function Cn(n){if(typeof n=="string")return n;if(Array.isArray(n))return"["+n.map(Cn).join(", ")+"]";if(n==null)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;let e=n.toString();if(e==null)return""+e;let t=e.indexOf(`
`);return t===-1?e:e.substring(0,t)}function DR(n,e){return n==null||n===""?e===null?"":e:e==null||e===""?n:n+" "+e}var sB=Ue({__forward_ref__:Ue});function ux(n){return n.__forward_ref__=ux,n.toString=function(){return Cn(this())},n}function jn(n){return dx(n)?n():n}function dx(n){return typeof n=="function"&&n.hasOwnProperty(sB)&&n.__forward_ref__===ux}function ne(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function or(n){return{providers:n.providers||[],imports:n.imports||[]}}function Jf(n){return SR(n,fx)||SR(n,px)}function hx(n){return Jf(n)!==null}function SR(n,e){return n.hasOwnProperty(e)?n[e]:null}function oB(n){let e=n&&(n[fx]||n[px]);return e||null}function AR(n){return n&&(n.hasOwnProperty(RR)||n.hasOwnProperty(aB))?n[RR]:null}var fx=Ue({\u0275prov:Ue}),RR=Ue({\u0275inj:Ue}),px=Ue({ngInjectableDef:Ue}),aB=Ue({ngInjectorDef:Ue}),ue=class{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,typeof t=="number"?this.__NG_ELEMENT_ID__=t:t!==void 0&&(this.\u0275prov=ne({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function mx(n){return n&&!!n.\u0275providers}var cB=Ue({\u0275cmp:Ue}),lB=Ue({\u0275dir:Ue}),uB=Ue({\u0275pipe:Ue}),dB=Ue({\u0275mod:Ue}),Pf=Ue({\u0275fac:Ue}),Bl=Ue({__NG_ELEMENT_ID__:Ue}),xR=Ue({__NG_ENV_ID__:Ue});function xv(n){return typeof n=="string"?n:n==null?"":String(n)}function hB(n){return typeof n=="function"?n.name||n.toString():typeof n=="object"&&n!=null&&typeof n.type=="function"?n.type.name||n.type.toString():xv(n)}function fB(n,e){let t=e?`. Dependency path: ${e.join(" > ")} > ${n}`:"";throw new te(-200,n)}function Nv(n,e){throw new te(-201,!1)}var ye=function(n){return n[n.Default=0]="Default",n[n.Host=1]="Host",n[n.Self=2]="Self",n[n.SkipSelf=4]="SkipSelf",n[n.Optional=8]="Optional",n}(ye||{}),Yy;function gx(){return Yy}function Un(n){let e=Yy;return Yy=n,e}function _x(n,e,t){let r=Jf(n);if(r&&r.providedIn=="root")return r.value===void 0?r.value=r.factory():r.value;if(t&ye.Optional)return null;if(e!==void 0)return e;Nv(n,"Injector")}var pB={},Hl=pB,Jy="__NG_DI_FLAG__",Mf="ngTempTokenPath",mB="ngTokenPath",gB=/\n/gm,_B="\u0275",NR="__source",Ta;function yB(){return Ta}function $i(n){let e=Ta;return Ta=n,e}function vB(n,e=ye.Default){if(Ta===void 0)throw new te(-203,!1);return Ta===null?_x(n,void 0,e):Ta.get(n,e&ye.Optional?null:void 0,e)}function ie(n,e=ye.Default){return(gx()||vB)(jn(n),e)}function G(n,e=ye.Default){return ie(n,Xf(e))}function Xf(n){return typeof n>"u"||typeof n=="number"?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function Xy(n){let e=[];for(let t=0;t<n.length;t++){let r=jn(n[t]);if(Array.isArray(r)){if(r.length===0)throw new te(900,!1);let i,s=ye.Default;for(let o=0;o<r.length;o++){let a=r[o],c=wB(a);typeof c=="number"?c===-1?i=a.token:s|=c:i=a}e.push(ie(i,s))}else e.push(ie(r))}return e}function yx(n,e){return n[Jy]=e,n.prototype[Jy]=e,n}function wB(n){return n[Jy]}function IB(n,e,t,r){let i=n[Mf];throw e[NR]&&i.unshift(e[NR]),n.message=EB(`
`+n.message,i,t,r),n[mB]=i,n[Mf]=null,n}function EB(n,e,t,r=null){n=n&&n.charAt(0)===`
`&&n.charAt(1)==_B?n.slice(2):n;let i=Cn(e);if(Array.isArray(e))i=e.map(Cn).join(" -> ");else if(typeof e=="object"){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+(typeof a=="string"?JSON.stringify(a):Cn(a)))}i=`{${s.join(", ")}}`}return`${t}${r?"("+r+")":""}[${i}]: ${n.replace(gB,`
  `)}`}var Pv=yx(lx("Optional"),8);var vx=yx(lx("SkipSelf"),4);function Ca(n,e){let t=n.hasOwnProperty(Pf);return t?n[Pf]:null}function Mv(n,e){n.forEach(t=>Array.isArray(t)?Mv(t,e):e(t))}function wx(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function kf(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}var ql={},br=[],Da=new ue(""),Ix=new ue("",-1),Ex=new ue(""),Of=class{get(e,t=Hl){if(t===Hl){let r=new Error(`NullInjectorError: No provider for ${Cn(e)}!`);throw r.name="NullInjectorError",r}return t}},Tx=function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n}(Tx||{}),Sr=function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n}(Sr||{}),ir=function(n){return n[n.None=0]="None",n[n.SignalBased=1]="SignalBased",n[n.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",n}(ir||{});function TB(n,e,t){let r=n.length;for(;;){let i=n.indexOf(e,t);if(i===-1)return i;if(i===0||n.charCodeAt(i-1)<=32){let s=e.length;if(i+s===r||n.charCodeAt(i+s)<=32)return i}t=i+1}}function Zy(n,e,t){let r=0;for(;r<t.length;){let i=t[r];if(typeof i=="number"){if(i!==0)break;r++;let s=t[r++],o=t[r++],a=t[r++];n.setAttribute(e,o,a,s)}else{let s=i,o=t[++r];bB(s)?n.setProperty(e,s,o):n.setAttribute(e,s,o),r++}}return r}function bx(n){return n===3||n===4||n===6}function bB(n){return n.charCodeAt(0)===64}function kv(n,e){if(!(e===null||e.length===0))if(n===null||n.length===0)n=e.slice();else{let t=-1;for(let r=0;r<e.length;r++){let i=e[r];typeof i=="number"?t=i:t===0||(t===-1||t===2?PR(n,t,i,null,e[++r]):PR(n,t,i,null,null))}}return n}function PR(n,e,t,r,i){let s=0,o=n.length;if(e===-1)o=-1;else for(;s<n.length;){let a=n[s++];if(typeof a=="number"){if(a===e){o=-1;break}else if(a>e){o=s-1;break}}}for(;s<n.length;){let a=n[s];if(typeof a=="number")break;if(a===t){if(r===null){i!==null&&(n[s+1]=i);return}else if(r===n[s+1]){n[s+2]=i;return}}s++,r!==null&&s++,i!==null&&s++}o!==-1&&(n.splice(o,0,e),s=o+1),n.splice(s++,0,t),r!==null&&n.splice(s++,0,r),i!==null&&n.splice(s++,0,i)}var Cx="ng-template";function CB(n,e,t,r){let i=0;if(r){for(;i<e.length&&typeof e[i]=="string";i+=2)if(e[i]==="class"&&TB(e[i+1].toLowerCase(),t,0)!==-1)return!0}else if(Ov(n))return!1;if(i=e.indexOf(1,i),i>-1){let s;for(;++i<e.length&&typeof(s=e[i])=="string";)if(s.toLowerCase()===t)return!0}return!1}function Ov(n){return n.type===4&&n.value!==Cx}function DB(n,e,t){let r=n.type===4&&!t?Cx:n.value;return e===r}function SB(n,e,t){let r=4,i=n.attrs,s=i!==null?xB(i):0,o=!1;for(let a=0;a<e.length;a++){let c=e[a];if(typeof c=="number"){if(!o&&!nr(r)&&!nr(c))return!1;if(o&&nr(c))continue;o=!1,r=c|r&1;continue}if(!o)if(r&4){if(r=2|r&1,c!==""&&!DB(n,c,t)||c===""&&e.length===1){if(nr(r))return!1;o=!0}}else if(r&8){if(i===null||!CB(n,i,c,t)){if(nr(r))return!1;o=!0}}else{let l=e[++a],d=AB(c,i,Ov(n),t);if(d===-1){if(nr(r))return!1;o=!0;continue}if(l!==""){let h;if(d>s?h="":h=i[d+1].toLowerCase(),r&2&&l!==h){if(nr(r))return!1;o=!0}}}}return nr(r)||o}function nr(n){return(n&1)===0}function AB(n,e,t,r){if(e===null)return-1;let i=0;if(r||!t){let s=!1;for(;i<e.length;){let o=e[i];if(o===n)return i;if(o===3||o===6)s=!0;else if(o===1||o===2){let a=e[++i];for(;typeof a=="string";)a=e[++i];continue}else{if(o===4)break;if(o===0){i+=4;continue}}i+=s?1:2}return-1}else return NB(e,n)}function RB(n,e,t=!1){for(let r=0;r<e.length;r++)if(SB(n,e[r],t))return!0;return!1}function xB(n){for(let e=0;e<n.length;e++){let t=n[e];if(bx(t))return e}return n.length}function NB(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){let r=n[t];if(typeof r=="number")return-1;if(r===e)return t;t++}return-1}function MR(n,e){return n?":not("+e.trim()+")":e}function PB(n){let e=n[0],t=1,r=2,i="",s=!1;for(;t<n.length;){let o=n[t];if(typeof o=="string")if(r&2){let a=n[++t];i+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else r&8?i+="."+o:r&4&&(i+=" "+o);else i!==""&&!nr(o)&&(e+=MR(s,i),i=""),r=o,s=s||!nr(r);t++}return i!==""&&(e+=MR(s,i)),e}function MB(n){return n.map(PB).join(",")}function kB(n){let e=[],t=[],r=1,i=2;for(;r<n.length;){let s=n[r];if(typeof s=="string")i===2?s!==""&&e.push(s,n[++r]):i===8&&t.push(s);else{if(!nr(i))break;i=s}r++}return{attrs:e,classes:t}}function Nt(n){return eu(()=>{let e=xx(n),t=it(X({},e),{decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===Tx.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||Sr.Emulated,styles:n.styles||br,_:null,schemas:n.schemas||null,tView:null,id:""});Nx(t);let r=n.dependencies;return t.directiveDefs=OR(r,!1),t.pipeDefs=OR(r,!0),t.id=FB(t),t})}function OB(n){return qi(n)||Dx(n)}function LB(n){return n!==null}function ar(n){return eu(()=>({type:n.type,bootstrap:n.bootstrap||br,declarations:n.declarations||br,imports:n.imports||br,exports:n.exports||br,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function kR(n,e){if(n==null)return ql;let t={};for(let r in n)if(n.hasOwnProperty(r)){let i=n[r],s,o,a=ir.None;Array.isArray(i)?(a=i[0],s=i[1],o=i[2]??s):(s=i,o=i),e?(t[s]=a!==ir.None?[r,a]:r,e[s]=o):t[s]=r}return t}function Zf(n){return eu(()=>{let e=xx(n);return Nx(e),e})}function qi(n){return n[cB]||null}function Dx(n){return n[lB]||null}function Sx(n){return n[uB]||null}function Ax(n){let e=qi(n)||Dx(n)||Sx(n);return e!==null?e.standalone:!1}function Rx(n,e){let t=n[dB]||null;if(!t&&e===!0)throw new Error(`Type ${Cn(n)} does not have '\u0275mod' property.`);return t}function xx(n){let e={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:n.inputs||ql,exportAs:n.exportAs||null,standalone:n.standalone===!0,signals:n.signals===!0,selectors:n.selectors||br,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:kR(n.inputs,e),outputs:kR(n.outputs),debugInfo:null}}function Nx(n){n.features?.forEach(e=>e(n))}function OR(n,e){if(!n)return null;let t=e?Sx:OB;return()=>(typeof n=="function"?n():n).map(r=>t(r)).filter(LB)}function FB(n){let e=0,t=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,n.consts,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery].join("|");for(let i of t)e=Math.imul(31,e)+i.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function VB(...n){return{\u0275providers:Px(!0,n),\u0275fromNgModule:!0}}function Px(n,...e){let t=[],r=new Set,i,s=o=>{t.push(o)};return Mv(e,o=>{let a=o;ev(a,s,[],r)&&(i||=[],i.push(a))}),i!==void 0&&Mx(i,s),t}function Mx(n,e){for(let t=0;t<n.length;t++){let{ngModule:r,providers:i}=n[t];Lv(i,s=>{e(s,r)})}}function ev(n,e,t,r){if(n=jn(n),!n)return!1;let i=null,s=AR(n),o=!s&&qi(n);if(!s&&!o){let c=n.ngModule;if(s=AR(c),s)i=c;else return!1}else{if(o&&!o.standalone)return!1;i=n}let a=r.has(i);if(o){if(a)return!1;if(r.add(i),o.dependencies){let c=typeof o.dependencies=="function"?o.dependencies():o.dependencies;for(let l of c)ev(l,e,t,r)}}else if(s){if(s.imports!=null&&!a){r.add(i);let l;try{Mv(s.imports,d=>{ev(d,e,t,r)&&(l||=[],l.push(d))})}finally{}l!==void 0&&Mx(l,e)}if(!a){let l=Ca(i)||(()=>new i);e({provide:i,useFactory:l,deps:br},i),e({provide:Ex,useValue:i,multi:!0},i),e({provide:Da,useValue:()=>ie(i),multi:!0},i)}let c=s.providers;if(c!=null&&!a){let l=n;Lv(c,d=>{e(d,l)})}}else return!1;return i!==n&&n.providers!==void 0}function Lv(n,e){for(let t of n)mx(t)&&(t=t.\u0275providers),Array.isArray(t)?Lv(t,e):e(t)}var UB=Ue({provide:String,useValue:Ue});function kx(n){return n!==null&&typeof n=="object"&&UB in n}function jB(n){return!!(n&&n.useExisting)}function BB(n){return!!(n&&n.useFactory)}function tv(n){return typeof n=="function"}var ep=new ue(""),Sf={},$B={},By;function Fv(){return By===void 0&&(By=new Of),By}var gn=class{},zl=class extends gn{get destroyed(){return this._destroyed}constructor(e,t,r,i){super(),this.parent=t,this.source=r,this.scopes=i,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,rv(e,o=>this.processProvider(o)),this.records.set(Ix,va(void 0,this)),i.has("environment")&&this.records.set(gn,va(void 0,this));let s=this.records.get(ep);s!=null&&typeof s.value=="string"&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(Ex,br,ye.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;let e=Me(null);try{for(let r of this._ngOnDestroyHooks)r.ngOnDestroy();let t=this._onDestroyHooks;this._onDestroyHooks=[];for(let r of t)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),Me(e)}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();let t=$i(this),r=Un(void 0),i;try{return e()}finally{$i(t),Un(r)}}get(e,t=Hl,r=ye.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(xR))return e[xR](this);r=Xf(r);let i,s=$i(this),o=Un(void 0);try{if(!(r&ye.SkipSelf)){let c=this.records.get(e);if(c===void 0){let l=KB(e)&&Jf(e);l&&this.injectableDefInScope(l)?c=va(nv(e),Sf):c=null,this.records.set(e,c)}if(c!=null)return this.hydrate(e,c)}let a=r&ye.Self?Fv():this.parent;return t=r&ye.Optional&&t===Hl?null:t,a.get(e,t)}catch(a){if(a.name==="NullInjectorError"){if((a[Mf]=a[Mf]||[]).unshift(Cn(e)),s)throw a;return IB(a,e,"R3InjectorError",this.source)}else throw a}finally{Un(o),$i(s)}}resolveInjectorInitializers(){let e=Me(null),t=$i(this),r=Un(void 0),i;try{let s=this.get(Da,br,ye.Self);for(let o of s)o()}finally{$i(t),Un(r),Me(e)}}toString(){let e=[],t=this.records;for(let r of t.keys())e.push(Cn(r));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new te(205,!1)}processProvider(e){e=jn(e);let t=tv(e)?e:jn(e&&e.provide),r=qB(e);if(!tv(e)&&e.multi===!0){let i=this.records.get(t);i||(i=va(void 0,Sf,!0),i.factory=()=>Xy(i.multi),this.records.set(t,i)),t=e,i.multi.push(e)}this.records.set(t,r)}hydrate(e,t){let r=Me(null);try{return t.value===Sf&&(t.value=$B,t.value=t.factory()),typeof t.value=="object"&&t.value&&GB(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}finally{Me(r)}}injectableDefInScope(e){if(!e.providedIn)return!1;let t=jn(e.providedIn);return typeof t=="string"?t==="any"||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){let t=this._onDestroyHooks.indexOf(e);t!==-1&&this._onDestroyHooks.splice(t,1)}};function nv(n){let e=Jf(n),t=e!==null?e.factory:Ca(n);if(t!==null)return t;if(n instanceof ue)throw new te(204,!1);if(n instanceof Function)return HB(n);throw new te(204,!1)}function HB(n){if(n.length>0)throw new te(204,!1);let t=oB(n);return t!==null?()=>t.factory(n):()=>new n}function qB(n){if(kx(n))return va(void 0,n.useValue);{let e=zB(n);return va(e,Sf)}}function zB(n,e,t){let r;if(tv(n)){let i=jn(n);return Ca(i)||nv(i)}else if(kx(n))r=()=>jn(n.useValue);else if(BB(n))r=()=>n.useFactory(...Xy(n.deps||[]));else if(jB(n))r=()=>ie(jn(n.useExisting));else{let i=jn(n&&(n.useClass||n.provide));if(WB(n))r=()=>new i(...Xy(n.deps));else return Ca(i)||nv(i)}return r}function va(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function WB(n){return!!n.deps}function GB(n){return n!==null&&typeof n=="object"&&typeof n.ngOnDestroy=="function"}function KB(n){return typeof n=="function"||typeof n=="object"&&n instanceof ue}function rv(n,e){for(let t of n)Array.isArray(t)?rv(t,e):t&&mx(t)?rv(t.\u0275providers,e):e(t)}function pi(n,e){n instanceof zl&&n.assertNotDestroyed();let t,r=$i(n),i=Un(void 0);try{return e()}finally{$i(r),Un(i)}}function Ox(){return gx()!==void 0||yB()!=null}function QB(n){if(!Ox())throw new te(-203,!1)}function YB(n){let e=Ut.ng;if(e&&e.\u0275compilerFacade)return e.\u0275compilerFacade;throw new Error("JIT compiler unavailable")}function JB(n){return typeof n=="function"}var mi=0,be=1,le=2,Gt=3,rr=4,cr=5,Lf=6,Wl=7,hi=8,Sa=9,sr=10,Dn=11,Gl=12,LR=13,tu=14,Ar=15,Vv=16,wa=17,tp=18,np=19,Lx=20,Hi=21,$y=22,Ks=23,Qs=25,Fx=1;var Ys=7,Ff=8,Vf=9,Bn=10,Uv=function(n){return n[n.None=0]="None",n[n.HasTransplantedViews=2]="HasTransplantedViews",n}(Uv||{});function Ws(n){return Array.isArray(n)&&typeof n[Fx]=="object"}function gi(n){return Array.isArray(n)&&n[Fx]===!0}function Vx(n){return(n.flags&4)!==0}function jv(n){return n.componentOffset>-1}function Ux(n){return(n.flags&1)===1}function nu(n){return!!n.template}function XB(n){return(n[le]&512)!==0}var iv=class{constructor(e,t,r){this.previousValue=e,this.currentValue=t,this.firstChange=r}isFirstChange(){return this.firstChange}};function jx(n,e,t,r){e!==null?e.applyValueToInputSignal(e,r):n[t]=r}function ru(){return Bx}function Bx(n){return n.type.prototype.ngOnChanges&&(n.setInput=e$),ZB}ru.ngInherit=!0;function ZB(){let n=Hx(this),e=n?.current;if(e){let t=n.previous;if(t===ql)n.previous=e;else for(let r in e)t[r]=e[r];n.current=null,this.ngOnChanges(e)}}function e$(n,e,t,r,i){let s=this.declaredInputs[r],o=Hx(n)||t$(n,{previous:ql,current:null}),a=o.current||(o.current={}),c=o.previous,l=c[s];a[s]=new iv(l&&l.currentValue,t,c===ql),jx(n,e,i,t)}var $x="__ngSimpleChanges__";function Hx(n){return n[$x]||null}function t$(n,e){return n[$x]=e}var FR=null;var Cr=function(n,e,t){FR?.(n,e,t)},n$="svg",r$="math",i$=!1;function s$(){return i$}function fi(n){for(;Array.isArray(n);)n=n[mi];return n}function lr(n,e){return fi(e[n.index])}function qx(n,e){return n.data[e]}function Xs(n,e){let t=e[n];return Ws(t)?t:t[mi]}function Bv(n){return(n[le]&128)===128}function o$(n){return gi(n[Gt])}function VR(n,e){return e==null?null:n[e]}function zx(n){n[wa]=0}function a$(n){n[le]&1024||(n[le]|=1024,Bv(n)&&Kl(n))}function $v(n){return!!(n[le]&9216||n[Ks]?.dirty)}function sv(n){n[sr].changeDetectionScheduler?.notify(1),$v(n)?Kl(n):n[le]&64&&(s$()?(n[le]|=1024,Kl(n)):n[sr].changeDetectionScheduler?.notify())}function Kl(n){n[sr].changeDetectionScheduler?.notify();let e=Ql(n);for(;e!==null&&!(e[le]&8192||(e[le]|=8192,!Bv(e)));)e=Ql(e)}function Wx(n,e){if((n[le]&256)===256)throw new te(911,!1);n[Hi]===null&&(n[Hi]=[]),n[Hi].push(e)}function c$(n,e){if(n[Hi]===null)return;let t=n[Hi].indexOf(e);t!==-1&&n[Hi].splice(t,1)}function Ql(n){let e=n[Gt];return gi(e)?e[Gt]:e}var Ne={lFrame:Zx(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function l$(){return Ne.lFrame.elementDepthCount}function u$(){Ne.lFrame.elementDepthCount++}function d$(){Ne.lFrame.elementDepthCount--}function Gx(){return Ne.bindingsEnabled}function h$(){return Ne.skipHydrationRootTNode!==null}function f$(n){return Ne.skipHydrationRootTNode===n}function p$(){Ne.skipHydrationRootTNode=null}function rn(){return Ne.lFrame.lView}function iu(){return Ne.lFrame.tView}function ur(){let n=Kx();for(;n!==null&&n.type===64;)n=n.parent;return n}function Kx(){return Ne.lFrame.currentTNode}function m$(){let n=Ne.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}function rp(n,e){let t=Ne.lFrame;t.currentTNode=n,t.isParent=e}function Qx(){return Ne.lFrame.isParent}function g$(){Ne.lFrame.isParent=!1}function _$(n){return Ne.lFrame.bindingIndex=n}function y$(){return Ne.lFrame.bindingIndex++}function v$(){return Ne.lFrame.inI18n}function w$(n,e){let t=Ne.lFrame;t.bindingIndex=t.bindingRootIndex=n,ov(e)}function I$(){return Ne.lFrame.currentDirectiveIndex}function ov(n){Ne.lFrame.currentDirectiveIndex=n}function Yx(n){Ne.lFrame.currentQueryIndex=n}function E$(n){let e=n[be];return e.type===2?e.declTNode:e.type===1?n[cr]:null}function Jx(n,e,t){if(t&ye.SkipSelf){let i=e,s=n;for(;i=i.parent,i===null&&!(t&ye.Host);)if(i=E$(s),i===null||(s=s[tu],i.type&10))break;if(i===null)return!1;e=i,n=s}let r=Ne.lFrame=Xx();return r.currentTNode=e,r.lView=n,!0}function Hv(n){let e=Xx(),t=n[be];Ne.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function Xx(){let n=Ne.lFrame,e=n===null?null:n.child;return e===null?Zx(n):e}function Zx(n){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return n!==null&&(n.child=e),e}function eN(){let n=Ne.lFrame;return Ne.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}var tN=eN;function qv(){let n=eN();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function T$(){return Ne.lFrame.selectedIndex}function Js(n){Ne.lFrame.selectedIndex=n}function b$(){let n=Ne.lFrame;return qx(n.tView,n.selectedIndex)}function C$(){return Ne.lFrame.currentNamespace}var nN=!0;function rN(){return nN}function iN(n){nN=n}function D$(n,e,t){let{ngOnChanges:r,ngOnInit:i,ngDoCheck:s}=e.type.prototype;if(r){let o=Bx(e);(t.preOrderHooks??=[]).push(n,o),(t.preOrderCheckHooks??=[]).push(n,o)}i&&(t.preOrderHooks??=[]).push(0-n,i),s&&((t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s))}function sN(n,e){for(let t=e.directiveStart,r=e.directiveEnd;t<r;t++){let s=n.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:c,ngAfterViewChecked:l,ngOnDestroy:d}=s;o&&(n.contentHooks??=[]).push(-t,o),a&&((n.contentHooks??=[]).push(t,a),(n.contentCheckHooks??=[]).push(t,a)),c&&(n.viewHooks??=[]).push(-t,c),l&&((n.viewHooks??=[]).push(t,l),(n.viewCheckHooks??=[]).push(t,l)),d!=null&&(n.destroyHooks??=[]).push(t,d)}}function Af(n,e,t){oN(n,e,3,t)}function Rf(n,e,t,r){(n[le]&3)===t&&oN(n,e,t,r)}function Hy(n,e){let t=n[le];(t&3)===e&&(t&=16383,t+=1,n[le]=t)}function oN(n,e,t,r){let i=r!==void 0?n[wa]&65535:0,s=r??-1,o=e.length-1,a=0;for(let c=i;c<o;c++)if(typeof e[c+1]=="number"){if(a=e[c],r!=null&&a>=r)break}else e[c]<0&&(n[wa]+=65536),(a<s||s==-1)&&(S$(n,t,e,c),n[wa]=(n[wa]&4294901760)+c+2),c++}function UR(n,e){Cr(4,n,e);let t=Me(null);try{e.call(n)}finally{Me(t),Cr(5,n,e)}}function S$(n,e,t,r){let i=t[r]<0,s=t[r+1],o=i?-t[r]:t[r],a=n[o];i?n[le]>>14<n[wa]>>16&&(n[le]&3)===e&&(n[le]+=16384,UR(a,s)):UR(a,s)}var ba=-1,Yl=class{constructor(e,t,r){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=r}};function A$(n){return n instanceof Yl}function R$(n){return(n.flags&8)!==0}function x$(n){return(n.flags&16)!==0}function aN(n){return n!==ba}function Uf(n){return n&32767}function N$(n){return n>>16}function jf(n,e){let t=N$(n),r=e;for(;t>0;)r=r[tu],t--;return r}var av=!0;function jR(n){let e=av;return av=n,e}var P$=256,cN=P$-1,lN=5,M$=0,Dr={};function k$(n,e,t){let r;typeof t=="string"?r=t.charCodeAt(0)||0:t.hasOwnProperty(Bl)&&(r=t[Bl]),r==null&&(r=t[Bl]=M$++);let i=r&cN,s=1<<i;e.data[n+(i>>lN)]|=s}function uN(n,e){let t=dN(n,e);if(t!==-1)return t;let r=e[be];r.firstCreatePass&&(n.injectorIndex=e.length,qy(r.data,n),qy(e,null),qy(r.blueprint,null));let i=zv(n,e),s=n.injectorIndex;if(aN(i)){let o=Uf(i),a=jf(i,e),c=a[be].data;for(let l=0;l<8;l++)e[s+l]=a[o+l]|c[o+l]}return e[s+8]=i,s}function qy(n,e){n.push(0,0,0,0,0,0,0,0,e)}function dN(n,e){return n.injectorIndex===-1||n.parent&&n.parent.injectorIndex===n.injectorIndex||e[n.injectorIndex+8]===null?-1:n.injectorIndex}function zv(n,e){if(n.parent&&n.parent.injectorIndex!==-1)return n.parent.injectorIndex;let t=0,r=null,i=e;for(;i!==null;){if(r=gN(i),r===null)return ba;if(t++,i=i[tu],r.injectorIndex!==-1)return r.injectorIndex|t<<16}return ba}function O$(n,e,t){k$(n,e,t)}function L$(n,e){if(e==="class")return n.classes;if(e==="style")return n.styles;let t=n.attrs;if(t){let r=t.length,i=0;for(;i<r;){let s=t[i];if(bx(s))break;if(s===0)i=i+2;else if(typeof s=="number")for(i++;i<r&&typeof t[i]=="string";)i++;else{if(s===e)return t[i+1];i=i+2}}}return null}function hN(n,e,t){if(t&ye.Optional||n!==void 0)return n;Nv(e,"NodeInjector")}function fN(n,e,t,r){if(t&ye.Optional&&r===void 0&&(r=null),!(t&(ye.Self|ye.Host))){let i=n[Sa],s=Un(void 0);try{return i?i.get(e,r,t&ye.Optional):_x(e,r,t&ye.Optional)}finally{Un(s)}}return hN(r,e,t)}function pN(n,e,t,r=ye.Default,i){if(n!==null){if(e[le]&2048&&!(r&ye.Self)){let o=B$(n,e,t,r,Dr);if(o!==Dr)return o}let s=mN(n,e,t,r,Dr);if(s!==Dr)return s}return fN(e,t,r,i)}function mN(n,e,t,r,i){let s=U$(t);if(typeof s=="function"){if(!Jx(e,n,r))return r&ye.Host?hN(i,t,r):fN(e,t,r,i);try{let o;if(o=s(r),o==null&&!(r&ye.Optional))Nv(t);else return o}finally{tN()}}else if(typeof s=="number"){let o=null,a=dN(n,e),c=ba,l=r&ye.Host?e[Ar][cr]:null;for((a===-1||r&ye.SkipSelf)&&(c=a===-1?zv(n,e):e[a+8],c===ba||!$R(r,!1)?a=-1:(o=e[be],a=Uf(c),e=jf(c,e)));a!==-1;){let d=e[be];if(BR(s,a,d.data)){let h=F$(a,e,t,o,r,l);if(h!==Dr)return h}c=e[a+8],c!==ba&&$R(r,e[be].data[a+8]===l)&&BR(s,a,e)?(o=d,a=Uf(c),e=jf(c,e)):a=-1}}return i}function F$(n,e,t,r,i,s){let o=e[be],a=o.data[n+8],c=r==null?jv(a)&&av:r!=o&&(a.type&3)!==0,l=i&ye.Host&&s===a,d=V$(a,o,t,c,l);return d!==null?Jl(e,o,d,a):Dr}function V$(n,e,t,r,i){let s=n.providerIndexes,o=e.data,a=s&1048575,c=n.directiveStart,l=n.directiveEnd,d=s>>20,h=r?a:a+d,m=i?a+d:l;for(let _=h;_<m;_++){let w=o[_];if(_<c&&t===w||_>=c&&w.type===t)return _}if(i){let _=o[c];if(_&&nu(_)&&_.type===t)return c}return null}function Jl(n,e,t,r){let i=n[t],s=e.data;if(A$(i)){let o=i;o.resolving&&fB(hB(s[t]));let a=jR(o.canSeeViewProviders);o.resolving=!0;let c,l=o.injectImpl?Un(o.injectImpl):null,d=Jx(n,r,ye.Default);try{i=n[t]=o.factory(void 0,s,n,r),e.firstCreatePass&&t>=r.directiveStart&&D$(t,s[t],e)}finally{l!==null&&Un(l),jR(a),o.resolving=!1,tN()}}return i}function U$(n){if(typeof n=="string")return n.charCodeAt(0)||0;let e=n.hasOwnProperty(Bl)?n[Bl]:void 0;return typeof e=="number"?e>=0?e&cN:j$:e}function BR(n,e,t){let r=1<<n;return!!(t[e+(n>>lN)]&r)}function $R(n,e){return!(n&ye.Self)&&!(n&ye.Host&&e)}var Gs=class{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,r){return pN(this._tNode,this._lView,e,Xf(r),t)}};function j$(){return new Gs(ur(),rn())}function Wv(n){return eu(()=>{let e=n.prototype.constructor,t=e[Pf]||cv(e),r=Object.prototype,i=Object.getPrototypeOf(n.prototype).constructor;for(;i&&i!==r;){let s=i[Pf]||cv(i);if(s&&s!==t)return s;i=Object.getPrototypeOf(i)}return s=>new s})}function cv(n){return dx(n)?()=>{let e=cv(jn(n));return e&&e()}:Ca(n)}function B$(n,e,t,r,i){let s=n,o=e;for(;s!==null&&o!==null&&o[le]&2048&&!(o[le]&512);){let a=mN(s,o,t,r|ye.Self,Dr);if(a!==Dr)return a;let c=s.parent;if(!c){let l=o[Lx];if(l){let d=l.get(t,Dr,r);if(d!==Dr)return d}c=gN(o),o=o[tu]}s=c}return i}function gN(n){let e=n[be],t=e.type;return t===2?e.declTNode:t===1?n[cr]:null}function Gv(n){return L$(ur(),n)}function HR(n,e=null,t=null,r){let i=_N(n,e,t,r);return i.resolveInjectorInitializers(),i}function _N(n,e=null,t=null,r,i=new Set){let s=[t||br,VB(n)];return r=r||(typeof n=="object"?void 0:Cn(n)),new zl(s,e||Fv(),r||null,i)}var xr=(()=>{let e=class e{static create(r,i){if(Array.isArray(r))return HR({name:""},i,r,"");{let s=r.name??"";return HR({name:s},r.parent,r.providers,s)}}};e.THROW_IF_NOT_FOUND=Hl,e.NULL=new Of,e.\u0275prov=ne({token:e,providedIn:"any",factory:()=>ie(Ix)}),e.__NG_ELEMENT_ID__=-1;let n=e;return n})();var $$="ngOriginalError";function zy(n){return n[$$]}var Rr=class{constructor(){this._console=console}handleError(e){let t=this._findOriginalError(e);this._console.error("ERROR",e),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&zy(e);for(;t&&zy(t);)t=zy(t);return t||null}},yN=new ue("",{providedIn:"root",factory:()=>G(Rr).handleError.bind(void 0)}),Kv=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=H$,e.__NG_ENV_ID__=r=>r;let n=e;return n})(),lv=class extends Kv{constructor(e){super(),this._lView=e}onDestroy(e){return Wx(this._lView,e),()=>c$(this._lView,e)}};function H$(){return new lv(rn())}function q$(){return Qv(ur(),rn())}function Qv(n,e){return new su(lr(n,e))}var su=(()=>{let e=class e{constructor(r){this.nativeElement=r}};e.__NG_ELEMENT_ID__=q$;let n=e;return n})();var uv=class extends Wt{constructor(e=!1){super(),this.destroyRef=void 0,this.__isAsync=e,Ox()&&(this.destroyRef=G(Kv,{optional:!0})??void 0)}emit(e){let t=Me(null);try{super.next(e)}finally{Me(t)}}subscribe(e,t,r){let i=e,s=t||(()=>null),o=r;if(e&&typeof e=="object"){let c=e;i=c.next?.bind(c),s=c.error?.bind(c),o=c.complete?.bind(c)}this.__isAsync&&(s=Wy(s),i&&(i=Wy(i)),o&&(o=Wy(o)));let a=super.subscribe({next:i,error:s,complete:o});return e instanceof Ct&&e.add(a),a}};function Wy(n){return e=>{setTimeout(n,void 0,e)}}var nn=uv;function vN(n){return(n.flags&128)===128}var wN=new Map,z$=0;function W$(){return z$++}function G$(n){wN.set(n[np],n)}function K$(n){wN.delete(n[np])}var qR="__ngContext__";function Aa(n,e){Ws(e)?(n[qR]=e[np],G$(e)):n[qR]=e}function IN(n){return TN(n[Gl])}function EN(n){return TN(n[rr])}function TN(n){for(;n!==null&&!gi(n);)n=n[rr];return n}var dv;function bN(n){dv=n}function Q$(){if(dv!==void 0)return dv;if(typeof document<"u")return document;throw new te(210,!1)}var ip=new ue("",{providedIn:"root",factory:()=>Y$}),Y$="ng",Yv=new ue(""),Wi=new ue("",{providedIn:"platform",factory:()=>"unknown"});var Jv=new ue("",{providedIn:"root",factory:()=>Q$().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var J$="h",X$="b";var Z$=()=>null;function Xv(n,e,t=!1){return Z$(n,e,t)}var CN=!1,eH=new ue("",{providedIn:"root",factory:()=>CN});var bf;function tH(){if(bf===void 0&&(bf=null,Ut.trustedTypes))try{bf=Ut.trustedTypes.createPolicy("angular",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return bf}function nH(n){return tH()?.createScriptURL(n)||n}var Cf;function rH(){if(Cf===void 0&&(Cf=null,Ut.trustedTypes))try{Cf=Ut.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return Cf}function zR(n){return rH()?.createScriptURL(n)||n}var Bf=class{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${cx})`}};function sp(n){return n instanceof Bf?n.changingThisBreaksApplicationSecurity:n}function Zv(n,e){let t=iH(n);if(t!=null&&t!==e){if(t==="ResourceURL"&&e==="URL")return!0;throw new Error(`Required a safe ${e}, got a ${t} (see ${cx})`)}return t===e}function iH(n){return n instanceof Bf&&n.getTypeName()||null}var sH=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function DN(n){return n=String(n),n.match(sH)?n:"unsafe:"+n}var op=function(n){return n[n.NONE=0]="NONE",n[n.HTML=1]="HTML",n[n.STYLE=2]="STYLE",n[n.SCRIPT=3]="SCRIPT",n[n.URL=4]="URL",n[n.RESOURCE_URL=5]="RESOURCE_URL",n}(op||{});function oH(n){let e=AN();return e?e.sanitize(op.URL,n)||"":Zv(n,"URL")?sp(n):DN(xv(n))}function aH(n){let e=AN();if(e)return zR(e.sanitize(op.RESOURCE_URL,n)||"");if(Zv(n,"ResourceURL"))return zR(sp(n));throw new te(904,!1)}function ou(n){return nH(n[0])}function cH(n,e){return e==="src"&&(n==="embed"||n==="frame"||n==="iframe"||n==="media"||n==="script")||e==="href"&&(n==="base"||n==="link")?aH:oH}function SN(n,e,t){return cH(e,t)(n)}function AN(){let n=rn();return n&&n[sr].sanitizer}function RN(n){return n instanceof Function?n():n}function lH(n){return(n??G(xr)).get(Wi)==="browser"}var Zs=function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n}(Zs||{}),uH;function ew(n,e){return uH(n,e)}function Ia(n,e,t,r,i){if(r!=null){let s,o=!1;gi(r)?s=r:Ws(r)&&(o=!0,r=r[mi]);let a=fi(r);n===0&&t!==null?i==null?kN(e,t,a):$f(e,t,a,i||null,!0):n===1&&t!==null?$f(e,t,a,i||null,!0):n===2?DH(e,a,o):n===3&&e.destroyNode(a),s!=null&&AH(e,n,s,t,i)}}function dH(n,e){return n.createText(e)}function xN(n,e,t){return n.createElement(e,t)}function hH(n,e){NN(n,e),e[mi]=null,e[cr]=null}function fH(n,e,t,r,i,s){r[mi]=i,r[cr]=e,ap(n,r,t,1,i,s)}function NN(n,e){e[sr].changeDetectionScheduler?.notify(1),ap(n,e,e[Dn],2,null,null)}function pH(n){let e=n[Gl];if(!e)return Gy(n[be],n);for(;e;){let t=null;if(Ws(e))t=e[Gl];else{let r=e[Bn];r&&(t=r)}if(!t){for(;e&&!e[rr]&&e!==n;)Ws(e)&&Gy(e[be],e),e=e[Gt];e===null&&(e=n),Ws(e)&&Gy(e[be],e),t=e&&e[rr]}e=t}}function mH(n,e,t,r){let i=Bn+r,s=t.length;r>0&&(t[i-1][rr]=e),r<s-Bn?(e[rr]=t[i],wx(t,Bn+r,e)):(t.push(e),e[rr]=null),e[Gt]=t;let o=e[Vv];o!==null&&t!==o&&gH(o,e);let a=e[tp];a!==null&&a.insertView(n),sv(e),e[le]|=128}function gH(n,e){let t=n[Vf],i=e[Gt][Gt][Ar];e[Ar]!==i&&(n[le]|=Uv.HasTransplantedViews),t===null?n[Vf]=[e]:t.push(e)}function PN(n,e){let t=n[Vf],r=t.indexOf(e);t.splice(r,1)}function hv(n,e){if(n.length<=Bn)return;let t=Bn+e,r=n[t];if(r){let i=r[Vv];i!==null&&i!==n&&PN(i,r),e>0&&(n[t-1][rr]=r[rr]);let s=kf(n,Bn+e);hH(r[be],r);let o=s[tp];o!==null&&o.detachView(s[be]),r[Gt]=null,r[rr]=null,r[le]&=-129}return r}function MN(n,e){if(!(e[le]&256)){let t=e[Dn];t.destroyNode&&ap(n,e,t,3,null,null),pH(e)}}function Gy(n,e){if(e[le]&256)return;let t=Me(null);try{e[le]&=-129,e[le]|=256,e[Ks]&&YA(e[Ks]),yH(n,e),_H(n,e),e[be].type===1&&e[Dn].destroy();let r=e[Vv];if(r!==null&&gi(e[Gt])){r!==e[Gt]&&PN(r,e);let i=e[tp];i!==null&&i.detachView(n)}K$(e)}finally{Me(t)}}function _H(n,e){let t=n.cleanup,r=e[Wl];if(t!==null)for(let s=0;s<t.length-1;s+=2)if(typeof t[s]=="string"){let o=t[s+3];o>=0?r[o]():r[-o].unsubscribe(),s+=2}else{let o=r[t[s+1]];t[s].call(o)}r!==null&&(e[Wl]=null);let i=e[Hi];if(i!==null){e[Hi]=null;for(let s=0;s<i.length;s++){let o=i[s];o()}}}function yH(n,e){let t;if(n!=null&&(t=n.destroyHooks)!=null)for(let r=0;r<t.length;r+=2){let i=e[t[r]];if(!(i instanceof Yl)){let s=t[r+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){let a=i[s[o]],c=s[o+1];Cr(4,a,c);try{c.call(a)}finally{Cr(5,a,c)}}else{Cr(4,i,s);try{s.call(i)}finally{Cr(5,i,s)}}}}}function vH(n,e,t){return wH(n,e.parent,t)}function wH(n,e,t){let r=e;for(;r!==null&&r.type&40;)e=r,r=e.parent;if(r===null)return t[mi];{let{componentOffset:i}=r;if(i>-1){let{encapsulation:s}=n.data[r.directiveStart+i];if(s===Sr.None||s===Sr.Emulated)return null}return lr(r,t)}}function $f(n,e,t,r,i){n.insertBefore(e,t,r,i)}function kN(n,e,t){n.appendChild(e,t)}function WR(n,e,t,r,i){r!==null?$f(n,e,t,r,i):kN(n,e,t)}function IH(n,e,t,r){n.removeChild(e,t,r)}function tw(n,e){return n.parentNode(e)}function EH(n,e){return n.nextSibling(e)}function TH(n,e,t){return CH(n,e,t)}function bH(n,e,t){return n.type&40?lr(n,t):null}var CH=bH,GR;function ON(n,e,t,r){let i=vH(n,r,e),s=e[Dn],o=r.parent||e[cr],a=TH(o,r,e);if(i!=null)if(Array.isArray(t))for(let c=0;c<t.length;c++)WR(s,i,t[c],a,!1);else WR(s,i,t,a,!1);GR!==void 0&&GR(s,r,e,t,i)}function xf(n,e){if(e!==null){let t=e.type;if(t&3)return lr(e,n);if(t&4)return fv(-1,n[e.index]);if(t&8){let r=e.child;if(r!==null)return xf(n,r);{let i=n[e.index];return gi(i)?fv(-1,i):fi(i)}}else{if(t&32)return ew(e,n)()||fi(n[e.index]);{let r=LN(n,e);if(r!==null){if(Array.isArray(r))return r[0];let i=Ql(n[Ar]);return xf(i,r)}else return xf(n,e.next)}}}return null}function LN(n,e){if(e!==null){let r=n[Ar][cr],i=e.projection;return r.projection[i]}return null}function fv(n,e){let t=Bn+n+1;if(t<e.length){let r=e[t],i=r[be].firstChild;if(i!==null)return xf(r,i)}return e[Ys]}function DH(n,e,t){let r=tw(n,e);r&&IH(n,r,e,t)}function nw(n,e,t,r,i,s,o){for(;t!=null;){let a=r[t.index],c=t.type;if(o&&e===0&&(a&&Aa(fi(a),r),t.flags|=2),(t.flags&32)!==32)if(c&8)nw(n,e,t.child,r,i,s,!1),Ia(e,n,i,a,s);else if(c&32){let l=ew(t,r),d;for(;d=l();)Ia(e,n,i,d,s);Ia(e,n,i,a,s)}else c&16?SH(n,e,r,t,i,s):Ia(e,n,i,a,s);t=o?t.projectionNext:t.next}}function ap(n,e,t,r,i,s){nw(t,r,n.firstChild,e,i,s,!1)}function SH(n,e,t,r,i,s){let o=t[Ar],c=o[cr].projection[r.projection];if(Array.isArray(c))for(let l=0;l<c.length;l++){let d=c[l];Ia(e,n,i,d,s)}else{let l=c,d=o[Gt];vN(r)&&(l.flags|=128),nw(n,e,l,d,i,s,!0)}}function AH(n,e,t,r,i){let s=t[Ys],o=fi(t);s!==o&&Ia(e,n,r,s,i);for(let a=Bn;a<t.length;a++){let c=t[a];ap(c[be],c,n,e,r,s)}}function RH(n,e,t){n.setAttribute(e,"style",t)}function FN(n,e,t){t===""?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function VN(n,e,t){let{mergedAttrs:r,classes:i,styles:s}=t;r!==null&&Zy(n,e,r),i!==null&&FN(n,e,i),s!==null&&RH(n,e,s)}var UN={};function xH(n,e,t,r){if(!r)if((e[le]&3)===3){let s=n.preOrderCheckHooks;s!==null&&Af(e,s,t)}else{let s=n.preOrderHooks;s!==null&&Rf(e,s,0,t)}Js(t)}function $n(n,e=ye.Default){let t=rn();if(t===null)return ie(n,e);let r=ur();return pN(r,t,jn(n),e)}function jN(){let n="invalid";throw new Error(n)}function BN(n,e,t,r,i,s){let o=Me(null);try{let a=null;i&ir.SignalBased&&(a=e[r][WA]),a!==null&&a.transformFn!==void 0&&(s=a.transformFn(s)),i&ir.HasDecoratorInputTransform&&(s=n.inputTransforms[r].call(e,s)),n.setInput!==null?n.setInput(e,a,s,t,r):jx(e,a,r,s)}finally{Me(o)}}function NH(n,e){let t=n.hostBindingOpCodes;if(t!==null)try{for(let r=0;r<t.length;r++){let i=t[r];if(i<0)Js(~i);else{let s=i,o=t[++r],a=t[++r];w$(o,s);let c=e[s];a(2,c)}}}finally{Js(-1)}}function rw(n,e,t,r,i,s,o,a,c,l,d){let h=e.blueprint.slice();return h[mi]=i,h[le]=r|4|128|8|64,(l!==null||n&&n[le]&2048)&&(h[le]|=2048),zx(h),h[Gt]=h[tu]=n,h[hi]=t,h[sr]=o||n&&n[sr],h[Dn]=a||n&&n[Dn],h[Sa]=c||n&&n[Sa]||null,h[cr]=s,h[np]=W$(),h[Lf]=d,h[Lx]=l,h[Ar]=e.type==2?n[Ar]:h,h}function iw(n,e,t,r,i){let s=n.data[e];if(s===null)s=PH(n,e,t,r,i),v$()&&(s.flags|=32);else if(s.type&64){s.type=t,s.value=r,s.attrs=i;let o=m$();s.injectorIndex=o===null?-1:o.injectorIndex}return rp(s,!0),s}function PH(n,e,t,r,i){let s=Kx(),o=Qx(),a=o?s:s&&s.parent,c=n.data[e]=UH(n,a,t,e,r,i);return n.firstChild===null&&(n.firstChild=c),s!==null&&(o?s.child==null&&c.parent!==null&&(s.child=c):s.next===null&&(s.next=c,c.prev=s)),c}function $N(n,e,t,r){if(t===0)return-1;let i=e.length;for(let s=0;s<t;s++)e.push(r),n.blueprint.push(r),n.data.push(null);return i}function HN(n,e,t,r,i){let s=T$(),o=r&2;try{Js(-1),o&&e.length>Qs&&xH(n,e,Qs,!1),Cr(o?2:0,i),t(r,i)}finally{Js(s),Cr(o?3:1,i)}}function qN(n,e,t){if(Vx(e)){let r=Me(null);try{let i=e.directiveStart,s=e.directiveEnd;for(let o=i;o<s;o++){let a=n.data[o];if(a.contentQueries){let c=t[o];a.contentQueries(1,c,o)}}}finally{Me(r)}}}function MH(n,e,t){Gx()&&(qH(n,e,t,lr(t,e)),(t.flags&64)===64&&KN(n,e,t))}function kH(n,e,t=lr){let r=e.localNames;if(r!==null){let i=e.index+1;for(let s=0;s<r.length;s+=2){let o=r[s+1],a=o===-1?t(e,n):n[o];n[i++]=a}}}function zN(n){let e=n.tView;return e===null||e.incompleteFirstPass?n.tView=WN(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function WN(n,e,t,r,i,s,o,a,c,l,d){let h=Qs+r,m=h+i,_=OH(h,m),w=typeof l=="function"?l():l;return _[be]={type:n,blueprint:_,template:t,queries:null,viewQuery:a,declTNode:e,data:_.slice().fill(null,h),bindingStartIndex:h,expandoStartIndex:m,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof s=="function"?s():s,pipeRegistry:typeof o=="function"?o():o,firstChild:null,schemas:c,consts:w,incompleteFirstPass:!1,ssrId:d}}function OH(n,e){let t=[];for(let r=0;r<e;r++)t.push(r<n?null:UN);return t}function LH(n,e,t,r){let s=r.get(eH,CN)||t===Sr.ShadowDom,o=n.selectRootElement(e,s);return FH(o),o}function FH(n){VH(n)}var VH=()=>null;function UH(n,e,t,r,i,s){let o=e?e.injectorIndex:-1,a=0;return h$()&&(a|=128),{type:t,index:r,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function KR(n,e,t,r,i){for(let s in e){if(!e.hasOwnProperty(s))continue;let o=e[s];if(o===void 0)continue;r??={};let a,c=ir.None;Array.isArray(o)?(a=o[0],c=o[1]):a=o;let l=s;if(i!==null){if(!i.hasOwnProperty(s))continue;l=i[s]}n===0?QR(r,t,l,a,c):QR(r,t,l,a)}return r}function QR(n,e,t,r,i){let s;n.hasOwnProperty(t)?(s=n[t]).push(e,r):s=n[t]=[e,r],i!==void 0&&s.push(i)}function jH(n,e,t){let r=e.directiveStart,i=e.directiveEnd,s=n.data,o=e.attrs,a=[],c=null,l=null;for(let d=r;d<i;d++){let h=s[d],m=t?t.get(h):null,_=m?m.inputs:null,w=m?m.outputs:null;c=KR(0,h.inputs,d,c,_),l=KR(1,h.outputs,d,l,w);let C=c!==null&&o!==null&&!Ov(e)?tq(c,d,o):null;a.push(C)}c!==null&&(c.hasOwnProperty("class")&&(e.flags|=8),c.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=c,e.outputs=l}function BH(n,e,t,r){if(Gx()){let i=r===null?null:{"":-1},s=WH(n,t),o,a;s===null?o=a=null:[o,a]=s,o!==null&&GN(n,e,t,o,i,a),i&&GH(t,r,i)}t.mergedAttrs=kv(t.mergedAttrs,t.attrs)}function GN(n,e,t,r,i,s){for(let l=0;l<r.length;l++)O$(uN(t,e),n,r[l].type);QH(t,n.data.length,r.length);for(let l=0;l<r.length;l++){let d=r[l];d.providersResolver&&d.providersResolver(d)}let o=!1,a=!1,c=$N(n,e,r.length,null);for(let l=0;l<r.length;l++){let d=r[l];t.mergedAttrs=kv(t.mergedAttrs,d.hostAttrs),YH(n,t,e,c,d),KH(c,d,i),d.contentQueries!==null&&(t.flags|=4),(d.hostBindings!==null||d.hostAttrs!==null||d.hostVars!==0)&&(t.flags|=64);let h=d.type.prototype;!o&&(h.ngOnChanges||h.ngOnInit||h.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),o=!0),!a&&(h.ngOnChanges||h.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),a=!0),c++}jH(n,t,s)}function $H(n,e,t,r,i){let s=i.hostBindings;if(s){let o=n.hostBindingOpCodes;o===null&&(o=n.hostBindingOpCodes=[]);let a=~e.index;HH(o)!=a&&o.push(a),o.push(t,r,s)}}function HH(n){let e=n.length;for(;e>0;){let t=n[--e];if(typeof t=="number"&&t<0)return t}return 0}function qH(n,e,t,r){let i=t.directiveStart,s=t.directiveEnd;jv(t)&&JH(e,t,n.data[i+t.componentOffset]),n.firstCreatePass||uN(t,e),Aa(r,e);let o=t.initialInputs;for(let a=i;a<s;a++){let c=n.data[a],l=Jl(e,n,a,t);if(Aa(l,e),o!==null&&eq(e,a-i,l,c,t,o),nu(c)){let d=Xs(t.index,e);d[hi]=Jl(e,n,a,t)}}}function KN(n,e,t){let r=t.directiveStart,i=t.directiveEnd,s=t.index,o=I$();try{Js(s);for(let a=r;a<i;a++){let c=n.data[a],l=e[a];ov(a),(c.hostBindings!==null||c.hostVars!==0||c.hostAttrs!==null)&&zH(c,l)}}finally{Js(-1),ov(o)}}function zH(n,e){n.hostBindings!==null&&n.hostBindings(1,e)}function WH(n,e){let t=n.directiveRegistry,r=null,i=null;if(t)for(let s=0;s<t.length;s++){let o=t[s];if(RB(e,o.selectors,!1))if(r||(r=[]),nu(o))if(o.findHostDirectiveDefs!==null){let a=[];i=i||new Map,o.findHostDirectiveDefs(o,a,i),r.unshift(...a,o);let c=a.length;pv(n,e,c)}else r.unshift(o),pv(n,e,0);else i=i||new Map,o.findHostDirectiveDefs?.(o,r,i),r.push(o)}return r===null?null:[r,i]}function pv(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function GH(n,e,t){if(e){let r=n.localNames=[];for(let i=0;i<e.length;i+=2){let s=t[e[i+1]];if(s==null)throw new te(-301,!1);r.push(e[i],s)}}}function KH(n,e,t){if(t){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)t[e.exportAs[r]]=n;nu(e)&&(t[""]=n)}}function QH(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}function YH(n,e,t,r,i){n.data[r]=i;let s=i.factory||(i.factory=Ca(i.type,!0)),o=new Yl(s,nu(i),$n);n.blueprint[r]=o,t[r]=o,$H(n,e,r,$N(n,t,i.hostVars,UN),i)}function JH(n,e,t){let r=lr(e,n),i=zN(t),s=n[sr].rendererFactory,o=16;t.signals?o=4096:t.onPush&&(o=64);let a=sw(n,rw(n,i,null,o,r,e,null,s.createRenderer(r,t),null,null,null));n[e.index]=a}function XH(n,e,t,r,i,s){let o=lr(n,e);ZH(e[Dn],o,s,n.value,t,r,i)}function ZH(n,e,t,r,i,s,o){if(s==null)n.removeAttribute(e,i,t);else{let a=o==null?xv(s):o(s,r||"",i);n.setAttribute(e,i,a,t)}}function eq(n,e,t,r,i,s){let o=s[e];if(o!==null)for(let a=0;a<o.length;){let c=o[a++],l=o[a++],d=o[a++],h=o[a++];BN(r,t,c,l,d,h)}}function tq(n,e,t){let r=null,i=0;for(;i<t.length;){let s=t[i];if(s===0){i+=4;continue}else if(s===5){i+=2;continue}if(typeof s=="number")break;if(n.hasOwnProperty(s)){r===null&&(r=[]);let o=n[s];for(let a=0;a<o.length;a+=3)if(o[a]===e){r.push(s,o[a+1],o[a+2],t[i+1]);break}}i+=2}return r}function nq(n,e,t,r){return[n,!0,0,e,null,r,null,t,null,null]}function QN(n,e){let t=n.contentQueries;if(t!==null){let r=Me(null);try{for(let i=0;i<t.length;i+=2){let s=t[i],o=t[i+1];if(o!==-1){let a=n.data[o];Yx(s),a.contentQueries(2,e[o],o)}}}finally{Me(r)}}}function sw(n,e){return n[Gl]?n[LR][rr]=e:n[Gl]=e,n[LR]=e,e}function mv(n,e,t){Yx(0);let r=Me(null);try{e(n,t)}finally{Me(r)}}function rq(n){return n[Wl]||(n[Wl]=[])}function iq(n){return n.cleanup||(n.cleanup=[])}function YN(n,e){let t=n[Sa],r=t?t.get(Rr,null):null;r&&r.handleError(e)}function JN(n,e,t,r,i){for(let s=0;s<t.length;){let o=t[s++],a=t[s++],c=t[s++],l=e[o],d=n.data[o];BN(d,l,r,a,c,i)}}function sq(n,e){let t=Xs(e,n),r=t[be];oq(r,t);let i=t[mi];i!==null&&t[Lf]===null&&(t[Lf]=Xv(i,t[Sa])),XN(r,t,t[hi])}function oq(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}function XN(n,e,t){Hv(e);try{let r=n.viewQuery;r!==null&&mv(1,r,t);let i=n.template;i!==null&&HN(n,e,i,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),e[tp]?.finishViewCreation(n),n.staticContentQueries&&QN(n,e),n.staticViewQueries&&mv(2,n.viewQuery,t);let s=n.components;s!==null&&aq(e,s)}catch(r){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),r}finally{e[le]&=-5,qv()}}function aq(n,e){for(let t=0;t<e.length;t++)sq(n,e[t])}function YR(n,e){return!e||e.firstChild===null||vN(n)}function cq(n,e,t,r=!0){let i=e[be];if(mH(i,e,n,t),r){let o=fv(t,n),a=e[Dn],c=tw(a,n[Ys]);c!==null&&fH(i,n[cr],a,e,c,o)}let s=e[Lf];s!==null&&s.firstChild!==null&&(s.firstChild=null)}function Hf(n,e,t,r,i=!1){for(;t!==null;){let s=e[t.index];s!==null&&r.push(fi(s)),gi(s)&&lq(s,r);let o=t.type;if(o&8)Hf(n,e,t.child,r);else if(o&32){let a=ew(t,e),c;for(;c=a();)r.push(c)}else if(o&16){let a=LN(e,t);if(Array.isArray(a))r.push(...a);else{let c=Ql(e[Ar]);Hf(c[be],c,a,r,!0)}}t=i?t.projectionNext:t.next}return r}function lq(n,e){for(let t=Bn;t<n.length;t++){let r=n[t],i=r[be].firstChild;i!==null&&Hf(r[be],r,i,e)}n[Ys]!==n[mi]&&e.push(n[Ys])}var ZN=[];function uq(n){return n[Ks]??dq(n)}function dq(n){let e=ZN.pop()??Object.create(fq);return e.lView=n,e}function hq(n){n.lView[Ks]!==n&&(n.lView=null,ZN.push(n))}var fq=it(X({},GA),{consumerIsAlwaysLive:!0,consumerMarkedDirty:n=>{Kl(n.lView)},consumerOnSignalRead(){this.lView[Ks]=this}}),eP=100;function tP(n,e=!0,t=0){let r=n[sr],i=r.rendererFactory,s=!1;s||i.begin?.();try{pq(n,t)}catch(o){throw e&&YN(n,o),o}finally{s||(i.end?.(),r.inlineEffectRunner?.flush())}}function pq(n,e){gv(n,e);let t=0;for(;$v(n);){if(t===eP)throw new te(103,!1);t++,gv(n,1)}}function mq(n,e,t,r){let i=e[le];if((i&256)===256)return;let s=!1;!s&&e[sr].inlineEffectRunner?.flush(),Hv(e);let o=null,a=null;!s&&gq(n)&&(a=uq(e),o=KA(a));try{zx(e),_$(n.bindingStartIndex),t!==null&&HN(n,e,t,2,r);let c=(i&3)===3;if(!s)if(c){let h=n.preOrderCheckHooks;h!==null&&Af(e,h,null)}else{let h=n.preOrderHooks;h!==null&&Rf(e,h,0,null),Hy(e,0)}if(_q(e),nP(e,0),n.contentQueries!==null&&QN(n,e),!s)if(c){let h=n.contentCheckHooks;h!==null&&Af(e,h)}else{let h=n.contentHooks;h!==null&&Rf(e,h,1),Hy(e,1)}NH(n,e);let l=n.components;l!==null&&iP(e,l,0);let d=n.viewQuery;if(d!==null&&mv(2,d,r),!s)if(c){let h=n.viewCheckHooks;h!==null&&Af(e,h)}else{let h=n.viewHooks;h!==null&&Rf(e,h,2),Hy(e,2)}if(n.firstUpdatePass===!0&&(n.firstUpdatePass=!1),e[$y]){for(let h of e[$y])h();e[$y]=null}s||(e[le]&=-73)}catch(c){throw Kl(e),c}finally{a!==null&&(QA(a,o),hq(a)),qv()}}function gq(n){return n.type!==2}function nP(n,e){for(let t=IN(n);t!==null;t=EN(t))for(let r=Bn;r<t.length;r++){let i=t[r];rP(i,e)}}function _q(n){for(let e=IN(n);e!==null;e=EN(e)){if(!(e[le]&Uv.HasTransplantedViews))continue;let t=e[Vf];for(let r=0;r<t.length;r++){let i=t[r],s=i[Gt];a$(i)}}}function yq(n,e,t){let r=Xs(e,n);rP(r,t)}function rP(n,e){Bv(n)&&gv(n,e)}function gv(n,e){let r=n[be],i=n[le],s=n[Ks],o=!!(e===0&&i&16);if(o||=!!(i&64&&e===0),o||=!!(i&1024),o||=!!(s?.dirty&&Ty(s)),s&&(s.dirty=!1),n[le]&=-9217,o)mq(r,n,r.template,n[hi]);else if(i&8192){nP(n,1);let a=r.components;a!==null&&iP(n,a,1)}}function iP(n,e,t){for(let r=0;r<e.length;r++)yq(n,e[r],t)}function ow(n){for(n[sr].changeDetectionScheduler?.notify();n;){n[le]|=64;let e=Ql(n);if(XB(n)&&!e)return n;n=e}return null}var Ra=class{get rootNodes(){let e=this._lView,t=e[be];return Hf(t,e,t.firstChild,[])}constructor(e,t,r=!0){this._lView=e,this._cdRefInjectingView=t,this.notifyErrorHandler=r,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[hi]}set context(e){this._lView[hi]=e}get destroyed(){return(this._lView[le]&256)===256}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[Gt];if(gi(e)){let t=e[Ff],r=t?t.indexOf(this):-1;r>-1&&(hv(e,r),kf(t,r))}this._attachedToViewContainer=!1}MN(this._lView[be],this._lView)}onDestroy(e){Wx(this._lView,e)}markForCheck(){ow(this._cdRefInjectingView||this._lView)}detach(){this._lView[le]&=-129}reattach(){sv(this._lView),this._lView[le]|=128}detectChanges(){this._lView[le]|=1024,tP(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new te(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,NN(this._lView[be],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new te(902,!1);this._appRef=e,sv(this._lView)}};var lre=new RegExp(`^(\\d+)*(${X$}|${J$})*(.*)`);var vq=()=>null;function JR(n,e){return vq(n,e)}var qf=class{},_v=class{},zf=class{};function wq(n){let e=Error(`No component factory found for ${Cn(n)}.`);return e[Iq]=n,e}var Iq="ngComponent";var yv=class{resolveComponentFactory(e){throw wq(e)}},cp=(()=>{let e=class e{};e.NULL=new yv;let n=e;return n})(),Xl=class{},lp=(()=>{let e=class e{constructor(){this.destroyNode=null}};e.__NG_ELEMENT_ID__=()=>Eq();let n=e;return n})();function Eq(){let n=rn(),e=ur(),t=Xs(e.index,n);return(Ws(t)?t:n)[Dn]}var Tq=(()=>{let e=class e{};e.\u0275prov=ne({token:e,providedIn:"root",factory:()=>null});let n=e;return n})(),Ky={};var XR=new Set;function aw(n){XR.has(n)||(XR.add(n),performance?.mark?.("mark_feature_usage",{detail:{feature:n}}))}function ZR(...n){}function bq(){let n=typeof Ut.requestAnimationFrame=="function",e=Ut[n?"requestAnimationFrame":"setTimeout"],t=Ut[n?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&e&&t){let r=e[Zone.__symbol__("OriginalDelegate")];r&&(e=r);let i=t[Zone.__symbol__("OriginalDelegate")];i&&(t=i)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:t}}var $e=class n{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new nn(!1),this.onMicrotaskEmpty=new nn(!1),this.onStable=new nn(!1),this.onError=new nn(!1),typeof Zone>"u")throw new te(908,!1);Zone.assertZonePatched();let i=this;i._nesting=0,i._outer=i._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(i._inner=i._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(i._inner=i._inner.fork(Zone.longStackTraceZoneSpec)),i.shouldCoalesceEventChangeDetection=!r&&t,i.shouldCoalesceRunChangeDetection=r,i.lastRequestAnimationFrameId=-1,i.nativeRequestAnimationFrame=bq().nativeRequestAnimationFrame,Sq(i)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get("isAngularZone")===!0}static assertInAngularZone(){if(!n.isInAngularZone())throw new te(909,!1)}static assertNotInAngularZone(){if(n.isInAngularZone())throw new te(909,!1)}run(e,t,r){return this._inner.run(e,t,r)}runTask(e,t,r,i){let s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+i,e,Cq,ZR,ZR);try{return s.runTask(o,t,r)}finally{s.cancelTask(o)}}runGuarded(e,t,r){return this._inner.runGuarded(e,t,r)}runOutsideAngular(e){return this._outer.run(e)}},Cq={};function cw(n){if(n._nesting==0&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function Dq(n){n.isCheckStableRunning||n.lastRequestAnimationFrameId!==-1||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(Ut,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,vv(n),n.isCheckStableRunning=!0,cw(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),vv(n))}function Sq(n){let e=()=>{Dq(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,r,i,s,o,a)=>{if(Aq(a))return t.invokeTask(i,s,o,a);try{return ex(n),t.invokeTask(i,s,o,a)}finally{(n.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||n.shouldCoalesceRunChangeDetection)&&e(),tx(n)}},onInvoke:(t,r,i,s,o,a,c)=>{try{return ex(n),t.invoke(i,s,o,a,c)}finally{n.shouldCoalesceRunChangeDetection&&e(),tx(n)}},onHasTask:(t,r,i,s)=>{t.hasTask(i,s),r===i&&(s.change=="microTask"?(n._hasPendingMicrotasks=s.microTask,vv(n),cw(n)):s.change=="macroTask"&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(t,r,i,s)=>(t.handleError(i,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}function vv(n){n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&n.lastRequestAnimationFrameId!==-1?n.hasPendingMicrotasks=!0:n.hasPendingMicrotasks=!1}function ex(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function tx(n){n._nesting--,cw(n)}var wv=class{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new nn,this.onMicrotaskEmpty=new nn,this.onStable=new nn,this.onError=new nn}run(e,t,r){return e.apply(t,r)}runGuarded(e,t,r){return e.apply(t,r)}runOutsideAngular(e){return e()}runTask(e,t,r,i){return e.apply(t,r)}};function Aq(n){return!Array.isArray(n)||n.length!==1?!1:n[0].data?.__ignore_ng_zone__===!0}function Rq(n="zone.js",e){return n==="noop"?new wv:n==="zone.js"?new $e(e):n}var Ea=function(n){return n[n.EarlyRead=0]="EarlyRead",n[n.Write=1]="Write",n[n.MixedReadWrite=2]="MixedReadWrite",n[n.Read=3]="Read",n}(Ea||{}),xq={destroy(){}};function up(n,e){!e&&QB(up);let t=e?.injector??G(xr);if(!lH(t))return xq;aw("NgAfterNextRender");let r=t.get(lw),i=r.handler??=new Ev,s=e?.phase??Ea.MixedReadWrite,o=()=>{i.unregister(c),a()},a=t.get(Kv).onDestroy(o),c=pi(t,()=>new Iv(s,()=>{o(),n()}));return i.register(c),{destroy:o}}var Iv=class{constructor(e,t){this.phase=e,this.callbackFn=t,this.zone=G($e),this.errorHandler=G(Rr,{optional:!0}),G(qf,{optional:!0})?.notify(1)}invoke(){try{this.zone.runOutsideAngular(this.callbackFn)}catch(e){this.errorHandler?.handleError(e)}}},Ev=class{constructor(){this.executingCallbacks=!1,this.buckets={[Ea.EarlyRead]:new Set,[Ea.Write]:new Set,[Ea.MixedReadWrite]:new Set,[Ea.Read]:new Set},this.deferredCallbacks=new Set}register(e){(this.executingCallbacks?this.deferredCallbacks:this.buckets[e.phase]).add(e)}unregister(e){this.buckets[e.phase].delete(e),this.deferredCallbacks.delete(e)}execute(){this.executingCallbacks=!0;for(let e of Object.values(this.buckets))for(let t of e)t.invoke();this.executingCallbacks=!1;for(let e of this.deferredCallbacks)this.buckets[e.phase].add(e);this.deferredCallbacks.clear()}destroy(){for(let e of Object.values(this.buckets))e.clear();this.deferredCallbacks.clear()}},lw=(()=>{let e=class e{constructor(){this.handler=null,this.internalCallbacks=[]}execute(){this.executeInternalCallbacks(),this.handler?.execute()}executeInternalCallbacks(){let r=[...this.internalCallbacks];this.internalCallbacks.length=0;for(let i of r)i()}ngOnDestroy(){this.handler?.destroy(),this.handler=null,this.internalCallbacks.length=0}};e.\u0275prov=ne({token:e,providedIn:"root",factory:()=>new e});let n=e;return n})();function Tv(n,e,t){let r=t?n.styles:null,i=t?n.classes:null,s=0;if(e!==null)for(let o=0;o<e.length;o++){let a=e[o];if(typeof a=="number")s=a;else if(s==1)i=DR(i,a);else if(s==2){let c=a,l=e[++o];r=DR(r,c+": "+l+";")}}t?n.styles=r:n.stylesWithoutHost=r,t?n.classes=i:n.classesWithoutHost=i}var Wf=class extends cp{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let t=qi(e);return new xa(t,this.ngModule)}};function nx(n){let e=[];for(let t in n){if(!n.hasOwnProperty(t))continue;let r=n[t];r!==void 0&&e.push({propName:Array.isArray(r)?r[0]:r,templateName:t})}return e}function Nq(n){let e=n.toLowerCase();return e==="svg"?n$:e==="math"?r$:null}var bv=class{constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,r){r=Xf(r);let i=this.injector.get(e,Ky,r);return i!==Ky||t===Ky?i:this.parentInjector.get(e,t,r)}},xa=class extends zf{get inputs(){let e=this.componentDef,t=e.inputTransforms,r=nx(e.inputs);if(t!==null)for(let i of r)t.hasOwnProperty(i.propName)&&(i.transform=t[i.propName]);return r}get outputs(){return nx(this.componentDef.outputs)}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=MB(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}create(e,t,r,i){let s=Me(null);try{i=i||this.ngModule;let o=i instanceof gn?i:i?.injector;o&&this.componentDef.getStandaloneInjector!==null&&(o=this.componentDef.getStandaloneInjector(o)||o);let a=o?new bv(e,o):e,c=a.get(Xl,null);if(c===null)throw new te(407,!1);let l=a.get(Tq,null),d=a.get(lw,null),h=a.get(qf,null),m={rendererFactory:c,sanitizer:l,inlineEffectRunner:null,afterRenderEventManager:d,changeDetectionScheduler:h},_=c.createRenderer(null,this.componentDef),w=this.componentDef.selectors[0][0]||"div",C=r?LH(_,r,this.componentDef.encapsulation,a):xN(_,w,Nq(w)),A=512;this.componentDef.signals?A|=4096:this.componentDef.onPush||(A|=16);let L=null;C!==null&&(L=Xv(C,a,!0));let H=WN(0,null,null,1,0,null,null,null,null,null,null),j=rw(null,H,null,A,null,null,m,_,a,null,L);Hv(j);let Q,se;try{let J=this.componentDef,T,v=null;J.findHostDirectiveDefs?(T=[],v=new Map,J.findHostDirectiveDefs(J,T,v),T.push(J)):T=[J];let I=Pq(j,C),b=Mq(I,C,J,T,j,m,_);se=qx(H,Qs),C&&Lq(_,J,C,r),t!==void 0&&Fq(se,this.ngContentSelectors,t),Q=Oq(b,J,T,v,j,[Vq]),XN(H,j,null)}finally{qv()}return new Cv(this.componentType,Q,Qv(se,j),j,se)}finally{Me(s)}}},Cv=class extends _v{constructor(e,t,r,i,s){super(),this.location=r,this._rootLView=i,this._tNode=s,this.previousInputValues=null,this.instance=t,this.hostView=this.changeDetectorRef=new Ra(i,void 0,!1),this.componentType=e}setInput(e,t){let r=this._tNode.inputs,i;if(r!==null&&(i=r[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;let s=this._rootLView;JN(s[be],s,i,e,t),this.previousInputValues.set(e,t);let o=Xs(this._tNode.index,s);ow(o)}}get injector(){return new Gs(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function Pq(n,e){let t=n[be],r=Qs;return n[r]=e,iw(t,r,2,"#host",null)}function Mq(n,e,t,r,i,s,o){let a=i[be];kq(r,n,e,o);let c=null;e!==null&&(c=Xv(e,i[Sa]));let l=s.rendererFactory.createRenderer(e,t),d=16;t.signals?d=4096:t.onPush&&(d=64);let h=rw(i,zN(t),null,d,i[n.index],n,s,l,null,null,c);return a.firstCreatePass&&pv(a,n,r.length-1),sw(i,h),i[n.index]=h}function kq(n,e,t,r){for(let i of n)e.mergedAttrs=kv(e.mergedAttrs,i.hostAttrs);e.mergedAttrs!==null&&(Tv(e,e.mergedAttrs,!0),t!==null&&VN(r,t,e))}function Oq(n,e,t,r,i,s){let o=ur(),a=i[be],c=lr(o,i);GN(a,i,o,t,null,r);for(let d=0;d<t.length;d++){let h=o.directiveStart+d,m=Jl(i,a,h,o);Aa(m,i)}KN(a,i,o),c&&Aa(c,i);let l=Jl(i,a,o.directiveStart+o.componentOffset,o);if(n[hi]=i[hi]=l,s!==null)for(let d of s)d(l,e);return qN(a,o,i),l}function Lq(n,e,t,r){if(r)Zy(n,t,["ng-version","17.3.12"]);else{let{attrs:i,classes:s}=kB(e.selectors[0]);i&&Zy(n,t,i),s&&s.length>0&&FN(n,t,s.join(" "))}}function Fq(n,e,t){let r=n.projection=[];for(let i=0;i<e.length;i++){let s=t[i];r.push(s!=null?Array.from(s):null)}}function Vq(){let n=ur();sN(rn()[be],n)}var dp=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=Uq;let n=e;return n})();function Uq(){let n=ur();return Bq(n,rn())}var jq=dp,sP=class extends jq{constructor(e,t,r){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=r}get element(){return Qv(this._hostTNode,this._hostLView)}get injector(){return new Gs(this._hostTNode,this._hostLView)}get parentInjector(){let e=zv(this._hostTNode,this._hostLView);if(aN(e)){let t=jf(e,this._hostLView),r=Uf(e),i=t[be].data[r+8];return new Gs(i,t)}else return new Gs(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let t=rx(this._lContainer);return t!==null&&t[e]||null}get length(){return this._lContainer.length-Bn}createEmbeddedView(e,t,r){let i,s;typeof r=="number"?i=r:r!=null&&(i=r.index,s=r.injector);let o=JR(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(t||{},s,o);return this.insertImpl(a,i,YR(this._hostTNode,o)),a}createComponent(e,t,r,i,s){let o=e&&!JB(e),a;if(o)a=t;else{let w=t||{};a=w.index,r=w.injector,i=w.projectableNodes,s=w.environmentInjector||w.ngModuleRef}let c=o?e:new xa(qi(e)),l=r||this.parentInjector;if(!s&&c.ngModule==null){let C=(o?l:this.parentInjector).get(gn,null);C&&(s=C)}let d=qi(c.componentType??{}),h=JR(this._lContainer,d?.id??null),m=h?.firstChild??null,_=c.create(l,i,m,s);return this.insertImpl(_.hostView,a,YR(this._hostTNode,h)),_}insert(e,t){return this.insertImpl(e,t,!0)}insertImpl(e,t,r){let i=e._lView;if(o$(i)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let c=i[Gt],l=new sP(c,c[cr],c[Gt]);l.detach(l.indexOf(e))}}let s=this._adjustIndex(t),o=this._lContainer;return cq(o,i,s,r),e.attachToViewContainerRef(),wx(Qy(o),s,e),e}move(e,t){return this.insert(e,t)}indexOf(e){let t=rx(this._lContainer);return t!==null?t.indexOf(e):-1}remove(e){let t=this._adjustIndex(e,-1),r=hv(this._lContainer,t);r&&(kf(Qy(this._lContainer),t),MN(r[be],r))}detach(e){let t=this._adjustIndex(e,-1),r=hv(this._lContainer,t);return r&&kf(Qy(this._lContainer),t)!=null?new Ra(r):null}_adjustIndex(e,t=0){return e??this.length+t}};function rx(n){return n[Ff]}function Qy(n){return n[Ff]||(n[Ff]=[])}function Bq(n,e){let t,r=e[n.index];return gi(r)?t=r:(t=nq(r,e,null,n),e[n.index]=t,sw(e,t)),Hq(t,e,n,r),new sP(t,n,e)}function $q(n,e){let t=n[Dn],r=t.createComment(""),i=lr(e,n),s=tw(t,i);return $f(t,s,r,EH(t,i),!1),r}var Hq=qq;function qq(n,e,t,r){if(n[Ys])return;let i;t.type&8?i=fi(r):i=$q(e,t),n[Ys]=i}function zq(n){let e=[],t=new Map;function r(i){let s=t.get(i);if(!s){let o=n(i);t.set(i,s=o.then(Qq))}return s}return Gf.forEach((i,s)=>{let o=[];i.templateUrl&&o.push(r(i.templateUrl).then(l=>{i.template=l}));let a=typeof i.styles=="string"?[i.styles]:i.styles||[];if(i.styles=a,i.styleUrl&&i.styleUrls?.length)throw new Error("@Component cannot define both `styleUrl` and `styleUrls`. Use `styleUrl` if the component has one stylesheet, or `styleUrls` if it has multiple");if(i.styleUrls?.length){let l=i.styles.length,d=i.styleUrls;i.styleUrls.forEach((h,m)=>{a.push(""),o.push(r(h).then(_=>{a[l+m]=_,d.splice(d.indexOf(h),1),d.length==0&&(i.styleUrls=void 0)}))})}else i.styleUrl&&o.push(r(i.styleUrl).then(l=>{a.push(l),i.styleUrl=void 0}));let c=Promise.all(o).then(()=>Yq(s));e.push(c)}),Gq(),Promise.all(e).then(()=>{})}var Gf=new Map,Wq=new Set;function Gq(){let n=Gf;return Gf=new Map,n}function Kq(){return Gf.size===0}function Qq(n){return typeof n=="string"?n:n.text()}function Yq(n){Wq.delete(n)}function uw(n){let e=n.inputConfig,t={};for(let r in e)if(e.hasOwnProperty(r)){let i=e[r];Array.isArray(i)&&i[3]&&(t[r]=i[3])}n.inputTransforms=t}var zi=class{},Zl=class{};var Kf=class extends zi{constructor(e,t,r){super(),this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new Wf(this);let i=Rx(e);this._bootstrapComponents=RN(i.bootstrap),this._r3Injector=_N(e,t,[{provide:zi,useValue:this},{provide:cp,useValue:this.componentFactoryResolver},...r],Cn(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},Qf=class extends Zl{constructor(e){super(),this.moduleType=e}create(e){return new Kf(this.moduleType,e,[])}};function Jq(n,e,t){return new Kf(n,e,t)}var Dv=class extends zi{constructor(e){super(),this.componentFactoryResolver=new Wf(this),this.instance=null;let t=new zl([...e.providers,{provide:zi,useValue:this},{provide:cp,useValue:this.componentFactoryResolver}],e.parent||Fv(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function hp(n,e,t=null){return new Dv({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}var fp=(()=>{let e=class e{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new Ft(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);let r=this.taskId++;return this.pendingTasks.add(r),r}remove(r){this.pendingTasks.delete(r),this.pendingTasks.size===0&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function Xq(n,e,t){let r=n[e];return Object.is(r,t)?!1:(n[e]=t,!0)}function Zq(n){return(n.flags&32)===32}function dw(n,e,t,r){let i=rn(),s=y$();if(Xq(i,s,e)){let o=iu(),a=b$();XH(a,i,n,e,t,r)}return dw}function ix(n,e,t,r,i){let s=e.inputs,o=i?"class":"style";JN(n,t,s[o],o,r)}function e4(n,e,t,r,i,s){let o=e.consts,a=VR(o,i),c=iw(e,n,2,r,a);return BH(e,t,c,VR(o,s)),c.attrs!==null&&Tv(c,c.attrs,!1),c.mergedAttrs!==null&&Tv(c,c.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,c),c}function k(n,e,t,r){let i=rn(),s=iu(),o=Qs+n,a=i[Dn],c=s.firstCreatePass?e4(o,s,i,e,t,r):s.data[o],l=t4(s,i,c,a,e,n);i[o]=l;let d=Ux(c);return rp(c,!0),VN(a,l,c),!Zq(c)&&rN()&&ON(s,i,l,c),l$()===0&&Aa(l,i),u$(),d&&(MH(s,i,c),qN(s,c,i)),r!==null&&kH(i,c),k}function M(){let n=ur();Qx()?g$():(n=n.parent,rp(n,!1));let e=n;f$(e)&&p$(),d$();let t=iu();return t.firstCreatePass&&(sN(t,n),Vx(n)&&t.queries.elementEnd(n)),e.classesWithoutHost!=null&&R$(e)&&ix(t,e,rn(),e.classesWithoutHost,!0),e.stylesWithoutHost!=null&&x$(e)&&ix(t,e,rn(),e.stylesWithoutHost,!1),M}function K(n,e,t,r){return k(n,e,t,r),M(),K}var t4=(n,e,t,r,i,s)=>(iN(!0),xN(r,i,C$()));var Yf="en-US";var n4=Yf;function r4(n){typeof n=="string"&&(n4=n.toLowerCase().replace(/_/g,"-"))}function fe(n,e,t,r){let i=rn(),s=iu(),o=ur();return s4(s,i,i[Dn],o,n,e,r),fe}function i4(n,e,t,r){let i=n.cleanup;if(i!=null)for(let s=0;s<i.length-1;s+=2){let o=i[s];if(o===t&&i[s+1]===r){let a=e[Wl],c=i[s+2];return a.length>c?a[c]:null}typeof o=="string"&&(s+=2)}return null}function s4(n,e,t,r,i,s,o){let a=Ux(r),l=n.firstCreatePass&&iq(n),d=e[hi],h=rq(e),m=!0;if(r.type&3||o){let C=lr(r,e),A=o?o(C):C,L=h.length,H=o?Q=>o(fi(Q[r.index])):r.index,j=null;if(!o&&a&&(j=i4(n,e,i,r.index)),j!==null){let Q=j.__ngLastListenerFn__||j;Q.__ngNextListenerFn__=s,j.__ngLastListenerFn__=s,m=!1}else{s=ox(r,e,d,s,!1);let Q=t.listen(A,i,s);h.push(s,Q),l&&l.push(i,H,L,L+1)}}else s=ox(r,e,d,s,!1);let _=r.outputs,w;if(m&&_!==null&&(w=_[i])){let C=w.length;if(C)for(let A=0;A<C;A+=2){let L=w[A],H=w[A+1],se=e[L][H].subscribe(s),J=h.length;h.push(s,se),l&&l.push(i,r.index,J,-(J+1))}}}function sx(n,e,t,r){let i=Me(null);try{return Cr(6,e,t),t(r)!==!1}catch(s){return YN(n,s),!1}finally{Cr(7,e,t),Me(i)}}function ox(n,e,t,r,i){return function s(o){if(o===Function)return r;let a=n.componentOffset>-1?Xs(n.index,e):e;ow(a);let c=sx(e,t,r,o),l=s.__ngNextListenerFn__;for(;l;)c=sx(e,t,l,o)&&c,l=l.__ngNextListenerFn__;return i&&c===!1&&o.preventDefault(),c}}function F(n,e=""){let t=rn(),r=iu(),i=n+Qs,s=r.firstCreatePass?iw(r,i,1,e,null):r.data[i],o=o4(r,t,s,e,n);t[i]=o,rN()&&ON(r,t,o,s),rp(s,!1)}var o4=(n,e,t,r,i)=>(iN(!0),dH(e[Dn],r));var a4=(()=>{let e=class e{constructor(r){this._injector=r,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(r){if(!r.standalone)return null;if(!this.cachedInjectors.has(r)){let i=Px(!1,r.type),s=i.length>0?hp([i],this._injector,`Standalone[${r.type.name}]`):null;this.cachedInjectors.set(r,s)}return this.cachedInjectors.get(r)}ngOnDestroy(){try{for(let r of this.cachedInjectors.values())r!==null&&r.destroy()}finally{this.cachedInjectors.clear()}}};e.\u0275prov=ne({token:e,providedIn:"environment",factory:()=>new e(ie(gn))});let n=e;return n})();function oP(n){aw("NgStandalone"),n.getStandaloneInjector=e=>e.get(a4).getOrCreateStandaloneInjector(n)}var Df=null;function c4(n){Df!==null&&(n.defaultEncapsulation!==Df.defaultEncapsulation||n.preserveWhitespaces!==Df.preserveWhitespaces)||(Df=n)}var pp=(()=>{let e=class e{log(r){console.log(r)}warn(r){console.warn(r)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"platform"});let n=e;return n})();var hw=new ue(""),au=new ue(""),mp=(()=>{let e=class e{constructor(r,i,s){this._ngZone=r,this.registry=i,this._pendingCount=0,this._isZoneStable=!0,this._callbacks=[],this.taskTrackingZone=null,fw||(l4(s),s.addToWindow(i)),this._watchAngularEvents(),r.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{$e.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&this._pendingCount===0&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;this._callbacks.length!==0;){let r=this._callbacks.pop();clearTimeout(r.timeoutId),r.doneCb()}});else{let r=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>i.updateCb&&i.updateCb(r)?(clearTimeout(i.timeoutId),!1):!0)}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(r=>({source:r.source,creationLocation:r.creationLocation,data:r.data})):[]}addCallback(r,i,s){let o=-1;i&&i>0&&(o=setTimeout(()=>{this._callbacks=this._callbacks.filter(a=>a.timeoutId!==o),r()},i)),this._callbacks.push({doneCb:r,timeoutId:o,updateCb:s})}whenStable(r,i,s){if(s&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(r,i,s),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(r){this.registry.registerApplication(r,this)}unregisterApplication(r){this.registry.unregisterApplication(r)}findProviders(r,i,s){return[]}};e.\u0275fac=function(i){return new(i||e)(ie($e),ie(gp),ie(au))},e.\u0275prov=ne({token:e,factory:e.\u0275fac});let n=e;return n})(),gp=(()=>{let e=class e{constructor(){this._applications=new Map}registerApplication(r,i){this._applications.set(r,i)}unregisterApplication(r){this._applications.delete(r)}unregisterAllApplications(){this._applications.clear()}getTestability(r){return this._applications.get(r)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(r,i=!0){return fw?.findTestabilityInTree(this,r,i)??null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"platform"});let n=e;return n})();function l4(n){fw=n}var fw;function cu(n){return!!n&&typeof n.then=="function"}function aP(n){return!!n&&typeof n.subscribe=="function"}var _p=new ue(""),cP=(()=>{let e=class e{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((r,i)=>{this.resolve=r,this.reject=i}),this.appInits=G(_p,{optional:!0})??[]}runInitializers(){if(this.initialized)return;let r=[];for(let s of this.appInits){let o=s();if(cu(o))r.push(o);else if(aP(o)){let a=new Promise((c,l)=>{o.subscribe({complete:c,error:l})});r.push(a)}}let i=()=>{this.done=!0,this.resolve()};Promise.all(r).then(()=>{i()}).catch(s=>{this.reject(s)}),r.length===0&&i(),this.initialized=!0}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),pw=new ue("");function u4(){JA(()=>{throw new te(600,!1)})}function d4(n){return n.isBoundToModule}function h4(n,e,t){try{let r=t();return cu(r)?r.catch(i=>{throw e.runOutsideAngular(()=>n.handleError(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>n.handleError(r)),r}}function lP(n,e){return Array.isArray(e)?e.reduce(lP,n):X(X({},n),e)}var Na=(()=>{let e=class e{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=G(yN),this.afterRenderEffectManager=G(lw),this.externalTestViews=new Set,this.beforeRender=new Wt,this.afterTick=new Wt,this.componentTypes=[],this.components=[],this.isStable=G(fp).hasPendingTasks.pipe(Te(r=>!r)),this._injector=G(gn)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(r,i){let s=r instanceof zf;if(!this._injector.get(cP).done){let _=!s&&Ax(r),w=!1;throw new te(405,w)}let a;s?a=r:a=this._injector.get(cp).resolveComponentFactory(r),this.componentTypes.push(a.componentType);let c=d4(a)?void 0:this._injector.get(zi),l=i||a.selector,d=a.create(xr.NULL,[],l,c),h=d.location.nativeElement,m=d.injector.get(hw,null);return m?.registerApplication(h),d.onDestroy(()=>{this.detachView(d.hostView),Nf(this.components,d),m?.unregisterApplication(h)}),this._loadComponent(d),d}tick(){this._tick(!0)}_tick(r){if(this._runningTick)throw new te(101,!1);let i=Me(null);try{this._runningTick=!0,this.detectChangesInAttachedViews(r)}catch(s){this.internalErrorHandler(s)}finally{this.afterTick.next(),this._runningTick=!1,Me(i)}}detectChangesInAttachedViews(r){let i=0,s=this.afterRenderEffectManager;for(;;){if(i===eP)throw new te(103,!1);if(r){let o=i===0;this.beforeRender.next(o);for(let{_lView:a,notifyErrorHandler:c}of this._views)f4(a,o,c)}if(i++,s.executeInternalCallbacks(),![...this.externalTestViews.keys(),...this._views].some(({_lView:o})=>Sv(o))&&(s.execute(),![...this.externalTestViews.keys(),...this._views].some(({_lView:o})=>Sv(o))))break}}attachView(r){let i=r;this._views.push(i),i.attachToAppRef(this)}detachView(r){let i=r;Nf(this._views,i),i.detachFromAppRef()}_loadComponent(r){this.attachView(r.hostView),this.tick(),this.components.push(r);let i=this._injector.get(pw,[]);[...this._bootstrapListeners,...i].forEach(s=>s(r))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(r=>r()),this._views.slice().forEach(r=>r.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(r){return this._destroyListeners.push(r),()=>Nf(this._destroyListeners,r)}destroy(){if(this._destroyed)throw new te(406,!1);let r=this._injector;r.destroy&&!r.destroyed&&r.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function Nf(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function f4(n,e,t){!e&&!Sv(n)||p4(n,t,e)}function Sv(n){return $v(n)}function p4(n,e,t){let r;t?(r=0,n[le]|=1024):n[le]&64?r=0:r=1,tP(n,e,r)}var Av=class{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}},yp=(()=>{let e=class e{compileModuleSync(r){return new Qf(r)}compileModuleAsync(r){return Promise.resolve(this.compileModuleSync(r))}compileModuleAndAllComponentsSync(r){let i=this.compileModuleSync(r),s=Rx(r),o=RN(s.declarations).reduce((a,c)=>{let l=qi(c);return l&&a.push(new xa(l)),a},[]);return new Av(i,o)}compileModuleAndAllComponentsAsync(r){return Promise.resolve(this.compileModuleAndAllComponentsSync(r))}clearCache(){}clearCacheFor(r){}getModuleId(r){}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),m4=new ue("");function g4(n,e,t){let r=new Qf(t);return Promise.resolve(r)}function ax(n){for(let e=n.length-1;e>=0;e--)if(n[e]!==void 0)return n[e]}var _4=(()=>{let e=class e{constructor(){this.zone=G($e),this.applicationRef=G(Na)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function y4(n){return[{provide:$e,useFactory:n},{provide:Da,multi:!0,useFactory:()=>{let e=G(_4,{optional:!0});return()=>e.initialize()}},{provide:Da,multi:!0,useFactory:()=>{let e=G(I4);return()=>{e.initialize()}}},{provide:yN,useFactory:v4}]}function v4(){let n=G($e),e=G(Rr);return t=>n.runOutsideAngular(()=>e.handleError(t))}function w4(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}var I4=(()=>{let e=class e{constructor(){this.subscription=new Ct,this.initialized=!1,this.zone=G($e),this.pendingTasks=G(fp)}initialize(){if(this.initialized)return;this.initialized=!0;let r=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(r=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{$e.assertNotInAngularZone(),queueMicrotask(()=>{r!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(r),r=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{$e.assertInAngularZone(),r??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function E4(){return typeof $localize<"u"&&$localize.locale||Yf}var mw=new ue("",{providedIn:"root",factory:()=>G(mw,ye.Optional|ye.SkipSelf)||E4()});var uP=new ue(""),dP=(()=>{let e=class e{constructor(r){this._injector=r,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(r,i){let s=Rq(i?.ngZone,w4({eventCoalescing:i?.ngZoneEventCoalescing,runCoalescing:i?.ngZoneRunCoalescing}));return s.run(()=>{let o=Jq(r.moduleType,this.injector,y4(()=>s)),a=o.injector.get(Rr,null);return s.runOutsideAngular(()=>{let c=s.onError.subscribe({next:l=>{a.handleError(l)}});o.onDestroy(()=>{Nf(this._modules,o),c.unsubscribe()})}),h4(a,s,()=>{let c=o.injector.get(cP);return c.runInitializers(),c.donePromise.then(()=>{let l=o.injector.get(mw,Yf);return r4(l||Yf),this._moduleDoBootstrap(o),o})})})}bootstrapModule(r,i=[]){let s=lP({},i);return g4(this.injector,s,r).then(o=>this.bootstrapModuleFactory(o,s))}_moduleDoBootstrap(r){let i=r.injector.get(Na);if(r._bootstrapComponents.length>0)r._bootstrapComponents.forEach(s=>i.bootstrap(s));else if(r.instance.ngDoBootstrap)r.instance.ngDoBootstrap(i);else throw new te(-403,!1);this._modules.push(r)}onDestroy(r){this._destroyListeners.push(r)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new te(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());let r=this._injector.get(uP,null);r&&(r.forEach(i=>i()),r.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}};e.\u0275fac=function(i){return new(i||e)(ie(xr))},e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"platform"});let n=e;return n})(),$l=null,hP=new ue("");function T4(n){if($l&&!$l.get(hP,!1))throw new te(400,!1);u4(),$l=n;let e=n.get(dP);return D4(n),e}function gw(n,e,t=[]){let r=`Platform: ${e}`,i=new ue(r);return(s=[])=>{let o=fP();if(!o||o.injector.get(hP,!1)){let a=[...t,...s,{provide:i,useValue:!0}];n?n(a):T4(b4(a,r))}return C4(i)}}function b4(n=[],e){return xr.create({name:e,providers:[{provide:ep,useValue:"platform"},{provide:uP,useValue:new Set([()=>$l=null])},...n]})}function C4(n){let e=fP();if(!e)throw new te(401,!1);return e}function fP(){return $l?.get(dP)??null}function D4(n){n.get(Yv,null)?.forEach(t=>t())}var lu=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=S4;let n=e;return n})();function S4(n){return A4(ur(),rn(),(n&16)===16)}function A4(n,e,t){if(jv(n)&&!t){let r=Xs(n.index,e);return new Ra(r,r)}else if(n.type&47){let r=e[Ar];return new Ra(r,e)}return null}var pP=gw(null,"core",[]),mP=(()=>{let e=class e{constructor(r){}};e.\u0275fac=function(i){return new(i||e)(ie(Na))},e.\u0275mod=ar({type:e}),e.\u0275inj=or({});let n=e;return n})();function uu(n){return typeof n=="boolean"?n:n!=null&&n!=="false"}function gP(n){let e=qi(n);if(!e)return null;let t=new xa(e);return{get selector(){return t.selector},get type(){return t.componentType},get inputs(){return t.inputs},get outputs(){return t.outputs},get ngContentSelectors(){return t.ngContentSelectors},get isStandalone(){return e.standalone},get isSignal(){return e.signals}}}var wP=null;function eo(){return wP}function IP(n){wP??=n}var vp=class{};var yn=new ue(""),vw=(()=>{let e=class e{historyGo(r){throw new Error("")}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:()=>G(R4),providedIn:"platform"});let n=e;return n})(),EP=new ue(""),R4=(()=>{let e=class e extends vw{constructor(){super(),this._doc=G(yn),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return eo().getBaseHref(this._doc)}onPopState(r){let i=eo().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",r,!1),()=>i.removeEventListener("popstate",r)}onHashChange(r){let i=eo().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",r,!1),()=>i.removeEventListener("hashchange",r)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(r){this._location.pathname=r}pushState(r,i,s){this._history.pushState(r,i,s)}replaceState(r,i,s){this._history.replaceState(r,i,s)}forward(){this._history.forward()}back(){this._history.back()}historyGo(r=0){this._history.go(r)}getState(){return this._history.state}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:()=>new e,providedIn:"platform"});let n=e;return n})();function ww(n,e){if(n.length==0)return e;if(e.length==0)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,t==2?n+e.substring(1):t==1?n+e:n+"/"+e}function _P(n){let e=n.match(/#|\?|$/),t=e&&e.index||n.length,r=t-(n[t-1]==="/"?1:0);return n.slice(0,r)+n.slice(t)}function _i(n){return n&&n[0]!=="?"?"?"+n:n}var dr=(()=>{let e=class e{historyGo(r){throw new Error("")}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:()=>G(Iw),providedIn:"root"});let n=e;return n})(),TP=new ue(""),Iw=(()=>{let e=class e extends dr{constructor(r,i){super(),this._platformLocation=r,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??G(yn).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(r){this._removeListenerFns.push(this._platformLocation.onPopState(r),this._platformLocation.onHashChange(r))}getBaseHref(){return this._baseHref}prepareExternalUrl(r){return ww(this._baseHref,r)}path(r=!1){let i=this._platformLocation.pathname+_i(this._platformLocation.search),s=this._platformLocation.hash;return s&&r?`${i}${s}`:i}pushState(r,i,s,o){let a=this.prepareExternalUrl(s+_i(o));this._platformLocation.pushState(r,i,a)}replaceState(r,i,s,o){let a=this.prepareExternalUrl(s+_i(o));this._platformLocation.replaceState(r,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(r=0){this._platformLocation.historyGo?.(r)}};e.\u0275fac=function(i){return new(i||e)(ie(vw),ie(TP,8))},e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),Ip=(()=>{let e=class e extends dr{constructor(r,i){super(),this._platformLocation=r,this._baseHref="",this._removeListenerFns=[],i!=null&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(r){this._removeListenerFns.push(this._platformLocation.onPopState(r),this._platformLocation.onHashChange(r))}getBaseHref(){return this._baseHref}path(r=!1){let i=this._platformLocation.hash??"#";return i.length>0?i.substring(1):i}prepareExternalUrl(r){let i=ww(this._baseHref,r);return i.length>0?"#"+i:i}pushState(r,i,s,o){let a=this.prepareExternalUrl(s+_i(o));a.length==0&&(a=this._platformLocation.pathname),this._platformLocation.pushState(r,i,a)}replaceState(r,i,s,o){let a=this.prepareExternalUrl(s+_i(o));a.length==0&&(a=this._platformLocation.pathname),this._platformLocation.replaceState(r,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(r=0){this._platformLocation.historyGo?.(r)}};e.\u0275fac=function(i){return new(i||e)(ie(vw),ie(TP,8))},e.\u0275prov=ne({token:e,factory:e.\u0275fac});let n=e;return n})(),Pa=(()=>{let e=class e{constructor(r){this._subject=new nn,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=r;let i=this._locationStrategy.getBaseHref();this._basePath=P4(_P(yP(i))),this._locationStrategy.onPopState(s=>{this._subject.emit({url:this.path(!0),pop:!0,state:s.state,type:s.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(r=!1){return this.normalize(this._locationStrategy.path(r))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(r,i=""){return this.path()==this.normalize(r+_i(i))}normalize(r){return e.stripTrailingSlash(N4(this._basePath,yP(r)))}prepareExternalUrl(r){return r&&r[0]!=="/"&&(r="/"+r),this._locationStrategy.prepareExternalUrl(r)}go(r,i="",s=null){this._locationStrategy.pushState(s,"",r,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(r+_i(i)),s)}replaceState(r,i="",s=null){this._locationStrategy.replaceState(s,"",r,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(r+_i(i)),s)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(r=0){this._locationStrategy.historyGo?.(r)}onUrlChange(r){return this._urlChangeListeners.push(r),this._urlChangeSubscription??=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)}),()=>{let i=this._urlChangeListeners.indexOf(r);this._urlChangeListeners.splice(i,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(r="",i){this._urlChangeListeners.forEach(s=>s(r,i))}subscribe(r,i,s){return this._subject.subscribe({next:r,error:i,complete:s})}};e.normalizeQueryParams=_i,e.joinWithSlash=ww,e.stripTrailingSlash=_P,e.\u0275fac=function(i){return new(i||e)(ie(dr))},e.\u0275prov=ne({token:e,factory:()=>x4(),providedIn:"root"});let n=e;return n})();function x4(){return new Pa(ie(dr))}function N4(n,e){if(!n||!e.startsWith(n))return e;let t=e.substring(n.length);return t===""||["/",";","?","#"].includes(t[0])?t:e}function yP(n){return n.replace(/\/index.html$/,"")}function P4(n){if(new RegExp("^(https?:)?//").test(n)){let[,t]=n.split(/\/\/[^\/]+/);return t}return n}function bP(n,e){e=encodeURIComponent(e);for(let t of n.split(";")){let r=t.indexOf("="),[i,s]=r==-1?[t,""]:[t.slice(0,r),t.slice(r+1)];if(i.trim()===e)return decodeURIComponent(s)}return null}var CP=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=ar({type:e}),e.\u0275inj=or({});let n=e;return n})(),Ew="browser",M4="server";function k4(n){return n===Ew}function Tw(n){return n===M4}var DP=(()=>{let e=class e{};e.\u0275prov=ne({token:e,providedIn:"root",factory:()=>k4(G(Wi))?new _w(G(yn),window):new yw});let n=e;return n})(),_w=class{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){Array.isArray(e)?this.offset=()=>e:this.offset=e}getScrollPosition(){return[this.window.scrollX,this.window.scrollY]}scrollToPosition(e){this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){let t=O4(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){this.window.history.scrollRestoration=e}scrollToElement(e){let t=e.getBoundingClientRect(),r=t.left+this.window.pageXOffset,i=t.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(r-s[0],i-s[1])}};function O4(n,e){let t=n.getElementById(e)||n.getElementsByName(e)[0];if(t)return t;if(typeof n.createTreeWalker=="function"&&n.body&&typeof n.body.attachShadow=="function"){let r=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT),i=r.currentNode;for(;i;){let s=i.shadowRoot;if(s){let o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}i=r.nextNode()}}return null}var yw=class{setOffset(e){}getScrollPosition(){return[0,0]}scrollToPosition(e){}scrollToAnchor(e){}setHistoryScrollRestoration(e){}},wp=class{};var Dw=class extends vp{constructor(){super(...arguments),this.supportsDOMEvents=!0}},Sw=class n extends Dw{static makeCurrent(){IP(new n)}onAndCancel(e,t,r){return e.addEventListener(t,r),()=>{e.removeEventListener(t,r)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=V4();return t==null?null:U4(t)}resetBaseElement(){du=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return bP(document.cookie,e)}},du=null;function V4(){return du=du||document.querySelector("base"),du?du.getAttribute("href"):null}function U4(n){return new URL(n,document.baseURI).pathname}var Aw=class{addToWindow(e){Ut.getAngularTestability=(r,i=!0)=>{let s=e.findTestabilityInTree(r,i);if(s==null)throw new te(5103,!1);return s},Ut.getAllAngularTestabilities=()=>e.getAllTestabilities(),Ut.getAllAngularRootElements=()=>e.getAllRootElements();let t=r=>{let i=Ut.getAllAngularTestabilities(),s=i.length,o=function(){s--,s==0&&r()};i.forEach(a=>{a.whenStable(o)})};Ut.frameworkStabilizers||(Ut.frameworkStabilizers=[]),Ut.frameworkStabilizers.push(t)}findTestabilityInTree(e,t,r){if(t==null)return null;let i=e.getTestability(t);return i??(r?eo().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null)}},j4=(()=>{let e=class e{build(){return new XMLHttpRequest}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:e.\u0275fac});let n=e;return n})(),Rw=new ue(""),xP=(()=>{let e=class e{constructor(r,i){this._zone=i,this._eventNameToPlugin=new Map,r.forEach(s=>{s.manager=this}),this._plugins=r.slice().reverse()}addEventListener(r,i,s){return this._findPluginFor(i).addEventListener(r,i,s)}getZone(){return this._zone}_findPluginFor(r){let i=this._eventNameToPlugin.get(r);if(i)return i;if(i=this._plugins.find(o=>o.supports(r)),!i)throw new te(5101,!1);return this._eventNameToPlugin.set(r,i),i}};e.\u0275fac=function(i){return new(i||e)(ie(Rw),ie($e))},e.\u0275prov=ne({token:e,factory:e.\u0275fac});let n=e;return n})(),Ep=class{constructor(e){this._doc=e}},bw="ng-app-id",NP=(()=>{let e=class e{constructor(r,i,s,o={}){this.doc=r,this.appId=i,this.nonce=s,this.platformId=o,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=Tw(o),this.resetHostNodes()}addStyles(r){for(let i of r)this.changeUsageCount(i,1)===1&&this.onStyleAdded(i)}removeStyles(r){for(let i of r)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){let r=this.styleNodesInDOM;r&&(r.forEach(i=>i.remove()),r.clear());for(let i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(r){this.hostNodes.add(r);for(let i of this.getAllStyles())this.addStyleToHost(r,i)}removeHost(r){this.hostNodes.delete(r)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(r){for(let i of this.hostNodes)this.addStyleToHost(i,r)}onStyleRemoved(r){let i=this.styleRef;i.get(r)?.elements?.forEach(s=>s.remove()),i.delete(r)}collectServerRenderedStyles(){let r=this.doc.head?.querySelectorAll(`style[${bw}="${this.appId}"]`);if(r?.length){let i=new Map;return r.forEach(s=>{s.textContent!=null&&i.set(s.textContent,s)}),i}return null}changeUsageCount(r,i){let s=this.styleRef;if(s.has(r)){let o=s.get(r);return o.usage+=i,o.usage}return s.set(r,{usage:i,elements:[]}),i}getStyleElement(r,i){let s=this.styleNodesInDOM,o=s?.get(i);if(o?.parentNode===r)return s.delete(i),o.removeAttribute(bw),o;{let a=this.doc.createElement("style");return this.nonce&&a.setAttribute("nonce",this.nonce),a.textContent=i,this.platformIsServer&&a.setAttribute(bw,this.appId),r.appendChild(a),a}}addStyleToHost(r,i){let s=this.getStyleElement(r,i),o=this.styleRef,a=o.get(i)?.elements;a?a.push(s):o.set(i,{elements:[s],usage:1})}resetHostNodes(){let r=this.hostNodes;r.clear(),r.add(this.doc.head)}};e.\u0275fac=function(i){return new(i||e)(ie(yn),ie(ip),ie(Jv,8),ie(Wi))},e.\u0275prov=ne({token:e,factory:e.\u0275fac});let n=e;return n})(),Cw={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},Nw=/%COMP%/g,PP="%COMP%",B4=`_nghost-${PP}`,$4=`_ngcontent-${PP}`,H4=!0,q4=new ue("",{providedIn:"root",factory:()=>H4});function z4(n){return $4.replace(Nw,n)}function W4(n){return B4.replace(Nw,n)}function MP(n,e){return e.map(t=>t.replace(Nw,n))}var SP=(()=>{let e=class e{constructor(r,i,s,o,a,c,l,d=null){this.eventManager=r,this.sharedStylesHost=i,this.appId=s,this.removeStylesOnCompDestroy=o,this.doc=a,this.platformId=c,this.ngZone=l,this.nonce=d,this.rendererByCompId=new Map,this.platformIsServer=Tw(c),this.defaultRenderer=new hu(r,a,l,this.platformIsServer)}createRenderer(r,i){if(!r||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===Sr.ShadowDom&&(i=it(X({},i),{encapsulation:Sr.Emulated}));let s=this.getOrCreateRenderer(r,i);return s instanceof Tp?s.applyToHost(r):s instanceof fu&&s.applyStyles(),s}getOrCreateRenderer(r,i){let s=this.rendererByCompId,o=s.get(i.id);if(!o){let a=this.doc,c=this.ngZone,l=this.eventManager,d=this.sharedStylesHost,h=this.removeStylesOnCompDestroy,m=this.platformIsServer;switch(i.encapsulation){case Sr.Emulated:o=new Tp(l,d,i,this.appId,h,a,c,m);break;case Sr.ShadowDom:return new xw(l,d,r,i,a,c,this.nonce,m);default:o=new fu(l,d,i,h,a,c,m);break}s.set(i.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}};e.\u0275fac=function(i){return new(i||e)(ie(xP),ie(NP),ie(ip),ie(q4),ie(yn),ie(Wi),ie($e),ie(Jv))},e.\u0275prov=ne({token:e,factory:e.\u0275fac});let n=e;return n})(),hu=class{constructor(e,t,r,i){this.eventManager=e,this.doc=t,this.ngZone=r,this.platformIsServer=i,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,t){return t?this.doc.createElementNS(Cw[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(AP(e)?e.content:e).appendChild(t)}insertBefore(e,t,r){e&&(AP(e)?e.content:e).insertBefore(t,r)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new te(-5104,!1);return t||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,r,i){if(i){t=i+":"+t;let s=Cw[i];s?e.setAttributeNS(s,t,r):e.setAttribute(t,r)}else e.setAttribute(t,r)}removeAttribute(e,t,r){if(r){let i=Cw[r];i?e.removeAttributeNS(i,t):e.removeAttribute(`${r}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,r,i){i&(Zs.DashCase|Zs.Important)?e.style.setProperty(t,r,i&Zs.Important?"important":""):e.style[t]=r}removeStyle(e,t,r){r&Zs.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,r){e!=null&&(e[t]=r)}setValue(e,t){e.nodeValue=t}listen(e,t,r){if(typeof e=="string"&&(e=eo().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${t}`);return this.eventManager.addEventListener(e,t,this.decoratePreventDefault(r))}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))===!1&&t.preventDefault()}}};function AP(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var xw=class extends hu{constructor(e,t,r,i,s,o,a,c){super(e,s,o,c),this.sharedStylesHost=t,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let l=MP(i.id,i.styles);for(let d of l){let h=document.createElement("style");a&&h.setAttribute("nonce",a),h.textContent=d,this.shadowRoot.appendChild(h)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,r){return super.insertBefore(this.nodeOrShadowRoot(e),t,r)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},fu=class extends hu{constructor(e,t,r,i,s,o,a,c){super(e,s,o,a),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=i,this.styles=c?MP(c,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},Tp=class extends fu{constructor(e,t,r,i,s,o,a,c){let l=i+"-"+r.id;super(e,t,r,s,o,a,c,l),this.contentAttr=z4(l),this.hostAttr=W4(l)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let r=super.createElement(e,t);return super.setAttribute(r,this.contentAttr,""),r}},G4=(()=>{let e=class e extends Ep{constructor(r){super(r)}supports(r){return!0}addEventListener(r,i,s){return r.addEventListener(i,s,!1),()=>this.removeEventListener(r,i,s)}removeEventListener(r,i,s){return r.removeEventListener(i,s)}};e.\u0275fac=function(i){return new(i||e)(ie(yn))},e.\u0275prov=ne({token:e,factory:e.\u0275fac});let n=e;return n})(),RP=["alt","control","meta","shift"],K4={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Q4={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},Y4=(()=>{let e=class e extends Ep{constructor(r){super(r)}supports(r){return e.parseEventName(r)!=null}addEventListener(r,i,s){let o=e.parseEventName(i),a=e.eventCallback(o.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>eo().onAndCancel(r,o.domEventName,a))}static parseEventName(r){let i=r.toLowerCase().split("."),s=i.shift();if(i.length===0||!(s==="keydown"||s==="keyup"))return null;let o=e._normalizeKey(i.pop()),a="",c=i.indexOf("code");if(c>-1&&(i.splice(c,1),a="code."),RP.forEach(d=>{let h=i.indexOf(d);h>-1&&(i.splice(h,1),a+=d+".")}),a+=o,i.length!=0||o.length===0)return null;let l={};return l.domEventName=s,l.fullKey=a,l}static matchEventFullKeyCode(r,i){let s=K4[r.key]||r.key,o="";return i.indexOf("code.")>-1&&(s=r.code,o="code."),s==null||!s?!1:(s=s.toLowerCase(),s===" "?s="space":s==="."&&(s="dot"),RP.forEach(a=>{if(a!==s){let c=Q4[a];c(r)&&(o+=a+".")}}),o+=s,o===i)}static eventCallback(r,i,s){return o=>{e.matchEventFullKeyCode(o,r)&&s.runGuarded(()=>i(o))}}static _normalizeKey(r){return r==="esc"?"escape":r}};e.\u0275fac=function(i){return new(i||e)(ie(yn))},e.\u0275prov=ne({token:e,factory:e.\u0275fac});let n=e;return n})();function J4(){Sw.makeCurrent()}function X4(){return new Rr}function Z4(){return bN(document),document}var ez=[{provide:Wi,useValue:Ew},{provide:Yv,useValue:J4,multi:!0},{provide:yn,useFactory:Z4,deps:[]}],kP=gw(pP,"browser",ez),tz=new ue(""),nz=[{provide:au,useClass:Aw,deps:[]},{provide:hw,useClass:mp,deps:[$e,gp,au]},{provide:mp,useClass:mp,deps:[$e,gp,au]}],rz=[{provide:ep,useValue:"root"},{provide:Rr,useFactory:X4,deps:[]},{provide:Rw,useClass:G4,multi:!0,deps:[yn,$e,Wi]},{provide:Rw,useClass:Y4,multi:!0,deps:[yn]},SP,NP,xP,{provide:Xl,useExisting:SP},{provide:wp,useClass:j4,deps:[]},[]],OP=(()=>{let e=class e{constructor(r){}static withServerTransition(r){return{ngModule:e,providers:[{provide:ip,useValue:r.appId}]}}};e.\u0275fac=function(i){return new(i||e)(ie(tz,12))},e.\u0275mod=ar({type:e}),e.\u0275inj=or({providers:[...rz,...nz],imports:[CP,mP]});let n=e;return n})();var LP=(()=>{let e=class e{constructor(r){this._doc=r}getTitle(){return this._doc.title}setTitle(r){this._doc.title=r||""}};e.\u0275fac=function(i){return new(i||e)(ie(yn))},e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();var pe="primary",Au=Symbol("RouteTitle"),Lw=class{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function Fa(n){return new Lw(n)}function iz(n,e,t){let r=t.path.split("/");if(r.length>n.length||t.pathMatch==="full"&&(e.hasChildren()||r.length<n.length))return null;let i={};for(let s=0;s<r.length;s++){let o=r[s],a=n[s];if(o.startsWith(":"))i[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:n.slice(0,r.length),posParams:i}}function sz(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!Nr(n[t],e[t]))return!1;return!0}function Nr(n,e){let t=n?Fw(n):void 0,r=e?Fw(e):void 0;if(!t||!r||t.length!=r.length)return!1;let i;for(let s=0;s<t.length;s++)if(i=t[s],!WP(n[i],e[i]))return!1;return!0}function Fw(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function WP(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;let t=[...n].sort(),r=[...e].sort();return t.every((i,s)=>r[s]===i)}else return n===e}function GP(n){return n.length>0?n[n.length-1]:null}function Yi(n){return Oy(n)?n:cu(n)?lt(Promise.resolve(n)):oe(n)}var oz={exact:QP,subset:YP},KP={exact:az,subset:cz,ignored:()=>!0};function VP(n,e,t){return oz[t.paths](n.root,e.root,t.matrixParams)&&KP[t.queryParams](n.queryParams,e.queryParams)&&!(t.fragment==="exact"&&n.fragment!==e.fragment)}function az(n,e){return Nr(n,e)}function QP(n,e,t){if(!no(n.segments,e.segments)||!Dp(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(let r in e.children)if(!n.children[r]||!QP(n.children[r],e.children[r],t))return!1;return!0}function cz(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>WP(n[t],e[t]))}function YP(n,e,t){return JP(n,e,e.segments,t)}function JP(n,e,t,r){if(n.segments.length>t.length){let i=n.segments.slice(0,t.length);return!(!no(i,t)||e.hasChildren()||!Dp(i,t,r))}else if(n.segments.length===t.length){if(!no(n.segments,t)||!Dp(n.segments,t,r))return!1;for(let i in e.children)if(!n.children[i]||!YP(n.children[i],e.children[i],r))return!1;return!0}else{let i=t.slice(0,n.segments.length),s=t.slice(n.segments.length);return!no(n.segments,i)||!Dp(n.segments,i,r)||!n.children[pe]?!1:JP(n.children[pe],e,s,r)}}function Dp(n,e,t){return e.every((r,i)=>KP[t](n[i].parameters,r.parameters))}var Gi=class{constructor(e=new Pe([],{}),t={},r=null){this.root=e,this.queryParams=t,this.fragment=r}get queryParamMap(){return this._queryParamMap??=Fa(this.queryParams),this._queryParamMap}toString(){return dz.serialize(this)}},Pe=class{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Object.values(t).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Sp(this)}},to=class{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=Fa(this.parameters),this._parameterMap}toString(){return ZP(this)}};function lz(n,e){return no(n,e)&&n.every((t,r)=>Nr(t.parameters,e[r].parameters))}function no(n,e){return n.length!==e.length?!1:n.every((t,r)=>t.path===e[r].path)}function uz(n,e){let t=[];return Object.entries(n.children).forEach(([r,i])=>{r===pe&&(t=t.concat(e(i,r)))}),Object.entries(n.children).forEach(([r,i])=>{r!==pe&&(t=t.concat(e(i,r)))}),t}var Ru=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:()=>new wu,providedIn:"root"});let n=e;return n})(),wu=class{parse(e){let t=new Uw(e);return new Gi(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${pu(e.root,!0)}`,r=pz(e.queryParams),i=typeof e.fragment=="string"?`#${hz(e.fragment)}`:"";return`${t}${r}${i}`}},dz=new wu;function Sp(n){return n.segments.map(e=>ZP(e)).join("/")}function pu(n,e){if(!n.hasChildren())return Sp(n);if(e){let t=n.children[pe]?pu(n.children[pe],!1):"",r=[];return Object.entries(n.children).forEach(([i,s])=>{i!==pe&&r.push(`${i}:${pu(s,!1)}`)}),r.length>0?`${t}(${r.join("//")})`:t}else{let t=uz(n,(r,i)=>i===pe?[pu(n.children[pe],!1)]:[`${i}:${pu(r,!1)}`]);return Object.keys(n.children).length===1&&n.children[pe]!=null?`${Sp(n)}/${t[0]}`:`${Sp(n)}/(${t.join("//")})`}}function XP(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function bp(n){return XP(n).replace(/%3B/gi,";")}function hz(n){return encodeURI(n)}function Vw(n){return XP(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Ap(n){return decodeURIComponent(n)}function UP(n){return Ap(n.replace(/\+/g,"%20"))}function ZP(n){return`${Vw(n.path)}${fz(n.parameters)}`}function fz(n){return Object.entries(n).map(([e,t])=>`;${Vw(e)}=${Vw(t)}`).join("")}function pz(n){let e=Object.entries(n).map(([t,r])=>Array.isArray(r)?r.map(i=>`${bp(t)}=${bp(i)}`).join("&"):`${bp(t)}=${bp(r)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var mz=/^[^\/()?;#]+/;function Pw(n){let e=n.match(mz);return e?e[0]:""}var gz=/^[^\/()?;=#]+/;function _z(n){let e=n.match(gz);return e?e[0]:""}var yz=/^[^=?&#]+/;function vz(n){let e=n.match(yz);return e?e[0]:""}var wz=/^[^&#]+/;function Iz(n){let e=n.match(wz);return e?e[0]:""}var Uw=class{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new Pe([],{}):new Pe([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(r[pe]=new Pe(e,t)),r}parseSegment(){let e=Pw(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new te(4009,!1);return this.capture(e),new to(Ap(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=_z(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let i=Pw(this.remaining);i&&(r=i,this.capture(r))}e[Ap(t)]=Ap(r)}parseQueryParam(e){let t=vz(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let o=Iz(this.remaining);o&&(r=o,this.capture(r))}let i=UP(t),s=UP(r);if(e.hasOwnProperty(i)){let o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(s)}else e[i]=s}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=Pw(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new te(4010,!1);let s;r.indexOf(":")>-1?(s=r.slice(0,r.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=pe);let o=this.parseChildren();t[s]=Object.keys(o).length===1?o[pe]:new Pe([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new te(4011,!1)}};function eM(n){return n.segments.length>0?new Pe([],{[pe]:n}):n}function tM(n){let e={};for(let[r,i]of Object.entries(n.children)){let s=tM(i);if(r===pe&&s.segments.length===0&&s.hasChildren())for(let[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[r]=s)}let t=new Pe(n.segments,e);return Ez(t)}function Ez(n){if(n.numberOfChildren===1&&n.children[pe]){let e=n.children[pe];return new Pe(n.segments.concat(e.segments),e.children)}return n}function Va(n){return n instanceof Gi}function Tz(n,e,t=null,r=null){let i=nM(n);return rM(i,e,t,r)}function nM(n){let e;function t(s){let o={};for(let c of s.children){let l=t(c);o[c.outlet]=l}let a=new Pe(s.url,o);return s===n&&(e=a),a}let r=t(n.root),i=eM(r);return e??i}function rM(n,e,t,r){let i=n;for(;i.parent;)i=i.parent;if(e.length===0)return Mw(i,i,i,t,r);let s=bz(e);if(s.toRoot())return Mw(i,i,new Pe([],{}),t,r);let o=Cz(s,i,n),a=o.processChildren?_u(o.segmentGroup,o.index,s.commands):sM(o.segmentGroup,o.index,s.commands);return Mw(i,o.segmentGroup,a,t,r)}function Rp(n){return typeof n=="object"&&n!=null&&!n.outlets&&!n.segmentPath}function Iu(n){return typeof n=="object"&&n!=null&&n.outlets}function Mw(n,e,t,r,i){let s={};r&&Object.entries(r).forEach(([c,l])=>{s[c]=Array.isArray(l)?l.map(d=>`${d}`):`${l}`});let o;n===e?o=t:o=iM(n,e,t);let a=eM(tM(o));return new Gi(a,s,i)}function iM(n,e,t){let r={};return Object.entries(n.children).forEach(([i,s])=>{s===e?r[i]=t:r[i]=iM(s,e,t)}),new Pe(n.segments,r)}var xp=class{constructor(e,t,r){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=r,e&&r.length>0&&Rp(r[0]))throw new te(4003,!1);let i=r.find(Iu);if(i&&i!==GP(r))throw new te(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function bz(n){if(typeof n[0]=="string"&&n.length===1&&n[0]==="/")return new xp(!0,0,n);let e=0,t=!1,r=n.reduce((i,s,o)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let a={};return Object.entries(s.outlets).forEach(([c,l])=>{a[c]=typeof l=="string"?l.split("/"):l}),[...i,{outlets:a}]}if(s.segmentPath)return[...i,s.segmentPath]}return typeof s!="string"?[...i,s]:o===0?(s.split("/").forEach((a,c)=>{c==0&&a==="."||(c==0&&a===""?t=!0:a===".."?e++:a!=""&&i.push(a))}),i):[...i,s]},[]);return new xp(t,e,r)}var Oa=class{constructor(e,t,r){this.segmentGroup=e,this.processChildren=t,this.index=r}};function Cz(n,e,t){if(n.isAbsolute)return new Oa(e,!0,0);if(!t)return new Oa(e,!1,NaN);if(t.parent===null)return new Oa(t,!0,0);let r=Rp(n.commands[0])?0:1,i=t.segments.length-1+r;return Dz(t,i,n.numberOfDoubleDots)}function Dz(n,e,t){let r=n,i=e,s=t;for(;s>i;){if(s-=i,r=r.parent,!r)throw new te(4005,!1);i=r.segments.length}return new Oa(r,!1,i-s)}function Sz(n){return Iu(n[0])?n[0].outlets:{[pe]:n}}function sM(n,e,t){if(n??=new Pe([],{}),n.segments.length===0&&n.hasChildren())return _u(n,e,t);let r=Az(n,e,t),i=t.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){let s=new Pe(n.segments.slice(0,r.pathIndex),{});return s.children[pe]=new Pe(n.segments.slice(r.pathIndex),n.children),_u(s,0,i)}else return r.match&&i.length===0?new Pe(n.segments,{}):r.match&&!n.hasChildren()?jw(n,e,t):r.match?_u(n,0,i):jw(n,e,t)}function _u(n,e,t){if(t.length===0)return new Pe(n.segments,{});{let r=Sz(t),i={};if(Object.keys(r).some(s=>s!==pe)&&n.children[pe]&&n.numberOfChildren===1&&n.children[pe].segments.length===0){let s=_u(n.children[pe],e,t);return new Pe(n.segments,s.children)}return Object.entries(r).forEach(([s,o])=>{typeof o=="string"&&(o=[o]),o!==null&&(i[s]=sM(n.children[s],e,o))}),Object.entries(n.children).forEach(([s,o])=>{r[s]===void 0&&(i[s]=o)}),new Pe(n.segments,i)}}function Az(n,e,t){let r=0,i=e,s={match:!1,pathIndex:0,commandIndex:0};for(;i<n.segments.length;){if(r>=t.length)return s;let o=n.segments[i],a=t[r];if(Iu(a))break;let c=`${a}`,l=r<t.length-1?t[r+1]:null;if(i>0&&c===void 0)break;if(c&&l&&typeof l=="object"&&l.outlets===void 0){if(!BP(c,l,o))return s;r+=2}else{if(!BP(c,{},o))return s;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function jw(n,e,t){let r=n.segments.slice(0,e),i=0;for(;i<t.length;){let s=t[i];if(Iu(s)){let c=Rz(s.outlets);return new Pe(r,c)}if(i===0&&Rp(t[0])){let c=n.segments[e];r.push(new to(c.path,jP(t[0]))),i++;continue}let o=Iu(s)?s.outlets[pe]:`${s}`,a=i<t.length-1?t[i+1]:null;o&&a&&Rp(a)?(r.push(new to(o,jP(a))),i+=2):(r.push(new to(o,{})),i++)}return new Pe(r,{})}function Rz(n){let e={};return Object.entries(n).forEach(([t,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(e[t]=jw(new Pe([],{}),0,r))}),e}function jP(n){let e={};return Object.entries(n).forEach(([t,r])=>e[t]=`${r}`),e}function BP(n,e,t){return n==t.path&&Nr(e,t.parameters)}var yu="imperative",Pt=function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n}(Pt||{}),Hn=class{constructor(e,t){this.id=e,this.url=t}},Ua=class extends Hn{constructor(e,t,r="imperative",i=null){super(e,t),this.type=Pt.NavigationStart,this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},Pr=class extends Hn{constructor(e,t,r){super(e,t),this.urlAfterRedirects=r,this.type=Pt.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},An=function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n}(An||{}),Np=function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n}(Np||{}),Ki=class extends Hn{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=Pt.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},Qi=class extends Hn{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=Pt.NavigationSkipped}},Eu=class extends Hn{constructor(e,t,r,i){super(e,t),this.error=r,this.target=i,this.type=Pt.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},Pp=class extends Hn{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=Pt.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Bw=class extends Hn{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=Pt.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},$w=class extends Hn{constructor(e,t,r,i,s){super(e,t),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=s,this.type=Pt.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},Hw=class extends Hn{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=Pt.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},qw=class extends Hn{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=Pt.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},zw=class{constructor(e){this.route=e,this.type=Pt.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},Ww=class{constructor(e){this.route=e,this.type=Pt.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},Gw=class{constructor(e){this.snapshot=e,this.type=Pt.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Kw=class{constructor(e){this.snapshot=e,this.type=Pt.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Qw=class{constructor(e){this.snapshot=e,this.type=Pt.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Yw=class{constructor(e){this.snapshot=e,this.type=Pt.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Mp=class{constructor(e,t,r){this.routerEvent=e,this.position=t,this.anchor=r,this.type=Pt.Scroll}toString(){let e=this.position?`${this.position[0]}, ${this.position[1]}`:null;return`Scroll(anchor: '${this.anchor}', position: '${e}')`}},Tu=class{},bu=class{constructor(e){this.url=e}};var Jw=class{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new xu,this.attachRef=null}},xu=(()=>{let e=class e{constructor(){this.contexts=new Map}onChildOutletCreated(r,i){let s=this.getOrCreateContext(r);s.outlet=i,this.contexts.set(r,s)}onChildOutletDestroyed(r){let i=this.getContext(r);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){let r=this.contexts;return this.contexts=new Map,r}onOutletReAttached(r){this.contexts=r}getOrCreateContext(r){let i=this.getContext(r);return i||(i=new Jw,this.contexts.set(r,i)),i}getContext(r){return this.contexts.get(r)||null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),kp=class{constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=Xw(e,this._root);return t?t.children.map(r=>r.value):[]}firstChild(e){let t=Xw(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=Zw(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return Zw(e,this._root).map(t=>t.value)}};function Xw(n,e){if(n===e.value)return e;for(let t of e.children){let r=Xw(n,t);if(r)return r}return null}function Zw(n,e){if(n===e.value)return[e];for(let t of e.children){let r=Zw(n,t);if(r.length)return r.unshift(e),r}return[]}var Sn=class{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function ka(n){let e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}var Op=class extends kp{constructor(e,t){super(e),this.snapshot=t,lI(this,e)}toString(){return this.snapshot.toString()}};function oM(n){let e=xz(n),t=new Ft([new to("",{})]),r=new Ft({}),i=new Ft({}),s=new Ft({}),o=new Ft(""),a=new ro(t,r,s,o,i,pe,n,e.root);return a.snapshot=e.root,new Op(new Sn(a,[]),e)}function xz(n){let e={},t={},r={},i="",s=new Cu([],e,r,i,t,pe,n,null,{});return new Lp("",new Sn(s,[]))}var ro=class{constructor(e,t,r,i,s,o,a,c){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(Te(l=>l[Au]))??oe(void 0),this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(Te(e=>Fa(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(Te(e=>Fa(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function cI(n,e,t="emptyOnly"){let r,{routeConfig:i}=n;return e!==null&&(t==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?r={params:X(X({},e.params),n.params),data:X(X({},e.data),n.data),resolve:X(X(X(X({},n.data),e.data),i?.data),n._resolvedData)}:r={params:X({},n.params),data:X({},n.data),resolve:X(X({},n.data),n._resolvedData??{})},i&&cM(i)&&(r.resolve[Au]=i.title),r}var Cu=class{get title(){return this.data?.[Au]}constructor(e,t,r,i,s,o,a,c,l){this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s,this.outlet=o,this.component=a,this.routeConfig=c,this._resolve=l}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=Fa(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=Fa(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(r=>r.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},Lp=class extends kp{constructor(e,t){super(t),this.url=e,lI(this,t)}toString(){return aM(this._root)}};function lI(n,e){e.value._routerState=n,e.children.forEach(t=>lI(n,t))}function aM(n){let e=n.children.length>0?` { ${n.children.map(aM).join(", ")} } `:"";return`${n.value}${e}`}function kw(n){if(n.snapshot){let e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,Nr(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),Nr(e.params,t.params)||n.paramsSubject.next(t.params),sz(e.url,t.url)||n.urlSubject.next(t.url),Nr(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function eI(n,e){let t=Nr(n.params,e.params)&&lz(n.url,e.url),r=!n.parent!=!e.parent;return t&&!r&&(!n.parent||eI(n.parent,e.parent))}function cM(n){return typeof n.title=="string"||n.title===null}var uI=(()=>{let e=class e{constructor(){this.activated=null,this._activatedRoute=null,this.name=pe,this.activateEvents=new nn,this.deactivateEvents=new nn,this.attachEvents=new nn,this.detachEvents=new nn,this.parentContexts=G(xu),this.location=G(dp),this.changeDetector=G(lu),this.environmentInjector=G(gn),this.inputBinder=G(Bp,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(r){if(r.name){let{firstChange:i,previousValue:s}=r.name;if(i)return;this.isTrackedInParentContexts(s)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(s)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(r){return this.parentContexts.getContext(r)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let r=this.parentContexts.getContext(this.name);r?.route&&(r.attachRef?this.attach(r.attachRef,r.route):this.activateWith(r.route,r.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new te(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new te(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new te(4012,!1);this.location.detach();let r=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(r.instance),r}attach(r,i){this.activated=r,this._activatedRoute=i,this.location.insert(r.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(r.instance)}deactivate(){if(this.activated){let r=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(r)}}activateWith(r,i){if(this.isActivated)throw new te(4013,!1);this._activatedRoute=r;let s=this.location,a=r.snapshot.component,c=this.parentContexts.getOrCreateContext(this.name).children,l=new tI(r,c,s.injector);this.activated=s.createComponent(a,{index:s.length,injector:l,environmentInjector:i??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=Zf({type:e,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[ru]});let n=e;return n})(),tI=class n{__ngOutletInjector(e){return new n(this.route,this.childContexts,e)}constructor(e,t,r){this.route=e,this.childContexts=t,this.parent=r}get(e,t){return e===ro?this.route:e===xu?this.childContexts:this.parent.get(e,t)}},Bp=new ue(""),$P=(()=>{let e=class e{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(r){this.unsubscribeFromRouteData(r),this.subscribeToRouteData(r)}unsubscribeFromRouteData(r){this.outletDataSubscriptions.get(r)?.unsubscribe(),this.outletDataSubscriptions.delete(r)}subscribeToRouteData(r){let{activatedRoute:i}=r,s=Ul([i.queryParams,i.params,i.data]).pipe(Vn(([o,a,c],l)=>(c=X(X(X({},o),a),c),l===0?oe(c):Promise.resolve(c)))).subscribe(o=>{if(!r.isActivated||!r.activatedComponentRef||r.activatedRoute!==i||i.component===null){this.unsubscribeFromRouteData(r);return}let a=gP(i.component);if(!a){this.unsubscribeFromRouteData(r);return}for(let{templateName:c}of a.inputs)r.activatedComponentRef.setInput(c,o[c])});this.outletDataSubscriptions.set(r,s)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:e.\u0275fac});let n=e;return n})();function Nz(n,e,t){let r=Du(n,e._root,t?t._root:void 0);return new Op(r,e)}function Du(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){let r=t.value;r._futureSnapshot=e.value;let i=Pz(n,e,t);return new Sn(r,i)}else{if(n.shouldAttach(e.value)){let s=n.retrieve(e.value);if(s!==null){let o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>Du(n,a)),o}}let r=Mz(e.value),i=e.children.map(s=>Du(n,s));return new Sn(r,i)}}function Pz(n,e,t){return e.children.map(r=>{for(let i of t.children)if(n.shouldReuseRoute(r.value,i.value.snapshot))return Du(n,r,i);return Du(n,r)})}function Mz(n){return new ro(new Ft(n.url),new Ft(n.params),new Ft(n.queryParams),new Ft(n.fragment),new Ft(n.data),n.outlet,n.component,n)}var lM="ngNavigationCancelingError";function uM(n,e){let{redirectTo:t,navigationBehaviorOptions:r}=Va(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=dM(!1,An.Redirect);return i.url=t,i.navigationBehaviorOptions=r,i}function dM(n,e){let t=new Error(`NavigationCancelingError: ${n||""}`);return t[lM]=!0,t.cancellationCode=e,t}function kz(n){return hM(n)&&Va(n.url)}function hM(n){return!!n&&n[lM]}var Oz=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=Nt({type:e,selectors:[["ng-component"]],standalone:!0,features:[oP],decls:1,vars:0,template:function(i,s){i&1&&K(0,"router-outlet")},dependencies:[uI],encapsulation:2});let n=e;return n})();function Lz(n,e){return n.providers&&!n._injector&&(n._injector=hp(n.providers,e,`Route: ${n.path}`)),n._injector??e}function dI(n){let e=n.children&&n.children.map(dI),t=e?it(X({},n),{children:e}):X({},n);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==pe&&(t.component=Oz),t}function Mr(n){return n.outlet||pe}function Fz(n,e){let t=n.filter(r=>Mr(r)===e);return t.push(...n.filter(r=>Mr(r)!==e)),t}function Nu(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){let t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}var Vz=(n,e,t,r)=>Te(i=>(new nI(e,i.targetRouterState,i.currentRouterState,t,r).activate(n),i)),nI=class{constructor(e,t,r,i,s){this.routeReuseStrategy=e,this.futureState=t,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=s}activate(e){let t=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,r,e),kw(this.futureState.root),this.activateChildRoutes(t,r,e)}deactivateChildRoutes(e,t,r){let i=ka(t);e.children.forEach(s=>{let o=s.value.outlet;this.deactivateRoutes(s,i[o],r),delete i[o]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,r)})}deactivateRoutes(e,t,r){let i=e.value,s=t?t.value:null;if(i===s)if(i.component){let o=r.getContext(i.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,r);else s&&this.deactivateRouteAndItsChildren(t,r)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=ka(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);if(r&&r.outlet){let o=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=ka(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,t,r){let i=ka(t);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],r),this.forwardEvent(new Yw(s.value.snapshot))}),e.children.length&&this.forwardEvent(new Kw(e.value.snapshot))}activateRoutes(e,t,r){let i=e.value,s=t?t.value:null;if(kw(i),i===s)if(i.component){let o=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,r);else if(i.component){let o=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),kw(a.route.value),this.activateChildRoutes(e,null,o.children)}else{let a=Nu(i.snapshot);o.attachRef=null,o.route=i,o.injector=a,o.outlet&&o.outlet.activateWith(i,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,r)}},Fp=class{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},La=class{constructor(e,t){this.component=e,this.route=t}};function Uz(n,e,t){let r=n._root,i=e?e._root:null;return mu(r,i,t,[r.value])}function jz(n){let e=n.routeConfig?n.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:n,guards:e}}function Ba(n,e){let t=Symbol(),r=e.get(n,t);return r===t?typeof n=="function"&&!hx(n)?n:e.get(n):r}function mu(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=ka(e);return n.children.forEach(o=>{Bz(o,s[o.value.outlet],t,r.concat([o.value]),i),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>vu(a,t.getContext(o),i)),i}function Bz(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=n.value,o=e?e.value:null,a=t?t.getContext(n.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){let c=$z(o,s,s.routeConfig.runGuardsAndResolvers);c?i.canActivateChecks.push(new Fp(r)):(s.data=o.data,s._resolvedData=o._resolvedData),s.component?mu(n,e,a?a.children:null,r,i):mu(n,e,t,r,i),c&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new La(a.outlet.component,o))}else o&&vu(e,a,i),i.canActivateChecks.push(new Fp(r)),s.component?mu(n,null,a?a.children:null,r,i):mu(n,null,t,r,i);return i}function $z(n,e,t){if(typeof t=="function")return t(n,e);switch(t){case"pathParamsChange":return!no(n.url,e.url);case"pathParamsOrQueryParamsChange":return!no(n.url,e.url)||!Nr(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!eI(n,e)||!Nr(n.queryParams,e.queryParams);case"paramsChange":default:return!eI(n,e)}}function vu(n,e,t){let r=ka(n),i=n.value;Object.entries(r).forEach(([s,o])=>{i.component?e?vu(o,e.children.getContext(s),t):vu(o,null,t):vu(o,e,t)}),i.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new La(e.outlet.component,i)):t.canDeactivateChecks.push(new La(null,i)):t.canDeactivateChecks.push(new La(null,i))}function Pu(n){return typeof n=="function"}function Hz(n){return typeof n=="boolean"}function qz(n){return n&&Pu(n.canLoad)}function zz(n){return n&&Pu(n.canActivate)}function Wz(n){return n&&Pu(n.canActivateChild)}function Gz(n){return n&&Pu(n.canDeactivate)}function Kz(n){return n&&Pu(n.canMatch)}function fM(n){return n instanceof ui||n?.name==="EmptyError"}var Cp=Symbol("INITIAL_VALUE");function ja(){return Vn(n=>Ul(n.map(e=>e.pipe(di(1),Uy(Cp)))).pipe(Te(e=>{for(let t of e)if(t!==!0){if(t===Cp)return Cp;if(t===!1||t instanceof Gi)return t}return!0}),Fn(e=>e!==Cp),di(1)))}function Qz(n,e){return mt(t=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return o.length===0&&s.length===0?oe(it(X({},t),{guardsResult:!0})):Yz(o,r,i,n).pipe(mt(a=>a&&Hz(a)?Jz(r,s,n,e):oe(a)),Te(a=>it(X({},t),{guardsResult:a})))})}function Yz(n,e,t,r){return lt(n).pipe(mt(i=>n3(i.component,i.route,t,e,r)),Tr(i=>i!==!0,!0))}function Jz(n,e,t,r){return lt(e).pipe(zs(i=>_a(Zz(i.route.parent,r),Xz(i.route,r),t3(n,i.path,t),e3(n,i.route,t))),Tr(i=>i!==!0,!0))}function Xz(n,e){return n!==null&&e&&e(new Qw(n)),oe(!0)}function Zz(n,e){return n!==null&&e&&e(new Gw(n)),oe(!0)}function e3(n,e,t){let r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||r.length===0)return oe(!0);let i=r.map(s=>If(()=>{let o=Nu(e)??t,a=Ba(s,o),c=zz(a)?a.canActivate(e,n):pi(o,()=>a(e,n));return Yi(c).pipe(Tr())}));return oe(i).pipe(ja())}function t3(n,e,t){let r=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>jz(o)).filter(o=>o!==null).map(o=>If(()=>{let a=o.guards.map(c=>{let l=Nu(o.node)??t,d=Ba(c,l),h=Wz(d)?d.canActivateChild(r,n):pi(l,()=>d(r,n));return Yi(h).pipe(Tr())});return oe(a).pipe(ja())}));return oe(s).pipe(ja())}function n3(n,e,t,r,i){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return oe(!0);let o=s.map(a=>{let c=Nu(e)??i,l=Ba(a,c),d=Gz(l)?l.canDeactivate(n,e,t,r):pi(c,()=>l(n,e,t,r));return Yi(d).pipe(Tr())});return oe(o).pipe(ja())}function r3(n,e,t,r){let i=e.canLoad;if(i===void 0||i.length===0)return oe(!0);let s=i.map(o=>{let a=Ba(o,n),c=qz(a)?a.canLoad(e,t):pi(n,()=>a(e,t));return Yi(c)});return oe(s).pipe(ja(),pM(r))}function pM(n){return Ny(Vt(e=>{if(Va(e))throw uM(n,e)}),Te(e=>e===!0))}function i3(n,e,t,r){let i=e.canMatch;if(!i||i.length===0)return oe(!0);let s=i.map(o=>{let a=Ba(o,n),c=Kz(a)?a.canMatch(e,t):pi(n,()=>a(e,t));return Yi(c)});return oe(s).pipe(ja(),pM(r))}var Su=class{constructor(e){this.segmentGroup=e||null}},Vp=class extends Error{constructor(e){super(),this.urlTree=e}};function Ma(n){return ma(new Su(n))}function s3(n){return ma(new te(4e3,!1))}function o3(n){return ma(dM(!1,An.GuardRejected))}var rI=class{constructor(e,t){this.urlSerializer=e,this.urlTree=t}lineralizeSegments(e,t){let r=[],i=t.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return oe(r);if(i.numberOfChildren>1||!i.children[pe])return s3(e.redirectTo);i=i.children[pe]}}applyRedirectCommands(e,t,r){let i=this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,r);if(t.startsWith("/"))throw new Vp(i);return i}applyRedirectCreateUrlTree(e,t,r,i){let s=this.createSegmentGroup(e,t.root,r,i);return new Gi(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let r={};return Object.entries(e).forEach(([i,s])=>{if(typeof s=="string"&&s.startsWith(":")){let a=s.substring(1);r[i]=t[a]}else r[i]=s}),r}createSegmentGroup(e,t,r,i){let s=this.createSegments(e,t.segments,r,i),o={};return Object.entries(t.children).forEach(([a,c])=>{o[a]=this.createSegmentGroup(e,c,r,i)}),new Pe(s,o)}createSegments(e,t,r,i){return t.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,i):this.findOrReturn(s,r))}findPosParam(e,t,r){let i=r[t.path.substring(1)];if(!i)throw new te(4001,!1);return i}findOrReturn(e,t){let r=0;for(let i of t){if(i.path===e.path)return t.splice(r),i;r++}return e}},iI={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function a3(n,e,t,r,i){let s=hI(n,e,t);return s.matched?(r=Lz(e,r),i3(r,e,t,i).pipe(Te(o=>o===!0?s:X({},iI)))):oe(s)}function hI(n,e,t){if(e.path==="**")return c3(t);if(e.path==="")return e.pathMatch==="full"&&(n.hasChildren()||t.length>0)?X({},iI):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let i=(e.matcher||iz)(t,n,e);if(!i)return X({},iI);let s={};Object.entries(i.posParams??{}).forEach(([a,c])=>{s[a]=c.path});let o=i.consumed.length>0?X(X({},s),i.consumed[i.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:t.slice(i.consumed.length),parameters:o,positionalParamSegments:i.posParams??{}}}function c3(n){return{matched:!0,parameters:n.length>0?GP(n).parameters:{},consumedSegments:n,remainingSegments:[],positionalParamSegments:{}}}function HP(n,e,t,r){return t.length>0&&d3(n,t,r)?{segmentGroup:new Pe(e,u3(r,new Pe(t,n.children))),slicedSegments:[]}:t.length===0&&h3(n,t,r)?{segmentGroup:new Pe(n.segments,l3(n,t,r,n.children)),slicedSegments:t}:{segmentGroup:new Pe(n.segments,n.children),slicedSegments:t}}function l3(n,e,t,r){let i={};for(let s of t)if($p(n,e,s)&&!r[Mr(s)]){let o=new Pe([],{});i[Mr(s)]=o}return X(X({},r),i)}function u3(n,e){let t={};t[pe]=e;for(let r of n)if(r.path===""&&Mr(r)!==pe){let i=new Pe([],{});t[Mr(r)]=i}return t}function d3(n,e,t){return t.some(r=>$p(n,e,r)&&Mr(r)!==pe)}function h3(n,e,t){return t.some(r=>$p(n,e,r))}function $p(n,e,t){return(n.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function f3(n,e,t,r){return Mr(n)!==r&&(r===pe||!$p(e,t,n))?!1:hI(e,n,t).matched}function p3(n,e,t){return e.length===0&&!n.children[t]}var sI=class{};function m3(n,e,t,r,i,s,o="emptyOnly"){return new oI(n,e,t,r,i,o,s).recognize()}var g3=31,oI=class{constructor(e,t,r,i,s,o,a){this.injector=e,this.configLoader=t,this.rootComponentType=r,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.applyRedirects=new rI(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new te(4002,`'${e.segmentGroup}'`)}recognize(){let e=HP(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(Te(t=>{let r=new Cu([],Object.freeze({}),Object.freeze(X({},this.urlTree.queryParams)),this.urlTree.fragment,{},pe,this.rootComponentType,null,{}),i=new Sn(r,t),s=new Lp("",i),o=Tz(r,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),this.inheritParamsAndData(s._root,null),{state:s,tree:o}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e,pe).pipe(ji(r=>{if(r instanceof Vp)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof Su?this.noMatchError(r):r}))}inheritParamsAndData(e,t){let r=e.value,i=cI(r,t,this.paramsInheritanceStrategy);r.params=Object.freeze(i.params),r.data=Object.freeze(i.data),e.children.forEach(s=>this.inheritParamsAndData(s,r))}processSegmentGroup(e,t,r,i){return r.segments.length===0&&r.hasChildren()?this.processChildren(e,t,r):this.processSegment(e,t,r,r.segments,i,!0).pipe(Te(s=>s instanceof Sn?[s]:[]))}processChildren(e,t,r){let i=[];for(let s of Object.keys(r.children))s==="primary"?i.unshift(s):i.push(s);return lt(i).pipe(zs(s=>{let o=r.children[s],a=Fz(t,s);return this.processSegmentGroup(e,a,o,s)}),Vy((s,o)=>(s.push(...o),s)),Bi(null),Fy(),mt(s=>{if(s===null)return Ma(r);let o=mM(s);return _3(o),oe(o)}))}processSegment(e,t,r,i,s,o){return lt(t).pipe(zs(a=>this.processSegmentAgainstRoute(a._injector??e,t,a,r,i,s,o).pipe(ji(c=>{if(c instanceof Su)return oe(null);throw c}))),Tr(a=>!!a),ji(a=>{if(fM(a))return p3(r,i,s)?oe(new sI):Ma(r);throw a}))}processSegmentAgainstRoute(e,t,r,i,s,o,a){return f3(r,i,s,o)?r.redirectTo===void 0?this.matchSegmentAgainstRoute(e,i,r,s,o):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,i,t,r,s,o):Ma(i):Ma(i)}expandSegmentAgainstRouteUsingRedirect(e,t,r,i,s,o){let{matched:a,consumedSegments:c,positionalParamSegments:l,remainingSegments:d}=hI(t,i,s);if(!a)return Ma(t);i.redirectTo.startsWith("/")&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>g3&&(this.allowRedirects=!1));let h=this.applyRedirects.applyRedirectCommands(c,i.redirectTo,l);return this.applyRedirects.lineralizeSegments(i,h).pipe(mt(m=>this.processSegment(e,r,t,m.concat(d),o,!1)))}matchSegmentAgainstRoute(e,t,r,i,s){let o=a3(t,r,i,e,this.urlSerializer);return r.path==="**"&&(t.children={}),o.pipe(Vn(a=>a.matched?(e=r._injector??e,this.getChildConfig(e,r,i).pipe(Vn(({routes:c})=>{let l=r._loadedInjector??e,{consumedSegments:d,remainingSegments:h,parameters:m}=a,_=new Cu(d,m,Object.freeze(X({},this.urlTree.queryParams)),this.urlTree.fragment,v3(r),Mr(r),r.component??r._loadedComponent??null,r,w3(r)),{segmentGroup:w,slicedSegments:C}=HP(t,d,h,c);if(C.length===0&&w.hasChildren())return this.processChildren(l,c,w).pipe(Te(L=>L===null?null:new Sn(_,L)));if(c.length===0&&C.length===0)return oe(new Sn(_,[]));let A=Mr(r)===s;return this.processSegment(l,c,w,C,A?pe:s,!0).pipe(Te(L=>new Sn(_,L instanceof Sn?[L]:[])))}))):Ma(t)))}getChildConfig(e,t,r){return t.children?oe({routes:t.children,injector:e}):t.loadChildren?t._loadedRoutes!==void 0?oe({routes:t._loadedRoutes,injector:t._loadedInjector}):r3(e,t,r,this.urlSerializer).pipe(mt(i=>i?this.configLoader.loadChildren(e,t).pipe(Vt(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):o3(t))):oe({routes:[],injector:e})}};function _3(n){n.sort((e,t)=>e.value.outlet===pe?-1:t.value.outlet===pe?1:e.value.outlet.localeCompare(t.value.outlet))}function y3(n){let e=n.value.routeConfig;return e&&e.path===""}function mM(n){let e=[],t=new Set;for(let r of n){if(!y3(r)){e.push(r);continue}let i=e.find(s=>r.value.routeConfig===s.value.routeConfig);i!==void 0?(i.children.push(...r.children),t.add(i)):e.push(r)}for(let r of t){let i=mM(r.children);e.push(new Sn(r.value,i))}return e.filter(r=>!t.has(r))}function v3(n){return n.data||{}}function w3(n){return n.resolve||{}}function I3(n,e,t,r,i,s){return mt(o=>m3(n,e,t,r,o.extractedUrl,i,s).pipe(Te(({state:a,tree:c})=>it(X({},o),{targetSnapshot:a,urlAfterRedirects:c}))))}function E3(n,e){return mt(t=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=t;if(!i.length)return oe(t);let s=new Set(i.map(c=>c.route)),o=new Set;for(let c of s)if(!o.has(c))for(let l of gM(c))o.add(l);let a=0;return lt(o).pipe(zs(c=>s.has(c)?T3(c,r,n,e):(c.data=cI(c,c.parent,n).resolve,oe(void 0))),Vt(()=>a++),ya(1),mt(c=>a===o.size?oe(t):bn))})}function gM(n){let e=n.children.map(t=>gM(t)).flat();return[n,...e]}function T3(n,e,t,r){let i=n.routeConfig,s=n._resolve;return i?.title!==void 0&&!cM(i)&&(s[Au]=i.title),b3(s,n,e,r).pipe(Te(o=>(n._resolvedData=o,n.data=cI(n,n.parent,t).resolve,null)))}function b3(n,e,t,r){let i=Fw(n);if(i.length===0)return oe({});let s={};return lt(i).pipe(mt(o=>C3(n[o],e,t,r).pipe(Tr(),Vt(a=>{s[o]=a}))),ya(1),Ly(s),ji(o=>fM(o)?bn:ma(o)))}function C3(n,e,t,r){let i=Nu(e)??r,s=Ba(n,i),o=s.resolve?s.resolve(e,t):pi(i,()=>s(e,t));return Yi(o)}function Ow(n){return Vn(e=>{let t=n(e);return t?lt(t).pipe(Te(()=>e)):oe(e)})}var _M=(()=>{let e=class e{buildTitle(r){let i,s=r.root;for(;s!==void 0;)i=this.getResolvedTitleForRoute(s)??i,s=s.children.find(o=>o.outlet===pe);return i}getResolvedTitleForRoute(r){return r.data[Au]}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:()=>G(D3),providedIn:"root"});let n=e;return n})(),D3=(()=>{let e=class e extends _M{constructor(r){super(),this.title=r}updateTitle(r){let i=this.buildTitle(r);i!==void 0&&this.title.setTitle(i)}};e.\u0275fac=function(i){return new(i||e)(ie(LP))},e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),Mu=new ue("",{providedIn:"root",factory:()=>({})}),Up=new ue(""),fI=(()=>{let e=class e{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=G(yp)}loadComponent(r){if(this.componentLoaders.get(r))return this.componentLoaders.get(r);if(r._loadedComponent)return oe(r._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(r);let i=Yi(r.loadComponent()).pipe(Te(yM),Vt(o=>{this.onLoadEndListener&&this.onLoadEndListener(r),r._loadedComponent=o}),jl(()=>{this.componentLoaders.delete(r)})),s=new pa(i,()=>new Wt).pipe(fa());return this.componentLoaders.set(r,s),s}loadChildren(r,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return oe({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);let o=S3(i,this.compiler,r,this.onLoadEndListener).pipe(jl(()=>{this.childrenLoaders.delete(i)})),a=new pa(o,()=>new Wt).pipe(fa());return this.childrenLoaders.set(i,a),a}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function S3(n,e,t,r){return Yi(n.loadChildren()).pipe(Te(yM),mt(i=>i instanceof Zl||Array.isArray(i)?oe(i):lt(e.compileModuleAsync(i))),Te(i=>{r&&r(n);let s,o,a=!1;return Array.isArray(i)?(o=i,a=!0):(s=i.create(t).injector,o=s.get(Up,[],{optional:!0,self:!0}).flat()),{routes:o.map(dI),injector:s}}))}function A3(n){return n&&typeof n=="object"&&"default"in n}function yM(n){return A3(n)?n.default:n}var pI=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:()=>G(R3),providedIn:"root"});let n=e;return n})(),R3=(()=>{let e=class e{shouldProcessUrl(r){return!0}extract(r){return r}merge(r,i){return r}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),vM=new ue(""),wM=new ue("");function x3(n,e,t){let r=n.get(wM),i=n.get(yn);return n.get($e).runOutsideAngular(()=>{if(!i.startViewTransition||r.skipNextTransition)return r.skipNextTransition=!1,new Promise(l=>setTimeout(l));let s,o=new Promise(l=>{s=l}),a=i.startViewTransition(()=>(s(),N3(n))),{onViewTransitionCreated:c}=r;return c&&pi(n,()=>c({transition:a,from:e,to:t})),o})}function N3(n){return new Promise(e=>{up(e,{injector:n})})}var mI=(()=>{let e=class e{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new Wt,this.transitionAbortSubject=new Wt,this.configLoader=G(fI),this.environmentInjector=G(gn),this.urlSerializer=G(Ru),this.rootContexts=G(xu),this.location=G(Pa),this.inputBindingEnabled=G(Bp,{optional:!0})!==null,this.titleStrategy=G(_M),this.options=G(Mu,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=G(pI),this.createViewTransition=G(vM,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>oe(void 0),this.rootComponentType=null;let r=s=>this.events.next(new zw(s)),i=s=>this.events.next(new Ww(s));this.configLoader.onLoadEndListener=i,this.configLoader.onLoadStartListener=r}complete(){this.transitions?.complete()}handleNavigationRequest(r){let i=++this.navigationId;this.transitions?.next(it(X(X({},this.transitions.value),r),{id:i}))}setupNavigations(r,i,s){return this.transitions=new Ft({id:0,currentUrlTree:i,currentRawUrl:i,extractedUrl:this.urlHandlingStrategy.extract(i),urlAfterRedirects:this.urlHandlingStrategy.extract(i),rawUrl:i,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:yu,restoredState:null,currentSnapshot:s.snapshot,targetSnapshot:null,currentRouterState:s,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Fn(o=>o.id!==0),Te(o=>it(X({},o),{extractedUrl:this.urlHandlingStrategy.extract(o.rawUrl)})),Vn(o=>{let a=!1,c=!1;return oe(o).pipe(Vn(l=>{if(this.navigationId>o.id)return this.cancelNavigationTransition(o,"",An.SupersededByNewNavigation),bn;this.currentTransition=o,this.currentNavigation={id:l.id,initialUrl:l.rawUrl,extractedUrl:l.extractedUrl,trigger:l.source,extras:l.extras,previousNavigation:this.lastSuccessfulNavigation?it(X({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let d=!r.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),h=l.extras.onSameUrlNavigation??r.onSameUrlNavigation;if(!d&&h!=="reload"){let m="";return this.events.next(new Qi(l.id,this.urlSerializer.serialize(l.rawUrl),m,Np.IgnoredSameUrlNavigation)),l.resolve(null),bn}if(this.urlHandlingStrategy.shouldProcessUrl(l.rawUrl))return oe(l).pipe(Vn(m=>{let _=this.transitions?.getValue();return this.events.next(new Ua(m.id,this.urlSerializer.serialize(m.extractedUrl),m.source,m.restoredState)),_!==this.transitions?.getValue()?bn:Promise.resolve(m)}),I3(this.environmentInjector,this.configLoader,this.rootComponentType,r.config,this.urlSerializer,this.paramsInheritanceStrategy),Vt(m=>{o.targetSnapshot=m.targetSnapshot,o.urlAfterRedirects=m.urlAfterRedirects,this.currentNavigation=it(X({},this.currentNavigation),{finalUrl:m.urlAfterRedirects});let _=new Pp(m.id,this.urlSerializer.serialize(m.extractedUrl),this.urlSerializer.serialize(m.urlAfterRedirects),m.targetSnapshot);this.events.next(_)}));if(d&&this.urlHandlingStrategy.shouldProcessUrl(l.currentRawUrl)){let{id:m,extractedUrl:_,source:w,restoredState:C,extras:A}=l,L=new Ua(m,this.urlSerializer.serialize(_),w,C);this.events.next(L);let H=oM(this.rootComponentType).snapshot;return this.currentTransition=o=it(X({},l),{targetSnapshot:H,urlAfterRedirects:_,extras:it(X({},A),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=_,oe(o)}else{let m="";return this.events.next(new Qi(l.id,this.urlSerializer.serialize(l.extractedUrl),m,Np.IgnoredByUrlHandlingStrategy)),l.resolve(null),bn}}),Vt(l=>{let d=new Bw(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(d)}),Te(l=>(this.currentTransition=o=it(X({},l),{guards:Uz(l.targetSnapshot,l.currentSnapshot,this.rootContexts)}),o)),Qz(this.environmentInjector,l=>this.events.next(l)),Vt(l=>{if(o.guardsResult=l.guardsResult,Va(l.guardsResult))throw uM(this.urlSerializer,l.guardsResult);let d=new $w(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot,!!l.guardsResult);this.events.next(d)}),Fn(l=>l.guardsResult?!0:(this.cancelNavigationTransition(l,"",An.GuardRejected),!1)),Ow(l=>{if(l.guards.canActivateChecks.length)return oe(l).pipe(Vt(d=>{let h=new Hw(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot);this.events.next(h)}),Vn(d=>{let h=!1;return oe(d).pipe(E3(this.paramsInheritanceStrategy,this.environmentInjector),Vt({next:()=>h=!0,complete:()=>{h||this.cancelNavigationTransition(d,"",An.NoDataFromResolver)}}))}),Vt(d=>{let h=new qw(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot);this.events.next(h)}))}),Ow(l=>{let d=h=>{let m=[];h.routeConfig?.loadComponent&&!h.routeConfig._loadedComponent&&m.push(this.configLoader.loadComponent(h.routeConfig).pipe(Vt(_=>{h.component=_}),Te(()=>{})));for(let _ of h.children)m.push(...d(_));return m};return Ul(d(l.targetSnapshot.root)).pipe(Bi(null),di(1))}),Ow(()=>this.afterPreactivation()),Vn(()=>{let{currentSnapshot:l,targetSnapshot:d}=o,h=this.createViewTransition?.(this.environmentInjector,l.root,d.root);return h?lt(h).pipe(Te(()=>o)):oe(o)}),Te(l=>{let d=Nz(r.routeReuseStrategy,l.targetSnapshot,l.currentRouterState);return this.currentTransition=o=it(X({},l),{targetRouterState:d}),this.currentNavigation.targetRouterState=d,o}),Vt(()=>{this.events.next(new Tu)}),Vz(this.rootContexts,r.routeReuseStrategy,l=>this.events.next(l),this.inputBindingEnabled),di(1),Vt({next:l=>{a=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new Pr(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects))),this.titleStrategy?.updateTitle(l.targetRouterState.snapshot),l.resolve(!0)},complete:()=>{a=!0}}),jy(this.transitionAbortSubject.pipe(Vt(l=>{throw l}))),jl(()=>{!a&&!c&&this.cancelNavigationTransition(o,"",An.SupersededByNewNavigation),this.currentTransition?.id===o.id&&(this.currentNavigation=null,this.currentTransition=null)}),ji(l=>{if(c=!0,hM(l))this.events.next(new Ki(o.id,this.urlSerializer.serialize(o.extractedUrl),l.message,l.cancellationCode)),kz(l)?this.events.next(new bu(l.url)):o.resolve(!1);else{this.events.next(new Eu(o.id,this.urlSerializer.serialize(o.extractedUrl),l,o.targetSnapshot??void 0));try{o.resolve(r.errorHandler(l))}catch(d){this.options.resolveNavigationPromiseOnError?o.resolve(!1):o.reject(d)}}return bn}))}))}cancelNavigationTransition(r,i,s){let o=new Ki(r.id,this.urlSerializer.serialize(r.extractedUrl),i,s);this.events.next(o),r.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){return this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))).toString()!==this.currentTransition?.extractedUrl.toString()&&!this.currentTransition?.extras.skipLocationChange}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function P3(n){return n!==yu}var M3=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:()=>G(k3),providedIn:"root"});let n=e;return n})(),aI=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}},k3=(()=>{let e=class e extends aI{};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Wv(e)))(s||e)}})(),e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),IM=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:()=>G(O3),providedIn:"root"});let n=e;return n})(),O3=(()=>{let e=class e extends IM{constructor(){super(...arguments),this.location=G(Pa),this.urlSerializer=G(Ru),this.options=G(Mu,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=G(pI),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new Gi,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=oM(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(r){return this.location.subscribe(i=>{i.type==="popstate"&&r(i.url,i.state)})}handleRouterEvent(r,i){if(r instanceof Ua)this.stateMemento=this.createStateMemento();else if(r instanceof Qi)this.rawUrlTree=i.initialUrl;else if(r instanceof Pp){if(this.urlUpdateStrategy==="eager"&&!i.extras.skipLocationChange){let s=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl);this.setBrowserUrl(s,i)}}else r instanceof Tu?(this.currentUrlTree=i.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl),this.routerState=i.targetRouterState,this.urlUpdateStrategy==="deferred"&&(i.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,i))):r instanceof Ki&&(r.code===An.GuardRejected||r.code===An.NoDataFromResolver)?this.restoreHistory(i):r instanceof Eu?this.restoreHistory(i,!0):r instanceof Pr&&(this.lastSuccessfulId=r.id,this.currentPageId=this.browserPageId)}setBrowserUrl(r,i){let s=this.urlSerializer.serialize(r);if(this.location.isCurrentPathEqualTo(s)||i.extras.replaceUrl){let o=this.browserPageId,a=X(X({},i.extras.state),this.generateNgRouterState(i.id,o));this.location.replaceState(s,"",a)}else{let o=X(X({},i.extras.state),this.generateNgRouterState(i.id,this.browserPageId+1));this.location.go(s,"",o)}}restoreHistory(r,i=!1){if(this.canceledNavigationResolution==="computed"){let s=this.browserPageId,o=this.currentPageId-s;o!==0?this.location.historyGo(o):this.currentUrlTree===r.finalUrl&&o===0&&(this.resetState(r),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(i&&this.resetState(r),this.resetUrlToCurrentUrlTree())}resetState(r){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,r.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(r,i){return this.canceledNavigationResolution==="computed"?{navigationId:r,\u0275routerPageId:i}:{navigationId:r}}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Wv(e)))(s||e)}})(),e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),gu=function(n){return n[n.COMPLETE=0]="COMPLETE",n[n.FAILED=1]="FAILED",n[n.REDIRECTING=2]="REDIRECTING",n}(gu||{});function EM(n,e){n.events.pipe(Fn(t=>t instanceof Pr||t instanceof Ki||t instanceof Eu||t instanceof Qi),Te(t=>t instanceof Pr||t instanceof Qi?gu.COMPLETE:(t instanceof Ki?t.code===An.Redirect||t.code===An.SupersededByNewNavigation:!1)?gu.REDIRECTING:gu.FAILED),Fn(t=>t!==gu.REDIRECTING),di(1)).subscribe(()=>{e()})}function L3(n){throw n}var F3={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},V3={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},kr=(()=>{let e=class e{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.isNgZoneEnabled=!1,this.console=G(pp),this.stateManager=G(IM),this.options=G(Mu,{optional:!0})||{},this.pendingTasks=G(fp),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=G(mI),this.urlSerializer=G(Ru),this.location=G(Pa),this.urlHandlingStrategy=G(pI),this._events=new Wt,this.errorHandler=this.options.errorHandler||L3,this.navigated=!1,this.routeReuseStrategy=G(M3),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=G(Up,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!G(Bp,{optional:!0}),this.eventsSubscription=new Ct,this.isNgZoneEnabled=G($e)instanceof $e&&$e.isInAngularZone(),this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:r=>{this.console.warn(r)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let r=this.navigationTransitions.events.subscribe(i=>{try{let s=this.navigationTransitions.currentTransition,o=this.navigationTransitions.currentNavigation;if(s!==null&&o!==null){if(this.stateManager.handleRouterEvent(i,o),i instanceof Ki&&i.code!==An.Redirect&&i.code!==An.SupersededByNewNavigation)this.navigated=!0;else if(i instanceof Pr)this.navigated=!0;else if(i instanceof bu){let a=this.urlHandlingStrategy.merge(i.url,s.currentRawUrl),c={info:s.extras.info,skipLocationChange:s.extras.skipLocationChange,replaceUrl:this.urlUpdateStrategy==="eager"||P3(s.source)};this.scheduleNavigation(a,yu,null,c,{resolve:s.resolve,reject:s.reject,promise:s.promise})}}j3(i)&&this._events.next(i)}catch(s){this.navigationTransitions.transitionAbortSubject.next(s)}});this.eventsSubscription.add(r)}resetRootComponentType(r){this.routerState.root.component=r,this.navigationTransitions.rootComponentType=r}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),yu,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((r,i)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(r,"popstate",i)},0)})}navigateToSyncWithBrowser(r,i,s){let o={replaceUrl:!0},a=s?.navigationId?s:null;if(s){let l=X({},s);delete l.navigationId,delete l.\u0275routerPageId,Object.keys(l).length!==0&&(o.state=l)}let c=this.parseUrl(r);this.scheduleNavigation(c,i,a,o)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(r){this.config=r.map(dI),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(r,i={}){let{relativeTo:s,queryParams:o,fragment:a,queryParamsHandling:c,preserveFragment:l}=i,d=l?this.currentUrlTree.fragment:a,h=null;switch(c){case"merge":h=X(X({},this.currentUrlTree.queryParams),o);break;case"preserve":h=this.currentUrlTree.queryParams;break;default:h=o||null}h!==null&&(h=this.removeEmptyProps(h));let m;try{let _=s?s.snapshot:this.routerState.snapshot.root;m=nM(_)}catch{(typeof r[0]!="string"||!r[0].startsWith("/"))&&(r=[]),m=this.currentUrlTree.root}return rM(m,r,h,d??null)}navigateByUrl(r,i={skipLocationChange:!1}){let s=Va(r)?r:this.parseUrl(r),o=this.urlHandlingStrategy.merge(s,this.rawUrlTree);return this.scheduleNavigation(o,yu,null,i)}navigate(r,i={skipLocationChange:!1}){return U3(r),this.navigateByUrl(this.createUrlTree(r,i),i)}serializeUrl(r){return this.urlSerializer.serialize(r)}parseUrl(r){try{return this.urlSerializer.parse(r)}catch{return this.urlSerializer.parse("/")}}isActive(r,i){let s;if(i===!0?s=X({},F3):i===!1?s=X({},V3):s=i,Va(r))return VP(this.currentUrlTree,r,s);let o=this.parseUrl(r);return VP(this.currentUrlTree,o,s)}removeEmptyProps(r){return Object.entries(r).reduce((i,[s,o])=>(o!=null&&(i[s]=o),i),{})}scheduleNavigation(r,i,s,o,a){if(this.disposed)return Promise.resolve(!1);let c,l,d;a?(c=a.resolve,l=a.reject,d=a.promise):d=new Promise((m,_)=>{c=m,l=_});let h=this.pendingTasks.add();return EM(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(h))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:s,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:r,extras:o,resolve:c,reject:l,promise:d,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),d.catch(m=>Promise.reject(m))}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function U3(n){for(let e=0;e<n.length;e++)if(n[e]==null)throw new te(4008,!1)}function j3(n){return!(n instanceof Tu)&&!(n instanceof bu)}var Hp=(()=>{let e=class e{constructor(r,i,s,o,a,c){this.router=r,this.route=i,this.tabIndexAttribute=s,this.renderer=o,this.el=a,this.locationStrategy=c,this.href=null,this.commands=null,this.onChanges=new Wt,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1;let l=a.nativeElement.tagName?.toLowerCase();this.isAnchorElement=l==="a"||l==="area",this.isAnchorElement?this.subscription=r.events.subscribe(d=>{d instanceof Pr&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(r){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",r)}ngOnChanges(r){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(r){r!=null?(this.commands=Array.isArray(r)?r:[r],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(r,i,s,o,a){let c=this.urlTree;if(c===null||this.isAnchorElement&&(r!==0||i||s||o||a||typeof this.target=="string"&&this.target!="_self"))return!0;let l={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(c,l),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let r=this.urlTree;this.href=r!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(r)):null;let i=this.href===null?null:SN(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",i)}applyAttributeValue(r,i){let s=this.renderer,o=this.el.nativeElement;i!==null?s.setAttribute(o,r,i):s.removeAttribute(o,r)}get urlTree(){return this.commands===null?null:this.router.createUrlTree(this.commands,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}};e.\u0275fac=function(i){return new(i||e)($n(kr),$n(ro),Gv("tabindex"),$n(lp),$n(su),$n(dr))},e.\u0275dir=Zf({type:e,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(i,s){i&1&&fe("click",function(a){return s.onClick(a.button,a.ctrlKey,a.shiftKey,a.altKey,a.metaKey)}),i&2&&dw("target",s.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[ir.HasDecoratorInputTransform,"preserveFragment","preserveFragment",uu],skipLocationChange:[ir.HasDecoratorInputTransform,"skipLocationChange","skipLocationChange",uu],replaceUrl:[ir.HasDecoratorInputTransform,"replaceUrl","replaceUrl",uu],routerLink:"routerLink"},standalone:!0,features:[uw,ru]});let n=e;return n})();var jp=class{};var B3=(()=>{let e=class e{constructor(r,i,s,o,a){this.router=r,this.injector=s,this.preloadingStrategy=o,this.loader=a}setUpPreloading(){this.subscription=this.router.events.pipe(Fn(r=>r instanceof Pr),zs(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(r,i){let s=[];for(let o of i){o.providers&&!o._injector&&(o._injector=hp(o.providers,r,`Route: ${o.path}`));let a=o._injector??r,c=o._loadedInjector??a;(o.loadChildren&&!o._loadedRoutes&&o.canLoad===void 0||o.loadComponent&&!o._loadedComponent)&&s.push(this.preloadConfig(a,o)),(o.children||o._loadedRoutes)&&s.push(this.processRoutes(c,o.children??o._loadedRoutes))}return lt(s).pipe(ga())}preloadConfig(r,i){return this.preloadingStrategy.preload(i,()=>{let s;i.loadChildren&&i.canLoad===void 0?s=this.loader.loadChildren(r,i):s=oe(null);let o=s.pipe(mt(a=>a===null?oe(void 0):(i._loadedRoutes=a.routes,i._loadedInjector=a.injector,this.processRoutes(a.injector??r,a.routes))));if(i.loadComponent&&!i._loadedComponent){let a=this.loader.loadComponent(i);return lt([o,a]).pipe(ga())}else return o})}};e.\u0275fac=function(i){return new(i||e)(ie(kr),ie(yp),ie(gn),ie(jp),ie(fI))},e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),TM=new ue(""),$3=(()=>{let e=class e{constructor(r,i,s,o,a={}){this.urlSerializer=r,this.transitions=i,this.viewportScroller=s,this.zone=o,this.options=a,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},this.environmentInjector=G(gn),a.scrollPositionRestoration||="disabled",a.anchorScrolling||="disabled"}init(){this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(r=>{r instanceof Ua?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=r.navigationTrigger,this.restoredId=r.restoredState?r.restoredState.navigationId:0):r instanceof Pr?(this.lastId=r.id,this.scheduleScrollEvent(r,this.urlSerializer.parse(r.urlAfterRedirects).fragment)):r instanceof Qi&&r.code===Np.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(r,this.urlSerializer.parse(r.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(r=>{r instanceof Mp&&(r.position?this.options.scrollPositionRestoration==="top"?this.viewportScroller.scrollToPosition([0,0]):this.options.scrollPositionRestoration==="enabled"&&this.viewportScroller.scrollToPosition(r.position):r.anchor&&this.options.anchorScrolling==="enabled"?this.viewportScroller.scrollToAnchor(r.anchor):this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(r,i){this.zone.runOutsideAngular(()=>g(this,null,function*(){yield new Promise(s=>{setTimeout(()=>{s()}),up(()=>{s()},{injector:this.environmentInjector})}),this.zone.run(()=>{this.transitions.events.next(new Mp(r,this.lastSource==="popstate"?this.store[this.restoredId]:null,i))})}))}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}};e.\u0275fac=function(i){jN()},e.\u0275prov=ne({token:e,factory:e.\u0275fac});let n=e;return n})();function H3(n){return n.routerState.root}function ku(n,e){return{\u0275kind:n,\u0275providers:e}}function q3(){let n=G(xr);return e=>{let t=n.get(Na);if(e!==t.components[0])return;let r=n.get(kr),i=n.get(bM);n.get(gI)===1&&r.initialNavigation(),n.get(CM,null,ye.Optional)?.setUpPreloading(),n.get(TM,null,ye.Optional)?.init(),r.resetRootComponentType(t.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var bM=new ue("",{factory:()=>new Wt}),gI=new ue("",{providedIn:"root",factory:()=>1});function z3(){return ku(2,[{provide:gI,useValue:0},{provide:_p,multi:!0,deps:[xr],useFactory:e=>{let t=e.get(EP,Promise.resolve());return()=>t.then(()=>new Promise(r=>{let i=e.get(kr),s=e.get(bM);EM(i,()=>{r(!0)}),e.get(mI).afterPreactivation=()=>(r(!0),s.closed?oe(void 0):s),i.initialNavigation()}))}}])}function W3(){return ku(3,[{provide:_p,multi:!0,useFactory:()=>{let e=G(kr);return()=>{e.setUpLocationChangeListener()}}},{provide:gI,useValue:2}])}var CM=new ue("");function G3(n){return ku(0,[{provide:CM,useExisting:B3},{provide:jp,useExisting:n}])}function K3(){return ku(8,[$P,{provide:Bp,useExisting:$P}])}function Q3(n){let e=[{provide:vM,useValue:x3},{provide:wM,useValue:X({skipNextTransition:!!n?.skipInitialTransition},n)}];return ku(9,e)}var qP=new ue("ROUTER_FORROOT_GUARD"),Y3=[Pa,{provide:Ru,useClass:wu},kr,xu,{provide:ro,useFactory:H3,deps:[kr]},fI,[]],_I=(()=>{let e=class e{constructor(r){}static forRoot(r,i){return{ngModule:e,providers:[Y3,[],{provide:Up,multi:!0,useValue:r},{provide:qP,useFactory:eW,deps:[[kr,new Pv,new vx]]},{provide:Mu,useValue:i||{}},i?.useHash?X3():Z3(),J3(),i?.preloadingStrategy?G3(i.preloadingStrategy).\u0275providers:[],i?.initialNavigation?tW(i):[],i?.bindToComponentInputs?K3().\u0275providers:[],i?.enableViewTransitions?Q3().\u0275providers:[],nW()]}}static forChild(r){return{ngModule:e,providers:[{provide:Up,multi:!0,useValue:r}]}}};e.\u0275fac=function(i){return new(i||e)(ie(qP,8))},e.\u0275mod=ar({type:e}),e.\u0275inj=or({});let n=e;return n})();function J3(){return{provide:TM,useFactory:()=>{let n=G(DP),e=G($e),t=G(Mu),r=G(mI),i=G(Ru);return t.scrollOffset&&n.setOffset(t.scrollOffset),new $3(i,r,n,e,t)}}}function X3(){return{provide:dr,useClass:Ip}}function Z3(){return{provide:dr,useClass:Iw}}function eW(n){return"guarded"}function tW(n){return[n.initialNavigation==="disabled"?W3().\u0275providers:[],n.initialNavigation==="enabledBlocking"?z3().\u0275providers:[]]}var zP=new ue("");function nW(){return[{provide:zP,useFactory:q3},{provide:pw,multi:!0,useExisting:zP}]}var Or=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=Nt({type:e,selectors:[["app-footer"]],decls:22,vars:0,consts:[[1,"responsive-footer",2,"width","100%","display","flex","flex-direction","row","align-items","start","gap","3rem","justify-content","center","flex-wrap","wrap","background","black","padding-bottom","5rem"],["src","assets\\svg\\solo jj.svg",1,"responsive-image-2",2,"width","15rem"],[2,"display","flex","flex-direction","column","gap","0.2rem","width","15rem"],[2,"margin-bottom","0.2rem"],["routerLink","/home",1,"a1",2,"margin-top","0rem","margin-bottom","0rem"],["routerLink","/menu",1,"a1",2,"margin-top","0rem","margin-bottom","0rem"],["routerLink","/prenota",1,"a1",2,"margin-top","0rem","margin-bottom","0rem"],["routerLink","/contattaci",1,"a1",2,"margin-top","0rem","margin-bottom","0rem"],[2,"display","flex","flex-direction","column","gap","0.2rem","width","15rem","margin-bottom","3rem"],["target","_blank","href","tel:+390402334609",1,"a1",2,"margin-top","0rem","margin-bottom","0rem"],["target","_blank","href","https://www.instagram.com/osteria_jamesjoyce?igsh=MTZseGsxcmpneWd2OQ%3D%3D&utm_source=qr",1,"a1",2,"margin-top","0rem","margin-bottom","0rem"],["target","_blank","href","mailto:lavorocristian9@gmail.com",1,"a1"]],template:function(i,s){i&1&&(k(0,"div",0),K(1,"img",1),k(2,"div",2)(3,"h1",3),F(4,"Indice"),M(),k(5,"a",4),F(6,"Home"),M(),k(7,"a",5),F(8,"Men\xF9"),M(),k(9,"a",6),F(10,"Prenota"),M(),k(11,"a",7),F(12,"Contattaci"),M()(),k(13,"div",8)(14,"h1",3),F(15,"Contatti"),M(),k(16,"a",9),F(17,"+39 040 233 46 09"),M(),k(18,"a",10),F(19,"Instagram"),M(),k(20,"a",11),F(21,"Email"),M()()())},dependencies:[Hp]});let n=e;return n})();var DM=(()=>{let e=class e{ngOnInit(){let r=document.querySelector(".carousel-images"),s=document.querySelectorAll(".carousel-images img").length,o=0,a=document.querySelector(".parallax-div"),c=document.querySelector(".parallax-background"),l=document.querySelector(".responsive-title"),d=document.getElementById("piatto-sopra"),h=document.getElementById("piatto-sotto"),m=document.getElementById("jj-logo-parallax");a.addEventListener("scroll",function(){let L=a.scrollTop/(a.scrollHeight-a.clientHeight),H=L*800;L>5e-4&&(m.style.opacity=+("+"+L)*15+"",m.style.scale=+("+"+L)*15+""),L<5e-4&&(m.style.opacity=+("+"+L)*15+"",m.style.scale=+("-"+L)*15+""),innerWidth<999&&(l.style.transform=`translateY(+${H*5}%)`),d.style.transform=`translateY(-${H}%)`,h.style.transform=`translateY(+${H}%)`});function _(){o=(o+1)%s,C()}function w(){o=(o-1+s)%s,C()}function C(){let A=-o*100;r.style.transform=`translateX(${A}%)`}document.querySelector(".carousel-arrow.right").addEventListener("click",_),document.querySelector(".carousel-arrow.left").addEventListener("click",w),setInterval(_,3e3)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=Nt({type:e,selectors:[["app-home"]],decls:46,vars:0,consts:[[1,"parallax-div",2,"height","100%","width","100%","overflow-y","auto","overflow-x","hidden"],[1,"header",2,"height","105vh"],[1,"parallax-background"],[1,"overlay"],[2,"flex","1"],["id","hands-parallax-container",2,"width","100%","height","100%","display","flex","flex-direction","row","align-items","center","justify-content","center","flex-wrap","wrap","gap","2rem"],[1,"responsive-title",2,"font-size","2.5rem","text-align","start","margin-top","3rem","max-width","35rem"],[2,"display","flex","flex-direction","column","width","100%","max-width","35rem","align-items","center","justify-content","center"],[2,"display","flex","flex-direction","column","position","absolute","z-index","3"],["id","piatto-sopra","src","assets\\imgs\\header\\piatto sopra .png",2,"max-width","50rem","width","100%","object-fit","cover","z-index","1","position","relative"],["id","piatto-sotto","src","assets\\imgs\\header\\piatto sotto .png",2,"max-width","50rem","width","100%","object-fit","cover","z-index","1","position","relative"],["id","jj-logo-parallax","src","assets\\svg\\jj .svg",2,"height","18rem","width","100%","object-fit","cover","z-index","1","position","relative","opacity","0"],["src","assets\\svg\\wave.svg",2,"width","100%","height","11rem","object-fit","cover","object-position","bottom","overflow-y","visible","margin-bottom","-0.2rem","z-index","5"],[2,"height","50rem","display","flex","flex-direction","column","align-items","center","justify-content","center","gap","5rem","background","black","padding-bottom","1rem"],[1,"responsive-text-align-center",2,"margin-bottom","0rem","margin-top","0rem"],[1,"carousel"],[1,"carousel-images"],["src","assets\\imgs\\IMG_3725.jpeg","alt","Image 1"],["src","assets\\imgs\\IMG_3817.jpeg","alt","Image 2"],["src","assets\\imgs\\IMG_3826.jpeg","alt","Image 3"],["src","assets\\imgs\\IMG_3843.jpeg","alt","Image 4"],["src","assets\\imgs\\tempImage3RCXza.jpg","alt","Image 5"],[1,"carousel-arrow","left"],[1,"carousel-arrow","right"],["src","assets\\svg\\wave.svg",2,"width","100%","height","11rem","object-fit","cover","object-position","bottom","overflow-y","visible","margin-top","-0.5rem","rotate","-180deg"],[1,"column-reverse-responsive-div",2,"display","flex","flex-direction","row","align-items","center","justify-content","center","gap","5rem"],["src","assets\\imgs\\tempImageFEw6QP.jpg",2,"width","18rem","border-radius","1rem"],[1,"responsive-margin-left"],[2,"margin-bottom","0rem"],[2,"max-width","20rem","margin-top","0.5rem","margin-right","1rem"],[2,"width","100%","display","flex","flex-direction","row","align-items","center","gap","1rem","flex-wrap","wrap"],["href","tel:+390402334609",1,"button-a"],["href","mailto:lavorocristian9@gmail.com",1,"button-a"],["href","https://www.instagram.com/osteria_jamesjoyce?igsh=MTZseGsxcmpneWd2OQ%3D%3D&utm_source=qr",1,"button-a"],["src","assets\\svg\\wave.svg",2,"width","100%","height","11rem","object-fit","cover","object-position","bottom","overflow-y","visible","margin-bottom","-0.8rem"]],template:function(i,s){i&1&&(k(0,"div",0)(1,"div",1),K(2,"img",2),k(3,"div",3),K(4,"div",4),k(5,"div",5)(6,"h1",6),F(7,'"Nella realt\xE0 le avventure non capitano a chi se ne sta a casa: bisogna venirle a cercare qui da noi"'),M(),k(8,"div",7)(9,"div",8),K(10,"img",9)(11,"img",10),M(),K(12,"img",11),M()(),K(13,"div",4)(14,"img",12),M()(),k(15,"div",13)(16,"h1",14),F(17,"La nostra galleria immagini"),M(),k(18,"div",15)(19,"div",16),K(20,"img",17)(21,"img",18)(22,"img",19)(23,"img",20)(24,"img",21),M(),k(25,"button",22),F(26,"\u25C0"),M(),k(27,"button",23),F(28,"\u25B6"),M()()(),K(29,"img",24),k(30,"div",25),K(31,"img",26),k(32,"div",27)(33,"h1",28),F(34,"Contattaci"),M(),k(35,"p",29),F(36,"Contattaci e seguici sui nostri canali per restare aggiornato"),M(),k(37,"div",30)(38,"a",31),F(39,"+39 040 233 4609"),M(),k(40,"a",32),F(41,"Email"),M(),k(42,"a",33),F(43,"Instagram"),M()()()(),K(44,"img",34)(45,"app-footer"),M())},dependencies:[Or]});let n=e;return n})();var wI={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};var B=function(n,e){if(!n)throw io(e)},io=function(n){return new Error("Firebase Database ("+wI.SDK_VERSION+") INTERNAL ASSERT FAILED: "+n)};var AM=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},rW=function(n){let e=[],t=0,r=0;for(;t<n.length;){let i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){let s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){let s=n[t++],o=n[t++],a=n[t++],c=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{let s=n[t++],o=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},zp={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){let s=n[i],o=i+1<n.length,a=o?n[i+1]:0,c=i+2<n.length,l=c?n[i+2]:0,d=s>>2,h=(s&3)<<4|a>>4,m=(a&15)<<2|l>>6,_=l&63;c||(_=64,o||(m=64)),r.push(t[d],t[h],t[m],t[_])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(AM(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):rW(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){let s=t[n.charAt(i++)],a=i<n.length?t[n.charAt(i)]:0;++i;let l=i<n.length?t[n.charAt(i)]:64;++i;let h=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||a==null||l==null||h==null)throw new II;let m=s<<2|a>>4;if(r.push(m),l!==64){let _=a<<4&240|l>>2;if(r.push(_),h!==64){let w=l<<6&192|h;r.push(w)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},II=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},TI=function(n){let e=AM(n);return zp.encodeByteArray(e,!0)},Lu=function(n){return TI(n).replace(/\./g,"")},Fu=function(n){try{return zp.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function RM(n){return Ha(void 0,n)}function Ha(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:let t=e;return new Date(t.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return e}for(let t in e)!e.hasOwnProperty(t)||!iW(t)||(n[t]=Ha(n[t],e[t]));return n}function iW(n){return n!=="__proto__"}function bI(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var sW=()=>bI().__FIREBASE_DEFAULTS__,oW=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},aW=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&Fu(n[1]);return e&&JSON.parse(e)},CI=()=>{try{return sW()||oW()||aW()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}};var DI=()=>{var n;return(n=CI())===null||n===void 0?void 0:n.config},xM=n=>{var e;return(e=CI())===null||e===void 0?void 0:e[`_${n}`]};var Dt=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}};function qa(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n);return[Lu(JSON.stringify(t)),Lu(JSON.stringify(o)),""].join(".")}function He(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Vu(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(He())}function Wp(){var n;let e=(n=CI())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function NM(){return typeof window<"u"||SI()}function SI(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Gp(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function so(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Kp(){let n=He();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function Lr(){return wI.NODE_CLIENT===!0||wI.NODE_ADMIN===!0}function AI(){return!Wp()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Ji(){try{return typeof indexedDB=="object"}catch{return!1}}function PM(){return new Promise((n,e)=>{try{let t=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}var cW="FirebaseError",st=class n extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=cW,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,qn.prototype.create)}},qn=class{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){let r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?lW(s,r):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new st(i,a,r)}};function lW(n,e){return n.replace(uW,(t,r)=>{let i=e[r];return i!=null?String(i):`<${r}?>`})}var uW=/\{\$([^}]+)}/g;function $a(n){return JSON.parse(n)}function gt(n){return JSON.stringify(n)}var MM=function(n){let e={},t={},r={},i="";try{let s=n.split(".");e=$a(Fu(s[0])||""),t=$a(Fu(s[1])||""),i=s[2],r=t.d||{},delete t.d}catch{}return{header:e,claims:t,data:r,signature:i}};var kM=function(n){let e=MM(n),t=e.claims;return!!t&&typeof t=="object"&&t.hasOwnProperty("iat")},OM=function(n){let e=MM(n).claims;return typeof e=="object"&&e.admin===!0};function sn(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function Xi(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]}function za(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Uu(n,e,t){let r={};for(let i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=e.call(t,n[i],i,n));return r}function Zi(n,e){if(n===e)return!0;let t=Object.keys(n),r=Object.keys(e);for(let i of t){if(!r.includes(i))return!1;let s=n[i],o=e[i];if(SM(s)&&SM(o)){if(!Zi(s,o))return!1}else if(s!==o)return!1}for(let i of r)if(!t.includes(i))return!1;return!0}function SM(n){return n!==null&&typeof n=="object"}function yi(n){let e=[];for(let[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function es(n){let e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){let[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function Wa(n){let e=n.indexOf("?");if(!e)return"";let t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}var qp=class{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);let r=this.W_;if(typeof e=="string")for(let h=0;h<16;h++)r[h]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let h=0;h<16;h++)r[h]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let h=16;h<80;h++){let m=r[h-3]^r[h-8]^r[h-14]^r[h-16];r[h]=(m<<1|m>>>31)&4294967295}let i=this.chain_[0],s=this.chain_[1],o=this.chain_[2],a=this.chain_[3],c=this.chain_[4],l,d;for(let h=0;h<80;h++){h<40?h<20?(l=a^s&(o^a),d=1518500249):(l=s^o^a,d=1859775393):h<60?(l=s&o|a&(s|o),d=2400959708):(l=s^o^a,d=3395469782);let m=(i<<5|i>>>27)+l+c+d+r[h]&4294967295;c=a,a=o,o=(s<<30|s>>>2)&4294967295,s=i,i=m}this.chain_[0]=this.chain_[0]+i&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295}update(e,t){if(e==null)return;t===void 0&&(t=e.length);let r=t-this.blockSize,i=0,s=this.buf_,o=this.inbuf_;for(;i<t;){if(o===0)for(;i<=r;)this.compress_(e,i),i+=this.blockSize;if(typeof e=="string"){for(;i<t;)if(s[o]=e.charCodeAt(i),++o,++i,o===this.blockSize){this.compress_(s),o=0;break}}else for(;i<t;)if(s[o]=e[i],++o,++i,o===this.blockSize){this.compress_(s),o=0;break}}this.inbuf_=o,this.total_+=t}digest(){let e=[],t=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let i=this.blockSize-1;i>=56;i--)this.buf_[i]=t&255,t/=256;this.compress_(this.buf_);let r=0;for(let i=0;i<5;i++)for(let s=24;s>=0;s-=8)e[r]=this.chain_[i]>>s&255,++r;return e}};function Qp(n,e){let t=new EI(n,e);return t.subscribe.bind(t)}var EI=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");dW(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=vI),i.error===void 0&&(i.error=vI),i.complete===void 0&&(i.complete=vI);let s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function dW(n,e){if(typeof n!="object"||n===null)return!1;for(let t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function vI(){}var re=function(n,e,t,r){let i;if(r<e?i="at least "+e:r>t&&(i=t===0?"none":"no more than "+t),i){let s=n+" failed: Was called with "+r+(r===1?" argument.":" arguments.")+" Expects "+i+".";throw new Error(s)}};function Kt(n,e){return`${n} failed: ${e} argument `}function St(n,e,t,r){if(!(r&&!t)&&typeof t!="function")throw new Error(Kt(n,e)+"must be a valid function.")}function RI(n,e,t,r){if(!(r&&!t)&&(typeof t!="object"||t===null))throw new Error(Kt(n,e)+"must be a valid context object.")}var LM=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);if(i>=55296&&i<=56319){let s=i-55296;r++,B(r<n.length,"Surrogate pair missing trail surrogate.");let o=n.charCodeAt(r)-56320;i=65536+(s<<10)+o}i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):i<65536?(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},ju=function(n){let e=0;for(let t=0;t<n.length;t++){let r=n.charCodeAt(t);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,t++):e+=3}return e};var Cie=4*60*60*1e3;function q(n){return n&&n._delegate?n._delegate:n}var Le=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var oo="[DEFAULT]";var ao=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let r=new Dt;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;let r=this.normalizeInstanceIdentifier(e?.identifier),i=(t=e?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(fW(e))try{this.getOrInitializeService({instanceIdentifier:oo})}catch{}for(let[t,r]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(t);try{let s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=oo){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){return g(this,null,function*(){let e=Array.from(this.instances.values());yield Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])})}isComponentSet(){return this.component!=null}isInitialized(e=oo){return this.instances.has(e)}getOptions(e=oo){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(let[s,o]of this.instancesDeferred.entries()){let a=this.normalizeInstanceIdentifier(s);r===a&&o.resolve(i)}return i}onInit(e,t){var r;let i=this.normalizeInstanceIdentifier(t),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);let o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){let r=this.onInitCallbacks.get(t);if(r)for(let i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:hW(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=oo){return this.component?this.component.multipleInstances?e:oo:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function hW(n){return n===oo?void 0:n}function fW(n){return n.instantiationMode==="EAGER"}var ts=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new ao(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var zI={};Pj(zI,{FirebaseError:()=>st,SDK_VERSION:()=>an,_DEFAULT_ENTRY_NAME:()=>Vr,_addComponent:()=>Qa,_addOrOverwriteComponent:()=>$I,_apps:()=>ns,_clearComponents:()=>eG,_components:()=>Ka,_getProvider:()=>Ya,_isFirebaseApp:()=>JM,_isFirebaseServerApp:()=>Ze,_registerComponent:()=>on,_removeServiceInstance:()=>YM,_serverApps:()=>Ga,deleteApp:()=>em,getApp:()=>$u,getApps:()=>rG,initializeApp:()=>Zp,initializeServerApp:()=>nG,onLog:()=>HI,registerVersion:()=>ut,setLogLevel:()=>qI});var xI=[],me=function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n}(me||{}),FM={debug:me.DEBUG,verbose:me.VERBOSE,info:me.INFO,warn:me.WARN,error:me.ERROR,silent:me.SILENT},pW=me.INFO,mW={[me.DEBUG]:"log",[me.VERBOSE]:"log",[me.INFO]:"info",[me.WARN]:"warn",[me.ERROR]:"error"},gW=(n,e,...t)=>{if(e<n.logLevel)return;let r=new Date().toISOString(),i=mW[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},vn=class{constructor(e){this.name=e,this._logLevel=pW,this._logHandler=gW,this._userLogHandler=null,xI.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in me))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?FM[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,me.DEBUG,...e),this._logHandler(this,me.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,me.VERBOSE,...e),this._logHandler(this,me.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,me.INFO,...e),this._logHandler(this,me.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,me.WARN,...e),this._logHandler(this,me.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,me.ERROR,...e),this._logHandler(this,me.ERROR,...e)}};function VM(n){xI.forEach(e=>{e.setLogLevel(n)})}function UM(n,e){for(let t of xI){let r=null;e&&e.level&&(r=FM[e.level]),n===null?t.userLogHandler=null:t.userLogHandler=(i,s,...o)=>{let a=o.map(c=>{if(c==null)return null;if(typeof c=="string")return c;if(typeof c=="number"||typeof c=="boolean")return c.toString();if(c instanceof Error)return c.message;try{return JSON.stringify(c)}catch{return null}}).filter(c=>c).join(" ");s>=(r??i.logLevel)&&n({level:me[s].toLowerCase(),message:a,args:o,type:i.name})}}}var _W=(n,e)=>e.some(t=>n instanceof t),jM,BM;function yW(){return jM||(jM=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function vW(){return BM||(BM=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var $M=new WeakMap,PI=new WeakMap,HM=new WeakMap,NI=new WeakMap,kI=new WeakMap;function wW(n){let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{t(Fr(n.result)),i()},o=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&$M.set(t,n)}).catch(()=>{}),kI.set(e,n),e}function IW(n){if(PI.has(n))return;let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{t(),i()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});PI.set(n,e)}var MI={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return PI.get(n);if(e==="objectStoreNames")return n.objectStoreNames||HM.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Fr(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function qM(n){MI=n(MI)}function EW(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let r=n.call(Yp(this),e,...t);return HM.set(r,e.sort?e.sort():[e]),Fr(r)}:vW().includes(n)?function(...e){return n.apply(Yp(this),e),Fr($M.get(this))}:function(...e){return Fr(n.apply(Yp(this),e))}}function TW(n){return typeof n=="function"?EW(n):(n instanceof IDBTransaction&&IW(n),_W(n,yW())?new Proxy(n,MI):n)}function Fr(n){if(n instanceof IDBRequest)return wW(n);if(NI.has(n))return NI.get(n);let e=TW(n);return e!==n&&(NI.set(n,e),kI.set(e,n)),e}var Yp=n=>kI.get(n);function WM(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){let o=indexedDB.open(n,e),a=Fr(o);return r&&o.addEventListener("upgradeneeded",c=>{r(Fr(o.result),c.oldVersion,c.newVersion,Fr(o.transaction),c)}),t&&o.addEventListener("blocked",c=>t(c.oldVersion,c.newVersion,c)),a.then(c=>{s&&c.addEventListener("close",()=>s()),i&&c.addEventListener("versionchange",l=>i(l.oldVersion,l.newVersion,l))}).catch(()=>{}),a}var bW=["get","getKey","getAll","getAllKeys","count"],CW=["put","add","delete","clear"],OI=new Map;function zM(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(OI.get(e))return OI.get(e);let t=e.replace(/FromIndex$/,""),r=e!==t,i=CW.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||bW.includes(t)))return;let s=function(o,...a){return g(this,null,function*(){let c=this.transaction(o,i?"readwrite":"readonly"),l=c.store;return r&&(l=l.index(a.shift())),(yield Promise.all([l[t](...a),i&&c.done]))[0]})};return OI.set(e,s),s}qM(n=>it(X({},n),{get:(e,t,r)=>zM(e,t)||n.get(e,t,r),has:(e,t)=>!!zM(e,t)||n.has(e,t)}));var FI=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(DW(t)){let r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}};function DW(n){let e=n.getComponent();return e?.type==="VERSION"}var Jp="@firebase/app",VI="0.10.10";var vi=new vn("@firebase/app"),SW="@firebase/app-compat",AW="@firebase/analytics-compat",RW="@firebase/analytics",xW="@firebase/app-check-compat",NW="@firebase/app-check",PW="@firebase/auth",MW="@firebase/auth-compat",kW="@firebase/database",OW="@firebase/database-compat",LW="@firebase/functions",FW="@firebase/functions-compat",VW="@firebase/installations",UW="@firebase/installations-compat",jW="@firebase/messaging",BW="@firebase/messaging-compat",$W="@firebase/performance",HW="@firebase/performance-compat",qW="@firebase/remote-config",zW="@firebase/remote-config-compat",WW="@firebase/storage",GW="@firebase/storage-compat",KW="@firebase/firestore",QW="@firebase/vertexai-preview",YW="@firebase/firestore-compat",JW="firebase",XW="10.13.1";var Vr="[DEFAULT]",ZW={[Jp]:"fire-core",[SW]:"fire-core-compat",[RW]:"fire-analytics",[AW]:"fire-analytics-compat",[NW]:"fire-app-check",[xW]:"fire-app-check-compat",[PW]:"fire-auth",[MW]:"fire-auth-compat",[kW]:"fire-rtdb",[OW]:"fire-rtdb-compat",[LW]:"fire-fn",[FW]:"fire-fn-compat",[VW]:"fire-iid",[UW]:"fire-iid-compat",[jW]:"fire-fcm",[BW]:"fire-fcm-compat",[$W]:"fire-perf",[HW]:"fire-perf-compat",[qW]:"fire-rc",[zW]:"fire-rc-compat",[WW]:"fire-gcs",[GW]:"fire-gcs-compat",[KW]:"fire-fst",[YW]:"fire-fst-compat",[QW]:"fire-vertex","fire-js":"fire-js",[JW]:"fire-js-all"};var ns=new Map,Ga=new Map,Ka=new Map;function Qa(n,e){try{n.container.addComponent(e)}catch(t){vi.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function $I(n,e){n.container.addOrOverwriteComponent(e)}function on(n){let e=n.name;if(Ka.has(e))return vi.debug(`There were multiple attempts to register component ${e}.`),!1;Ka.set(e,n);for(let t of ns.values())Qa(t,n);for(let t of Ga.values())Qa(t,n);return!0}function Ya(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function YM(n,e,t=Vr){Ya(n,e).clearInstance(t)}function JM(n){return n.options!==void 0}function Ze(n){return n.settings!==void 0}function eG(){Ka.clear()}var tG={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},zn=new qn("app","Firebase",tG);var Xp=class{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Le("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw zn.create("app-deleted",{appName:this._name})}};var UI=class extends Xp{constructor(e,t,r,i){let s=t.automaticDataCollectionEnabled!==void 0?t.automaticDataCollectionEnabled:!1,o={name:r,automaticDataCollectionEnabled:s};if(e.apiKey!==void 0)super(e,o,i);else{let a=e;super(a.options,o,i)}this._serverConfig=Object.assign({automaticDataCollectionEnabled:s},t),this._finalizationRegistry=null,typeof FinalizationRegistry<"u"&&(this._finalizationRegistry=new FinalizationRegistry(()=>{this.automaticCleanup()})),this._refCount=0,this.incRefCount(this._serverConfig.releaseOnDeref),this._serverConfig.releaseOnDeref=void 0,t.releaseOnDeref=void 0,ut(Jp,VI,"serverapp")}toJSON(){}get refCount(){return this._refCount}incRefCount(e){this.isDeleted||(this._refCount++,e!==void 0&&this._finalizationRegistry!==null&&this._finalizationRegistry.register(e,this))}decRefCount(){return this.isDeleted?0:--this._refCount}automaticCleanup(){em(this)}get settings(){return this.checkDestroyed(),this._serverConfig}checkDestroyed(){if(this.isDeleted)throw zn.create("server-app-deleted")}};var an=XW;function Zp(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let r=Object.assign({name:Vr,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw zn.create("bad-app-name",{appName:String(i)});if(t||(t=DI()),!t)throw zn.create("no-options");let s=ns.get(i);if(s){if(Zi(t,s.options)&&Zi(r,s.config))return s;throw zn.create("duplicate-app",{appName:i})}let o=new ts(i);for(let c of Ka.values())o.addComponent(c);let a=new Xp(t,r,o);return ns.set(i,a),a}function nG(n,e){if(NM()&&!SI())throw zn.create("invalid-server-app-environment");e.automaticDataCollectionEnabled===void 0&&(e.automaticDataCollectionEnabled=!1);let t;JM(n)?t=n.options:t=n;let r=Object.assign(Object.assign({},e),t);r.releaseOnDeref!==void 0&&delete r.releaseOnDeref;let i=l=>[...l].reduce((d,h)=>Math.imul(31,d)+h.charCodeAt(0)|0,0);if(e.releaseOnDeref!==void 0&&typeof FinalizationRegistry>"u")throw zn.create("finalization-registry-not-supported",{});let s=""+i(JSON.stringify(r)),o=Ga.get(s);if(o)return o.incRefCount(e.releaseOnDeref),o;let a=new ts(s);for(let l of Ka.values())a.addComponent(l);let c=new UI(t,e,s,a);return Ga.set(s,c),c}function $u(n=Vr){let e=ns.get(n);if(!e&&n===Vr&&DI())return Zp();if(!e)throw zn.create("no-app",{appName:n});return e}function rG(){return Array.from(ns.values())}function em(n){return g(this,null,function*(){let e=!1,t=n.name;ns.has(t)?(e=!0,ns.delete(t)):Ga.has(t)&&n.decRefCount()<=0&&(Ga.delete(t),e=!0),e&&(yield Promise.all(n.container.getProviders().map(r=>r.delete())),n.isDeleted=!0)})}function ut(n,e,t){var r;let i=(r=ZW[n])!==null&&r!==void 0?r:n;t&&(i+=`-${t}`);let s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){let a=[`Unable to register library "${i}" with version "${e}":`];s&&a.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),vi.warn(a.join(" "));return}on(new Le(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}function HI(n,e){if(n!==null&&typeof n!="function")throw zn.create("invalid-log-argument");UM(n,e)}function qI(n){VM(n)}var iG="firebase-heartbeat-database",sG=1,Bu="firebase-heartbeat-store",LI=null;function XM(){return LI||(LI=WM(iG,sG,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Bu)}catch(t){console.warn(t)}}}}).catch(n=>{throw zn.create("idb-open",{originalErrorMessage:n.message})})),LI}function oG(n){return g(this,null,function*(){try{let t=(yield XM()).transaction(Bu),r=yield t.objectStore(Bu).get(ZM(n));return yield t.done,r}catch(e){if(e instanceof st)vi.warn(e.message);else{let t=zn.create("idb-get",{originalErrorMessage:e?.message});vi.warn(t.message)}}})}function GM(n,e){return g(this,null,function*(){try{let r=(yield XM()).transaction(Bu,"readwrite");yield r.objectStore(Bu).put(e,ZM(n)),yield r.done}catch(t){if(t instanceof st)vi.warn(t.message);else{let r=zn.create("idb-set",{originalErrorMessage:t?.message});vi.warn(r.message)}}})}function ZM(n){return`${n.name}!${n.options.appId}`}var aG=1024,cG=30*24*60*60*1e3,jI=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new BI(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}triggerHeartbeat(){return g(this,null,function*(){var e,t;try{let i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=KM();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=yield this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{let a=new Date(o.date).valueOf();return Date.now()-a<=cG}),this._storage.overwrite(this._heartbeatsCache))}catch(r){vi.warn(r)}})}getHeartbeatsHeader(){return g(this,null,function*(){var e;try{if(this._heartbeatsCache===null&&(yield this._heartbeatsCachePromise),((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";let t=KM(),{heartbeatsToSend:r,unsentEntries:i}=lG(this._heartbeatsCache.heartbeats),s=Lu(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,yield this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return vi.warn(t),""}})}};function KM(){return new Date().toISOString().substring(0,10)}function lG(n,e=aG){let t=[],r=n.slice();for(let i of n){let s=t.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),QM(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),QM(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}var BI=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return g(this,null,function*(){return Ji()?PM().then(()=>!0).catch(()=>!1):!1})}read(){return g(this,null,function*(){if(yield this._canUseIndexedDBPromise){let t=yield oG(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}})}overwrite(e){return g(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return GM(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return})}add(e){return g(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return GM(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return})}};function QM(n){return Lu(JSON.stringify({version:2,heartbeats:n})).length}function uG(n){on(new Le("platform-logger",e=>new FI(e),"PRIVATE")),on(new Le("heartbeat",e=>new jI(e),"PRIVATE")),ut(Jp,VI,n),ut(Jp,VI,"esm2017"),ut("fire-js","")}uG("");var WI=class{constructor(e,t){this._delegate=e,this.firebase=t,Qa(e,new Le("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),em(this._delegate)))}_getService(e,t=Vr){var r;this._delegate.checkDestroyed();let i=this._delegate.container.getProvider(e);return!i.isInitialized()&&((r=i.getComponent())===null||r===void 0?void 0:r.instantiationMode)==="EXPLICIT"&&i.initialize(),i.getImmediate({identifier:t})}_removeServiceInstance(e,t=Vr){this._delegate.container.getProvider(e).clearInstance(t)}_addComponent(e){Qa(this._delegate,e)}_addOrOverwriteComponent(e){$I(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}};var dG={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."},ek=new qn("app-compat","Firebase",dG);function hG(n){let e={},t={__esModule:!0,initializeApp:s,app:i,registerVersion:ut,setLogLevel:qI,onLog:HI,apps:null,SDK_VERSION:an,INTERNAL:{registerComponent:a,removeApp:r,useAsService:c,modularAPIs:zI}};t.default=t,Object.defineProperty(t,"apps",{get:o});function r(l){delete e[l]}function i(l){if(l=l||Vr,!sn(e,l))throw ek.create("no-app",{appName:l});return e[l]}i.App=n;function s(l,d={}){let h=Zp(l,d);if(sn(e,h.name))return e[h.name];let m=new n(h,t);return e[h.name]=m,m}function o(){return Object.keys(e).map(l=>e[l])}function a(l){let d=l.name,h=d.replace("-compat","");if(on(l)&&l.type==="PUBLIC"){let m=(_=i())=>{if(typeof _[h]!="function")throw ek.create("invalid-app-argument",{appName:d});return _[h]()};l.serviceProps!==void 0&&Ha(m,l.serviceProps),t[h]=m,n.prototype[h]=function(..._){return this._getService.bind(this,d).apply(this,l.multipleInstances?_:[])}}return l.type==="PUBLIC"?t[h]:null}function c(l,d){return d==="serverAuth"?null:d}return t}function nk(){let n=hG(WI);n.INTERNAL=Object.assign(Object.assign({},n.INTERNAL),{createFirebaseNamespace:nk,extendNamespace:e,createSubscribe:Qp,ErrorFactory:qn,deepExtend:Ha});function e(t){Ha(n,t)}return n}var fG=nk();var tk=new vn("@firebase/app-compat"),pG="@firebase/app-compat",mG="0.2.40";function gG(n){ut(pG,mG,n)}try{let n=bI();if(n.firebase!==void 0){tk.warn(`
      Warning: Firebase is already defined in the global scope. Please make sure
      Firebase library is only loaded once.
    `);let e=n.firebase.SDK_VERSION;e&&e.indexOf("LITE")>=0&&tk.warn(`
        Warning: You are trying to load Firebase while using Firebase Performance standalone script.
        You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
        `)}}catch{}var Fe=fG;gG();var _G="firebase",yG="10.13.1";Fe.registerVersion(_G,yG,"app-compat");var po={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"};var as={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};function vG(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registered for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is incorrect, malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements."}}function yk(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var TE=vG,vk=yk,wk=new qn("auth","Firebase",yk());var im=new vn("@firebase/auth");function wG(n,...e){im.logLevel<=me.WARN&&im.warn(`Auth (${an}): ${n}`,...e)}function nm(n,...e){im.logLevel<=me.ERROR&&im.error(`Auth (${an}): ${n}`,...e)}function vt(n,...e){throw CE(n,...e)}function yt(n,...e){return CE(n,...e)}function bE(n,e,t){let r=Object.assign(Object.assign({},vk()),{[e]:t});return new qn("auth","Firebase",r).create(e,{appName:n.name})}function Mt(n){return bE(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Za(n,e,t){let r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&vt(n,"argument-error"),bE(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function CE(n,...e){if(typeof n!="string"){let t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return wk.create(n,...e)}function U(n,e,...t){if(!n)throw CE(e,...t)}function Ur(n){let e="INTERNAL ASSERTION FAILED: "+n;throw nm(e),new Error(e)}function Wn(n,e){n||Ur(e)}function Gu(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function DE(){return rk()==="http:"||rk()==="https:"}function rk(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}function IG(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(DE()||Gp()||"connection"in navigator)?navigator.onLine:!0}function EG(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var co=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,Wn(t>e,"Short delay should be less than long delay!"),this.isMobile=Vu()||so()}get(){return IG()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function SE(n,e){Wn(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var Ku=class{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ur("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ur("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ur("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var TG={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var bG=new co(3e4,6e4);function ot(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}function at(s,o,a,c){return g(this,arguments,function*(n,e,t,r,i={}){return Ik(n,i,()=>g(this,null,function*(){let l={},d={};r&&(e==="GET"?d=r:l={body:JSON.stringify(r)});let h=yi(Object.assign({key:n.config.apiKey},d)).slice(1),m=yield n._getAdditionalHeaders();return m["Content-Type"]="application/json",n.languageCode&&(m["X-Firebase-Locale"]=n.languageCode),Ku.fetch()(Ek(n,n.config.apiHost,t,h),Object.assign({method:e,headers:m,referrerPolicy:"no-referrer"},l))}))})}function Ik(n,e,t){return g(this,null,function*(){n._canInitEmulator=!1;let r=Object.assign(Object.assign({},TG),e);try{let i=new JI(n),s=yield Promise.race([t(),i.promise]);i.clearNetworkTimeout();let o=yield s.json();if("needConfirmation"in o)throw Hu(n,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{let a=s.ok?o.errorMessage:o.error.message,[c,l]=a.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Hu(n,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw Hu(n,"email-already-in-use",o);if(c==="USER_DISABLED")throw Hu(n,"user-disabled",o);let d=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(l)throw bE(n,d,l);vt(n,d)}}catch(i){if(i instanceof st)throw i;vt(n,"network-request-failed",{message:String(i)})}})}function Ei(s,o,a,c){return g(this,arguments,function*(n,e,t,r,i={}){let l=yield at(n,e,t,r,i);return"mfaPendingCredential"in l&&vt(n,"multi-factor-auth-required",{_serverResponse:l}),l})}function Ek(n,e,t,r){let i=`${e}${t}?${r}`;return n.config.emulator?SE(n.config,i):`${n.config.apiScheme}://${i}`}function CG(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}var JI=class{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(yt(this.auth,"network-request-failed")),bG.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}};function Hu(n,e,t){let r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);let i=yt(n,e,r);return i.customData._tokenResponse=t,i}function ik(n){return n!==void 0&&n.getResponse!==void 0}function sk(n){return n!==void 0&&n.enterprise!==void 0}var XI=class{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(let t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return CG(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}};function DG(n){return g(this,null,function*(){return(yield at(n,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""})}function SG(n,e){return g(this,null,function*(){return at(n,"GET","/v2/recaptchaConfig",ot(n,e))})}function AG(n,e){return g(this,null,function*(){return at(n,"POST","/v1/accounts:delete",e)})}function RG(n,e){return g(this,null,function*(){return at(n,"POST","/v1/accounts:update",e)})}function Tk(n,e){return g(this,null,function*(){return at(n,"POST","/v1/accounts:lookup",e)})}function qu(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function bk(n,e=!1){return g(this,null,function*(){let t=q(n),r=yield t.getIdToken(e),i=mm(r);U(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");let s=typeof i.firebase=="object"?i.firebase:void 0,o=s?.sign_in_provider;return{claims:i,token:r,authTime:qu(GI(i.auth_time)),issuedAtTime:qu(GI(i.iat)),expirationTime:qu(GI(i.exp)),signInProvider:o||null,signInSecondFactor:s?.sign_in_second_factor||null}})}function GI(n){return Number(n)*1e3}function mm(n){let[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return nm("JWT malformed, contained fewer than 3 sections"),null;try{let i=Fu(t);return i?JSON.parse(i):(nm("Failed to decode base64 JWT payload"),null)}catch(i){return nm("Caught error parsing JWT payload as JSON",i?.toString()),null}}function ok(n){let e=mm(n);return U(e,"internal-error"),U(typeof e.exp<"u","internal-error"),U(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}function Ii(n,e,t=!1){return g(this,null,function*(){if(t)return e;try{return yield e}catch(r){throw r instanceof st&&xG(r)&&n.auth.currentUser===n&&(yield n.auth.signOut()),r}})}function xG({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var ZI=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){let r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;let i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(()=>g(this,null,function*(){yield this.iteration()}),t)}iteration(){return g(this,null,function*(){try{yield this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()})}};var Qu=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=qu(this.lastLoginAt),this.creationTime=qu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};function Yu(n){return g(this,null,function*(){var e;let t=n.auth,r=yield n.getIdToken(),i=yield Ii(n,Tk(t,{idToken:r}));U(i?.users.length,t,"internal-error");let s=i.users[0];n._notifyReloadListener(s);let o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?Dk(s.providerUserInfo):[],a=NG(n.providerData,o),c=n.isAnonymous,l=!(n.email&&s.passwordHash)&&!a?.length,d=c?l:!1,h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new Qu(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(n,h)})}function Ck(n){return g(this,null,function*(){let e=q(n);yield Yu(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)})}function NG(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function Dk(n){return n.map(e=>{var{providerId:t}=e,r=cf(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}function PG(n,e){return g(this,null,function*(){let t=yield Ik(n,{},()=>g(this,null,function*(){let r=yi({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,o=Ek(n,i,"/v1/token",`key=${s}`),a=yield n._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",Ku.fetch()(o,{method:"POST",headers:a,body:r})}));return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}})}function MG(n,e){return g(this,null,function*(){return at(n,"POST","/v2/accounts:revokeToken",ot(n,e))})}var zu=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){U(e.idToken,"internal-error"),U(typeof e.idToken<"u","internal-error"),U(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):ok(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){U(e.length!==0,"internal-error");let t=ok(e);this.updateTokensAndExpiration(e,null,t)}getToken(e,t=!1){return g(this,null,function*(){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(U(this.refreshToken,e,"user-token-expired"),this.refreshToken?(yield this.refresh(e,this.refreshToken),this.accessToken):null)})}clearRefreshToken(){this.refreshToken=null}refresh(e,t){return g(this,null,function*(){let{accessToken:r,refreshToken:i,expiresIn:s}=yield PG(e,t);this.updateTokensAndExpiration(r,i,Number(s))})}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){let{refreshToken:r,accessToken:i,expirationTime:s}=t,o=new n;return r&&(U(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(U(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(U(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new n,this.toJSON())}_performRefresh(){return Ur("not implemented")}};function rs(n,e){U(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}var lo=class n{constructor(e){var{uid:t,auth:r,stsTokenManager:i}=e,s=cf(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new ZI(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Qu(s.createdAt||void 0,s.lastLoginAt||void 0)}getIdToken(e){return g(this,null,function*(){let t=yield Ii(this,this.stsTokenManager.getToken(this.auth,e));return U(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,yield this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t})}getIdTokenResult(e){return bk(this,e)}reload(){return Ck(this)}_assign(e){this!==e&&(U(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new n(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){U(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,t=!1){return g(this,null,function*(){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&(yield Yu(this)),yield this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)})}delete(){return g(this,null,function*(){if(Ze(this.auth.app))return Promise.reject(Mt(this.auth));let e=yield this.getIdToken();return yield Ii(this,AG(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()})}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,i,s,o,a,c,l,d;let h=(r=t.displayName)!==null&&r!==void 0?r:void 0,m=(i=t.email)!==null&&i!==void 0?i:void 0,_=(s=t.phoneNumber)!==null&&s!==void 0?s:void 0,w=(o=t.photoURL)!==null&&o!==void 0?o:void 0,C=(a=t.tenantId)!==null&&a!==void 0?a:void 0,A=(c=t._redirectEventId)!==null&&c!==void 0?c:void 0,L=(l=t.createdAt)!==null&&l!==void 0?l:void 0,H=(d=t.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:j,emailVerified:Q,isAnonymous:se,providerData:J,stsTokenManager:T}=t;U(j&&T,e,"internal-error");let v=zu.fromJSON(this.name,T);U(typeof j=="string",e,"internal-error"),rs(h,e.name),rs(m,e.name),U(typeof Q=="boolean",e,"internal-error"),U(typeof se=="boolean",e,"internal-error"),rs(_,e.name),rs(w,e.name),rs(C,e.name),rs(A,e.name),rs(L,e.name),rs(H,e.name);let I=new n({uid:j,auth:e,email:m,emailVerified:Q,displayName:h,isAnonymous:se,photoURL:w,phoneNumber:_,tenantId:C,stsTokenManager:v,createdAt:L,lastLoginAt:H});return J&&Array.isArray(J)&&(I.providerData=J.map(b=>Object.assign({},b))),A&&(I._redirectEventId=A),I}static _fromIdTokenResponse(e,t,r=!1){return g(this,null,function*(){let i=new zu;i.updateFromServerResponse(t);let s=new n({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return yield Yu(s),s})}static _fromGetAccountInfoResponse(e,t,r){return g(this,null,function*(){let i=t.users[0];U(i.localId!==void 0,"internal-error");let s=i.providerUserInfo!==void 0?Dk(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!s?.length,a=new zu;a.updateFromIdToken(r);let c=new n({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:o}),l={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Qu(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!s?.length};return Object.assign(c,l),c})}};var ak=new Map;function Qt(n){Wn(n instanceof Function,"Expected a class definition");let e=ak.get(n);return e?(Wn(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,ak.set(n,e),e)}var kG=(()=>{class n{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return g(this,null,function*(){return!0})}_set(t,r){return g(this,null,function*(){this.storage[t]=r})}_get(t){return g(this,null,function*(){let r=this.storage[t];return r===void 0?null:r})}_remove(t){return g(this,null,function*(){delete this.storage[t]})}_addListener(t,r){}_removeListener(t,r){}}return n.type="NONE",n})(),ss=kG;function jr(n,e,t){return`firebase:${n}:${e}:${t}`}var sm=class n{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;let{config:i,name:s}=this.auth;this.fullUserKey=jr(this.userKey,i.apiKey,s),this.fullPersistenceKey=jr("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){return g(this,null,function*(){let e=yield this.persistence._get(this.fullUserKey);return e?lo._fromJSON(this.auth,e):null})}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){return g(this,null,function*(){if(this.persistence===e)return;let t=yield this.getCurrentUser();if(yield this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)})}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,t,r="authUser"){return g(this,null,function*(){if(!t.length)return new n(Qt(ss),e,r);let i=(yield Promise.all(t.map(l=>g(this,null,function*(){if(yield l._isAvailable())return l})))).filter(l=>l),s=i[0]||Qt(ss),o=jr(r,e.config.apiKey,e.name),a=null;for(let l of t)try{let d=yield l._get(o);if(d){let h=lo._fromJSON(e,d);l!==s&&(a=h),s=l;break}}catch{}let c=i.filter(l=>l._shouldAllowMigration);return!s._shouldAllowMigration||!c.length?new n(s,e,r):(s=c[0],a&&(yield s._set(o,a.toJSON())),yield Promise.all(t.map(l=>g(this,null,function*(){if(l!==s)try{yield l._remove(o)}catch{}}))),new n(s,e,r))})}};function ck(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(xk(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Sk(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Nk(e))return"Blackberry";if(Pk(e))return"Webos";if(Ak(e))return"Safari";if((e.includes("chrome/")||Rk(e))&&!e.includes("edge/"))return"Chrome";if(ec(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function Sk(n=He()){return/firefox\//i.test(n)}function Ak(n=He()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Rk(n=He()){return/crios\//i.test(n)}function xk(n=He()){return/iemobile/i.test(n)}function ec(n=He()){return/android/i.test(n)}function Nk(n=He()){return/blackberry/i.test(n)}function Pk(n=He()){return/webos/i.test(n)}function tc(n=He()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function Mk(n=He()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(n)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(n)}function OG(n=He()){var e;return tc(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function LG(){return Kp()&&document.documentMode===10}function kk(n=He()){return tc(n)||ec(n)||Pk(n)||Nk(n)||/windows phone/i.test(n)||xk(n)}function AE(n,e=[]){let t;switch(n){case"Browser":t=ck(He());break;case"Worker":t=`${ck(He())}-${n}`;break;default:t=n}let r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${an}/${r}`}var eE=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let r=s=>new Promise((o,a)=>{try{let c=e(s);o(c)}catch(c){a(c)}});r.onAbort=t,this.queue.push(r);let i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}runMiddleware(e){return g(this,null,function*(){if(this.auth.currentUser===e)return;let t=[];try{for(let r of this.queue)yield r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(let i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}})}};function FG(t){return g(this,arguments,function*(n,e={}){return at(n,"GET","/v2/passwordPolicy",ot(n,e))})}var VG=6,tE=class{constructor(e){var t,r,i,s;let o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=o.minPasswordLength)!==null&&t!==void 0?t:VG,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,i,s,o,a;let c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(t=c.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),c.isValid&&(c.isValid=(r=c.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(i=c.containsLowercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(s=c.containsUppercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(o=c.containsNumericCharacter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(a=c.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),c}validatePasswordLengthOptions(e,t){let r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}};var om=class{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new am(this),this.idTokenSubscription=new am(this),this.beforeStateQueue=new eE(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=wk,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Qt(t)),this._initializationPromise=this.queue(()=>g(this,null,function*(){var r,i;if(!this._deleted&&(this.persistenceManager=yield sm.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{yield this._popupRedirectResolver._initialize(this)}catch{}yield this.initializeCurrentUser(t),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){return g(this,null,function*(){if(this._deleted)return;let e=yield this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),yield this.currentUser.getIdToken();return}yield this._updateCurrentUser(e,!0)}})}initializeCurrentUserFromIdToken(e){return g(this,null,function*(){try{let t=yield Tk(this,{idToken:e}),r=yield lo._fromGetAccountInfoResponse(this,t,e);yield this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),yield this.directlySetCurrentUser(null)}})}initializeCurrentUser(e){return g(this,null,function*(){var t;if(Ze(this.app)){let o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}let r=yield this.assertedPersistence.getCurrentUser(),i=r,s=!1;if(e&&this.config.authDomain){yield this.getOrInitRedirectPersistenceManager();let o=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,a=i?._redirectEventId,c=yield this.tryRedirectSignIn(e);(!o||o===a)&&c?.user&&(i=c.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{yield this.beforeStateQueue.runMiddleware(i)}catch(o){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return U(this._popupRedirectResolver,this,"argument-error"),yield this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)})}tryRedirectSignIn(e){return g(this,null,function*(){let t=null;try{t=yield this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{yield this._setRedirectUser(null)}return t})}reloadAndSetCurrentUserOrClear(e){return g(this,null,function*(){try{yield Yu(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)})}useDeviceLanguage(){this.languageCode=EG()}_delete(){return g(this,null,function*(){this._deleted=!0})}updateCurrentUser(e){return g(this,null,function*(){if(Ze(this.app))return Promise.reject(Mt(this));let t=e?q(e):null;return t&&U(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))})}_updateCurrentUser(e,t=!1){return g(this,null,function*(){if(!this._deleted)return e&&U(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||(yield this.beforeStateQueue.runMiddleware(e)),this.queue(()=>g(this,null,function*(){yield this.directlySetCurrentUser(e),this.notifyAuthListeners()}))})}signOut(){return g(this,null,function*(){return Ze(this.app)?Promise.reject(Mt(this)):(yield this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&(yield this._setRedirectUser(null)),this._updateCurrentUser(null,!0))})}setPersistence(e){return Ze(this.app)?Promise.reject(Mt(this)):this.queue(()=>g(this,null,function*(){yield this.assertedPersistence.setPersistence(Qt(e))}))}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(e){return g(this,null,function*(){this._getPasswordPolicyInternal()||(yield this._updatePasswordPolicy());let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)})}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){return g(this,null,function*(){let e=yield FG(this),t=new tE(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t})}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new qn("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let r=this.onAuthStateChanged(()=>{r(),e()},t)}})}revokeAccessToken(e){return g(this,null,function*(){if(this.currentUser){let t=yield this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),yield MG(this,r)}})}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}_setRedirectUser(e,t){return g(this,null,function*(){let r=yield this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)})}getOrInitRedirectPersistenceManager(e){return g(this,null,function*(){if(!this.redirectPersistenceManager){let t=e&&Qt(e)||this._popupRedirectResolver;U(t,this,"argument-error"),this.redirectPersistenceManager=yield sm.create(this,[Qt(t._redirectPersistence)],"redirectUser"),this.redirectUser=yield this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager})}_redirectUserForId(e){return g(this,null,function*(){var t,r;return this._isInitialized&&(yield this.queue(()=>g(this,null,function*(){}))),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null})}_persistUserIfCurrent(e){return g(this,null,function*(){if(e===this.currentUser)return this.queue(()=>g(this,null,function*(){return this.directlySetCurrentUser(e)}))})}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};let s=typeof t=="function"?t:t.next.bind(t),o=!1,a=this._isInitialized?Promise.resolve():this._initializationPromise;if(U(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof t=="function"){let c=e.addObserver(t,r,i);return()=>{o=!0,c()}}else{let c=e.addObserver(t);return()=>{o=!0,c()}}}directlySetCurrentUser(e){return g(this,null,function*(){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?yield this.assertedPersistence.setCurrentUser(e):yield this.assertedPersistence.removeCurrentUser()})}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return U(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=AE(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){return g(this,null,function*(){var e;let t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);let r=yield(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader();r&&(t["X-Firebase-Client"]=r);let i=yield this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t})}_getAppCheckToken(){return g(this,null,function*(){var e;let t=yield(e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken();return t?.error&&wG(`Error while retrieving App Check token: ${t.error}`),t?.token})}};function Ge(n){return q(n)}var am=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=Qp(t=>this.observer=t)}get next(){return U(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var od={loadJS(){return g(this,null,function*(){throw new Error("Unable to load external scripts")})},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function UG(n){od=n}function RE(n){return od.loadJS(n)}function jG(){return od.recaptchaV2Script}function BG(){return od.recaptchaEnterpriseScript}function $G(){return od.gapiScript}function Ok(n){return`__${n}${Math.floor(Math.random()*1e6)}`}var HG="recaptcha-enterprise",qG="NO_RECAPTCHA",nE=class{constructor(e){this.type=HG,this.auth=Ge(e)}verify(e="verify",t=!1){return g(this,null,function*(){function r(s){return g(this,null,function*(){if(!t){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise((o,a)=>g(this,null,function*(){SG(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{let l=new XI(c);return s.tenantId==null?s._agentRecaptchaConfig=l:s._tenantRecaptchaConfigs[s.tenantId]=l,o(l.siteKey)}}).catch(c=>{a(c)})}))})}function i(s,o,a){let c=window.grecaptcha;sk(c)?c.enterprise.ready(()=>{c.enterprise.execute(s,{action:e}).then(l=>{o(l)}).catch(()=>{o(qG)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((s,o)=>{r(this.auth).then(a=>{if(!t&&sk(window.grecaptcha))i(a,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let c=BG();c.length!==0&&(c+=a),RE(c).then(()=>{i(a,s,o)}).catch(l=>{o(l)})}}).catch(a=>{o(a)})})})}};function lk(n,e,t,r=!1){return g(this,null,function*(){let i=new nE(n),s;try{s=yield i.verify(t)}catch{s=yield i.verify(t,!0)}let o=Object.assign({},e);return r?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o})}function Ju(n,e,t,r){return g(this,null,function*(){var i;if(!((i=n._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){let s=yield lk(n,e,t,t==="getOobCode");return r(n,s)}else return r(n,e).catch(s=>g(this,null,function*(){if(s.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);let o=yield lk(n,e,t,t==="getOobCode");return r(n,o)}else return Promise.reject(s)}))})}function zG(n,e){let t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(Qt);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function xE(n,e,t){let r=Ge(n);U(r._canInitEmulator,r,"emulator-config-failed"),U(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");let i=!!t?.disableWarnings,s=Lk(e),{host:o,port:a}=WG(e),c=a===null?"":`:${a}`;r.config.emulator={url:`${s}//${o}${c}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||GG()}function Lk(n){let e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function WG(n){let e=Lk(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};let r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){let s=i[1];return{host:s,port:uk(r.substr(s.length+1))}}else{let[s,o]=r.split(":");return{host:s,port:uk(o)}}}function uk(n){if(!n)return null;let e=Number(n);return isNaN(e)?null:e}function GG(){function n(){let e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}var Br=class{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Ur("not implemented")}_getIdTokenResponse(e){return Ur("not implemented")}_linkToIdToken(e,t){return Ur("not implemented")}_getReauthenticationResolver(e){return Ur("not implemented")}};function Fk(n,e){return g(this,null,function*(){return at(n,"POST","/v1/accounts:resetPassword",ot(n,e))})}function KG(n,e){return g(this,null,function*(){return at(n,"POST","/v1/accounts:update",e)})}function QG(n,e){return g(this,null,function*(){return at(n,"POST","/v1/accounts:signUp",e)})}function YG(n,e){return g(this,null,function*(){return at(n,"POST","/v1/accounts:update",ot(n,e))})}function JG(n,e){return g(this,null,function*(){return Ei(n,"POST","/v1/accounts:signInWithPassword",ot(n,e))})}function gm(n,e){return g(this,null,function*(){return at(n,"POST","/v1/accounts:sendOobCode",ot(n,e))})}function XG(n,e){return g(this,null,function*(){return gm(n,e)})}function ZG(n,e){return g(this,null,function*(){return gm(n,e)})}function e6(n,e){return g(this,null,function*(){return gm(n,e)})}function t6(n,e){return g(this,null,function*(){return gm(n,e)})}function n6(n,e){return g(this,null,function*(){return Ei(n,"POST","/v1/accounts:signInWithEmailLink",ot(n,e))})}function r6(n,e){return g(this,null,function*(){return Ei(n,"POST","/v1/accounts:signInWithEmailLink",ot(n,e))})}var Xu=class n extends Br{constructor(e,t,r,i=null){super("password",r),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new n(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new n(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}_getIdTokenResponse(e){return g(this,null,function*(){switch(this.signInMethod){case"password":let t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ju(e,t,"signInWithPassword",JG);case"emailLink":return n6(e,{email:this._email,oobCode:this._password});default:vt(e,"internal-error")}})}_linkToIdToken(e,t){return g(this,null,function*(){switch(this.signInMethod){case"password":let r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ju(e,r,"signUpPassword",QG);case"emailLink":return r6(e,{idToken:t,email:this._email,oobCode:this._password});default:vt(e,"internal-error")}})}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}};function wi(n,e){return g(this,null,function*(){return Ei(n,"POST","/v1/accounts:signInWithIdp",ot(n,e))})}var i6="http://localhost",hr=class n extends Br{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){let t=new n(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):vt("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=t,s=cf(t,["providerId","signInMethod"]);if(!r||!i)return null;let o=new n(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){let t=this.buildRequest();return wi(e,t)}_linkToIdToken(e,t){let r=this.buildRequest();return r.idToken=t,wi(e,r)}_getReauthenticationResolver(e){let t=this.buildRequest();return t.autoCreate=!1,wi(e,t)}buildRequest(){let e={requestUri:i6,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{let t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=yi(t)}return e}};function s6(n,e){return g(this,null,function*(){return at(n,"POST","/v1/accounts:sendVerificationCode",ot(n,e))})}function o6(n,e){return g(this,null,function*(){return Ei(n,"POST","/v1/accounts:signInWithPhoneNumber",ot(n,e))})}function a6(n,e){return g(this,null,function*(){let t=yield Ei(n,"POST","/v1/accounts:signInWithPhoneNumber",ot(n,e));if(t.temporaryProof)throw Hu(n,"account-exists-with-different-credential",t);return t})}var c6={USER_NOT_FOUND:"user-not-found"};function l6(n,e){return g(this,null,function*(){let t=Object.assign(Object.assign({},e),{operation:"REAUTH"});return Ei(n,"POST","/v1/accounts:signInWithPhoneNumber",ot(n,t),c6)})}var Ja=class n extends Br{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new n({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new n({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return o6(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return a6(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return l6(e,this._makeVerificationRequest())}_makeVerificationRequest(){let{temporaryProof:e,phoneNumber:t,verificationId:r,verificationCode:i}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:r,code:i}}toJSON(){let e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));let{verificationId:t,verificationCode:r,phoneNumber:i,temporaryProof:s}=e;return!r&&!t&&!i&&!s?null:new n({verificationId:t,verificationCode:r,phoneNumber:i,temporaryProof:s})}};function u6(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function d6(n){let e=es(Wa(n)).link,t=e?es(Wa(e)).deep_link_id:null,r=es(Wa(n)).deep_link_id;return(r?es(Wa(r)).link:null)||r||t||e||n}var Zu=class n{constructor(e){var t,r,i,s,o,a;let c=es(Wa(e)),l=(t=c.apiKey)!==null&&t!==void 0?t:null,d=(r=c.oobCode)!==null&&r!==void 0?r:null,h=u6((i=c.mode)!==null&&i!==void 0?i:null);U(l&&d&&h,"argument-error"),this.apiKey=l,this.operation=h,this.code=d,this.continueUrl=(s=c.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(o=c.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(a=c.tenantId)!==null&&a!==void 0?a:null}static parseLink(e){let t=d6(e);try{return new n(t)}catch{return null}}};var ad=(()=>{class n{constructor(){this.providerId=n.PROVIDER_ID}static credential(t,r){return Xu._fromEmailAndPassword(t,r)}static credentialWithLink(t,r){let i=Zu.parseLink(r);return U(i,"argument-error"),Xu._fromEmailAndCode(t,i.code,i.tenantId)}}n.PROVIDER_ID="password",n.EMAIL_PASSWORD_SIGN_IN_METHOD="password",n.EMAIL_LINK_SIGN_IN_METHOD="emailLink";return n})(),fr=class{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}};var os=class extends fr{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}},Xa=class n extends os{static credentialFromJSON(e){let t=typeof e=="string"?JSON.parse(e):e;return U("providerId"in t&&"signInMethod"in t,"argument-error"),hr._fromParams(t)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return U(e.idToken||e.accessToken,"argument-error"),hr._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return n.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return n.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{oauthIdToken:t,oauthAccessToken:r,oauthTokenSecret:i,pendingToken:s,nonce:o,providerId:a}=e;if(!r&&!i&&!t&&!s||!a)return null;try{return new n(a)._credential({idToken:t,accessToken:r,nonce:o,pendingToken:s})}catch{return null}}};var _m=(()=>{class n extends os{constructor(){super("facebook.com")}static credential(t){return hr._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.FACEBOOK_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return n.credentialFromTaggedObject(t)}static credentialFromError(t){return n.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return n.credential(t.oauthAccessToken)}catch{return null}}}n.FACEBOOK_SIGN_IN_METHOD="facebook.com",n.PROVIDER_ID="facebook.com";return n})(),ym=(()=>{class n extends os{constructor(){super("google.com"),this.addScope("profile")}static credential(t,r){return hr._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:r})}static credentialFromResult(t){return n.credentialFromTaggedObject(t)}static credentialFromError(t){return n.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;let{oauthIdToken:r,oauthAccessToken:i}=t;if(!r&&!i)return null;try{return n.credential(r,i)}catch{return null}}}n.GOOGLE_SIGN_IN_METHOD="google.com",n.PROVIDER_ID="google.com";return n})(),vm=(()=>{class n extends os{constructor(){super("github.com")}static credential(t){return hr._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GITHUB_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return n.credentialFromTaggedObject(t)}static credentialFromError(t){return n.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return n.credential(t.oauthAccessToken)}catch{return null}}}n.GITHUB_SIGN_IN_METHOD="github.com",n.PROVIDER_ID="github.com";return n})(),h6="http://localhost",uo=class n extends Br{constructor(e,t){super(e,e),this.pendingToken=t}_getIdTokenResponse(e){let t=this.buildRequest();return wi(e,t)}_linkToIdToken(e,t){let r=this.buildRequest();return r.idToken=t,wi(e,r)}_getReauthenticationResolver(e){let t=this.buildRequest();return t.autoCreate=!1,wi(e,t)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,pendingToken:s}=t;return!r||!i||!s||r!==i?null:new n(r,s)}static _create(e,t){return new n(e,t)}buildRequest(){return{requestUri:h6,returnSecureToken:!0,pendingToken:this.pendingToken}}};var f6="saml.",ed=class n extends fr{constructor(e){U(e.startsWith(f6),"argument-error"),super(e)}static credentialFromResult(e){return n.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return n.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){let t=uo.fromJSON(e);return U(t,"argument-error"),t}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{pendingToken:t,providerId:r}=e;if(!t||!r)return null;try{return uo._create(r,t)}catch{return null}}};var wm=(()=>{class n extends os{constructor(){super("twitter.com")}static credential(t,r){return hr._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.TWITTER_SIGN_IN_METHOD,oauthToken:t,oauthTokenSecret:r})}static credentialFromResult(t){return n.credentialFromTaggedObject(t)}static credentialFromError(t){return n.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;let{oauthAccessToken:r,oauthTokenSecret:i}=t;if(!r||!i)return null;try{return n.credential(r,i)}catch{return null}}}n.TWITTER_SIGN_IN_METHOD="twitter.com",n.PROVIDER_ID="twitter.com";return n})();function Vk(n,e){return g(this,null,function*(){return Ei(n,"POST","/v1/accounts:signUp",ot(n,e))})}var pr=class n{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static _fromIdTokenResponse(e,t,r,i=!1){return g(this,null,function*(){let s=yield lo._fromIdTokenResponse(e,r,i),o=dk(r);return new n({user:s,providerId:o,_tokenResponse:r,operationType:t})})}static _forOperation(e,t,r){return g(this,null,function*(){yield e._updateTokensIfNecessary(r,!0);let i=dk(r);return new n({user:e,providerId:i,_tokenResponse:r,operationType:t})})}};function dk(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}function NE(n){return g(this,null,function*(){var e;if(Ze(n.app))return Promise.reject(Mt(n));let t=Ge(n);if(yield t._initializationPromise,!((e=t.currentUser)===null||e===void 0)&&e.isAnonymous)return new pr({user:t.currentUser,providerId:null,operationType:"signIn"});let r=yield Vk(t,{returnSecureToken:!0}),i=yield pr._fromIdTokenResponse(t,"signIn",r,!0);return yield t._updateCurrentUser(i.user),i})}var rE=class n extends st{constructor(e,t,r,i){var s;super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,n.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new n(e,t,r,i)}};function Uk(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?rE._fromErrorAndOperation(n,s,e,r):s})}function jk(n){return new Set(n.map(({providerId:e})=>e).filter(e=>!!e))}function PE(n,e){return g(this,null,function*(){let t=q(n);yield Im(!0,t,e);let{providerUserInfo:r}=yield RG(t.auth,{idToken:yield t.getIdToken(),deleteProvider:[e]}),i=jk(r||[]);return t.providerData=t.providerData.filter(s=>i.has(s.providerId)),i.has("phone")||(t.phoneNumber=null),yield t.auth._persistUserIfCurrent(t),t})}function ME(n,e,t=!1){return g(this,null,function*(){let r=yield Ii(n,e._linkToIdToken(n.auth,yield n.getIdToken()),t);return pr._forOperation(n,"link",r)})}function Im(n,e,t){return g(this,null,function*(){yield Yu(e);let r=jk(e.providerData),i=n===!1?"provider-already-linked":"no-such-provider";U(r.has(t)===n,e.auth,i)})}function Bk(n,e,t=!1){return g(this,null,function*(){let{auth:r}=n;if(Ze(r.app))return Promise.reject(Mt(r));let i="reauthenticate";try{let s=yield Ii(n,Uk(r,i,e,n),t);U(s.idToken,r,"internal-error");let o=mm(s.idToken);U(o,r,"internal-error");let{sub:a}=o;return U(n.uid===a,r,"user-mismatch"),pr._forOperation(n,i,s)}catch(s){throw s?.code==="auth/user-not-found"&&vt(r,"user-mismatch"),s}})}function $k(n,e,t=!1){return g(this,null,function*(){if(Ze(n.app))return Promise.reject(Mt(n));let r="signIn",i=yield Uk(n,r,e),s=yield pr._fromIdTokenResponse(n,r,i);return t||(yield n._updateCurrentUser(s.user)),s})}function nc(n,e){return g(this,null,function*(){return $k(Ge(n),e)})}function Em(n,e){return g(this,null,function*(){let t=q(n);return yield Im(!1,t,e.providerId),ME(t,e)})}function Tm(n,e){return g(this,null,function*(){return Bk(q(n),e)})}function p6(n,e){return g(this,null,function*(){return Ei(n,"POST","/v1/accounts:signInWithCustomToken",ot(n,e))})}function kE(n,e){return g(this,null,function*(){if(Ze(n.app))return Promise.reject(Mt(n));let t=Ge(n),r=yield p6(t,{token:e,returnSecureToken:!0}),i=yield pr._fromIdTokenResponse(t,"signIn",r);return yield t._updateCurrentUser(i.user),i})}var ho=class{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?iE._fromServerResponse(e,t):"totpInfo"in t?sE._fromServerResponse(e,t):vt(e,"internal-error")}},iE=class n extends ho{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new n(t)}},sE=class n extends ho{constructor(e){super("totp",e)}static _fromServerResponse(e,t){return new n(t)}};function bm(n,e,t){var r;U(((r=t.url)===null||r===void 0?void 0:r.length)>0,n,"invalid-continue-uri"),U(typeof t.dynamicLinkDomain>"u"||t.dynamicLinkDomain.length>0,n,"invalid-dynamic-link-domain"),e.continueUrl=t.url,e.dynamicLinkDomain=t.dynamicLinkDomain,e.canHandleCodeInApp=t.handleCodeInApp,t.iOS&&(U(t.iOS.bundleId.length>0,n,"missing-ios-bundle-id"),e.iOSBundleId=t.iOS.bundleId),t.android&&(U(t.android.packageName.length>0,n,"missing-android-pkg-name"),e.androidInstallApp=t.android.installApp,e.androidMinimumVersionCode=t.android.minimumVersion,e.androidPackageName=t.android.packageName)}function OE(n){return g(this,null,function*(){let e=Ge(n);e._getPasswordPolicyInternal()&&(yield e._updatePasswordPolicy())})}function LE(n,e,t){return g(this,null,function*(){let r=Ge(n),i={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};t&&bm(r,i,t),yield Ju(r,i,"getOobCode",ZG)})}function FE(n,e,t){return g(this,null,function*(){yield Fk(q(n),{oobCode:e,newPassword:t}).catch(r=>g(this,null,function*(){throw r.code==="auth/password-does-not-meet-requirements"&&OE(n),r}))})}function VE(n,e){return g(this,null,function*(){yield YG(q(n),{oobCode:e})})}function Cm(n,e){return g(this,null,function*(){let t=q(n),r=yield Fk(t,{oobCode:e}),i=r.requestType;switch(U(i,t,"internal-error"),i){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":U(r.newEmail,t,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":U(r.mfaInfo,t,"internal-error");default:U(r.email,t,"internal-error")}let s=null;return r.mfaInfo&&(s=ho._fromServerResponse(Ge(t),r.mfaInfo)),{data:{email:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.newEmail:r.email)||null,previousEmail:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.email:r.newEmail)||null,multiFactorInfo:s},operation:i}})}function UE(n,e){return g(this,null,function*(){let{data:t}=yield Cm(q(n),e);return t.email})}function jE(n,e,t){return g(this,null,function*(){if(Ze(n.app))return Promise.reject(Mt(n));let r=Ge(n),o=yield Ju(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Vk).catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&OE(n),c}),a=yield pr._fromIdTokenResponse(r,"signIn",o);return yield r._updateCurrentUser(a.user),a})}function BE(n,e,t){return Ze(n.app)?Promise.reject(Mt(n)):nc(q(n),ad.credential(e,t)).catch(r=>g(this,null,function*(){throw r.code==="auth/password-does-not-meet-requirements"&&OE(n),r}))}function $E(n,e,t){return g(this,null,function*(){let r=Ge(n),i={requestType:"EMAIL_SIGNIN",email:e,clientType:"CLIENT_TYPE_WEB"};function s(o,a){U(a.handleCodeInApp,r,"argument-error"),a&&bm(r,o,a)}s(i,t),yield Ju(r,i,"getOobCode",e6)})}function HE(n,e){let t=Zu.parseLink(e);return t?.operation==="EMAIL_SIGNIN"}function qE(n,e,t){return g(this,null,function*(){if(Ze(n.app))return Promise.reject(Mt(n));let r=q(n),i=ad.credentialWithLink(e,t||Gu());return U(i._tenantId===(r.tenantId||null),r,"tenant-id-mismatch"),nc(r,i)})}function m6(n,e){return g(this,null,function*(){return at(n,"POST","/v1/accounts:createAuthUri",ot(n,e))})}function zE(n,e){return g(this,null,function*(){let t=DE()?Gu():"http://localhost",r={identifier:e,continueUri:t},{signinMethods:i}=yield m6(q(n),r);return i||[]})}function WE(n,e){return g(this,null,function*(){let t=q(n),i={requestType:"VERIFY_EMAIL",idToken:yield n.getIdToken()};e&&bm(t.auth,i,e);let{email:s}=yield XG(t.auth,i);s!==n.email&&(yield n.reload())})}function GE(n,e,t){return g(this,null,function*(){let r=q(n),s={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:yield n.getIdToken(),newEmail:e};t&&bm(r.auth,s,t);let{email:o}=yield t6(r.auth,s);o!==n.email&&(yield n.reload())})}function g6(n,e){return g(this,null,function*(){return at(n,"POST","/v1/accounts:update",e)})}function KE(r,i){return g(this,arguments,function*(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;let s=q(n),a={idToken:yield s.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},c=yield Ii(s,g6(s.auth,a));s.displayName=c.displayName||null,s.photoURL=c.photoUrl||null;let l=s.providerData.find(({providerId:d})=>d==="password");l&&(l.displayName=s.displayName,l.photoURL=s.photoURL),yield s._updateTokensIfNecessary(c)})}function QE(n,e){let t=q(n);return Ze(t.auth.app)?Promise.reject(Mt(t.auth)):Hk(t,e,null)}function YE(n,e){return Hk(q(n),null,e)}function Hk(n,e,t){return g(this,null,function*(){let{auth:r}=n,s={idToken:yield n.getIdToken(),returnSecureToken:!0};e&&(s.email=e),t&&(s.password=t);let o=yield Ii(n,KG(r,s));yield n._updateTokensIfNecessary(o,!0)})}function _6(n){var e,t;if(!n)return null;let{providerId:r}=n,i=n.rawUserInfo?JSON.parse(n.rawUserInfo):{},s=n.isNewUser||n.kind==="identitytoolkit#SignupNewUserResponse";if(!r&&n?.idToken){let o=(t=(e=mm(n.idToken))===null||e===void 0?void 0:e.firebase)===null||t===void 0?void 0:t.sign_in_provider;if(o){let a=o!=="anonymous"&&o!=="custom"?o:null;return new is(s,a)}}if(!r)return null;switch(r){case"facebook.com":return new oE(s,i);case"github.com":return new aE(s,i);case"google.com":return new cE(s,i);case"twitter.com":return new lE(s,i,n.screenName||null);case"custom":case"anonymous":return new is(s,null);default:return new is(s,r,i)}}var is=class{constructor(e,t,r={}){this.isNewUser=e,this.providerId=t,this.profile=r}},cm=class extends is{constructor(e,t,r,i){super(e,t,r),this.username=i}},oE=class extends is{constructor(e,t){super(e,"facebook.com",t)}},aE=class extends cm{constructor(e,t){super(e,"github.com",t,typeof t?.login=="string"?t?.login:null)}},cE=class extends is{constructor(e,t){super(e,"google.com",t)}},lE=class extends cm{constructor(e,t,r){super(e,"twitter.com",t,r)}};function JE(n){let{user:e,_tokenResponse:t}=n;return e.isAnonymous&&!t?{providerId:null,isNewUser:!1,profile:null}:_6(t)}var lm=class n{constructor(e,t,r){this.type=e,this.credential=t,this.user=r}static _fromIdtoken(e,t){return new n("enroll",e,t)}static _fromMfaPendingCredential(e){return new n("signin",e)}toJSON(){return{multiFactorSession:{[this.type==="enroll"?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var t,r;if(e?.multiFactorSession){if(!((t=e.multiFactorSession)===null||t===void 0)&&t.pendingCredential)return n._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(!((r=e.multiFactorSession)===null||r===void 0)&&r.idToken)return n._fromIdtoken(e.multiFactorSession.idToken)}return null}};var uE=class n{constructor(e,t,r){this.session=e,this.hints=t,this.signInResolver=r}static _fromError(e,t){let r=Ge(e),i=t.customData._serverResponse,s=(i.mfaInfo||[]).map(a=>ho._fromServerResponse(r,a));U(i.mfaPendingCredential,r,"internal-error");let o=lm._fromMfaPendingCredential(i.mfaPendingCredential);return new n(o,s,a=>g(this,null,function*(){let c=yield a._process(r,o);delete i.mfaInfo,delete i.mfaPendingCredential;let l=Object.assign(Object.assign({},i),{idToken:c.idToken,refreshToken:c.refreshToken});switch(t.operationType){case"signIn":let d=yield pr._fromIdTokenResponse(r,t.operationType,l);return yield r._updateCurrentUser(d.user),d;case"reauthenticate":return U(t.user,r,"internal-error"),pr._forOperation(t.user,t.operationType,l);default:vt(r,"internal-error")}}))}resolveSignIn(e){return g(this,null,function*(){let t=e;return this.signInResolver(t)})}};function XE(n,e){var t;let r=q(n),i=e;return U(e.customData.operationType,r,"argument-error"),U((t=i.customData._serverResponse)===null||t===void 0?void 0:t.mfaPendingCredential,r,"argument-error"),uE._fromError(r,i)}function y6(n,e){return at(n,"POST","/v2/accounts/mfaEnrollment:start",ot(n,e))}function v6(n,e){return at(n,"POST","/v2/accounts/mfaEnrollment:finalize",ot(n,e))}function w6(n,e){return at(n,"POST","/v2/accounts/mfaEnrollment:withdraw",ot(n,e))}var dE=class n{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(t=>{t.mfaInfo&&(this.enrolledFactors=t.mfaInfo.map(r=>ho._fromServerResponse(e.auth,r)))})}static _fromUser(e){return new n(e)}getSession(){return g(this,null,function*(){return lm._fromIdtoken(yield this.user.getIdToken(),this.user)})}enroll(e,t){return g(this,null,function*(){let r=e,i=yield this.getSession(),s=yield Ii(this.user,r._process(this.user.auth,i,t));return yield this.user._updateTokensIfNecessary(s),this.user.reload()})}unenroll(e){return g(this,null,function*(){let t=typeof e=="string"?e:e.uid,r=yield this.user.getIdToken();try{let i=yield Ii(this.user,w6(this.user.auth,{idToken:r,mfaEnrollmentId:t}));this.enrolledFactors=this.enrolledFactors.filter(({uid:s})=>s!==t),yield this.user._updateTokensIfNecessary(i),yield this.user.reload()}catch(i){throw i}})}},KI=new WeakMap;function ZE(n){let e=q(n);return KI.has(e)||KI.set(e,dE._fromUser(e)),KI.get(e)}var um="__sak";var dm=class{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(um,"1"),this.storage.removeItem(um),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){let t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}};var I6=1e3,E6=10,T6=(()=>{class n extends dm{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,r)=>this.onStorageEvent(t,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=kk(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(let r of Object.keys(this.listeners)){let i=this.storage.getItem(r),s=this.localCache[r];i!==s&&t(r,s,i)}}onStorageEvent(t,r=!1){if(!t.key){this.forAllChangedKeys((a,c,l)=>{this.notifyListeners(a,l)});return}let i=t.key;r?this.detachListener():this.stopPolling();let s=()=>{let a=this.storage.getItem(i);!r&&this.localCache[i]===a||this.notifyListeners(i,a)},o=this.storage.getItem(i);LG()&&o!==t.newValue&&t.newValue!==t.oldValue?setTimeout(s,E6):s()}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let s of Array.from(i))s(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,r,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:r,newValue:i}),!0)})},I6)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}_set(t,r){return g(this,null,function*(){yield Er(n.prototype,this,"_set").call(this,t,r),this.localCache[t]=JSON.stringify(r)})}_get(t){return g(this,null,function*(){let r=yield Er(n.prototype,this,"_get").call(this,t);return this.localCache[t]=JSON.stringify(r),r})}_remove(t){return g(this,null,function*(){yield Er(n.prototype,this,"_remove").call(this,t),delete this.localCache[t]})}}return n.type="LOCAL",n})(),rc=T6;var b6=(()=>{class n extends dm{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,r){}_removeListener(t,r){}}return n.type="SESSION",n})(),$r=b6;function C6(n){return Promise.all(n.map(e=>g(this,null,function*(){try{return{fulfilled:!0,value:yield e}}catch(t){return{fulfilled:!1,reason:t}}})))}var D6=(()=>{class n{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){let r=this.receivers.find(s=>s.isListeningto(t));if(r)return r;let i=new n(t);return this.receivers.push(i),i}isListeningto(t){return this.eventTarget===t}handleEvent(t){return g(this,null,function*(){let r=t,{eventId:i,eventType:s,data:o}=r.data,a=this.handlersMap[s];if(!a?.size)return;r.ports[0].postMessage({status:"ack",eventId:i,eventType:s});let c=Array.from(a).map(d=>g(this,null,function*(){return d(r.origin,o)})),l=yield C6(c);r.ports[0].postMessage({status:"done",eventId:i,eventType:s,response:l})})}_subscribe(t,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(r)}_unsubscribe(t,r){this.handlersMap[t]&&r&&this.handlersMap[t].delete(r),(!r||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}n.receivers=[];return n})();function mo(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}var hE=class{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}_send(e,t,r=50){return g(this,null,function*(){let i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((a,c)=>{let l=mo("",20);i.port1.start();let d=setTimeout(()=>{c(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(h){let m=h;if(m.data.eventId===l)switch(m.data.status){case"ack":clearTimeout(d),s=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(m.data.response);break;default:clearTimeout(d),clearTimeout(s),c(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})})}};function _t(){return window}function S6(n){_t().location.href=n}function eT(){return typeof _t().WorkerGlobalScope<"u"&&typeof _t().importScripts=="function"}function A6(){return g(this,null,function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})}function R6(){var n;return((n=navigator?.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function x6(){return eT()?self:null}var qk="firebaseLocalStorageDb",N6=1,hm="firebaseLocalStorage",zk="fbase_key",fo=class{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}};function Dm(n,e){return n.transaction([hm],e?"readwrite":"readonly").objectStore(hm)}function P6(){let n=indexedDB.deleteDatabase(qk);return new fo(n).toPromise()}function fE(){let n=indexedDB.open(qk,N6);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{let r=n.result;try{r.createObjectStore(hm,{keyPath:zk})}catch(i){t(i)}}),n.addEventListener("success",()=>g(this,null,function*(){let r=n.result;r.objectStoreNames.contains(hm)?e(r):(r.close(),yield P6(),e(yield fE()))}))})}function hk(n,e,t){return g(this,null,function*(){let r=Dm(n,!0).put({[zk]:e,value:t});return new fo(r).toPromise()})}function M6(n,e){return g(this,null,function*(){let t=Dm(n,!1).get(e),r=yield new fo(t).toPromise();return r===void 0?null:r.value})}function fk(n,e){let t=Dm(n,!0).delete(e);return new fo(t).toPromise()}var k6=800,O6=3,L6=(()=>{class n{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){return g(this,null,function*(){return this.db?this.db:(this.db=yield fE(),this.db)})}_withRetries(t){return g(this,null,function*(){let r=0;for(;;)try{let i=yield this._openDb();return yield t(i)}catch(i){if(r++>O6)throw i;this.db&&(this.db.close(),this.db=void 0)}})}initializeServiceWorkerMessaging(){return g(this,null,function*(){return eT()?this.initializeReceiver():this.initializeSender()})}initializeReceiver(){return g(this,null,function*(){this.receiver=D6._getInstance(x6()),this.receiver._subscribe("keyChanged",(t,r)=>g(this,null,function*(){return{keyProcessed:(yield this._poll()).includes(r.key)}})),this.receiver._subscribe("ping",(t,r)=>g(this,null,function*(){return["keyChanged"]}))})}initializeSender(){return g(this,null,function*(){var t,r;if(this.activeServiceWorker=yield A6(),!this.activeServiceWorker)return;this.sender=new hE(this.activeServiceWorker);let i=yield this.sender._send("ping",{},800);i&&!((t=i[0])===null||t===void 0)&&t.fulfilled&&!((r=i[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)})}notifyServiceWorker(t){return g(this,null,function*(){if(!(!this.sender||!this.activeServiceWorker||R6()!==this.activeServiceWorker))try{yield this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}})}_isAvailable(){return g(this,null,function*(){try{if(!indexedDB)return!1;let t=yield fE();return yield hk(t,um,"1"),yield fk(t,um),!0}catch{}return!1})}_withPendingWrite(t){return g(this,null,function*(){this.pendingWrites++;try{yield t()}finally{this.pendingWrites--}})}_set(t,r){return g(this,null,function*(){return this._withPendingWrite(()=>g(this,null,function*(){return yield this._withRetries(i=>hk(i,t,r)),this.localCache[t]=r,this.notifyServiceWorker(t)}))})}_get(t){return g(this,null,function*(){let r=yield this._withRetries(i=>M6(i,t));return this.localCache[t]=r,r})}_remove(t){return g(this,null,function*(){return this._withPendingWrite(()=>g(this,null,function*(){return yield this._withRetries(r=>fk(r,t)),delete this.localCache[t],this.notifyServiceWorker(t)}))})}_poll(){return g(this,null,function*(){let t=yield this._withRetries(s=>{let o=Dm(s,!1).getAll();return new fo(o).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];let r=[],i=new Set;if(t.length!==0)for(let{fbase_key:s,value:o}of t)i.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(o)&&(this.notifyListeners(s,o),r.push(s));for(let s of Object.keys(this.localCache))this.localCache[s]&&!i.has(s)&&(this.notifyListeners(s,null),r.push(s));return r})}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let s of Array.from(i))s(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>g(this,null,function*(){return this._poll()}),k6)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}return n.type="LOCAL",n})(),go=L6;function F6(n,e){return at(n,"POST","/v2/accounts/mfaSignIn:start",ot(n,e))}function V6(n,e){return at(n,"POST","/v2/accounts/mfaSignIn:finalize",ot(n,e))}var U6=500,j6=6e4,tm=1e12,pE=class{constructor(e){this.auth=e,this.counter=tm,this._widgets=new Map}render(e,t){let r=this.counter;return this._widgets.set(r,new mE(e,this.auth.name,t||{})),this.counter++,r}reset(e){var t;let r=e||tm;(t=this._widgets.get(r))===null||t===void 0||t.delete(),this._widgets.delete(r)}getResponse(e){var t;let r=e||tm;return((t=this._widgets.get(r))===null||t===void 0?void 0:t.getResponse())||""}execute(e){return g(this,null,function*(){var t;let r=e||tm;return(t=this._widgets.get(r))===null||t===void 0||t.execute(),""})}},mE=class{constructor(e,t,r){this.params=r,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};let i=typeof e=="string"?document.getElementById(e):e;U(i,"argument-error",{appName:t}),this.container=i,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=B6(50);let{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch{}this.isVisible&&this.execute()},j6)},U6))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}};function B6(n){let e=[],t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let r=0;r<n;r++)e.push(t.charAt(Math.floor(Math.random()*t.length)));return e.join("")}var QI=Ok("rcb"),$6=new co(3e4,6e4),gE=class{constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!(!((e=_t().grecaptcha)===null||e===void 0)&&e.render)}load(e,t=""){return U(H6(t),e,"argument-error"),this.shouldResolveImmediately(t)&&ik(_t().grecaptcha)?Promise.resolve(_t().grecaptcha):new Promise((r,i)=>{let s=_t().setTimeout(()=>{i(yt(e,"network-request-failed"))},$6.get());_t()[QI]=()=>{_t().clearTimeout(s),delete _t()[QI];let a=_t().grecaptcha;if(!a||!ik(a)){i(yt(e,"internal-error"));return}let c=a.render;a.render=(l,d)=>{let h=c(l,d);return this.counter++,h},this.hostLanguage=t,r(a)};let o=`${jG()}?${yi({onload:QI,render:"explicit",hl:t})}`;RE(o).catch(()=>{clearTimeout(s),i(yt(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var t;return!!(!((t=_t().grecaptcha)===null||t===void 0)&&t.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}};function H6(n){return n.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(n)}var _E=class{load(e){return g(this,null,function*(){return new pE(e)})}clearedOneInstance(){}};var Wk="recaptcha",q6={theme:"light",type:"image"},td=class{constructor(e,t,r=Object.assign({},q6)){this.parameters=r,this.type=Wk,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Ge(e),this.isInvisible=this.parameters.size==="invisible",U(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");let i=typeof t=="string"?document.getElementById(t):t;U(i,this.auth,"argument-error"),this.container=i,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new _E:new gE,this.validateStartingState()}verify(){return g(this,null,function*(){this.assertNotDestroyed();let e=yield this.render(),t=this.getAssertedRecaptcha(),r=t.getResponse(e);return r||new Promise(i=>{let s=o=>{o&&(this.tokenChangeListeners.delete(s),i(o))};this.tokenChangeListeners.add(s),this.isInvisible&&t.execute(e)})})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){U(!this.parameters.sitekey,this.auth,"argument-error"),U(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),U(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach(r=>r(t)),typeof e=="function")e(t);else if(typeof e=="string"){let r=_t()[e];typeof r=="function"&&r(t)}}}assertNotDestroyed(){U(!this.destroyed,this.auth,"internal-error")}makeRenderPromise(){return g(this,null,function*(){if(yield this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){let t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId})}init(){return g(this,null,function*(){U(DE()&&!eT(),this.auth,"internal-error"),yield z6(),this.recaptcha=yield this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);let e=yield DG(this.auth);U(e,this.auth,"internal-error"),this.parameters.sitekey=e})}getAssertedRecaptcha(){return U(this.recaptcha,this.auth,"internal-error"),this.recaptcha}};function z6(){let n=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}n=()=>e(),window.addEventListener("load",n)}).catch(e=>{throw n&&window.removeEventListener("load",n),e})}var nd=class{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){let t=Ja._fromVerification(this.verificationId,e);return this.onConfirmation(t)}};function tT(n,e,t){return g(this,null,function*(){if(Ze(n.app))return Promise.reject(Mt(n));let r=Ge(n),i=yield Sm(r,e,q(t));return new nd(i,s=>nc(r,s))})}function nT(n,e,t){return g(this,null,function*(){let r=q(n);yield Im(!1,r,"phone");let i=yield Sm(r.auth,e,q(t));return new nd(i,s=>Em(r,s))})}function rT(n,e,t){return g(this,null,function*(){let r=q(n);if(Ze(r.auth.app))return Promise.reject(Mt(r.auth));let i=yield Sm(r.auth,e,q(t));return new nd(i,s=>Tm(r,s))})}function Sm(n,e,t){return g(this,null,function*(){var r;let i=yield t.verify();try{U(typeof i=="string",n,"argument-error"),U(t.type===Wk,n,"argument-error");let s;if(typeof e=="string"?s={phoneNumber:e}:s=e,"session"in s){let o=s.session;if("phoneNumber"in s)return U(o.type==="enroll",n,"internal-error"),(yield y6(n,{idToken:o.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:i}})).phoneSessionInfo.sessionInfo;{U(o.type==="signin",n,"internal-error");let a=((r=s.multiFactorHint)===null||r===void 0?void 0:r.uid)||s.multiFactorUid;return U(a,n,"missing-multi-factor-info"),(yield F6(n,{mfaPendingCredential:o.credential,mfaEnrollmentId:a,phoneSignInInfo:{recaptchaToken:i}})).phoneResponseInfo.sessionInfo}}else{let{sessionInfo:o}=yield s6(n,{phoneNumber:s.phoneNumber,recaptchaToken:i});return o}}finally{t._reset()}})}function iT(n,e){return g(this,null,function*(){let t=q(n);if(Ze(t.auth.app))return Promise.reject(Mt(t.auth));yield ME(t,e)})}var _o=(()=>{class n{constructor(t){this.providerId=n.PROVIDER_ID,this.auth=Ge(t)}verifyPhoneNumber(t,r){return Sm(this.auth,t,q(r))}static credential(t,r){return Ja._fromVerification(t,r)}static credentialFromResult(t){let r=t;return n.credentialFromTaggedObject(r)}static credentialFromError(t){return n.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;let{phoneNumber:r,temporaryProof:i}=t;return r&&i?Ja._fromTokenResponse(r,i):null}}n.PROVIDER_ID="phone",n.PHONE_SIGN_IN_METHOD="phone";return n})();function yo(n,e){return e?Qt(e):(U(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}var rd=class extends Br{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return wi(e,this._buildIdpRequest())}_linkToIdToken(e,t){return wi(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return wi(e,this._buildIdpRequest())}_buildIdpRequest(e){let t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}};function W6(n){return $k(n.auth,new rd(n),n.bypassAuthState)}function G6(n){let{auth:e,user:t}=n;return U(t,e,"internal-error"),Bk(t,new rd(n),n.bypassAuthState)}function K6(n){return g(this,null,function*(){let{auth:e,user:t}=n;return U(t,e,"internal-error"),ME(t,new rd(n),n.bypassAuthState)})}var fm=class{constructor(e,t,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((e,t)=>g(this,null,function*(){this.pendingPromise={resolve:e,reject:t};try{this.eventManager=yield this.resolver._initialize(this.auth),yield this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}}))}onAuthEvent(e){return g(this,null,function*(){let{urlResponse:t,sessionId:r,postBody:i,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}let c={auth:this.auth,requestUri:t,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(yield this.getIdpTask(a)(c))}catch(l){this.reject(l)}})}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return W6;case"linkViaPopup":case"linkViaRedirect":return K6;case"reauthViaPopup":case"reauthViaRedirect":return G6;default:vt(this.auth,"internal-error")}}resolve(e){Wn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Wn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}};var Q6=new co(2e3,1e4);function sT(n,e,t){return g(this,null,function*(){if(Ze(n.app))return Promise.reject(yt(n,"operation-not-supported-in-this-environment"));let r=Ge(n);Za(n,e,fr);let i=yo(r,t);return new cT(r,"signInViaPopup",e,i).executeNotNull()})}function oT(n,e,t){return g(this,null,function*(){let r=q(n);if(Ze(r.auth.app))return Promise.reject(yt(r.auth,"operation-not-supported-in-this-environment"));Za(r.auth,e,fr);let i=yo(r.auth,t);return new cT(r.auth,"reauthViaPopup",e,i,r).executeNotNull()})}function aT(n,e,t){return g(this,null,function*(){let r=q(n);Za(r.auth,e,fr);let i=yo(r.auth,t);return new cT(r.auth,"linkViaPopup",e,i,r).executeNotNull()})}var cT=(()=>{class n extends fm{constructor(t,r,i,s,o){super(t,r,s,o),this.provider=i,this.authWindow=null,this.pollId=null,n.currentPopupAction&&n.currentPopupAction.cancel(),n.currentPopupAction=this}executeNotNull(){return g(this,null,function*(){let t=yield this.execute();return U(t,this.auth,"internal-error"),t})}onExecution(){return g(this,null,function*(){Wn(this.filter.length===1,"Popup operations only handle one event");let t=mo();this.authWindow=yield this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(yt(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()})}get eventId(){var t;return((t=this.authWindow)===null||t===void 0?void 0:t.associatedEvent)||null}cancel(){this.reject(yt(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,n.currentPopupAction=null}pollUserCancellation(){let t=()=>{var r,i;if(!((i=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||i===void 0)&&i.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(yt(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(t,Q6.get())};t()}}n.currentPopupAction=null;return n})(),Y6="pendingRedirect",Wu=new Map,yE=class n extends fm{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}execute(){return g(this,null,function*(){let e=Wu.get(this.auth._key());if(!e){try{let r=(yield J6(this.resolver,this.auth))?yield Er(n.prototype,this,"execute").call(this):null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Wu.set(this.auth._key(),e)}return this.bypassAuthState||Wu.set(this.auth._key(),()=>Promise.resolve(null)),e()})}onAuthEvent(e){return g(this,null,function*(){if(e.type==="signInViaRedirect")return Er(n.prototype,this,"onAuthEvent").call(this,e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){let t=yield this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,Er(n.prototype,this,"onAuthEvent").call(this,e);this.resolve(null)}})}onExecution(){return g(this,null,function*(){})}cleanUp(){}};function J6(n,e){return g(this,null,function*(){let t=Qk(e),r=Kk(n);if(!(yield r._isAvailable()))return!1;let i=(yield r._get(t))==="true";return yield r._remove(t),i})}function lT(n,e){return g(this,null,function*(){return Kk(n)._set(Qk(e),"true")})}function Gk(){Wu.clear()}function ic(n,e){Wu.set(n._key(),e)}function Kk(n){return Qt(n._redirectPersistence)}function Qk(n){return jr(Y6,n.config.apiKey,n.name)}function uT(n,e,t){return X6(n,e,t)}function X6(n,e,t){return g(this,null,function*(){if(Ze(n.app))return Promise.reject(Mt(n));let r=Ge(n);Za(n,e,fr),yield r._initializationPromise;let i=yo(r,t);return yield lT(i,r),i._openRedirect(r,e,"signInViaRedirect")})}function dT(n,e,t){return Z6(n,e,t)}function Z6(n,e,t){return g(this,null,function*(){let r=q(n);if(Za(r.auth,e,fr),Ze(r.auth.app))return Promise.reject(Mt(r.auth));yield r.auth._initializationPromise;let i=yo(r.auth,t);yield lT(i,r.auth);let s=yield Yk(r);return i._openRedirect(r.auth,e,"reauthViaRedirect",s)})}function hT(n,e,t){return e9(n,e,t)}function e9(n,e,t){return g(this,null,function*(){let r=q(n);Za(r.auth,e,fr),yield r.auth._initializationPromise;let i=yo(r.auth,t);yield Im(!1,r,e.providerId),yield lT(i,r.auth);let s=yield Yk(r);return i._openRedirect(r.auth,e,"linkViaRedirect",s)})}function fT(n,e){return g(this,null,function*(){return yield Ge(n)._initializationPromise,vo(n,e,!1)})}function vo(n,e,t=!1){return g(this,null,function*(){if(Ze(n.app))return Promise.reject(Mt(n));let r=Ge(n),i=yo(r,e),o=yield new yE(r,i,t).execute();return o&&!t&&(delete o.user._redirectEventId,yield r._persistUserIfCurrent(o.user),yield r._setRedirectUser(null,e)),o})}function Yk(n){return g(this,null,function*(){let e=mo(`${n.uid}:::`);return n._redirectEventId=e,yield n.auth._setRedirectUser(n),yield n.auth._persistUserIfCurrent(n),e})}var t9=10*60*1e3,id=class{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!n9(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!Jk(e)){let i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(yt(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){let r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=t9&&this.cachedEventUids.clear(),this.cachedEventUids.has(pk(e))}saveEventToCache(e){this.cachedEventUids.add(pk(e)),this.lastProcessedEventTime=Date.now()}};function pk(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function Jk({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function n9(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Jk(n);default:return!1}}function pT(t){return g(this,arguments,function*(n,e={}){return at(n,"GET","/v1/projects",e)})}var r9=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,i9=/^https?/;function s9(n){return g(this,null,function*(){if(n.config.emulator)return;let{authorizedDomains:e}=yield pT(n);for(let t of e)try{if(o9(t))return}catch{}vt(n,"unauthorized-domain")})}function o9(n){let e=Gu(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){let o=new URL(n);return o.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===r}if(!i9.test(t))return!1;if(r9.test(n))return r===n;let i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}var a9=new co(3e4,6e4);function mk(){let n=_t().___jsl;if(n?.H){for(let e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function c9(n){return new Promise((e,t)=>{var r,i,s;function o(){mk(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{mk(),t(yt(n,"network-request-failed"))},timeout:a9.get()})}if(!((i=(r=_t().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=_t().gapi)===null||s===void 0)&&s.load)o();else{let a=Ok("iframefcb");return _t()[a]=()=>{gapi.load?o():t(yt(n,"network-request-failed"))},RE(`${$G()}?onload=${a}`).catch(c=>t(c))}}).catch(e=>{throw rm=null,e})}var rm=null;function l9(n){return rm=rm||c9(n),rm}var u9=new co(5e3,15e3),d9="__/auth/iframe",h9="emulator/auth/iframe",f9={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},p9=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function m9(n){let e=n.config;U(e.authDomain,n,"auth-domain-config-required");let t=e.emulator?SE(e,h9):`https://${n.config.authDomain}/${d9}`,r={apiKey:e.apiKey,appName:n.name,v:an},i=p9.get(n.config.apiHost);i&&(r.eid=i);let s=n._getFrameworks();return s.length&&(r.fw=s.join(",")),`${t}?${yi(r).slice(1)}`}function g9(n){return g(this,null,function*(){let e=yield l9(n),t=_t().gapi;return U(t,n,"internal-error"),e.open({where:document.body,url:m9(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:f9,dontclear:!0},r=>new Promise((i,s)=>g(this,null,function*(){yield r.restyle({setHideOnLeave:!1});let o=yt(n,"network-request-failed"),a=_t().setTimeout(()=>{s(o)},u9.get());function c(){_t().clearTimeout(a),i(r)}r.ping(c).then(c,()=>{s(o)})})))})}var _9={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},y9=500,v9=600,w9="_blank",I9="http://localhost",sd=class{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}};function E9(n,e,t,r=y9,i=v9){let s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString(),a="",c=Object.assign(Object.assign({},_9),{width:r.toString(),height:i.toString(),top:s,left:o}),l=He().toLowerCase();t&&(a=Rk(l)?w9:t),Sk(l)&&(e=e||I9,c.scrollbars="yes");let d=Object.entries(c).reduce((m,[_,w])=>`${m}${_}=${w},`,"");if(OG(l)&&a!=="_self")return T9(e||"",a),new sd(null);let h=window.open(e||"",a,d);U(h,n,"popup-blocked");try{h.focus()}catch{}return new sd(h)}function T9(n,e){let t=document.createElement("a");t.href=n,t.target=e;let r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}var b9="__/auth/handler",C9="emulator/auth/handler",D9=encodeURIComponent("fac");function pm(n,e,t,r,i,s){return g(this,null,function*(){U(n.config.authDomain,n,"auth-domain-config-required"),U(n.config.apiKey,n,"invalid-api-key");let o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:an,eventId:i};if(e instanceof fr){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",za(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(let[d,h]of Object.entries(s||{}))o[d]=h}if(e instanceof os){let d=e.getScopes().filter(h=>h!=="");d.length>0&&(o.scopes=d.join(","))}n.tenantId&&(o.tid=n.tenantId);let a=o;for(let d of Object.keys(a))a[d]===void 0&&delete a[d];let c=yield n._getAppCheckToken(),l=c?`#${D9}=${encodeURIComponent(c)}`:"";return`${S9(n)}?${yi(a).slice(1)}${l}`})}function S9({config:n}){return n.emulator?SE(n,C9):`https://${n.authDomain}/${b9}`}var YI="webStorageSupport",vE=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=$r,this._completeRedirectFn=vo,this._overrideRedirectResult=ic}_openPopup(e,t,r,i){return g(this,null,function*(){var s;Wn((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");let o=yield pm(e,t,r,Gu(),i);return E9(e,o,mo())})}_openRedirect(e,t,r,i){return g(this,null,function*(){yield this._originValidation(e);let s=yield pm(e,t,r,Gu(),i);return S6(s),new Promise(()=>{})})}_initialize(e){let t=e._key();if(this.eventManagers[t]){let{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(Wn(s,"If manager is not set, promise should be"),s)}let r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}initAndGetManager(e){return g(this,null,function*(){let t=yield g9(e),r=new id(e);return t.register("authEvent",i=>(U(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r})}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(YI,{type:YI},i=>{var s;let o=(s=i?.[0])===null||s===void 0?void 0:s[YI];o!==void 0&&t(!!o),vt(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=s9(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return kk()||Ak()||tc()}},mT=vE,wE=class{constructor(e){this.factorId=e}_process(e,t,r){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,r);case"signin":return this._finalizeSignIn(e,t.credential);default:return Ur("unexpected MultiFactorSessionType")}}},IE=class n extends wE{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new n(e)}_finalizeEnroll(e,t,r){return v6(e,{idToken:t,displayName:r,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,t){return V6(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}},gT=(()=>{class n{constructor(){}static assertion(t){return IE._fromCredential(t)}}return n.FACTOR_ID="phone",n})();var gk="@firebase/auth",_k="1.7.8";var EE=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}getToken(e){return g(this,null,function*(){return this.assertAuthConfigured(),yield this.auth._initializationPromise,this.auth.currentUser?{accessToken:yield this.auth.currentUser.getIdToken(e)}:null})}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){U(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function A9(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function R9(n){on(new Le("auth",(e,{options:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;U(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});let c={apiKey:o,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:AE(n)},l=new om(r,i,s,c);return zG(l,t),l},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),on(new Le("auth-internal",e=>{let t=Ge(e.getProvider("auth").getImmediate());return(r=>new EE(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),ut(gk,_k,A9(n)),ut(gk,_k,"esm2017")}var x9=5*60,nse=xM("authIdTokenMaxAge")||x9;function N9(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}UG({loadJS(n){return new Promise((e,t)=>{let r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{let s=yt("internal-error");s.customData=i,t(s)},r.type="text/javascript",r.charset="UTF-8",N9().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});R9("Browser");function wo(){return window}var P9=2e3;function M9(n,e,t){return g(this,null,function*(){var r;let{BuildInfo:i}=wo();Wn(e.sessionId,"AuthEvent did not contain a session ID");let s=yield V9(e.sessionId),o={};return tc()?o.ibi=i.packageName:ec()?o.apn=i.packageName:vt(n,"operation-not-supported-in-this-environment"),i.displayName&&(o.appDisplayName=i.displayName),o.sessionId=s,pm(n,t,e.type,void 0,(r=e.eventId)!==null&&r!==void 0?r:void 0,o)})}function k9(n){return g(this,null,function*(){let{BuildInfo:e}=wo(),t={};tc()?t.iosBundleId=e.packageName:ec()?t.androidPackageName=e.packageName:vt(n,"operation-not-supported-in-this-environment"),yield pT(n,t)})}function O9(n){let{cordova:e}=wo();return new Promise(t=>{e.plugins.browsertab.isAvailable(r=>{let i=null;r?e.plugins.browsertab.openUrl(n):i=e.InAppBrowser.open(n,Mk()?"_blank":"_system","location=yes"),t(i)})})}function L9(n,e,t){return g(this,null,function*(){let{cordova:r}=wo(),i=()=>{};try{yield new Promise((s,o)=>{let a=null;function c(){var h;s();let m=(h=r.plugins.browsertab)===null||h===void 0?void 0:h.close;typeof m=="function"&&m(),typeof t?.close=="function"&&t.close()}function l(){a||(a=window.setTimeout(()=>{o(yt(n,"redirect-cancelled-by-user"))},P9))}function d(){document?.visibilityState==="visible"&&l()}e.addPassiveListener(c),document.addEventListener("resume",l,!1),ec()&&document.addEventListener("visibilitychange",d,!1),i=()=>{e.removePassiveListener(c),document.removeEventListener("resume",l,!1),document.removeEventListener("visibilitychange",d,!1),a&&window.clearTimeout(a)}})}finally{i()}})}function F9(n){var e,t,r,i,s,o,a,c,l,d;let h=wo();U(typeof((e=h?.universalLinks)===null||e===void 0?void 0:e.subscribe)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),U(typeof((t=h?.BuildInfo)===null||t===void 0?void 0:t.packageName)<"u",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),U(typeof((s=(i=(r=h?.cordova)===null||r===void 0?void 0:r.plugins)===null||i===void 0?void 0:i.browsertab)===null||s===void 0?void 0:s.openUrl)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),U(typeof((c=(a=(o=h?.cordova)===null||o===void 0?void 0:o.plugins)===null||a===void 0?void 0:a.browsertab)===null||c===void 0?void 0:c.isAvailable)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),U(typeof((d=(l=h?.cordova)===null||l===void 0?void 0:l.InAppBrowser)===null||d===void 0?void 0:d.open)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}function V9(n){return g(this,null,function*(){let e=U9(n),t=yield crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(t)).map(i=>i.toString(16).padStart(2,"0")).join("")})}function U9(n){if(Wn(/[0-9a-zA-Z]+/.test(n),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return new TextEncoder().encode(n);let e=new ArrayBuffer(n.length),t=new Uint8Array(e);for(let r=0;r<n.length;r++)t[r]=n.charCodeAt(r);return t}var j9=20,_T=class extends id{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(e=>{this.resolveInitialized=e})}addPassiveListener(e){this.passiveListeners.add(e)}removePassiveListener(e){this.passiveListeners.delete(e)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(e){return this.resolveInitialized(),this.passiveListeners.forEach(t=>t(e)),super.onEvent(e)}initialized(){return g(this,null,function*(){yield this.initPromise})}};function B9(n,e,t=null){return{type:e,eventId:t,urlResponse:null,sessionId:q9(),postBody:null,tenantId:n.tenantId,error:yt(n,"no-auth-event")}}function $9(n,e){return yT()._set(vT(n),e)}function Xk(n){return g(this,null,function*(){let e=yield yT()._get(vT(n));return e&&(yield yT()._remove(vT(n))),e})}function H9(n,e){var t,r;let i=W9(e);if(i.includes("/__/auth/callback")){let s=Am(i),o=s.firebaseError?z9(decodeURIComponent(s.firebaseError)):null,a=(r=(t=o?.code)===null||t===void 0?void 0:t.split("auth/"))===null||r===void 0?void 0:r[1],c=a?yt(a):null;return c?{type:n.type,eventId:n.eventId,tenantId:n.tenantId,error:c,urlResponse:null,sessionId:null,postBody:null}:{type:n.type,eventId:n.eventId,tenantId:n.tenantId,sessionId:n.sessionId,urlResponse:i,postBody:null}}return null}function q9(){let n=[],e="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let t=0;t<j9;t++){let r=Math.floor(Math.random()*e.length);n.push(e.charAt(r))}return n.join("")}function yT(){return Qt(rc)}function vT(n){return jr("authEvent",n.config.apiKey,n.name)}function z9(n){try{return JSON.parse(n)}catch{return null}}function W9(n){let e=Am(n),t=e.link?decodeURIComponent(e.link):void 0,r=Am(t).link,i=e.deep_link_id?decodeURIComponent(e.deep_link_id):void 0;return Am(i).link||i||r||t||n}function Am(n){if(!n?.includes("?"))return{};let[e,...t]=n.split("?");return es(t.join("?"))}var G9=500,wT=class{constructor(){this._redirectPersistence=$r,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=vo,this._overrideRedirectResult=ic}_initialize(e){return g(this,null,function*(){let t=e._key(),r=this.eventManagers.get(t);return r||(r=new _T(e),this.eventManagers.set(t,r),this.attachCallbackListeners(e,r)),r})}_openPopup(e){vt(e,"operation-not-supported-in-this-environment")}_openRedirect(e,t,r,i){return g(this,null,function*(){F9(e);let s=yield this._initialize(e);yield s.initialized(),s.resetRedirect(),Gk(),yield this._originValidation(e);let o=B9(e,r,i);yield $9(e,o);let a=yield M9(e,o,t),c=yield O9(a);return L9(e,s,c)})}_isIframeWebStorageSupported(e,t){throw new Error("Method not implemented.")}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=k9(e)),this.originValidationPromises[t]}attachCallbackListeners(e,t){let{universalLinks:r,handleOpenURL:i,BuildInfo:s}=wo(),o=setTimeout(()=>g(this,null,function*(){yield Xk(e),t.onEvent(Zk())}),G9),a=d=>g(this,null,function*(){clearTimeout(o);let h=yield Xk(e),m=null;h&&d?.url&&(m=H9(h,d.url)),t.onEvent(m||Zk())});typeof r<"u"&&typeof r.subscribe=="function"&&r.subscribe(null,a);let c=i,l=`${s.packageName.toLowerCase()}://`;wo().handleOpenURL=d=>g(this,null,function*(){if(d.toLowerCase().startsWith(l)&&a({url:d}),typeof c=="function")try{c(d)}catch(h){console.error(h)}})}},eO=wT;function Zk(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:yt("no-auth-event")}}function tO(n,e){Ge(n)._logFramework(e)}var Q9="@firebase/auth-compat",Y9="0.5.13";var J9=1e3;function ud(){var n;return((n=self?.location)===null||n===void 0?void 0:n.protocol)||null}function X9(){return ud()==="http:"||ud()==="https:"}function iO(n=He()){return!!((ud()==="file:"||ud()==="ionic:"||ud()==="capacitor:")&&n.toLowerCase().match(/iphone|ipad|ipod|android/))}function Z9(){return so()||Wp()}function e5(){return Kp()&&document?.documentMode===11}function t5(n=He()){return/Edge\/\d+/.test(n)}function n5(n=He()){return e5()||t5(n)}function sO(){try{let n=self.localStorage,e=mo();if(n)return n.setItem(e,"1"),n.removeItem(e),n5()?Ji():!0}catch{return DT()&&Ji()}return!1}function DT(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function IT(){return(X9()||Gp()||iO())&&!Z9()&&sO()&&!DT()}function oO(){return iO()&&typeof document<"u"}function r5(){return g(this,null,function*(){return oO()?new Promise(n=>{let e=setTimeout(()=>{n(!1)},J9);document.addEventListener("deviceready",()=>{clearTimeout(e),n(!0)})}):!1})}function i5(){return typeof window<"u"?window:null}var Rn={LOCAL:"local",NONE:"none",SESSION:"session"},cd=U,aO="persistence";function s5(n,e){if(cd(Object.values(Rn).includes(e),n,"invalid-persistence-type"),so()){cd(e!==Rn.SESSION,n,"unsupported-persistence-type");return}if(Wp()){cd(e===Rn.NONE,n,"unsupported-persistence-type");return}if(DT()){cd(e===Rn.NONE||e===Rn.LOCAL&&Ji(),n,"unsupported-persistence-type");return}cd(e===Rn.NONE||sO(),n,"unsupported-persistence-type")}function ET(n){return g(this,null,function*(){yield n._initializationPromise;let e=cO(),t=jr(aO,n.config.apiKey,n.name);e&&e.setItem(t,n._getPersistence())})}function o5(n,e){let t=cO();if(!t)return[];let r=jr(aO,n,e);switch(t.getItem(r)){case Rn.NONE:return[ss];case Rn.LOCAL:return[go,$r];case Rn.SESSION:return[$r];default:return[]}}function cO(){var n;try{return((n=i5())===null||n===void 0?void 0:n.sessionStorage)||null}catch{return null}}var a5=U,Hr=class{constructor(){this.browserResolver=Qt(mT),this.cordovaResolver=Qt(eO),this.underlyingResolver=null,this._redirectPersistence=$r,this._completeRedirectFn=vo,this._overrideRedirectResult=ic}_initialize(e){return g(this,null,function*(){return yield this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._initialize(e)})}_openPopup(e,t,r,i){return g(this,null,function*(){return yield this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openPopup(e,t,r,i)})}_openRedirect(e,t,r,i){return g(this,null,function*(){return yield this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openRedirect(e,t,r,i)})}_isIframeWebStorageSupported(e,t){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,t)}_originValidation(e){return this.assertedUnderlyingResolver._originValidation(e)}get _shouldInitProactively(){return oO()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return a5(this.underlyingResolver,"internal-error"),this.underlyingResolver}selectUnderlyingResolver(){return g(this,null,function*(){if(this.underlyingResolver)return;let e=yield r5();this.underlyingResolver=e?this.cordovaResolver:this.browserResolver})}};function lO(n){return n.unwrap()}function c5(n){return n.wrapped()}function l5(n){return uO(n)}function u5(n,e){var t;let r=(t=e.customData)===null||t===void 0?void 0:t._tokenResponse;if(e?.code==="auth/multi-factor-auth-required"){let i=e;i.resolver=new bT(n,XE(n,e))}else if(r){let i=uO(e),s=e;i&&(s.credential=i,s.tenantId=r.tenantId||void 0,s.email=r.email||void 0,s.phoneNumber=r.phoneNumber||void 0)}}function uO(n){let{_tokenResponse:e}=n instanceof st?n.customData:n;if(!e)return null;if(!(n instanceof st)&&"temporaryProof"in e&&"phoneNumber"in e)return _o.credentialFromResult(n);let t=e.providerId;if(!t||t===po.PASSWORD)return null;let r;switch(t){case po.GOOGLE:r=ym;break;case po.FACEBOOK:r=_m;break;case po.GITHUB:r=vm;break;case po.TWITTER:r=wm;break;default:let{oauthIdToken:i,oauthAccessToken:s,oauthTokenSecret:o,pendingToken:a,nonce:c}=e;return!s&&!o&&!i&&!a?null:a?t.startsWith("saml.")?uo._create(t,a):hr._fromParams({providerId:t,signInMethod:t,pendingToken:a,idToken:i,accessToken:s}):new Xa(t).credential({idToken:i,accessToken:s,rawNonce:c})}return n instanceof st?r.credentialFromError(n):r.credentialFromResult(n)}function wn(n,e){return e.catch(t=>{throw t instanceof st&&u5(n,t),t}).then(t=>{let r=t.operationType,i=t.user;return{operationType:r,credential:l5(t),additionalUserInfo:JE(t),user:sc.getOrCreate(i)}})}function TT(n,e){return g(this,null,function*(){let t=yield e;return{verificationId:t.verificationId,confirm:r=>wn(n,t.confirm(r))}})}var bT=class{constructor(e,t){this.resolver=t,this.auth=c5(e)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(e){return wn(lO(this.auth),this.resolver.resolveSignIn(e))}};var sc=class n{constructor(e){this._delegate=e,this.multiFactor=ZE(e)}static getOrCreate(e){return n.USER_MAP.has(e)||n.USER_MAP.set(e,new n(e)),n.USER_MAP.get(e)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(e){return this._delegate.getIdTokenResult(e)}getIdToken(e){return this._delegate.getIdToken(e)}linkAndRetrieveDataWithCredential(e){return this.linkWithCredential(e)}linkWithCredential(e){return g(this,null,function*(){return wn(this.auth,Em(this._delegate,e))})}linkWithPhoneNumber(e,t){return g(this,null,function*(){return TT(this.auth,nT(this._delegate,e,t))})}linkWithPopup(e){return g(this,null,function*(){return wn(this.auth,aT(this._delegate,e,Hr))})}linkWithRedirect(e){return g(this,null,function*(){return yield ET(Ge(this.auth)),hT(this._delegate,e,Hr)})}reauthenticateAndRetrieveDataWithCredential(e){return this.reauthenticateWithCredential(e)}reauthenticateWithCredential(e){return g(this,null,function*(){return wn(this.auth,Tm(this._delegate,e))})}reauthenticateWithPhoneNumber(e,t){return TT(this.auth,rT(this._delegate,e,t))}reauthenticateWithPopup(e){return wn(this.auth,oT(this._delegate,e,Hr))}reauthenticateWithRedirect(e){return g(this,null,function*(){return yield ET(Ge(this.auth)),dT(this._delegate,e,Hr)})}sendEmailVerification(e){return WE(this._delegate,e)}unlink(e){return g(this,null,function*(){return yield PE(this._delegate,e),this})}updateEmail(e){return QE(this._delegate,e)}updatePassword(e){return YE(this._delegate,e)}updatePhoneNumber(e){return iT(this._delegate,e)}updateProfile(e){return KE(this._delegate,e)}verifyBeforeUpdateEmail(e,t){return GE(this._delegate,e,t)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}};sc.USER_MAP=new WeakMap;var ld=U,nO=(()=>{class n{constructor(t,r){if(this.app=t,r.isInitialized()){this._delegate=r.getImmediate(),this.linkUnderlyingAuth();return}let{apiKey:i}=t.options;ld(i,"invalid-api-key",{appName:t.name}),ld(i,"invalid-api-key",{appName:t.name});let s=typeof window<"u"?Hr:void 0;this._delegate=r.initialize({options:{persistence:d5(i,t.name),popupRedirectResolver:s}}),this._delegate._updateErrorMap(TE),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?sc.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(t){this._delegate.languageCode=t}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(t){this._delegate.tenantId=t}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(t,r){xE(this._delegate,t,r)}applyActionCode(t){return VE(this._delegate,t)}checkActionCode(t){return Cm(this._delegate,t)}confirmPasswordReset(t,r){return FE(this._delegate,t,r)}createUserWithEmailAndPassword(t,r){return g(this,null,function*(){return wn(this._delegate,jE(this._delegate,t,r))})}fetchProvidersForEmail(t){return this.fetchSignInMethodsForEmail(t)}fetchSignInMethodsForEmail(t){return zE(this._delegate,t)}isSignInWithEmailLink(t){return HE(this._delegate,t)}getRedirectResult(){return g(this,null,function*(){ld(IT(),this._delegate,"operation-not-supported-in-this-environment");let t=yield fT(this._delegate,Hr);return t?wn(this._delegate,Promise.resolve(t)):{credential:null,user:null}})}addFrameworkForLogging(t){tO(this._delegate,t)}onAuthStateChanged(t,r,i){let{next:s,error:o,complete:a}=rO(t,r,i);return this._delegate.onAuthStateChanged(s,o,a)}onIdTokenChanged(t,r,i){let{next:s,error:o,complete:a}=rO(t,r,i);return this._delegate.onIdTokenChanged(s,o,a)}sendSignInLinkToEmail(t,r){return $E(this._delegate,t,r)}sendPasswordResetEmail(t,r){return LE(this._delegate,t,r||void 0)}setPersistence(t){return g(this,null,function*(){s5(this._delegate,t);let r;switch(t){case Rn.SESSION:r=$r;break;case Rn.LOCAL:r=(yield Qt(go)._isAvailable())?go:rc;break;case Rn.NONE:r=ss;break;default:return vt("argument-error",{appName:this._delegate.name})}return this._delegate.setPersistence(r)})}signInAndRetrieveDataWithCredential(t){return this.signInWithCredential(t)}signInAnonymously(){return wn(this._delegate,NE(this._delegate))}signInWithCredential(t){return wn(this._delegate,nc(this._delegate,t))}signInWithCustomToken(t){return wn(this._delegate,kE(this._delegate,t))}signInWithEmailAndPassword(t,r){return wn(this._delegate,BE(this._delegate,t,r))}signInWithEmailLink(t,r){return wn(this._delegate,qE(this._delegate,t,r))}signInWithPhoneNumber(t,r){return TT(this._delegate,tT(this._delegate,t,r))}signInWithPopup(t){return g(this,null,function*(){return ld(IT(),this._delegate,"operation-not-supported-in-this-environment"),wn(this._delegate,sT(this._delegate,t,Hr))})}signInWithRedirect(t){return g(this,null,function*(){return ld(IT(),this._delegate,"operation-not-supported-in-this-environment"),yield ET(this._delegate),uT(this._delegate,t,Hr)})}updateCurrentUser(t){return this._delegate.updateCurrentUser(t)}verifyPasswordResetCode(t){return UE(this._delegate,t)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}return n.Persistence=Rn,n})();function rO(n,e,t){let r=n;typeof n!="function"&&({next:r,error:e,complete:t}=n);let i=r;return{next:o=>i(o&&sc.getOrCreate(o)),error:e,complete:t}}function d5(n,e){let t=o5(n,e);if(typeof self<"u"&&!t.includes(go)&&t.push(go),typeof window<"u")for(let r of[rc,$r])t.includes(r)||t.push(r);return t.includes(ss)||t.push(ss),t}var dd=class{constructor(){this.providerId="phone",this._delegate=new _o(lO(Fe.auth()))}static credential(e,t){return _o.credential(e,t)}verifyPhoneNumber(e,t){return this._delegate.verifyPhoneNumber(e,t)}unwrap(){return this._delegate}};dd.PHONE_SIGN_IN_METHOD=_o.PHONE_SIGN_IN_METHOD;dd.PROVIDER_ID=_o.PROVIDER_ID;var h5=U,CT=class{constructor(e,t,r=Fe.app()){var i;h5((i=r.options)===null||i===void 0?void 0:i.apiKey,"invalid-api-key",{appName:r.name}),this._delegate=new td(r.auth(),e,t),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}};var f5="auth-compat";function p5(n){n.INTERNAL.registerComponent(new Le(f5,e=>{let t=e.getProvider("app-compat").getImmediate(),r=e.getProvider("auth");return new nO(t,r)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:as.EMAIL_SIGNIN,PASSWORD_RESET:as.PASSWORD_RESET,RECOVER_EMAIL:as.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:as.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:as.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:as.VERIFY_EMAIL}},EmailAuthProvider:ad,FacebookAuthProvider:_m,GithubAuthProvider:vm,GoogleAuthProvider:ym,OAuthProvider:Xa,SAMLAuthProvider:ed,PhoneAuthProvider:dd,PhoneMultiFactorGenerator:gT,RecaptchaVerifier:CT,TwitterAuthProvider:wm,Auth:nO,AuthCredential:Br,Error:st}).setInstantiationMode("LAZY").setMultipleInstances(!1)),n.registerVersion(Q9,Y9)}p5(Fe);var dO=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},hO={};var cs,ST;(function(){var n;function e(T,v){function I(){}I.prototype=v.prototype,T.D=v.prototype,T.prototype=new I,T.prototype.constructor=T,T.C=function(b,D,R){for(var E=Array(arguments.length-2),ai=2;ai<arguments.length;ai++)E[ai-2]=arguments[ai];return v.prototype[D].apply(b,E)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(T,v,I){I||(I=0);var b=Array(16);if(typeof v=="string")for(var D=0;16>D;++D)b[D]=v.charCodeAt(I++)|v.charCodeAt(I++)<<8|v.charCodeAt(I++)<<16|v.charCodeAt(I++)<<24;else for(D=0;16>D;++D)b[D]=v[I++]|v[I++]<<8|v[I++]<<16|v[I++]<<24;v=T.g[0],I=T.g[1],D=T.g[2];var R=T.g[3],E=v+(R^I&(D^R))+b[0]+3614090360&4294967295;v=I+(E<<7&4294967295|E>>>25),E=R+(D^v&(I^D))+b[1]+3905402710&4294967295,R=v+(E<<12&4294967295|E>>>20),E=D+(I^R&(v^I))+b[2]+606105819&4294967295,D=R+(E<<17&4294967295|E>>>15),E=I+(v^D&(R^v))+b[3]+3250441966&4294967295,I=D+(E<<22&4294967295|E>>>10),E=v+(R^I&(D^R))+b[4]+4118548399&4294967295,v=I+(E<<7&4294967295|E>>>25),E=R+(D^v&(I^D))+b[5]+1200080426&4294967295,R=v+(E<<12&4294967295|E>>>20),E=D+(I^R&(v^I))+b[6]+2821735955&4294967295,D=R+(E<<17&4294967295|E>>>15),E=I+(v^D&(R^v))+b[7]+4249261313&4294967295,I=D+(E<<22&4294967295|E>>>10),E=v+(R^I&(D^R))+b[8]+1770035416&4294967295,v=I+(E<<7&4294967295|E>>>25),E=R+(D^v&(I^D))+b[9]+2336552879&4294967295,R=v+(E<<12&4294967295|E>>>20),E=D+(I^R&(v^I))+b[10]+4294925233&4294967295,D=R+(E<<17&4294967295|E>>>15),E=I+(v^D&(R^v))+b[11]+2304563134&4294967295,I=D+(E<<22&4294967295|E>>>10),E=v+(R^I&(D^R))+b[12]+1804603682&4294967295,v=I+(E<<7&4294967295|E>>>25),E=R+(D^v&(I^D))+b[13]+4254626195&4294967295,R=v+(E<<12&4294967295|E>>>20),E=D+(I^R&(v^I))+b[14]+2792965006&4294967295,D=R+(E<<17&4294967295|E>>>15),E=I+(v^D&(R^v))+b[15]+1236535329&4294967295,I=D+(E<<22&4294967295|E>>>10),E=v+(D^R&(I^D))+b[1]+4129170786&4294967295,v=I+(E<<5&4294967295|E>>>27),E=R+(I^D&(v^I))+b[6]+3225465664&4294967295,R=v+(E<<9&4294967295|E>>>23),E=D+(v^I&(R^v))+b[11]+643717713&4294967295,D=R+(E<<14&4294967295|E>>>18),E=I+(R^v&(D^R))+b[0]+3921069994&4294967295,I=D+(E<<20&4294967295|E>>>12),E=v+(D^R&(I^D))+b[5]+3593408605&4294967295,v=I+(E<<5&4294967295|E>>>27),E=R+(I^D&(v^I))+b[10]+38016083&4294967295,R=v+(E<<9&4294967295|E>>>23),E=D+(v^I&(R^v))+b[15]+3634488961&4294967295,D=R+(E<<14&4294967295|E>>>18),E=I+(R^v&(D^R))+b[4]+3889429448&4294967295,I=D+(E<<20&4294967295|E>>>12),E=v+(D^R&(I^D))+b[9]+568446438&4294967295,v=I+(E<<5&4294967295|E>>>27),E=R+(I^D&(v^I))+b[14]+3275163606&4294967295,R=v+(E<<9&4294967295|E>>>23),E=D+(v^I&(R^v))+b[3]+4107603335&4294967295,D=R+(E<<14&4294967295|E>>>18),E=I+(R^v&(D^R))+b[8]+1163531501&4294967295,I=D+(E<<20&4294967295|E>>>12),E=v+(D^R&(I^D))+b[13]+2850285829&4294967295,v=I+(E<<5&4294967295|E>>>27),E=R+(I^D&(v^I))+b[2]+4243563512&4294967295,R=v+(E<<9&4294967295|E>>>23),E=D+(v^I&(R^v))+b[7]+1735328473&4294967295,D=R+(E<<14&4294967295|E>>>18),E=I+(R^v&(D^R))+b[12]+2368359562&4294967295,I=D+(E<<20&4294967295|E>>>12),E=v+(I^D^R)+b[5]+4294588738&4294967295,v=I+(E<<4&4294967295|E>>>28),E=R+(v^I^D)+b[8]+2272392833&4294967295,R=v+(E<<11&4294967295|E>>>21),E=D+(R^v^I)+b[11]+1839030562&4294967295,D=R+(E<<16&4294967295|E>>>16),E=I+(D^R^v)+b[14]+4259657740&4294967295,I=D+(E<<23&4294967295|E>>>9),E=v+(I^D^R)+b[1]+2763975236&4294967295,v=I+(E<<4&4294967295|E>>>28),E=R+(v^I^D)+b[4]+1272893353&4294967295,R=v+(E<<11&4294967295|E>>>21),E=D+(R^v^I)+b[7]+4139469664&4294967295,D=R+(E<<16&4294967295|E>>>16),E=I+(D^R^v)+b[10]+3200236656&4294967295,I=D+(E<<23&4294967295|E>>>9),E=v+(I^D^R)+b[13]+681279174&4294967295,v=I+(E<<4&4294967295|E>>>28),E=R+(v^I^D)+b[0]+3936430074&4294967295,R=v+(E<<11&4294967295|E>>>21),E=D+(R^v^I)+b[3]+3572445317&4294967295,D=R+(E<<16&4294967295|E>>>16),E=I+(D^R^v)+b[6]+76029189&4294967295,I=D+(E<<23&4294967295|E>>>9),E=v+(I^D^R)+b[9]+3654602809&4294967295,v=I+(E<<4&4294967295|E>>>28),E=R+(v^I^D)+b[12]+3873151461&4294967295,R=v+(E<<11&4294967295|E>>>21),E=D+(R^v^I)+b[15]+530742520&4294967295,D=R+(E<<16&4294967295|E>>>16),E=I+(D^R^v)+b[2]+3299628645&4294967295,I=D+(E<<23&4294967295|E>>>9),E=v+(D^(I|~R))+b[0]+4096336452&4294967295,v=I+(E<<6&4294967295|E>>>26),E=R+(I^(v|~D))+b[7]+1126891415&4294967295,R=v+(E<<10&4294967295|E>>>22),E=D+(v^(R|~I))+b[14]+2878612391&4294967295,D=R+(E<<15&4294967295|E>>>17),E=I+(R^(D|~v))+b[5]+4237533241&4294967295,I=D+(E<<21&4294967295|E>>>11),E=v+(D^(I|~R))+b[12]+1700485571&4294967295,v=I+(E<<6&4294967295|E>>>26),E=R+(I^(v|~D))+b[3]+2399980690&4294967295,R=v+(E<<10&4294967295|E>>>22),E=D+(v^(R|~I))+b[10]+4293915773&4294967295,D=R+(E<<15&4294967295|E>>>17),E=I+(R^(D|~v))+b[1]+2240044497&4294967295,I=D+(E<<21&4294967295|E>>>11),E=v+(D^(I|~R))+b[8]+1873313359&4294967295,v=I+(E<<6&4294967295|E>>>26),E=R+(I^(v|~D))+b[15]+4264355552&4294967295,R=v+(E<<10&4294967295|E>>>22),E=D+(v^(R|~I))+b[6]+2734768916&4294967295,D=R+(E<<15&4294967295|E>>>17),E=I+(R^(D|~v))+b[13]+1309151649&4294967295,I=D+(E<<21&4294967295|E>>>11),E=v+(D^(I|~R))+b[4]+4149444226&4294967295,v=I+(E<<6&4294967295|E>>>26),E=R+(I^(v|~D))+b[11]+3174756917&4294967295,R=v+(E<<10&4294967295|E>>>22),E=D+(v^(R|~I))+b[2]+718787259&4294967295,D=R+(E<<15&4294967295|E>>>17),E=I+(R^(D|~v))+b[9]+3951481745&4294967295,T.g[0]=T.g[0]+v&4294967295,T.g[1]=T.g[1]+(D+(E<<21&4294967295|E>>>11))&4294967295,T.g[2]=T.g[2]+D&4294967295,T.g[3]=T.g[3]+R&4294967295}r.prototype.u=function(T,v){v===void 0&&(v=T.length);for(var I=v-this.blockSize,b=this.B,D=this.h,R=0;R<v;){if(D==0)for(;R<=I;)i(this,T,R),R+=this.blockSize;if(typeof T=="string"){for(;R<v;)if(b[D++]=T.charCodeAt(R++),D==this.blockSize){i(this,b),D=0;break}}else for(;R<v;)if(b[D++]=T[R++],D==this.blockSize){i(this,b),D=0;break}}this.h=D,this.o+=v},r.prototype.v=function(){var T=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);T[0]=128;for(var v=1;v<T.length-8;++v)T[v]=0;var I=8*this.o;for(v=T.length-8;v<T.length;++v)T[v]=I&255,I/=256;for(this.u(T),T=Array(16),v=I=0;4>v;++v)for(var b=0;32>b;b+=8)T[I++]=this.g[v]>>>b&255;return T};function s(T,v){var I=a;return Object.prototype.hasOwnProperty.call(I,T)?I[T]:I[T]=v(T)}function o(T,v){this.h=v;for(var I=[],b=!0,D=T.length-1;0<=D;D--){var R=T[D]|0;b&&R==v||(I[D]=R,b=!1)}this.g=I}var a={};function c(T){return-128<=T&&128>T?s(T,function(v){return new o([v|0],0>v?-1:0)}):new o([T|0],0>T?-1:0)}function l(T){if(isNaN(T)||!isFinite(T))return h;if(0>T)return A(l(-T));for(var v=[],I=1,b=0;T>=I;b++)v[b]=T/I|0,I*=4294967296;return new o(v,0)}function d(T,v){if(T.length==0)throw Error("number format error: empty string");if(v=v||10,2>v||36<v)throw Error("radix out of range: "+v);if(T.charAt(0)=="-")return A(d(T.substring(1),v));if(0<=T.indexOf("-"))throw Error('number format error: interior "-" character');for(var I=l(Math.pow(v,8)),b=h,D=0;D<T.length;D+=8){var R=Math.min(8,T.length-D),E=parseInt(T.substring(D,D+R),v);8>R?(R=l(Math.pow(v,R)),b=b.j(R).add(l(E))):(b=b.j(I),b=b.add(l(E)))}return b}var h=c(0),m=c(1),_=c(16777216);n=o.prototype,n.m=function(){if(C(this))return-A(this).m();for(var T=0,v=1,I=0;I<this.g.length;I++){var b=this.i(I);T+=(0<=b?b:4294967296+b)*v,v*=4294967296}return T},n.toString=function(T){if(T=T||10,2>T||36<T)throw Error("radix out of range: "+T);if(w(this))return"0";if(C(this))return"-"+A(this).toString(T);for(var v=l(Math.pow(T,6)),I=this,b="";;){var D=Q(I,v).g;I=L(I,D.j(v));var R=((0<I.g.length?I.g[0]:I.h)>>>0).toString(T);if(I=D,w(I))return R+b;for(;6>R.length;)R="0"+R;b=R+b}},n.i=function(T){return 0>T?0:T<this.g.length?this.g[T]:this.h};function w(T){if(T.h!=0)return!1;for(var v=0;v<T.g.length;v++)if(T.g[v]!=0)return!1;return!0}function C(T){return T.h==-1}n.l=function(T){return T=L(this,T),C(T)?-1:w(T)?0:1};function A(T){for(var v=T.g.length,I=[],b=0;b<v;b++)I[b]=~T.g[b];return new o(I,~T.h).add(m)}n.abs=function(){return C(this)?A(this):this},n.add=function(T){for(var v=Math.max(this.g.length,T.g.length),I=[],b=0,D=0;D<=v;D++){var R=b+(this.i(D)&65535)+(T.i(D)&65535),E=(R>>>16)+(this.i(D)>>>16)+(T.i(D)>>>16);b=E>>>16,R&=65535,E&=65535,I[D]=E<<16|R}return new o(I,I[I.length-1]&-2147483648?-1:0)};function L(T,v){return T.add(A(v))}n.j=function(T){if(w(this)||w(T))return h;if(C(this))return C(T)?A(this).j(A(T)):A(A(this).j(T));if(C(T))return A(this.j(A(T)));if(0>this.l(_)&&0>T.l(_))return l(this.m()*T.m());for(var v=this.g.length+T.g.length,I=[],b=0;b<2*v;b++)I[b]=0;for(b=0;b<this.g.length;b++)for(var D=0;D<T.g.length;D++){var R=this.i(b)>>>16,E=this.i(b)&65535,ai=T.i(D)>>>16,yl=T.i(D)&65535;I[2*b+2*D]+=E*yl,H(I,2*b+2*D),I[2*b+2*D+1]+=R*yl,H(I,2*b+2*D+1),I[2*b+2*D+1]+=E*ai,H(I,2*b+2*D+1),I[2*b+2*D+2]+=R*ai,H(I,2*b+2*D+2)}for(b=0;b<v;b++)I[b]=I[2*b+1]<<16|I[2*b];for(b=v;b<2*v;b++)I[b]=0;return new o(I,0)};function H(T,v){for(;(T[v]&65535)!=T[v];)T[v+1]+=T[v]>>>16,T[v]&=65535,v++}function j(T,v){this.g=T,this.h=v}function Q(T,v){if(w(v))throw Error("division by zero");if(w(T))return new j(h,h);if(C(T))return v=Q(A(T),v),new j(A(v.g),A(v.h));if(C(v))return v=Q(T,A(v)),new j(A(v.g),v.h);if(30<T.g.length){if(C(T)||C(v))throw Error("slowDivide_ only works with positive integers.");for(var I=m,b=v;0>=b.l(T);)I=se(I),b=se(b);var D=J(I,1),R=J(b,1);for(b=J(b,2),I=J(I,2);!w(b);){var E=R.add(b);0>=E.l(T)&&(D=D.add(I),R=E),b=J(b,1),I=J(I,1)}return v=L(T,D.j(v)),new j(D,v)}for(D=h;0<=T.l(v);){for(I=Math.max(1,Math.floor(T.m()/v.m())),b=Math.ceil(Math.log(I)/Math.LN2),b=48>=b?1:Math.pow(2,b-48),R=l(I),E=R.j(v);C(E)||0<E.l(T);)I-=b,R=l(I),E=R.j(v);w(R)&&(R=m),D=D.add(R),T=L(T,E)}return new j(D,T)}n.A=function(T){return Q(this,T).h},n.and=function(T){for(var v=Math.max(this.g.length,T.g.length),I=[],b=0;b<v;b++)I[b]=this.i(b)&T.i(b);return new o(I,this.h&T.h)},n.or=function(T){for(var v=Math.max(this.g.length,T.g.length),I=[],b=0;b<v;b++)I[b]=this.i(b)|T.i(b);return new o(I,this.h|T.h)},n.xor=function(T){for(var v=Math.max(this.g.length,T.g.length),I=[],b=0;b<v;b++)I[b]=this.i(b)^T.i(b);return new o(I,this.h^T.h)};function se(T){for(var v=T.g.length+1,I=[],b=0;b<v;b++)I[b]=T.i(b)<<1|T.i(b-1)>>>31;return new o(I,T.h)}function J(T,v){var I=v>>5;v%=32;for(var b=T.g.length-I,D=[],R=0;R<b;R++)D[R]=0<v?T.i(R+I)>>>v|T.i(R+I+1)<<32-v:T.i(R+I);return new o(D,T.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,ST=hO.Md5=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=l,o.fromString=d,cs=hO.Integer=o}).apply(typeof dO<"u"?dO:typeof self<"u"?self:typeof window<"u"?window:{});var Rm=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Ti={};var AT,RT,oc,xT,hd,xm,NT,PT,MT;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(u,f,p){return u==Array.prototype||u==Object.prototype||(u[f]=p.value),u};function t(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof Rm=="object"&&Rm];for(var f=0;f<u.length;++f){var p=u[f];if(p&&p.Math==Math)return p}throw Error("Cannot find global object")}var r=t(this);function i(u,f){if(f)e:{var p=r;u=u.split(".");for(var y=0;y<u.length-1;y++){var S=u[y];if(!(S in p))break e;p=p[S]}u=u[u.length-1],y=p[u],f=f(y),f!=y&&f!=null&&e(p,u,{configurable:!0,writable:!0,value:f})}}function s(u,f){u instanceof String&&(u+="");var p=0,y=!1,S={next:function(){if(!y&&p<u.length){var P=p++;return{value:f(P,u[P]),done:!1}}return y=!0,{done:!0,value:void 0}}};return S[Symbol.iterator]=function(){return S},S}i("Array.prototype.values",function(u){return u||function(){return s(this,function(f,p){return p})}});var o=o||{},a=this||self;function c(u){var f=typeof u;return f=f!="object"?f:u?Array.isArray(u)?"array":f:"null",f=="array"||f=="object"&&typeof u.length=="number"}function l(u){var f=typeof u;return f=="object"&&u!=null||f=="function"}function d(u,f,p){return u.call.apply(u.bind,arguments)}function h(u,f,p){if(!u)throw Error();if(2<arguments.length){var y=Array.prototype.slice.call(arguments,2);return function(){var S=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(S,y),u.apply(f,S)}}return function(){return u.apply(f,arguments)}}function m(u,f,p){return m=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:h,m.apply(null,arguments)}function _(u,f){var p=Array.prototype.slice.call(arguments,1);return function(){var y=p.slice();return y.push.apply(y,arguments),u.apply(this,y)}}function w(u,f){function p(){}p.prototype=f.prototype,u.aa=f.prototype,u.prototype=new p,u.prototype.constructor=u,u.Qb=function(y,S,P){for(var $=Array(arguments.length-2),Ve=2;Ve<arguments.length;Ve++)$[Ve-2]=arguments[Ve];return f.prototype[S].apply(y,$)}}function C(u){let f=u.length;if(0<f){let p=Array(f);for(let y=0;y<f;y++)p[y]=u[y];return p}return[]}function A(u,f){for(let p=1;p<arguments.length;p++){let y=arguments[p];if(c(y)){let S=u.length||0,P=y.length||0;u.length=S+P;for(let $=0;$<P;$++)u[S+$]=y[$]}else u.push(y)}}class L{constructor(f,p){this.i=f,this.j=p,this.h=0,this.g=null}get(){let f;return 0<this.h?(this.h--,f=this.g,this.g=f.next,f.next=null):f=this.i(),f}}function H(u){return/^[\s\xa0]*$/.test(u)}function j(){var u=a.navigator;return u&&(u=u.userAgent)?u:""}function Q(u){return Q[" "](u),u}Q[" "]=function(){};var se=j().indexOf("Gecko")!=-1&&!(j().toLowerCase().indexOf("webkit")!=-1&&j().indexOf("Edge")==-1)&&!(j().indexOf("Trident")!=-1||j().indexOf("MSIE")!=-1)&&j().indexOf("Edge")==-1;function J(u,f,p){for(let y in u)f.call(p,u[y],y,u)}function T(u,f){for(let p in u)f.call(void 0,u[p],p,u)}function v(u){let f={};for(let p in u)f[p]=u[p];return f}let I="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function b(u,f){let p,y;for(let S=1;S<arguments.length;S++){y=arguments[S];for(p in y)u[p]=y[p];for(let P=0;P<I.length;P++)p=I[P],Object.prototype.hasOwnProperty.call(y,p)&&(u[p]=y[p])}}function D(u){var f=1;u=u.split(":");let p=[];for(;0<f&&u.length;)p.push(u.shift()),f--;return u.length&&p.push(u.join(":")),p}function R(u){a.setTimeout(()=>{throw u},0)}function E(){var u=J_;let f=null;return u.g&&(f=u.g,u.g=u.g.next,u.g||(u.h=null),f.next=null),f}class ai{constructor(){this.h=this.g=null}add(f,p){let y=yl.get();y.set(f,p),this.h?this.h.next=y:this.g=y,this.h=y}}var yl=new L(()=>new WU,u=>u.reset());class WU{constructor(){this.next=this.g=this.h=null}set(f,p){this.h=f,this.g=p,this.next=null}reset(){this.next=this.g=this.h=null}}let vl,wl=!1,J_=new ai,BS=()=>{let u=a.Promise.resolve(void 0);vl=()=>{u.then(GU)}};var GU=()=>{for(var u;u=E();){try{u.h.call(u.g)}catch(p){R(p)}var f=yl;f.j(u),100>f.h&&(f.h++,u.next=f.g,f.g=u)}wl=!1};function Oi(){this.s=this.s,this.C=this.C}Oi.prototype.s=!1,Oi.prototype.ma=function(){this.s||(this.s=!0,this.N())},Oi.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function $t(u,f){this.type=u,this.g=this.target=f,this.defaultPrevented=!1}$t.prototype.h=function(){this.defaultPrevented=!0};var KU=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var u=!1,f=Object.defineProperty({},"passive",{get:function(){u=!0}});try{let p=()=>{};a.addEventListener("test",p,f),a.removeEventListener("test",p,f)}catch{}return u}();function Il(u,f){if($t.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u){var p=this.type=u.type,y=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;if(this.target=u.target||u.srcElement,this.g=f,f=u.relatedTarget){if(se){e:{try{Q(f.nodeName);var S=!0;break e}catch{}S=!1}S||(f=null)}}else p=="mouseover"?f=u.fromElement:p=="mouseout"&&(f=u.toElement);this.relatedTarget=f,y?(this.clientX=y.clientX!==void 0?y.clientX:y.pageX,this.clientY=y.clientY!==void 0?y.clientY:y.pageY,this.screenX=y.screenX||0,this.screenY=y.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=typeof u.pointerType=="string"?u.pointerType:QU[u.pointerType]||"",this.state=u.state,this.i=u,u.defaultPrevented&&Il.aa.h.call(this)}}w(Il,$t);var QU={2:"touch",3:"pen",4:"mouse"};Il.prototype.h=function(){Il.aa.h.call(this);var u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var El="closure_listenable_"+(1e6*Math.random()|0),YU=0;function JU(u,f,p,y,S){this.listener=u,this.proxy=null,this.src=f,this.type=p,this.capture=!!y,this.ha=S,this.key=++YU,this.da=this.fa=!1}function Vh(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function Uh(u){this.src=u,this.g={},this.h=0}Uh.prototype.add=function(u,f,p,y,S){var P=u.toString();u=this.g[P],u||(u=this.g[P]=[],this.h++);var $=Z_(u,f,y,S);return-1<$?(f=u[$],p||(f.fa=!1)):(f=new JU(f,this.src,P,!!y,S),f.fa=p,u.push(f)),f};function X_(u,f){var p=f.type;if(p in u.g){var y=u.g[p],S=Array.prototype.indexOf.call(y,f,void 0),P;(P=0<=S)&&Array.prototype.splice.call(y,S,1),P&&(Vh(f),u.g[p].length==0&&(delete u.g[p],u.h--))}}function Z_(u,f,p,y){for(var S=0;S<u.length;++S){var P=u[S];if(!P.da&&P.listener==f&&P.capture==!!p&&P.ha==y)return S}return-1}var ey="closure_lm_"+(1e6*Math.random()|0),ty={};function $S(u,f,p,y,S){if(y&&y.once)return qS(u,f,p,y,S);if(Array.isArray(f)){for(var P=0;P<f.length;P++)$S(u,f[P],p,y,S);return null}return p=sy(p),u&&u[El]?u.K(f,p,l(y)?!!y.capture:!!y,S):HS(u,f,p,!1,y,S)}function HS(u,f,p,y,S,P){if(!f)throw Error("Invalid event type");var $=l(S)?!!S.capture:!!S,Ve=ry(u);if(Ve||(u[ey]=Ve=new Uh(u)),p=Ve.add(f,p,y,$,P),p.proxy)return p;if(y=XU(),p.proxy=y,y.src=u,y.listener=p,u.addEventListener)KU||(S=$),S===void 0&&(S=!1),u.addEventListener(f.toString(),y,S);else if(u.attachEvent)u.attachEvent(WS(f.toString()),y);else if(u.addListener&&u.removeListener)u.addListener(y);else throw Error("addEventListener and attachEvent are unavailable.");return p}function XU(){function u(p){return f.call(u.src,u.listener,p)}let f=ZU;return u}function qS(u,f,p,y,S){if(Array.isArray(f)){for(var P=0;P<f.length;P++)qS(u,f[P],p,y,S);return null}return p=sy(p),u&&u[El]?u.L(f,p,l(y)?!!y.capture:!!y,S):HS(u,f,p,!0,y,S)}function zS(u,f,p,y,S){if(Array.isArray(f))for(var P=0;P<f.length;P++)zS(u,f[P],p,y,S);else y=l(y)?!!y.capture:!!y,p=sy(p),u&&u[El]?(u=u.i,f=String(f).toString(),f in u.g&&(P=u.g[f],p=Z_(P,p,y,S),-1<p&&(Vh(P[p]),Array.prototype.splice.call(P,p,1),P.length==0&&(delete u.g[f],u.h--)))):u&&(u=ry(u))&&(f=u.g[f.toString()],u=-1,f&&(u=Z_(f,p,y,S)),(p=-1<u?f[u]:null)&&ny(p))}function ny(u){if(typeof u!="number"&&u&&!u.da){var f=u.src;if(f&&f[El])X_(f.i,u);else{var p=u.type,y=u.proxy;f.removeEventListener?f.removeEventListener(p,y,u.capture):f.detachEvent?f.detachEvent(WS(p),y):f.addListener&&f.removeListener&&f.removeListener(y),(p=ry(f))?(X_(p,u),p.h==0&&(p.src=null,f[ey]=null)):Vh(u)}}}function WS(u){return u in ty?ty[u]:ty[u]="on"+u}function ZU(u,f){if(u.da)u=!0;else{f=new Il(f,this);var p=u.listener,y=u.ha||u.src;u.fa&&ny(u),u=p.call(y,f)}return u}function ry(u){return u=u[ey],u instanceof Uh?u:null}var iy="__closure_events_fn_"+(1e9*Math.random()>>>0);function sy(u){return typeof u=="function"?u:(u[iy]||(u[iy]=function(f){return u.handleEvent(f)}),u[iy])}function Ht(){Oi.call(this),this.i=new Uh(this),this.M=this,this.F=null}w(Ht,Oi),Ht.prototype[El]=!0,Ht.prototype.removeEventListener=function(u,f,p,y){zS(this,u,f,p,y)};function en(u,f){var p,y=u.F;if(y)for(p=[];y;y=y.F)p.push(y);if(u=u.M,y=f.type||f,typeof f=="string")f=new $t(f,u);else if(f instanceof $t)f.target=f.target||u;else{var S=f;f=new $t(y,u),b(f,S)}if(S=!0,p)for(var P=p.length-1;0<=P;P--){var $=f.g=p[P];S=jh($,y,!0,f)&&S}if($=f.g=u,S=jh($,y,!0,f)&&S,S=jh($,y,!1,f)&&S,p)for(P=0;P<p.length;P++)$=f.g=p[P],S=jh($,y,!1,f)&&S}Ht.prototype.N=function(){if(Ht.aa.N.call(this),this.i){var u=this.i,f;for(f in u.g){for(var p=u.g[f],y=0;y<p.length;y++)Vh(p[y]);delete u.g[f],u.h--}}this.F=null},Ht.prototype.K=function(u,f,p,y){return this.i.add(String(u),f,!1,p,y)},Ht.prototype.L=function(u,f,p,y){return this.i.add(String(u),f,!0,p,y)};function jh(u,f,p,y){if(f=u.i.g[String(f)],!f)return!0;f=f.concat();for(var S=!0,P=0;P<f.length;++P){var $=f[P];if($&&!$.da&&$.capture==p){var Ve=$.listener,Lt=$.ha||$.src;$.fa&&X_(u.i,$),S=Ve.call(Lt,y)!==!1&&S}}return S&&!y.defaultPrevented}function GS(u,f,p){if(typeof u=="function")p&&(u=m(u,p));else if(u&&typeof u.handleEvent=="function")u=m(u.handleEvent,u);else throw Error("Invalid listener argument");return 2147483647<Number(f)?-1:a.setTimeout(u,f||0)}function KS(u){u.g=GS(()=>{u.g=null,u.i&&(u.i=!1,KS(u))},u.l);let f=u.h;u.h=null,u.m.apply(null,f)}class ej extends Oi{constructor(f,p){super(),this.m=f,this.l=p,this.h=null,this.i=!1,this.g=null}j(f){this.h=arguments,this.g?this.i=!0:KS(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Tl(u){Oi.call(this),this.h=u,this.g={}}w(Tl,Oi);var QS=[];function YS(u){J(u.g,function(f,p){this.g.hasOwnProperty(p)&&ny(f)},u),u.g={}}Tl.prototype.N=function(){Tl.aa.N.call(this),YS(this)},Tl.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var oy=a.JSON.stringify,tj=a.JSON.parse,nj=class{stringify(u){return a.JSON.stringify(u,void 0)}parse(u){return a.JSON.parse(u,void 0)}};function ay(){}ay.prototype.h=null;function JS(u){return u.h||(u.h=u.i())}function XS(){}var bl={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function cy(){$t.call(this,"d")}w(cy,$t);function ly(){$t.call(this,"c")}w(ly,$t);var Vs={},ZS=null;function Bh(){return ZS=ZS||new Ht}Vs.La="serverreachability";function eA(u){$t.call(this,Vs.La,u)}w(eA,$t);function Cl(u){let f=Bh();en(f,new eA(f))}Vs.STAT_EVENT="statevent";function tA(u,f){$t.call(this,Vs.STAT_EVENT,u),this.stat=f}w(tA,$t);function tn(u){let f=Bh();en(f,new tA(f,u))}Vs.Ma="timingevent";function nA(u,f){$t.call(this,Vs.Ma,u),this.size=f}w(nA,$t);function Dl(u,f){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){u()},f)}function Sl(){this.g=!0}Sl.prototype.xa=function(){this.g=!1};function rj(u,f,p,y,S,P){u.info(function(){if(u.g)if(P)for(var $="",Ve=P.split("&"),Lt=0;Lt<Ve.length;Lt++){var Ae=Ve[Lt].split("=");if(1<Ae.length){var qt=Ae[0];Ae=Ae[1];var zt=qt.split("_");$=2<=zt.length&&zt[1]=="type"?$+(qt+"="+Ae+"&"):$+(qt+"=redacted&")}}else $=null;else $=P;return"XMLHTTP REQ ("+y+") [attempt "+S+"]: "+f+`
`+p+`
`+$})}function ij(u,f,p,y,S,P,$){u.info(function(){return"XMLHTTP RESP ("+y+") [ attempt "+S+"]: "+f+`
`+p+`
`+P+" "+$})}function ia(u,f,p,y){u.info(function(){return"XMLHTTP TEXT ("+f+"): "+oj(u,p)+(y?" "+y:"")})}function sj(u,f){u.info(function(){return"TIMEOUT: "+f})}Sl.prototype.info=function(){};function oj(u,f){if(!u.g)return f;if(!f)return null;try{var p=JSON.parse(f);if(p){for(u=0;u<p.length;u++)if(Array.isArray(p[u])){var y=p[u];if(!(2>y.length)){var S=y[1];if(Array.isArray(S)&&!(1>S.length)){var P=S[0];if(P!="noop"&&P!="stop"&&P!="close")for(var $=1;$<S.length;$++)S[$]=""}}}}return oy(p)}catch{return f}}var $h={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},rA={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},uy;function Hh(){}w(Hh,ay),Hh.prototype.g=function(){return new XMLHttpRequest},Hh.prototype.i=function(){return{}},uy=new Hh;function Li(u,f,p,y){this.j=u,this.i=f,this.l=p,this.R=y||1,this.U=new Tl(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new iA}function iA(){this.i=null,this.g="",this.h=!1}var sA={},dy={};function hy(u,f,p){u.L=1,u.v=Gh(ci(f)),u.m=p,u.P=!0,oA(u,null)}function oA(u,f){u.F=Date.now(),qh(u),u.A=ci(u.v);var p=u.A,y=u.R;Array.isArray(y)||(y=[String(y)]),wA(p.i,"t",y),u.C=0,p=u.j.J,u.h=new iA,u.g=VA(u.j,p?f:null,!u.m),0<u.O&&(u.M=new ej(m(u.Y,u,u.g),u.O)),f=u.U,p=u.g,y=u.ca;var S="readystatechange";Array.isArray(S)||(S&&(QS[0]=S.toString()),S=QS);for(var P=0;P<S.length;P++){var $=$S(p,S[P],y||f.handleEvent,!1,f.h||f);if(!$)break;f.g[$.key]=$}f=u.H?v(u.H):{},u.m?(u.u||(u.u="POST"),f["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.A,u.u,u.m,f)):(u.u="GET",u.g.ea(u.A,u.u,null,f)),Cl(),rj(u.i,u.u,u.A,u.l,u.R,u.m)}Li.prototype.ca=function(u){u=u.target;let f=this.M;f&&li(u)==3?f.j():this.Y(u)},Li.prototype.Y=function(u){try{if(u==this.g)e:{let zt=li(this.g);var f=this.g.Ba();let aa=this.g.Z();if(!(3>zt)&&(zt!=3||this.g&&(this.h.h||this.g.oa()||SA(this.g)))){this.J||zt!=4||f==7||(f==8||0>=aa?Cl(3):Cl(2)),fy(this);var p=this.g.Z();this.X=p;t:if(aA(this)){var y=SA(this.g);u="";var S=y.length,P=li(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Us(this),Al(this);var $="";break t}this.h.i=new a.TextDecoder}for(f=0;f<S;f++)this.h.h=!0,u+=this.h.i.decode(y[f],{stream:!(P&&f==S-1)});y.length=0,this.h.g+=u,this.C=0,$=this.h.g}else $=this.g.oa();if(this.o=p==200,ij(this.i,this.u,this.A,this.l,this.R,zt,p),this.o){if(this.T&&!this.K){t:{if(this.g){var Ve,Lt=this.g;if((Ve=Lt.g?Lt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!H(Ve)){var Ae=Ve;break t}}Ae=null}if(p=Ae)ia(this.i,this.l,p,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,py(this,p);else{this.o=!1,this.s=3,tn(12),Us(this),Al(this);break e}}if(this.P){p=!0;let er;for(;!this.J&&this.C<$.length;)if(er=aj(this,$),er==dy){zt==4&&(this.s=4,tn(14),p=!1),ia(this.i,this.l,null,"[Incomplete Response]");break}else if(er==sA){this.s=4,tn(15),ia(this.i,this.l,$,"[Invalid Chunk]"),p=!1;break}else ia(this.i,this.l,er,null),py(this,er);if(aA(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),zt!=4||$.length!=0||this.h.h||(this.s=1,tn(16),p=!1),this.o=this.o&&p,!p)ia(this.i,this.l,$,"[Invalid Chunked Response]"),Us(this),Al(this);else if(0<$.length&&!this.W){this.W=!0;var qt=this.j;qt.g==this&&qt.ba&&!qt.M&&(qt.j.info("Great, no buffering proxy detected. Bytes received: "+$.length),wy(qt),qt.M=!0,tn(11))}}else ia(this.i,this.l,$,null),py(this,$);zt==4&&Us(this),this.o&&!this.J&&(zt==4?kA(this.j,this):(this.o=!1,qh(this)))}else bj(this.g),p==400&&0<$.indexOf("Unknown SID")?(this.s=3,tn(12)):(this.s=0,tn(13)),Us(this),Al(this)}}}catch{}finally{}};function aA(u){return u.g?u.u=="GET"&&u.L!=2&&u.j.Ca:!1}function aj(u,f){var p=u.C,y=f.indexOf(`
`,p);return y==-1?dy:(p=Number(f.substring(p,y)),isNaN(p)?sA:(y+=1,y+p>f.length?dy:(f=f.slice(y,y+p),u.C=y+p,f)))}Li.prototype.cancel=function(){this.J=!0,Us(this)};function qh(u){u.S=Date.now()+u.I,cA(u,u.I)}function cA(u,f){if(u.B!=null)throw Error("WatchDog timer not null");u.B=Dl(m(u.ba,u),f)}function fy(u){u.B&&(a.clearTimeout(u.B),u.B=null)}Li.prototype.ba=function(){this.B=null;let u=Date.now();0<=u-this.S?(sj(this.i,this.A),this.L!=2&&(Cl(),tn(17)),Us(this),this.s=2,Al(this)):cA(this,this.S-u)};function Al(u){u.j.G==0||u.J||kA(u.j,u)}function Us(u){fy(u);var f=u.M;f&&typeof f.ma=="function"&&f.ma(),u.M=null,YS(u.U),u.g&&(f=u.g,u.g=null,f.abort(),f.ma())}function py(u,f){try{var p=u.j;if(p.G!=0&&(p.g==u||my(p.h,u))){if(!u.K&&my(p.h,u)&&p.G==3){try{var y=p.Da.g.parse(f)}catch{y=null}if(Array.isArray(y)&&y.length==3){var S=y;if(S[0]==0){e:if(!p.u){if(p.g)if(p.g.F+3e3<u.F)Xh(p),Yh(p);else break e;vy(p),tn(18)}}else p.za=S[1],0<p.za-p.T&&37500>S[2]&&p.F&&p.v==0&&!p.C&&(p.C=Dl(m(p.Za,p),6e3));if(1>=dA(p.h)&&p.ca){try{p.ca()}catch{}p.ca=void 0}}else Bs(p,11)}else if((u.K||p.g==u)&&Xh(p),!H(f))for(S=p.Da.g.parse(f),f=0;f<S.length;f++){let Ae=S[f];if(p.T=Ae[0],Ae=Ae[1],p.G==2)if(Ae[0]=="c"){p.K=Ae[1],p.ia=Ae[2];let qt=Ae[3];qt!=null&&(p.la=qt,p.j.info("VER="+p.la));let zt=Ae[4];zt!=null&&(p.Aa=zt,p.j.info("SVER="+p.Aa));let aa=Ae[5];aa!=null&&typeof aa=="number"&&0<aa&&(y=1.5*aa,p.L=y,p.j.info("backChannelRequestTimeoutMs_="+y)),y=p;let er=u.g;if(er){let ef=er.g?er.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ef){var P=y.h;P.g||ef.indexOf("spdy")==-1&&ef.indexOf("quic")==-1&&ef.indexOf("h2")==-1||(P.j=P.l,P.g=new Set,P.h&&(gy(P,P.h),P.h=null))}if(y.D){let Iy=er.g?er.g.getResponseHeader("X-HTTP-Session-Id"):null;Iy&&(y.ya=Iy,We(y.I,y.D,Iy))}}p.G=3,p.l&&p.l.ua(),p.ba&&(p.R=Date.now()-u.F,p.j.info("Handshake RTT: "+p.R+"ms")),y=p;var $=u;if(y.qa=FA(y,y.J?y.ia:null,y.W),$.K){hA(y.h,$);var Ve=$,Lt=y.L;Lt&&(Ve.I=Lt),Ve.B&&(fy(Ve),qh(Ve)),y.g=$}else PA(y);0<p.i.length&&Jh(p)}else Ae[0]!="stop"&&Ae[0]!="close"||Bs(p,7);else p.G==3&&(Ae[0]=="stop"||Ae[0]=="close"?Ae[0]=="stop"?Bs(p,7):yy(p):Ae[0]!="noop"&&p.l&&p.l.ta(Ae),p.v=0)}}Cl(4)}catch{}}var cj=class{constructor(u,f){this.g=u,this.map=f}};function lA(u){this.l=u||10,a.PerformanceNavigationTiming?(u=a.performance.getEntriesByType("navigation"),u=0<u.length&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function uA(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function dA(u){return u.h?1:u.g?u.g.size:0}function my(u,f){return u.h?u.h==f:u.g?u.g.has(f):!1}function gy(u,f){u.g?u.g.add(f):u.h=f}function hA(u,f){u.h&&u.h==f?u.h=null:u.g&&u.g.has(f)&&u.g.delete(f)}lA.prototype.cancel=function(){if(this.i=fA(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let u of this.g.values())u.cancel();this.g.clear()}};function fA(u){if(u.h!=null)return u.i.concat(u.h.D);if(u.g!=null&&u.g.size!==0){let f=u.i;for(let p of u.g.values())f=f.concat(p.D);return f}return C(u.i)}function lj(u){if(u.V&&typeof u.V=="function")return u.V();if(typeof Map<"u"&&u instanceof Map||typeof Set<"u"&&u instanceof Set)return Array.from(u.values());if(typeof u=="string")return u.split("");if(c(u)){for(var f=[],p=u.length,y=0;y<p;y++)f.push(u[y]);return f}f=[],p=0;for(y in u)f[p++]=u[y];return f}function uj(u){if(u.na&&typeof u.na=="function")return u.na();if(!u.V||typeof u.V!="function"){if(typeof Map<"u"&&u instanceof Map)return Array.from(u.keys());if(!(typeof Set<"u"&&u instanceof Set)){if(c(u)||typeof u=="string"){var f=[];u=u.length;for(var p=0;p<u;p++)f.push(p);return f}f=[],p=0;for(let y in u)f[p++]=y;return f}}}function pA(u,f){if(u.forEach&&typeof u.forEach=="function")u.forEach(f,void 0);else if(c(u)||typeof u=="string")Array.prototype.forEach.call(u,f,void 0);else for(var p=uj(u),y=lj(u),S=y.length,P=0;P<S;P++)f.call(void 0,y[P],p&&p[P],u)}var mA=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function dj(u,f){if(u){u=u.split("&");for(var p=0;p<u.length;p++){var y=u[p].indexOf("="),S=null;if(0<=y){var P=u[p].substring(0,y);S=u[p].substring(y+1)}else P=u[p];f(P,S?decodeURIComponent(S.replace(/\+/g," ")):"")}}}function js(u){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,u instanceof js){this.h=u.h,zh(this,u.j),this.o=u.o,this.g=u.g,Wh(this,u.s),this.l=u.l;var f=u.i,p=new Nl;p.i=f.i,f.g&&(p.g=new Map(f.g),p.h=f.h),gA(this,p),this.m=u.m}else u&&(f=String(u).match(mA))?(this.h=!1,zh(this,f[1]||"",!0),this.o=Rl(f[2]||""),this.g=Rl(f[3]||"",!0),Wh(this,f[4]),this.l=Rl(f[5]||"",!0),gA(this,f[6]||"",!0),this.m=Rl(f[7]||"")):(this.h=!1,this.i=new Nl(null,this.h))}js.prototype.toString=function(){var u=[],f=this.j;f&&u.push(xl(f,_A,!0),":");var p=this.g;return(p||f=="file")&&(u.push("//"),(f=this.o)&&u.push(xl(f,_A,!0),"@"),u.push(encodeURIComponent(String(p)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p=this.s,p!=null&&u.push(":",String(p))),(p=this.l)&&(this.g&&p.charAt(0)!="/"&&u.push("/"),u.push(xl(p,p.charAt(0)=="/"?pj:fj,!0))),(p=this.i.toString())&&u.push("?",p),(p=this.m)&&u.push("#",xl(p,gj)),u.join("")};function ci(u){return new js(u)}function zh(u,f,p){u.j=p?Rl(f,!0):f,u.j&&(u.j=u.j.replace(/:$/,""))}function Wh(u,f){if(f){if(f=Number(f),isNaN(f)||0>f)throw Error("Bad port number "+f);u.s=f}else u.s=null}function gA(u,f,p){f instanceof Nl?(u.i=f,_j(u.i,u.h)):(p||(f=xl(f,mj)),u.i=new Nl(f,u.h))}function We(u,f,p){u.i.set(f,p)}function Gh(u){return We(u,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),u}function Rl(u,f){return u?f?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function xl(u,f,p){return typeof u=="string"?(u=encodeURI(u).replace(f,hj),p&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function hj(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var _A=/[#\/\?@]/g,fj=/[#\?:]/g,pj=/[#\?]/g,mj=/[#\?@]/g,gj=/#/g;function Nl(u,f){this.h=this.g=null,this.i=u||null,this.j=!!f}function Fi(u){u.g||(u.g=new Map,u.h=0,u.i&&dj(u.i,function(f,p){u.add(decodeURIComponent(f.replace(/\+/g," ")),p)}))}n=Nl.prototype,n.add=function(u,f){Fi(this),this.i=null,u=sa(this,u);var p=this.g.get(u);return p||this.g.set(u,p=[]),p.push(f),this.h+=1,this};function yA(u,f){Fi(u),f=sa(u,f),u.g.has(f)&&(u.i=null,u.h-=u.g.get(f).length,u.g.delete(f))}function vA(u,f){return Fi(u),f=sa(u,f),u.g.has(f)}n.forEach=function(u,f){Fi(this),this.g.forEach(function(p,y){p.forEach(function(S){u.call(f,S,y,this)},this)},this)},n.na=function(){Fi(this);let u=Array.from(this.g.values()),f=Array.from(this.g.keys()),p=[];for(let y=0;y<f.length;y++){let S=u[y];for(let P=0;P<S.length;P++)p.push(f[y])}return p},n.V=function(u){Fi(this);let f=[];if(typeof u=="string")vA(this,u)&&(f=f.concat(this.g.get(sa(this,u))));else{u=Array.from(this.g.values());for(let p=0;p<u.length;p++)f=f.concat(u[p])}return f},n.set=function(u,f){return Fi(this),this.i=null,u=sa(this,u),vA(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[f]),this.h+=1,this},n.get=function(u,f){return u?(u=this.V(u),0<u.length?String(u[0]):f):f};function wA(u,f,p){yA(u,f),0<p.length&&(u.i=null,u.g.set(sa(u,f),C(p)),u.h+=p.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let u=[],f=Array.from(this.g.keys());for(var p=0;p<f.length;p++){var y=f[p];let P=encodeURIComponent(String(y)),$=this.V(y);for(y=0;y<$.length;y++){var S=P;$[y]!==""&&(S+="="+encodeURIComponent(String($[y]))),u.push(S)}}return this.i=u.join("&")};function sa(u,f){return f=String(f),u.j&&(f=f.toLowerCase()),f}function _j(u,f){f&&!u.j&&(Fi(u),u.i=null,u.g.forEach(function(p,y){var S=y.toLowerCase();y!=S&&(yA(this,y),wA(this,S,p))},u)),u.j=f}function yj(u,f){let p=new Sl;if(a.Image){let y=new Image;y.onload=_(Vi,p,"TestLoadImage: loaded",!0,f,y),y.onerror=_(Vi,p,"TestLoadImage: error",!1,f,y),y.onabort=_(Vi,p,"TestLoadImage: abort",!1,f,y),y.ontimeout=_(Vi,p,"TestLoadImage: timeout",!1,f,y),a.setTimeout(function(){y.ontimeout&&y.ontimeout()},1e4),y.src=u}else f(!1)}function vj(u,f){let p=new Sl,y=new AbortController,S=setTimeout(()=>{y.abort(),Vi(p,"TestPingServer: timeout",!1,f)},1e4);fetch(u,{signal:y.signal}).then(P=>{clearTimeout(S),P.ok?Vi(p,"TestPingServer: ok",!0,f):Vi(p,"TestPingServer: server error",!1,f)}).catch(()=>{clearTimeout(S),Vi(p,"TestPingServer: error",!1,f)})}function Vi(u,f,p,y,S){try{S&&(S.onload=null,S.onerror=null,S.onabort=null,S.ontimeout=null),y(p)}catch{}}function wj(){this.g=new nj}function Ij(u,f,p){let y=p||"";try{pA(u,function(S,P){let $=S;l(S)&&($=oy(S)),f.push(y+P+"="+encodeURIComponent($))})}catch(S){throw f.push(y+"type="+encodeURIComponent("_badmap")),S}}function Pl(u){this.l=u.Ub||null,this.j=u.eb||!1}w(Pl,ay),Pl.prototype.g=function(){return new Kh(this.l,this.j)},Pl.prototype.i=function(u){return function(){return u}}({});function Kh(u,f){Ht.call(this),this.D=u,this.o=f,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}w(Kh,Ht),n=Kh.prototype,n.open=function(u,f){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=u,this.A=f,this.readyState=1,kl(this)},n.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let f={headers:this.u,method:this.B,credentials:this.m,cache:void 0};u&&(f.body=u),(this.D||a).fetch(new Request(this.A,f)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ml(this)),this.readyState=0},n.Sa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,kl(this)),this.g&&(this.readyState=3,kl(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;IA(this)}else u.text().then(this.Ra.bind(this),this.ga.bind(this))};function IA(u){u.j.read().then(u.Pa.bind(u)).catch(u.ga.bind(u))}n.Pa=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var f=u.value?u.value:new Uint8Array(0);(f=this.v.decode(f,{stream:!u.done}))&&(this.response=this.responseText+=f)}u.done?Ml(this):kl(this),this.readyState==3&&IA(this)}},n.Ra=function(u){this.g&&(this.response=this.responseText=u,Ml(this))},n.Qa=function(u){this.g&&(this.response=u,Ml(this))},n.ga=function(){this.g&&Ml(this)};function Ml(u){u.readyState=4,u.l=null,u.j=null,u.v=null,kl(u)}n.setRequestHeader=function(u,f){this.u.append(u,f)},n.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let u=[],f=this.h.entries();for(var p=f.next();!p.done;)p=p.value,u.push(p[0]+": "+p[1]),p=f.next();return u.join(`\r
`)};function kl(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(Kh.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function EA(u){let f="";return J(u,function(p,y){f+=y,f+=":",f+=p,f+=`\r
`}),f}function _y(u,f,p){e:{for(y in p){var y=!1;break e}y=!0}y||(p=EA(p),typeof u=="string"?p!=null&&encodeURIComponent(String(p)):We(u,f,p))}function rt(u){Ht.call(this),this.headers=new Map,this.o=u||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}w(rt,Ht);var Ej=/^https?$/i,Tj=["POST","PUT"];n=rt.prototype,n.Ha=function(u){this.J=u},n.ea=function(u,f,p,y){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);f=f?f.toUpperCase():"GET",this.D=u,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():uy.g(),this.v=this.o?JS(this.o):JS(uy),this.g.onreadystatechange=m(this.Ea,this);try{this.B=!0,this.g.open(f,String(u),!0),this.B=!1}catch(P){TA(this,P);return}if(u=p||"",p=new Map(this.headers),y)if(Object.getPrototypeOf(y)===Object.prototype)for(var S in y)p.set(S,y[S]);else if(typeof y.keys=="function"&&typeof y.get=="function")for(let P of y.keys())p.set(P,y.get(P));else throw Error("Unknown input type for opt_headers: "+String(y));y=Array.from(p.keys()).find(P=>P.toLowerCase()=="content-type"),S=a.FormData&&u instanceof a.FormData,!(0<=Array.prototype.indexOf.call(Tj,f,void 0))||y||S||p.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[P,$]of p)this.g.setRequestHeader(P,$);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{DA(this),this.u=!0,this.g.send(u),this.u=!1}catch(P){TA(this,P)}};function TA(u,f){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=f,u.m=5,bA(u),Qh(u)}function bA(u){u.A||(u.A=!0,en(u,"complete"),en(u,"error"))}n.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=u||7,en(this,"complete"),en(this,"abort"),Qh(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Qh(this,!0)),rt.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?CA(this):this.bb())},n.bb=function(){CA(this)};function CA(u){if(u.h&&typeof o<"u"&&(!u.v[1]||li(u)!=4||u.Z()!=2)){if(u.u&&li(u)==4)GS(u.Ea,0,u);else if(en(u,"readystatechange"),li(u)==4){u.h=!1;try{let $=u.Z();e:switch($){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var f=!0;break e;default:f=!1}var p;if(!(p=f)){var y;if(y=$===0){var S=String(u.D).match(mA)[1]||null;!S&&a.self&&a.self.location&&(S=a.self.location.protocol.slice(0,-1)),y=!Ej.test(S?S.toLowerCase():"")}p=y}if(p)en(u,"complete"),en(u,"success");else{u.m=6;try{var P=2<li(u)?u.g.statusText:""}catch{P=""}u.l=P+" ["+u.Z()+"]",bA(u)}}finally{Qh(u)}}}}function Qh(u,f){if(u.g){DA(u);let p=u.g,y=u.v[0]?()=>{}:null;u.g=null,u.v=null,f||en(u,"ready");try{p.onreadystatechange=y}catch{}}}function DA(u){u.I&&(a.clearTimeout(u.I),u.I=null)}n.isActive=function(){return!!this.g};function li(u){return u.g?u.g.readyState:0}n.Z=function(){try{return 2<li(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(u){if(this.g){var f=this.g.responseText;return u&&f.indexOf(u)==0&&(f=f.substring(u.length)),tj(f)}};function SA(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.H){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function bj(u){let f={};u=(u.g&&2<=li(u)&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let y=0;y<u.length;y++){if(H(u[y]))continue;var p=D(u[y]);let S=p[0];if(p=p[1],typeof p!="string")continue;p=p.trim();let P=f[S]||[];f[S]=P,P.push(p)}T(f,function(y){return y.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ol(u,f,p){return p&&p.internalChannelParams&&p.internalChannelParams[u]||f}function AA(u){this.Aa=0,this.i=[],this.j=new Sl,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Ol("failFast",!1,u),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Ol("baseRetryDelayMs",5e3,u),this.cb=Ol("retryDelaySeedMs",1e4,u),this.Wa=Ol("forwardChannelMaxRetries",2,u),this.wa=Ol("forwardChannelRequestTimeoutMs",2e4,u),this.pa=u&&u.xmlHttpFactory||void 0,this.Xa=u&&u.Tb||void 0,this.Ca=u&&u.useFetchStreams||!1,this.L=void 0,this.J=u&&u.supportsCrossDomainXhr||!1,this.K="",this.h=new lA(u&&u.concurrentRequestLimit),this.Da=new wj,this.P=u&&u.fastHandshake||!1,this.O=u&&u.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=u&&u.Rb||!1,u&&u.xa&&this.j.xa(),u&&u.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&u&&u.detectBufferingProxy||!1,this.ja=void 0,u&&u.longPollingTimeout&&0<u.longPollingTimeout&&(this.ja=u.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=AA.prototype,n.la=8,n.G=1,n.connect=function(u,f,p,y){tn(0),this.W=u,this.H=f||{},p&&y!==void 0&&(this.H.OSID=p,this.H.OAID=y),this.F=this.X,this.I=FA(this,null,this.W),Jh(this)};function yy(u){if(RA(u),u.G==3){var f=u.U++,p=ci(u.I);if(We(p,"SID",u.K),We(p,"RID",f),We(p,"TYPE","terminate"),Ll(u,p),f=new Li(u,u.j,f),f.L=2,f.v=Gh(ci(p)),p=!1,a.navigator&&a.navigator.sendBeacon)try{p=a.navigator.sendBeacon(f.v.toString(),"")}catch{}!p&&a.Image&&(new Image().src=f.v,p=!0),p||(f.g=VA(f.j,null),f.g.ea(f.v)),f.F=Date.now(),qh(f)}LA(u)}function Yh(u){u.g&&(wy(u),u.g.cancel(),u.g=null)}function RA(u){Yh(u),u.u&&(a.clearTimeout(u.u),u.u=null),Xh(u),u.h.cancel(),u.s&&(typeof u.s=="number"&&a.clearTimeout(u.s),u.s=null)}function Jh(u){if(!uA(u.h)&&!u.s){u.s=!0;var f=u.Ga;vl||BS(),wl||(vl(),wl=!0),J_.add(f,u),u.B=0}}function Cj(u,f){return dA(u.h)>=u.h.j-(u.s?1:0)?!1:u.s?(u.i=f.D.concat(u.i),!0):u.G==1||u.G==2||u.B>=(u.Va?0:u.Wa)?!1:(u.s=Dl(m(u.Ga,u,f),OA(u,u.B)),u.B++,!0)}n.Ga=function(u){if(this.s)if(this.s=null,this.G==1){if(!u){this.U=Math.floor(1e5*Math.random()),u=this.U++;let S=new Li(this,this.j,u),P=this.o;if(this.S&&(P?(P=v(P),b(P,this.S)):P=this.S),this.m!==null||this.O||(S.H=P,P=null),this.P)e:{for(var f=0,p=0;p<this.i.length;p++){t:{var y=this.i[p];if("__data__"in y.map&&(y=y.map.__data__,typeof y=="string")){y=y.length;break t}y=void 0}if(y===void 0)break;if(f+=y,4096<f){f=p;break e}if(f===4096||p===this.i.length-1){f=p+1;break e}}f=1e3}else f=1e3;f=NA(this,S,f),p=ci(this.I),We(p,"RID",u),We(p,"CVER",22),this.D&&We(p,"X-HTTP-Session-Id",this.D),Ll(this,p),P&&(this.O?f="headers="+encodeURIComponent(String(EA(P)))+"&"+f:this.m&&_y(p,this.m,P)),gy(this.h,S),this.Ua&&We(p,"TYPE","init"),this.P?(We(p,"$req",f),We(p,"SID","null"),S.T=!0,hy(S,p,null)):hy(S,p,f),this.G=2}}else this.G==3&&(u?xA(this,u):this.i.length==0||uA(this.h)||xA(this))};function xA(u,f){var p;f?p=f.l:p=u.U++;let y=ci(u.I);We(y,"SID",u.K),We(y,"RID",p),We(y,"AID",u.T),Ll(u,y),u.m&&u.o&&_y(y,u.m,u.o),p=new Li(u,u.j,p,u.B+1),u.m===null&&(p.H=u.o),f&&(u.i=f.D.concat(u.i)),f=NA(u,p,1e3),p.I=Math.round(.5*u.wa)+Math.round(.5*u.wa*Math.random()),gy(u.h,p),hy(p,y,f)}function Ll(u,f){u.H&&J(u.H,function(p,y){We(f,y,p)}),u.l&&pA({},function(p,y){We(f,y,p)})}function NA(u,f,p){p=Math.min(u.i.length,p);var y=u.l?m(u.l.Na,u.l,u):null;e:{var S=u.i;let P=-1;for(;;){let $=["count="+p];P==-1?0<p?(P=S[0].g,$.push("ofs="+P)):P=0:$.push("ofs="+P);let Ve=!0;for(let Lt=0;Lt<p;Lt++){let Ae=S[Lt].g,qt=S[Lt].map;if(Ae-=P,0>Ae)P=Math.max(0,S[Lt].g-100),Ve=!1;else try{Ij(qt,$,"req"+Ae+"_")}catch{y&&y(qt)}}if(Ve){y=$.join("&");break e}}}return u=u.i.splice(0,p),f.D=u,y}function PA(u){if(!u.g&&!u.u){u.Y=1;var f=u.Fa;vl||BS(),wl||(vl(),wl=!0),J_.add(f,u),u.v=0}}function vy(u){return u.g||u.u||3<=u.v?!1:(u.Y++,u.u=Dl(m(u.Fa,u),OA(u,u.v)),u.v++,!0)}n.Fa=function(){if(this.u=null,MA(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var u=2*this.R;this.j.info("BP detection timer enabled: "+u),this.A=Dl(m(this.ab,this),u)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,tn(10),Yh(this),MA(this))};function wy(u){u.A!=null&&(a.clearTimeout(u.A),u.A=null)}function MA(u){u.g=new Li(u,u.j,"rpc",u.Y),u.m===null&&(u.g.H=u.o),u.g.O=0;var f=ci(u.qa);We(f,"RID","rpc"),We(f,"SID",u.K),We(f,"AID",u.T),We(f,"CI",u.F?"0":"1"),!u.F&&u.ja&&We(f,"TO",u.ja),We(f,"TYPE","xmlhttp"),Ll(u,f),u.m&&u.o&&_y(f,u.m,u.o),u.L&&(u.g.I=u.L);var p=u.g;u=u.ia,p.L=1,p.v=Gh(ci(f)),p.m=null,p.P=!0,oA(p,u)}n.Za=function(){this.C!=null&&(this.C=null,Yh(this),vy(this),tn(19))};function Xh(u){u.C!=null&&(a.clearTimeout(u.C),u.C=null)}function kA(u,f){var p=null;if(u.g==f){Xh(u),wy(u),u.g=null;var y=2}else if(my(u.h,f))p=f.D,hA(u.h,f),y=1;else return;if(u.G!=0){if(f.o)if(y==1){p=f.m?f.m.length:0,f=Date.now()-f.F;var S=u.B;y=Bh(),en(y,new nA(y,p)),Jh(u)}else PA(u);else if(S=f.s,S==3||S==0&&0<f.X||!(y==1&&Cj(u,f)||y==2&&vy(u)))switch(p&&0<p.length&&(f=u.h,f.i=f.i.concat(p)),S){case 1:Bs(u,5);break;case 4:Bs(u,10);break;case 3:Bs(u,6);break;default:Bs(u,2)}}}function OA(u,f){let p=u.Ta+Math.floor(Math.random()*u.cb);return u.isActive()||(p*=2),p*f}function Bs(u,f){if(u.j.info("Error code "+f),f==2){var p=m(u.fb,u),y=u.Xa;let S=!y;y=new js(y||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||zh(y,"https"),Gh(y),S?yj(y.toString(),p):vj(y.toString(),p)}else tn(2);u.G=0,u.l&&u.l.sa(f),LA(u),RA(u)}n.fb=function(u){u?(this.j.info("Successfully pinged google.com"),tn(2)):(this.j.info("Failed to ping google.com"),tn(1))};function LA(u){if(u.G=0,u.ka=[],u.l){let f=fA(u.h);(f.length!=0||u.i.length!=0)&&(A(u.ka,f),A(u.ka,u.i),u.h.i.length=0,C(u.i),u.i.length=0),u.l.ra()}}function FA(u,f,p){var y=p instanceof js?ci(p):new js(p);if(y.g!="")f&&(y.g=f+"."+y.g),Wh(y,y.s);else{var S=a.location;y=S.protocol,f=f?f+"."+S.hostname:S.hostname,S=+S.port;var P=new js(null);y&&zh(P,y),f&&(P.g=f),S&&Wh(P,S),p&&(P.l=p),y=P}return p=u.D,f=u.ya,p&&f&&We(y,p,f),We(y,"VER",u.la),Ll(u,y),y}function VA(u,f,p){if(f&&!u.J)throw Error("Can't create secondary domain capable XhrIo object.");return f=u.Ca&&!u.pa?new rt(new Pl({eb:p})):new rt(u.pa),f.Ha(u.J),f}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function UA(){}n=UA.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Zh(){}Zh.prototype.g=function(u,f){return new En(u,f)};function En(u,f){Ht.call(this),this.g=new AA(f),this.l=u,this.h=f&&f.messageUrlParams||null,u=f&&f.messageHeaders||null,f&&f.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=f&&f.initMessageHeaders||null,f&&f.messageContentType&&(u?u["X-WebChannel-Content-Type"]=f.messageContentType:u={"X-WebChannel-Content-Type":f.messageContentType}),f&&f.va&&(u?u["X-WebChannel-Client-Profile"]=f.va:u={"X-WebChannel-Client-Profile":f.va}),this.g.S=u,(u=f&&f.Sb)&&!H(u)&&(this.g.m=u),this.v=f&&f.supportsCrossDomainXhr||!1,this.u=f&&f.sendRawJson||!1,(f=f&&f.httpSessionIdParam)&&!H(f)&&(this.g.D=f,u=this.h,u!==null&&f in u&&(u=this.h,f in u&&delete u[f])),this.j=new oa(this)}w(En,Ht),En.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},En.prototype.close=function(){yy(this.g)},En.prototype.o=function(u){var f=this.g;if(typeof u=="string"){var p={};p.__data__=u,u=p}else this.u&&(p={},p.__data__=oy(u),u=p);f.i.push(new cj(f.Ya++,u)),f.G==3&&Jh(f)},En.prototype.N=function(){this.g.l=null,delete this.j,yy(this.g),delete this.g,En.aa.N.call(this)};function jA(u){cy.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var f=u.__sm__;if(f){e:{for(let p in f){u=p;break e}u=void 0}(this.i=u)&&(u=this.i,f=f!==null&&u in f?f[u]:void 0),this.data=f}else this.data=u}w(jA,cy);function BA(){ly.call(this),this.status=1}w(BA,ly);function oa(u){this.g=u}w(oa,UA),oa.prototype.ua=function(){en(this.g,"a")},oa.prototype.ta=function(u){en(this.g,new jA(u))},oa.prototype.sa=function(u){en(this.g,new BA)},oa.prototype.ra=function(){en(this.g,"b")},Zh.prototype.createWebChannel=Zh.prototype.g,En.prototype.send=En.prototype.o,En.prototype.open=En.prototype.m,En.prototype.close=En.prototype.close,MT=Ti.createWebChannelTransport=function(){return new Zh},PT=Ti.getStatEventTarget=function(){return Bh()},NT=Ti.Event=Vs,xm=Ti.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},$h.NO_ERROR=0,$h.TIMEOUT=8,$h.HTTP_ERROR=6,hd=Ti.ErrorCode=$h,rA.COMPLETE="complete",xT=Ti.EventType=rA,XS.EventType=bl,bl.OPEN="a",bl.CLOSE="b",bl.ERROR="c",bl.MESSAGE="d",Ht.prototype.listen=Ht.prototype.K,oc=Ti.WebChannel=XS,RT=Ti.FetchXmlHttpFactory=Pl,rt.prototype.listenOnce=rt.prototype.L,rt.prototype.getLastError=rt.prototype.Ka,rt.prototype.getLastErrorCode=rt.prototype.Ba,rt.prototype.getStatus=rt.prototype.Z,rt.prototype.getResponseJson=rt.prototype.Oa,rt.prototype.getResponseText=rt.prototype.oa,rt.prototype.send=rt.prototype.ea,rt.prototype.setWithCredentials=rt.prototype.Ha,AT=Ti.XhrIo=rt}).apply(typeof Rm<"u"?Rm:typeof self<"u"?self:typeof window<"u"?window:{});var fO="@firebase/firestore";var Et=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Et.UNAUTHENTICATED=new Et(null),Et.GOOGLE_CREDENTIALS=new Et("google-credentials-uid"),Et.FIRST_PARTY=new Et("first-party-uid"),Et.MOCK_USER=new Et("mock-user");var Fc="10.13.1";var ms=new vn("@firebase/firestore");function dc(){return ms.logLevel}function g1(n){ms.setLogLevel(n)}function V(n,...e){if(ms.logLevel<=me.DEBUG){let t=e.map(V0);ms.debug(`Firestore (${Fc}): ${n}`,...t)}}function dt(n,...e){if(ms.logLevel<=me.ERROR){let t=e.map(V0);ms.error(`Firestore (${Fc}): ${n}`,...t)}}function Kn(n,...e){if(ms.logLevel<=me.WARN){let t=e.map(V0);ms.warn(`Firestore (${Fc}): ${n}`,...t)}}function V0(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function Y(n="Unexpected state"){let e=`FIRESTORE (${Fc}) INTERNAL ASSERTION FAILED: `+n;throw dt(e),new Error(e)}function Z(n,e){n||Y()}function _1(n,e){n||Y()}function z(n,e){return n}var N={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},O=class extends st{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var Tt=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var Bm=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},VT=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Et.UNAUTHENTICATED))}shutdown(){}},UT=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},jT=class{constructor(e){this.t=e,this.currentUser=Et.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let r=this.i,i=c=>this.i!==r?(r=this.i,t(c)):Promise.resolve(),s=new Tt;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Tt,e.enqueueRetryable(()=>i(this.currentUser))};let o=()=>{let c=s;e.enqueueRetryable(()=>g(this,null,function*(){yield c.promise,yield i(this.currentUser)}))},a=c=>{V("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){let c=this.t.getImmediate({optional:!0});c?a(c):(V("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Tt)}},0),o()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(V("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Z(typeof r.accessToken=="string"),new Bm(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){let e=this.auth&&this.auth.getUid();return Z(e===null||typeof e=="string"),new Et(e)}},BT=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=Et.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},$T=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new BT(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(Et.FIRST_PARTY))}shutdown(){}invalidateToken(){}},HT=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},qT=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){let r=s=>{s.error!=null&&V("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.R;return this.R=s.token,V("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{V("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.A.getImmediate({optional:!0});s?i(s):V("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Z(typeof t.token=="string"),this.R=t.token,new HT(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}};function m5(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}var $m=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let i=m5(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%e.length))}return r}};function ae(n,e){return n<e?-1:n>e?1:0}function wc(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}function y1(n){return n+"\0"}var et=class n{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new O(N.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new O(N.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new O(N.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new O(N.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new n(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?ae(this.nanoseconds,e.nanoseconds):ae(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var ee=class n{constructor(e){this.timestamp=e}static fromTimestamp(e){return new n(e)}static min(){return new n(new et(0,0))}static max(){return new n(new et(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var Hm=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&Y(),r===void 0?r=e.length-t:r>e.length-t&&Y(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let s=e.get(i),o=t.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}},De=class n extends Hm{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new O(N.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},g5=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ht=class n extends Hm{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return g5.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new n(["__name__"])}static fromServerFormat(e){let t=[],r="",i=0,s=()=>{if(r.length===0)throw new O(N.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},o=!1;for(;i<e.length;){let a=e[i];if(a==="\\"){if(i+1===e.length)throw new O(N.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new O(N.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new O(N.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var W=class n{constructor(e){this.path=e}static fromPath(e){return new n(De.fromString(e))}static fromName(e){return new n(De.fromString(e).popFirst(5))}static empty(){return new n(De.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&De.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return De.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new De(e.slice()))}};var Ic=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};function zT(n){return n.fields.find(e=>e.kind===2)}function Eo(n){return n.fields.filter(e=>e.kind!==2)}Ic.UNKNOWN_ID=-1;var _c=class{constructor(e,t){this.fieldPath=e,this.kind=t}};var bd=class n{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new n(0,Qn.min())}};function v1(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=ee.fromTimestamp(r===1e9?new et(t+1,0):new et(t,r));return new Qn(i,W.empty(),e)}function w1(n){return new Qn(n.readTime,n.key,-1)}var Qn=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(ee.min(),W.empty(),-1)}static max(){return new n(ee.max(),W.empty(),-1)}};function U0(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=W.comparator(n.documentKey,e.documentKey),t!==0?t:ae(n.largestBatchId,e.largestBatchId))}var I1="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",qm=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function Cs(n){return g(this,null,function*(){if(n.code!==N.FAILED_PRECONDITION||n.message!==I1)throw n;V("LocalStore","Unexpectedly lost primary lease")})}var x=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Y(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&t()},c=>r(c))}),o=!0,s===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let s=e.length,o=new Array(s),a=0;for(let c=0;c<s;c++){let l=c;t(e[l]).next(d=>{o[l]=d,++a,a===s&&r(o)},d=>i(d))}})}static doWhile(e,t){return new n((r,i)=>{let s=()=>{e()===!0?t().next(()=>{s()},i):r()};s()})}};var zm=class n{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new Tt,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new Ao(e,t.error)):this.V.resolve()},this.transaction.onerror=r=>{let i=j0(r.target.error);this.V.reject(new Ao(e,i))}}static open(e,t,r,i){try{return new n(t,e.transaction(i,r))}catch(s){throw new Ao(t,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(V("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){let e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){let t=this.transaction.objectStore(e);return new GT(t)}},gs=class n{constructor(e,t,r){this.name=e,this.version=t,this.p=r,n.S(He())===12.2&&dt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return V("SimpleDb","Removing database:",e),To(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!Ji())return!1;if(n.v())return!0;let e=He(),t=n.S(e),r=0<t&&t<10,i=E1(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static v(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.C)==="YES"}static F(e,t){return e.store(t)}static S(e){let t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}M(e){return g(this,null,function*(){return this.db||(V("SimpleDb","Opening database:",this.name),this.db=yield new Promise((t,r)=>{let i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{let o=s.target.result;t(o)},i.onblocked=()=>{r(new Ao(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{let o=s.target.error;o.name==="VersionError"?r(new O(N.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new O(N.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new Ao(e,o))},i.onupgradeneeded=s=>{V("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);let o=s.target.result;this.p.O(o,i.transaction,s.oldVersion,this.version).next(()=>{V("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=t=>this.N(t)),this.db})}L(e){this.N=e,this.db&&(this.db.onversionchange=t=>e(t))}runTransaction(e,t,r,i){return g(this,null,function*(){let s=t==="readonly",o=0;for(;;){++o;try{this.db=yield this.M(e);let a=zm.open(this.db,e,s?"readonly":"readwrite",r),c=i(a).next(l=>(a.g(),l)).catch(l=>(a.abort(l),x.reject(l))).toPromise();return c.catch(()=>{}),yield a.m,c}catch(a){let c=a,l=c.name!=="FirebaseError"&&o<3;if(V("SimpleDb","Transaction failed with error:",c.message,"Retrying:",l),this.close(),!l)return Promise.reject(c)}}})}close(){this.db&&this.db.close(),this.db=void 0}};function E1(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}var WT=class{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return To(this.B.delete())}},Ao=class extends O{constructor(e,t){super(N.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}};function Ds(n){return n.name==="IndexedDbTransactionError"}var GT=class{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(V("SimpleDb","PUT",this.store.name,e,t),r=this.store.put(t,e)):(V("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),To(r)}add(e){return V("SimpleDb","ADD",this.store.name,e,e),To(this.store.add(e))}get(e){return To(this.store.get(e)).next(t=>(t===void 0&&(t=null),V("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return V("SimpleDb","DELETE",this.store.name,e),To(this.store.delete(e))}count(){return V("SimpleDb","COUNT",this.store.name),To(this.store.count())}U(e,t){let r=this.options(e,t),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){let s=i.getAll(r.range);return new x((o,a)=>{s.onerror=c=>{a(c.target.error)},s.onsuccess=c=>{o(c.target.result)}})}{let s=this.cursor(r),o=[];return this.W(s,(a,c)=>{o.push(c)}).next(()=>o)}}G(e,t){let r=this.store.getAll(e,t===null?void 0:t);return new x((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}j(e,t){V("SimpleDb","DELETE ALL",this.store.name);let r=this.options(e,t);r.H=!1;let i=this.cursor(r);return this.W(i,(s,o,a)=>a.delete())}J(e,t){let r;t?r=e:(r={},t=e);let i=this.cursor(r);return this.W(i,t)}Y(e){let t=this.cursor({});return new x((r,i)=>{t.onerror=s=>{let o=j0(s.target.error);i(o)},t.onsuccess=s=>{let o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}W(e,t){let r=[];return new x((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{let a=o.target.result;if(!a)return void i();let c=new WT(a),l=t(a.primaryKey,a.value,c);if(l instanceof x){let d=l.catch(h=>(c.done(),x.reject(h)));r.push(d)}c.isDone?i():c.K===null?a.continue():a.continue(c.K)}}).next(()=>x.waitFor(r))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){let r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}};function To(n){return new x((e,t)=>{n.onsuccess=r=>{let i=r.target.result;e(i)},n.onerror=r=>{let i=j0(r.target.error);t(i)}})}var pO=!1;function j0(n){let e=gs.S(He());if(e>=12.2&&e<13){let t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){let r=new O("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return pO||(pO=!0,setTimeout(()=>{throw r},0)),r}}return n}var KT=class{constructor(e,t){this.asyncQueue=e,this.Z=t,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){V("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,()=>g(this,null,function*(){this.task=null;try{V("IndexBackfiller",`Documents written: ${yield this.Z.ee()}`)}catch(t){Ds(t)?V("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",t):yield Cs(t)}yield this.X(6e4)}))}},QT=class{constructor(e,t){this.localStore=e,this.persistence=t}ee(e=50){return g(this,null,function*(){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.te(t,e))})}te(e,t){let r=new Set,i=t,s=!0;return x.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return V("IndexBackfiller",`Processing collection: ${o}`),this.ne(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>t-i)}ne(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next(s=>{let o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.re(i,s)).next(a=>(V("IndexBackfiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,t,a))).next(()=>o.size)}))}re(e,t){let r=e;return t.changes.forEach((i,s)=>{let o=w1(s);U0(o,r)>0&&(r=o)}),new Qn(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}};var xn=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.ie(i),this.se=i=>r.writeSequenceNumber(i))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.se&&this.se(t),t}}return n.oe=-1,n})();function Gd(n){return n==null}function Cd(n){return n===0&&1/n==-1/0}function T1(n){return typeof n=="number"&&Number.isInteger(n)&&!Cd(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}function cn(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=mO(e)),e=_5(n.get(t),e);return mO(e)}function _5(n,e){let t=e,r=n.length;for(let i=0;i<r;i++){let s=n.charAt(i);switch(s){case"\0":t+="";break;case"":t+="";break;default:t+=s}}return t}function mO(n){return n+""}function qr(n){let e=n.length;if(Z(e>=2),e===2)return Z(n.charAt(0)===""&&n.charAt(1)===""),De.emptyPath();let t=e-2,r=[],i="";for(let s=0;s<e;){let o=n.indexOf("",s);switch((o<0||o>t)&&Y(),n.charAt(o+1)){case"":let a=n.substring(s,o),c;i.length===0?c=a:(i+=a,c=i,i=""),r.push(c);break;case"":i+=n.substring(s,o),i+="\0";break;case"":i+=n.substring(s,o+1);break;default:Y()}s=o+2}return new De(r)}var gO=["userId","batchId"];function Om(n,e){return[n,cn(e)]}function b1(n,e,t){return[n,cn(e),t]}var y5={},v5=["prefixPath","collectionGroup","readTime","documentId"],w5=["prefixPath","collectionGroup","documentId"],I5=["collectionGroup","readTime","prefixPath","documentId"],E5=["canonicalId","targetId"],T5=["targetId","path"],b5=["path","targetId"],C5=["collectionId","parent"],D5=["indexId","uid"],S5=["uid","sequenceNumber"],A5=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],R5=["indexId","uid","orderedDocumentKey"],x5=["userId","collectionPath","documentId"],N5=["userId","collectionPath","largestBatchId"],P5=["userId","collectionGroup","largestBatchId"],C1=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],M5=[...C1,"documentOverlays"],D1=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],S1=D1,B0=[...S1,"indexConfiguration","indexState","indexEntries"],k5=B0,O5=[...B0,"globals"];var Dd=class extends qm{constructor(e,t){super(),this._e=e,this.currentSequenceNumber=t}};function At(n,e){let t=z(n);return gs.F(t._e,e)}function _O(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function jo(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function A1(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var Ke=class n{constructor(e,t){this.comparator=e,this.root=t||Wr.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Wr.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Wr.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new gc(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new gc(this.root,e,this.comparator,!1)}getReverseIterator(){return new gc(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new gc(this.root,e,this.comparator,!0)}},gc=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Wr=class n{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=s??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new n(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Y();let e=this.left.check();if(e!==this.right.check())throw Y();return e+(this.isRed()?0:1)}};Wr.EMPTY=null,Wr.RED=!0,Wr.BLACK=!1;Wr.EMPTY=new class{constructor(){this.size=0}get key(){throw Y()}get value(){throw Y()}get color(){throw Y()}get left(){throw Y()}get right(){throw Y()}copy(e,t,r,i,s){return this}insert(e,t,r){return new Wr(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var je=class n{constructor(e){this.comparator=e,this.data=new Ke(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Wm(this.data.getIterator())}getIteratorFrom(e){return new Wm(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},Wm=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};function ac(n){return n.hasNext()?n.getNext():void 0}var Nn=class n{constructor(e){this.fields=e,e.sort(ht.comparator)}static empty(){return new n([])}unionWith(e){let t=new je(ht.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return wc(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var Gm=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};function R1(){return typeof atob<"u"}var pt=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new Gm("Invalid base64 string: "+s):s}}(e);return new n(t)}static fromUint8Array(e){let t=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ae(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};pt.EMPTY_BYTE_STRING=new pt("");var L5=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Di(n){if(Z(!!n),typeof n=="string"){let e=0,t=L5.exec(n);if(Z(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Qe(n.seconds),nanos:Qe(n.nanos)}}function Qe(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function _s(n){return typeof n=="string"?pt.fromBase64String(n):pt.fromUint8Array(n)}function Fg(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function $0(n){let e=n.mapValue.fields.__previous_value__;return Fg(e)?$0(e):e}function Sd(n){let e=Di(n.mapValue.fields.__local_write_time__.timestampValue);return new et(e.seconds,e.nanos)}var YT=class{constructor(e,t,r,i,s,o,a,c,l){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=l}},ys=class n{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new n("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var fs={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Lm={nullValue:"NULL_VALUE"};function Ro(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Fg(n)?4:x1(n)?9007199254740991:Vg(n)?10:11:Y()}function Qr(n,e){if(n===e)return!0;let t=Ro(n);if(t!==Ro(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Sd(n).isEqual(Sd(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let o=Di(i.timestampValue),a=Di(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,s){return _s(i.bytesValue).isEqual(_s(s.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,s){return Qe(i.geoPointValue.latitude)===Qe(s.geoPointValue.latitude)&&Qe(i.geoPointValue.longitude)===Qe(s.geoPointValue.longitude)}(n,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return Qe(i.integerValue)===Qe(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let o=Qe(i.doubleValue),a=Qe(s.doubleValue);return o===a?Cd(o)===Cd(a):isNaN(o)&&isNaN(a)}return!1}(n,e);case 9:return wc(n.arrayValue.values||[],e.arrayValue.values||[],Qr);case 10:case 11:return function(i,s){let o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(_O(o)!==_O(a))return!1;for(let c in o)if(o.hasOwnProperty(c)&&(a[c]===void 0||!Qr(o[c],a[c])))return!1;return!0}(n,e);default:return Y()}}function Ad(n,e){return(n.values||[]).find(t=>Qr(t,e))!==void 0}function vs(n,e){if(n===e)return 0;let t=Ro(n),r=Ro(e);if(t!==r)return ae(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return ae(n.booleanValue,e.booleanValue);case 2:return function(s,o){let a=Qe(s.integerValue||s.doubleValue),c=Qe(o.integerValue||o.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1}(n,e);case 3:return yO(n.timestampValue,e.timestampValue);case 4:return yO(Sd(n),Sd(e));case 5:return ae(n.stringValue,e.stringValue);case 6:return function(s,o){let a=_s(s),c=_s(o);return a.compareTo(c)}(n.bytesValue,e.bytesValue);case 7:return function(s,o){let a=s.split("/"),c=o.split("/");for(let l=0;l<a.length&&l<c.length;l++){let d=ae(a[l],c[l]);if(d!==0)return d}return ae(a.length,c.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,o){let a=ae(Qe(s.latitude),Qe(o.latitude));return a!==0?a:ae(Qe(s.longitude),Qe(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return vO(n.arrayValue,e.arrayValue);case 10:return function(s,o){var a,c,l,d;let h=s.fields||{},m=o.fields||{},_=(a=h.value)===null||a===void 0?void 0:a.arrayValue,w=(c=m.value)===null||c===void 0?void 0:c.arrayValue,C=ae(((l=_?.values)===null||l===void 0?void 0:l.length)||0,((d=w?.values)===null||d===void 0?void 0:d.length)||0);return C!==0?C:vO(_,w)}(n.mapValue,e.mapValue);case 11:return function(s,o){if(s===fs.mapValue&&o===fs.mapValue)return 0;if(s===fs.mapValue)return 1;if(o===fs.mapValue)return-1;let a=s.fields||{},c=Object.keys(a),l=o.fields||{},d=Object.keys(l);c.sort(),d.sort();for(let h=0;h<c.length&&h<d.length;++h){let m=ae(c[h],d[h]);if(m!==0)return m;let _=vs(a[c[h]],l[d[h]]);if(_!==0)return _}return ae(c.length,d.length)}(n.mapValue,e.mapValue);default:throw Y()}}function yO(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return ae(n,e);let t=Di(n),r=Di(e),i=ae(t.seconds,r.seconds);return i!==0?i:ae(t.nanos,r.nanos)}function vO(n,e){let t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){let s=vs(t[i],r[i]);if(s)return s}return ae(t.length,r.length)}function Ec(n){return JT(n)}function JT(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){let r=Di(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return _s(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return W.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(let s of t.values||[])i?i=!1:r+=",",r+=JT(s);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){let r=Object.keys(t.fields||{}).sort(),i="{",s=!0;for(let o of r)s?s=!1:i+=",",i+=`${o}:${JT(t.fields[o])}`;return i+"}"}(n.mapValue):Y()}function xo(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function XT(n){return!!n&&"integerValue"in n}function Rd(n){return!!n&&"arrayValue"in n}function wO(n){return!!n&&"nullValue"in n}function IO(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Fm(n){return!!n&&"mapValue"in n}function Vg(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function vd(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return jo(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=vd(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=vd(n.arrayValue.values[t]);return e}return Object.assign({},n)}function x1(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}var N1={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function F5(n){return"nullValue"in n?Lm:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?xo(ys.empty(),W.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?Vg(n)?N1:{mapValue:{}}:Y()}function V5(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?xo(ys.empty(),W.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?N1:"mapValue"in n?Vg(n)?{mapValue:{}}:fs:Y()}function EO(n,e){let t=vs(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function TO(n,e){let t=vs(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}var Jt=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Fm(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=vd(t)}setAll(e){let t=ht.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){let c=this.getFieldsMap(t);this.applyChanges(c,r,i),r={},i=[],t=a.popLast()}o?r[a.lastSegment()]=vd(o):i.push(a.lastSegment())});let s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){let t=this.field(e.popLast());Fm(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Qr(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];Fm(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){jo(t,(i,s)=>e[i]=s);for(let i of r)delete e[i]}clone(){return new n(vd(this.value))}};function P1(n){let e=[];return jo(n.fields,(t,r)=>{let i=new ht([t]);if(Fm(r)){let s=P1(r.mapValue).fields;if(s.length===0)e.push(i);else for(let o of s)e.push(i.child(o))}else e.push(i)}),new Nn(e)}var bt=class n{constructor(e,t,r,i,s,o,a){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new n(e,0,ee.min(),ee.min(),ee.min(),Jt.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,ee.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,ee.min(),ee.min(),Jt.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,ee.min(),ee.min(),Jt.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(ee.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Jt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Jt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ee.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var Yr=class{constructor(e,t){this.position=e,this.inclusive=t}};function bO(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let s=e[i],o=n.position[i];if(s.field.isKeyField()?r=W.comparator(W.fromName(o.referenceValue),t.key):r=vs(o,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function CO(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Qr(n.position[t],e.position[t]))return!1;return!0}var No=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function U5(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var Km=class{},we=class n extends Km{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new tb(e,t,r):t==="array-contains"?new ib(e,r):t==="in"?new Qm(e,r):t==="not-in"?new sb(e,r):t==="array-contains-any"?new ob(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new nb(e,r):new rb(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(vs(t,this.value)):t!==null&&Ro(this.value)===Ro(t)&&this.matchesComparison(vs(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Y()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},ke=class n extends Km{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new n(e,t)}matches(e){return Tc(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}};function Tc(n){return n.op==="and"}function ZT(n){return n.op==="or"}function H0(n){return M1(n)&&Tc(n)}function M1(n){for(let e of n.filters)if(e instanceof ke)return!1;return!0}function eb(n){if(n instanceof we)return n.field.canonicalString()+n.op.toString()+Ec(n.value);if(H0(n))return n.filters.map(e=>eb(e)).join(",");{let e=n.filters.map(t=>eb(t)).join(",");return`${n.op}(${e})`}}function k1(n,e){return n instanceof we?function(r,i){return i instanceof we&&r.op===i.op&&r.field.isEqual(i.field)&&Qr(r.value,i.value)}(n,e):n instanceof ke?function(r,i){return i instanceof ke&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&k1(o,i.filters[a]),!0):!1}(n,e):void Y()}function O1(n,e){let t=n.filters.concat(e);return ke.create(t,n.op)}function L1(n){return n instanceof we?function(t){return`${t.field.canonicalString()} ${t.op} ${Ec(t.value)}`}(n):n instanceof ke?function(t){return t.op.toString()+" {"+t.getFilters().map(L1).join(" ,")+"}"}(n):"Filter"}var tb=class extends we{constructor(e,t,r){super(e,t,r),this.key=W.fromName(r.referenceValue)}matches(e){let t=W.comparator(e.key,this.key);return this.matchesComparison(t)}},nb=class extends we{constructor(e,t){super(e,"in",t),this.keys=F1("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},rb=class extends we{constructor(e,t){super(e,"not-in",t),this.keys=F1("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function F1(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>W.fromName(r.referenceValue))}var ib=class extends we{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return Rd(t)&&Ad(t.arrayValue,this.value)}},Qm=class extends we{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&Ad(this.value.arrayValue,t)}},sb=class extends we{constructor(e,t){super(e,"not-in",t)}matches(e){if(Ad(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&!Ad(this.value.arrayValue,t)}},ob=class extends we{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!Rd(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>Ad(this.value.arrayValue,r))}};var ab=class{constructor(e,t=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.ue=null}};function cb(n,e=null,t=[],r=[],i=null,s=null,o=null){return new ab(n,e,t,r,i,s,o)}function Po(n){let e=z(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>eb(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),Gd(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>Ec(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>Ec(r)).join(",")),e.ue=t}return e.ue}function Kd(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!U5(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!k1(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!CO(n.startAt,e.startAt)&&CO(n.endAt,e.endAt)}function Ym(n){return W.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function Jm(n,e){return n.filters.filter(t=>t instanceof we&&t.field.isEqual(e))}function DO(n,e,t){let r=Lm,i=!0;for(let s of Jm(n,e)){let o=Lm,a=!0;switch(s.op){case"<":case"<=":o=F5(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=Lm}EO({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){let o=t.position[s];EO({value:r,inclusive:i},{value:o,inclusive:t.inclusive})<0&&(r=o,i=t.inclusive);break}}return{value:r,inclusive:i}}function SO(n,e,t){let r=fs,i=!0;for(let s of Jm(n,e)){let o=fs,a=!0;switch(s.op){case">=":case">":o=V5(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=fs}TO({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){let o=t.position[s];TO({value:r,inclusive:i},{value:o,inclusive:t.inclusive})>0&&(r=o,i=t.inclusive);break}}return{value:r,inclusive:i}}var mr=class{constructor(e,t=null,r=[],i=[],s=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}};function V1(n,e,t,r,i,s,o,a){return new mr(n,e,t,r,i,s,o,a)}function Vc(n){return new mr(n)}function AO(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function q0(n){return n.collectionGroup!==null}function yc(n){let e=z(n);if(e.ce===null){e.ce=[];let t=new Set;for(let s of e.explicitOrderBy)e.ce.push(s),t.add(s.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new je(ht.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(l=>{l.isInequality()&&(a=a.add(l.field))})}),a})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.ce.push(new No(s,r))}),t.has(ht.keyField().canonicalString())||e.ce.push(new No(ht.keyField(),r))}return e.ce}function ln(n){let e=z(n);return e.le||(e.le=j5(e,yc(n))),e.le}function j5(n,e){if(n.limitType==="F")return cb(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new No(i.field,s)});let t=n.endAt?new Yr(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new Yr(n.startAt.position,n.startAt.inclusive):null;return cb(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function lb(n,e){let t=n.filters.concat([e]);return new mr(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Xm(n,e,t){return new mr(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Qd(n,e){return Kd(ln(n),ln(e))&&n.limitType===e.limitType}function U1(n){return`${Po(ln(n))}|lt:${n.limitType}`}function hc(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>L1(i)).join(", ")}]`),Gd(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>Ec(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>Ec(i)).join(",")),`Target(${r})`}(ln(n))}; limitType=${n.limitType})`}function Yd(n,e){return e.isFoundDocument()&&function(r,i){let s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):W.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(n,e)&&function(r,i){for(let s of yc(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(n,e)&&function(r,i){for(let s of r.filters)if(!s.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(o,a,c){let l=bO(o,a,c);return o.inclusive?l<=0:l<0}(r.startAt,yc(r),i)||r.endAt&&!function(o,a,c){let l=bO(o,a,c);return o.inclusive?l>=0:l>0}(r.endAt,yc(r),i))}(n,e)}function j1(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function B1(n){return(e,t)=>{let r=!1;for(let i of yc(n)){let s=B5(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function B5(n,e,t){let r=n.field.isKeyField()?W.comparator(e.key,t.key):function(s,o,a){let c=o.data.field(s),l=a.data.field(s);return c!==null&&l!==null?vs(c,l):Y()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return Y()}}var Jr=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){jo(this.inner,(t,r)=>{for(let[i,s]of r)e(i,s)})}isEmpty(){return A1(this.inner)}size(){return this.innerSize}};var $5=new Ke(W.comparator);function In(){return $5}var $1=new Ke(W.comparator);function _d(...n){let e=$1;for(let t of n)e=e.insert(t.key,t);return e}function H1(n){let e=$1;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function zr(){return wd()}function q1(){return wd()}function wd(){return new Jr(n=>n.toString(),(n,e)=>n.isEqual(e))}var H5=new Ke(W.comparator),q5=new je(W.comparator);function he(...n){let e=q5;for(let t of n)e=e.add(t);return e}var z5=new je(ae);function z0(){return z5}function W0(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Cd(e)?"-0":e}}function z1(n){return{integerValue:""+n}}function W1(n,e){return T1(e)?z1(e):W0(n,e)}var bc=class{constructor(){this._=void 0}};function W5(n,e,t){return n instanceof ws?function(i,s){let o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Fg(s)&&(s=$0(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(t,e):n instanceof Si?K1(n,e):n instanceof Ai?Q1(n,e):function(i,s){let o=G1(i,s),a=RO(o)+RO(i.Pe);return XT(o)&&XT(i.Pe)?z1(a):W0(i.serializer,a)}(n,e)}function G5(n,e,t){return n instanceof Si?K1(n,e):n instanceof Ai?Q1(n,e):t}function G1(n,e){return n instanceof Is?function(r){return XT(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}var ws=class extends bc{},Si=class extends bc{constructor(e){super(),this.elements=e}};function K1(n,e){let t=Y1(e);for(let r of n.elements)t.some(i=>Qr(i,r))||t.push(r);return{arrayValue:{values:t}}}var Ai=class extends bc{constructor(e){super(),this.elements=e}};function Q1(n,e){let t=Y1(e);for(let r of n.elements)t=t.filter(i=>!Qr(i,r));return{arrayValue:{values:t}}}var Is=class extends bc{constructor(e,t){super(),this.serializer=e,this.Pe=t}};function RO(n){return Qe(n.integerValue||n.doubleValue)}function Y1(n){return Rd(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}var Mo=class{constructor(e,t){this.field=e,this.transform=t}};function K5(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof Si&&i instanceof Si||r instanceof Ai&&i instanceof Ai?wc(r.elements,i.elements,Qr):r instanceof Is&&i instanceof Is?Qr(r.Pe,i.Pe):r instanceof ws&&i instanceof ws}(n.transform,e.transform)}var ub=class{constructor(e,t){this.version=e,this.transformResults=t}},ct=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Vm(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var Cc=class{};function J1(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Ts(n.key,ct.none()):new Es(n.key,n.data,ct.none());{let t=n.data,r=Jt.empty(),i=new je(ht.comparator);for(let s of e.fields)if(!i.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new gr(n.key,r,new Nn(i.toArray()),ct.none())}}function Q5(n,e,t){n instanceof Es?function(i,s,o){let a=i.value.clone(),c=NO(i.fieldTransforms,s,o.transformResults);a.setAll(c),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(n,e,t):n instanceof gr?function(i,s,o){if(!Vm(i.precondition,s))return void s.convertToUnknownDocument(o.version);let a=NO(i.fieldTransforms,s,o.transformResults),c=s.data;c.setAll(X1(i)),c.setAll(a),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(n,e,t):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function Id(n,e,t,r){return n instanceof Es?function(s,o,a,c){if(!Vm(s.precondition,o))return a;let l=s.value.clone(),d=PO(s.fieldTransforms,c,o);return l.setAll(d),o.convertToFoundDocument(o.version,l).setHasLocalMutations(),null}(n,e,t,r):n instanceof gr?function(s,o,a,c){if(!Vm(s.precondition,o))return a;let l=PO(s.fieldTransforms,c,o),d=o.data;return d.setAll(X1(s)),d.setAll(l),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(h=>h.field))}(n,e,t,r):function(s,o,a){return Vm(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(n,e,t)}function Y5(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),s=G1(r.transform,i||null);s!=null&&(t===null&&(t=Jt.empty()),t.set(r.field,s))}return t||null}function xO(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&wc(r,i,(s,o)=>K5(s,o))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var Es=class extends Cc{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},gr=class extends Cc{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function X1(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function NO(n,e,t){let r=new Map;Z(n.length===t.length);for(let i=0;i<t.length;i++){let s=n[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,G5(o,a,t[i]))}return r}function PO(n,e,t){let r=new Map;for(let i of n){let s=i.transform,o=t.data.field(i.field);r.set(i.field,W5(s,o,e))}return r}var Ts=class extends Cc{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},xd=class extends Cc{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var Nd=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&Q5(s,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=Id(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=Id(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=q1();return this.mutations.forEach(i=>{let s=e.get(i.key),o=s.overlayedDocument,a=this.applyToLocalView(o,s.mutatedFields);a=t.has(i.key)?null:a;let c=J1(o,a);c!==null&&r.set(i.key,c),o.isValidDocument()||o.convertToNoDocument(ee.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),he())}isEqual(e){return this.batchId===e.batchId&&wc(this.mutations,e.mutations,(t,r)=>xO(t,r))&&wc(this.baseMutations,e.baseMutations,(t,r)=>xO(t,r))}},db=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){Z(e.mutations.length===r.length);let i=function(){return H5}(),s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new n(e,t,r,i)}};var Pd=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var hb=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var wt,Ce;function Z1(n){switch(n){default:return Y();case N.CANCELLED:case N.UNKNOWN:case N.DEADLINE_EXCEEDED:case N.RESOURCE_EXHAUSTED:case N.INTERNAL:case N.UNAVAILABLE:case N.UNAUTHENTICATED:return!1;case N.INVALID_ARGUMENT:case N.NOT_FOUND:case N.ALREADY_EXISTS:case N.PERMISSION_DENIED:case N.FAILED_PRECONDITION:case N.ABORTED:case N.OUT_OF_RANGE:case N.UNIMPLEMENTED:case N.DATA_LOSS:return!0}}function eL(n){if(n===void 0)return dt("GRPC error has no .code"),N.UNKNOWN;switch(n){case wt.OK:return N.OK;case wt.CANCELLED:return N.CANCELLED;case wt.UNKNOWN:return N.UNKNOWN;case wt.DEADLINE_EXCEEDED:return N.DEADLINE_EXCEEDED;case wt.RESOURCE_EXHAUSTED:return N.RESOURCE_EXHAUSTED;case wt.INTERNAL:return N.INTERNAL;case wt.UNAVAILABLE:return N.UNAVAILABLE;case wt.UNAUTHENTICATED:return N.UNAUTHENTICATED;case wt.INVALID_ARGUMENT:return N.INVALID_ARGUMENT;case wt.NOT_FOUND:return N.NOT_FOUND;case wt.ALREADY_EXISTS:return N.ALREADY_EXISTS;case wt.PERMISSION_DENIED:return N.PERMISSION_DENIED;case wt.FAILED_PRECONDITION:return N.FAILED_PRECONDITION;case wt.ABORTED:return N.ABORTED;case wt.OUT_OF_RANGE:return N.OUT_OF_RANGE;case wt.UNIMPLEMENTED:return N.UNIMPLEMENTED;case wt.DATA_LOSS:return N.DATA_LOSS;default:return Y()}}(Ce=wt||(wt={}))[Ce.OK=0]="OK",Ce[Ce.CANCELLED=1]="CANCELLED",Ce[Ce.UNKNOWN=2]="UNKNOWN",Ce[Ce.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ce[Ce.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ce[Ce.NOT_FOUND=5]="NOT_FOUND",Ce[Ce.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ce[Ce.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ce[Ce.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ce[Ce.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ce[Ce.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ce[Ce.ABORTED=10]="ABORTED",Ce[Ce.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ce[Ce.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ce[Ce.INTERNAL=13]="INTERNAL",Ce[Ce.UNAVAILABLE=14]="UNAVAILABLE",Ce[Ce.DATA_LOSS=15]="DATA_LOSS";var MO=null;function tL(){return new TextEncoder}var J5=new cs([4294967295,4294967295],0);function kO(n){let e=tL().encode(n),t=new ST;return t.update(e),new Uint8Array(t.digest())}function OO(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new cs([t,r],0),new cs([i,s],0)]}var fb=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new So(`Invalid padding: ${t}`);if(r<0)throw new So(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new So(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new So(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=cs.fromNumber(this.Ie)}Ee(e,t,r){let i=e.add(t.multiply(cs.fromNumber(r)));return i.compare(J5)===1&&(i=new cs([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;let t=kO(e),[r,i]=OO(t);for(let s=0;s<this.hashCount;s++){let o=this.Ee(r,i,s);if(!this.de(o))return!1}return!0}static create(e,t,r){let i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new n(s,i,t);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Ie===0)return;let t=kO(e),[r,i]=OO(t);for(let s=0;s<this.hashCount;s++){let o=this.Ee(r,i,s);this.Ae(o)}}Ae(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},So=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var Md=class n{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,kd.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(ee.min(),i,new Ke(ae),In(),he())}},kd=class n{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,he(),he(),he())}};var vc=class{constructor(e,t,r,i){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=i}},Zm=class{constructor(e,t){this.targetId=e,this.me=t}},eg=class{constructor(e,t,r=pt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},tg=class{constructor(){this.fe=0,this.ge=FO(),this.pe=pt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=he(),t=he(),r=he();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:Y()}}),new kd(this.pe,this.ye,e,t,r)}Ce(){this.we=!1,this.ge=FO()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Z(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}},pb=class{constructor(e){this.Le=e,this.Be=new Map,this.ke=In(),this.qe=LO(),this.Qe=new Ke(ae)}Ke(e){for(let t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(let t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{let r=this.Ge(t);switch(e.state){case 0:this.ze(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),r.De(e.resumeToken));break;default:Y()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((r,i)=>{this.ze(i)&&t(i)})}He(e){let t=e.targetId,r=e.me.count,i=this.Je(t);if(i){let s=i.target;if(Ym(s))if(r===0){let o=new W(s.path);this.Ue(t,o,bt.newNoDocument(o,ee.min()))}else Z(r===1);else{let o=this.Ye(t);if(o!==r){let a=this.Ze(e),c=a?this.Xe(a,e,o):1;if(c!==0){this.je(t);let l=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,l)}MO?.et(function(d,h,m,_,w){var C,A,L,H,j,Q;let se={localCacheCount:d,existenceFilterCount:h.count,databaseId:m.database,projectId:m.projectId},J=h.unchangedNames;return J&&(se.bloomFilter={applied:w===0,hashCount:(C=J?.hashCount)!==null&&C!==void 0?C:0,bitmapLength:(H=(L=(A=J?.bits)===null||A===void 0?void 0:A.bitmap)===null||L===void 0?void 0:L.length)!==null&&H!==void 0?H:0,padding:(Q=(j=J?.bits)===null||j===void 0?void 0:j.padding)!==null&&Q!==void 0?Q:0,mightContain:T=>{var v;return(v=_?.mightContain(T))!==null&&v!==void 0&&v}}),se}(o,e.me,this.Le.tt(),a,c))}}}}Ze(e){let t=e.me.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t,o,a;try{o=_s(r).toUint8Array()}catch(c){if(c instanceof Gm)return Kn("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new fb(o,i,s)}catch(c){return Kn(c instanceof So?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return a.Ie===0?null:a}Xe(e,t,r){return t.me.count===r-this.nt(e,t.targetId)?0:2}nt(e,t){let r=this.Le.getRemoteKeysForTarget(t),i=0;return r.forEach(s=>{let o=this.Le.tt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.Ue(t,s,null),i++)}),i}rt(e){let t=new Map;this.Be.forEach((s,o)=>{let a=this.Je(o);if(a){if(s.current&&Ym(a.target)){let c=new W(a.target.path);this.ke.get(c)!==null||this.it(o,c)||this.Ue(o,c,bt.newNoDocument(c,e))}s.be&&(t.set(o,s.ve()),s.Ce())}});let r=he();this.qe.forEach((s,o)=>{let a=!0;o.forEachWhile(c=>{let l=this.Je(c);return!l||l.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.ke.forEach((s,o)=>o.setReadTime(e));let i=new Md(e,t,this.Qe,this.ke,r);return this.ke=In(),this.qe=LO(),this.Qe=new Ke(ae),i}$e(e,t){if(!this.ze(e))return;let r=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,r){if(!this.ze(e))return;let i=this.Ge(e);this.it(e,t)?i.Fe(t,1):i.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Be.delete(e)}Ye(e){let t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new tg,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new je(ae),this.qe=this.qe.insert(e,t)),t}ze(e){let t=this.Je(e)!==null;return t||V("WatchChangeAggregator","Detected inactive target",e),t}Je(e){let t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new tg),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}};function LO(){return new Ke(W.comparator)}function FO(){return new Ke(W.comparator)}var X5={asc:"ASCENDING",desc:"DESCENDING"},Z5={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},e8={and:"AND",or:"OR"},mb=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function gb(n,e){return n.useProto3Json||Gd(e)?e:{value:e}}function Dc(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function nL(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function t8(n,e){return Dc(n,e.toTimestamp())}function ft(n){return Z(!!n),ee.fromTimestamp(function(t){let r=Di(t);return new et(r.seconds,r.nanos)}(n))}function G0(n,e){return _b(n,e).canonicalString()}function _b(n,e){let t=function(i){return new De(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function rL(n){let e=De.fromString(n);return Z(fL(e)),e}function Od(n,e){return G0(n.databaseId,e.path)}function Gr(n,e){let t=rL(e);if(t.get(1)!==n.databaseId.projectId)throw new O(N.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new O(N.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new W(oL(t))}function iL(n,e){return G0(n.databaseId,e)}function sL(n){let e=rL(n);return e.length===4?De.emptyPath():oL(e)}function yb(n){return new De(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function oL(n){return Z(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function VO(n,e,t){return{name:Od(n,e),fields:t.value.mapValue.fields}}function aL(n,e,t){let r=Gr(n,e.name),i=ft(e.updateTime),s=e.createTime?ft(e.createTime):ee.min(),o=new Jt({mapValue:{fields:e.fields}}),a=bt.newFoundDocument(r,i,s,o);return t&&a.setHasCommittedMutations(),t?a.setHasCommittedMutations():a}function n8(n,e){return"found"in e?function(r,i){Z(!!i.found),i.found.name,i.found.updateTime;let s=Gr(r,i.found.name),o=ft(i.found.updateTime),a=i.found.createTime?ft(i.found.createTime):ee.min(),c=new Jt({mapValue:{fields:i.found.fields}});return bt.newFoundDocument(s,o,a,c)}(n,e):"missing"in e?function(r,i){Z(!!i.missing),Z(!!i.readTime);let s=Gr(r,i.missing),o=ft(i.readTime);return bt.newNoDocument(s,o)}(n,e):Y()}function r8(n,e){let t;if("targetChange"in e){e.targetChange;let r=function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:Y()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(l,d){return l.useProto3Json?(Z(d===void 0||typeof d=="string"),pt.fromBase64String(d||"")):(Z(d===void 0||d instanceof Buffer||d instanceof Uint8Array),pt.fromUint8Array(d||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(l){let d=l.code===void 0?N.UNKNOWN:eL(l.code);return new O(d,l.message||"")}(o);t=new eg(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=Gr(n,r.document.name),s=ft(r.document.updateTime),o=r.document.createTime?ft(r.document.createTime):ee.min(),a=new Jt({mapValue:{fields:r.document.fields}}),c=bt.newFoundDocument(i,s,o,a),l=r.targetIds||[],d=r.removedTargetIds||[];t=new vc(l,d,c.key,c)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=Gr(n,r.document),s=r.readTime?ft(r.readTime):ee.min(),o=bt.newNoDocument(i,s),a=r.removedTargetIds||[];t=new vc([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=Gr(n,r.document),s=r.removedTargetIds||[];t=new vc([],s,i,null)}else{if(!("filter"in e))return Y();{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:s}=r,o=new hb(i,s),a=r.targetId;t=new Zm(a,o)}}return t}function Ld(n,e){let t;if(e instanceof Es)t={update:VO(n,e.key,e.value)};else if(e instanceof Ts)t={delete:Od(n,e.key)};else if(e instanceof gr)t={update:VO(n,e.key,e.data),updateMask:l8(e.fieldMask)};else{if(!(e instanceof xd))return Y();t={verify:Od(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(s,o){let a=o.transform;if(a instanceof ws)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Si)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Ai)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Is)return{fieldPath:o.field.canonicalString(),increment:a.Pe};throw Y()}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:t8(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Y()}(n,e.precondition)),t}function vb(n,e){let t=e.currentDocument?function(s){return s.updateTime!==void 0?ct.updateTime(ft(s.updateTime)):s.exists!==void 0?ct.exists(s.exists):ct.none()}(e.currentDocument):ct.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,a){let c=null;if("setToServerValue"in a)Z(a.setToServerValue==="REQUEST_TIME"),c=new ws;else if("appendMissingElements"in a){let d=a.appendMissingElements.values||[];c=new Si(d)}else if("removeAllFromArray"in a){let d=a.removeAllFromArray.values||[];c=new Ai(d)}else"increment"in a?c=new Is(o,a.increment):Y();let l=ht.fromServerFormat(a.fieldPath);return new Mo(l,c)}(n,i)):[];if(e.update){e.update.name;let i=Gr(n,e.update.name),s=new Jt({mapValue:{fields:e.update.fields}});if(e.updateMask){let o=function(c){let l=c.fieldPaths||[];return new Nn(l.map(d=>ht.fromServerFormat(d)))}(e.updateMask);return new gr(i,s,o,t,r)}return new Es(i,s,t,r)}if(e.delete){let i=Gr(n,e.delete);return new Ts(i,t)}if(e.verify){let i=Gr(n,e.verify);return new xd(i,t)}return Y()}function i8(n,e){return n&&n.length>0?(Z(e!==void 0),n.map(t=>function(i,s){let o=i.updateTime?ft(i.updateTime):ft(s);return o.isEqual(ee.min())&&(o=ft(s)),new ub(o,i.transformResults||[])}(t,e))):[]}function cL(n,e){return{documents:[iL(n,e.path)]}}function lL(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=iL(n,i);let s=function(l){if(l.length!==0)return hL(ke.create(l,"and"))}(e.filters);s&&(t.structuredQuery.where=s);let o=function(l){if(l.length!==0)return l.map(d=>function(m){return{field:fc(m.field),direction:o8(m.dir)}}(d))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);let a=gb(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=function(l){return{before:l.inclusive,values:l.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(l){return{before:!l.inclusive,values:l.position}}(e.endAt)),{_t:t,parent:i}}function uL(n){let e=sL(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){Z(r===1);let d=t.from[0];d.allDescendants?i=d.collectionId:e=e.child(d.collectionId)}let s=[];t.where&&(s=function(h){let m=dL(h);return m instanceof ke&&H0(m)?m.getFilters():[m]}(t.where));let o=[];t.orderBy&&(o=function(h){return h.map(m=>function(w){return new No(pc(w.field),function(A){switch(A){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(w.direction))}(m))}(t.orderBy));let a=null;t.limit&&(a=function(h){let m;return m=typeof h=="object"?h.value:h,Gd(m)?null:m}(t.limit));let c=null;t.startAt&&(c=function(h){let m=!!h.before,_=h.values||[];return new Yr(_,m)}(t.startAt));let l=null;return t.endAt&&(l=function(h){let m=!h.before,_=h.values||[];return new Yr(_,m)}(t.endAt)),V1(e,i,o,s,a,"F",c,l)}function s8(n,e){let t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Y()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function dL(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=pc(t.unaryFilter.field);return we.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=pc(t.unaryFilter.field);return we.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=pc(t.unaryFilter.field);return we.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let o=pc(t.unaryFilter.field);return we.create(o,"!=",{nullValue:"NULL_VALUE"});default:return Y()}}(n):n.fieldFilter!==void 0?function(t){return we.create(pc(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Y()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return ke.create(t.compositeFilter.filters.map(r=>dL(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Y()}}(t.compositeFilter.op))}(n):Y()}function o8(n){return X5[n]}function a8(n){return Z5[n]}function c8(n){return e8[n]}function fc(n){return{fieldPath:n.canonicalString()}}function pc(n){return ht.fromServerFormat(n.fieldPath)}function hL(n){return n instanceof we?function(t){if(t.op==="=="){if(IO(t.value))return{unaryFilter:{field:fc(t.field),op:"IS_NAN"}};if(wO(t.value))return{unaryFilter:{field:fc(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(IO(t.value))return{unaryFilter:{field:fc(t.field),op:"IS_NOT_NAN"}};if(wO(t.value))return{unaryFilter:{field:fc(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:fc(t.field),op:a8(t.op),value:t.value}}}(n):n instanceof ke?function(t){let r=t.getFilters().map(i=>hL(i));return r.length===1?r[0]:{compositeFilter:{op:c8(t.op),filters:r}}}(n):Y()}function l8(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function fL(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var Sc=class n{constructor(e,t,r,i,s=ee.min(),o=ee.min(),a=pt.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var ng=class{constructor(e){this.ct=e}};function u8(n,e){let t;if(e.document)t=aL(n.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){let r=W.fromSegments(e.noDocument.path),i=Oo(e.noDocument.readTime);t=bt.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Y();{let r=W.fromSegments(e.unknownDocument.path),i=Oo(e.unknownDocument.version);t=bt.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime(function(i){let s=new et(i[0],i[1]);return ee.fromTimestamp(s)}(e.readTime)),t}function UO(n,e){let t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:rg(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,o){return{name:Od(s,o.key),fields:o.data.value.mapValue.fields,updateTime:Dc(s,o.version.toTimestamp()),createTime:Dc(s,o.createTime.toTimestamp())}}(n.ct,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:ko(e.version)};else{if(!e.isUnknownDocument())return Y();r.unknownDocument={path:t.path.toArray(),version:ko(e.version)}}return r}function rg(n){let e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function ko(n){let e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Oo(n){let e=new et(n.seconds,n.nanoseconds);return ee.fromTimestamp(e)}function bo(n,e){let t=(e.baseMutations||[]).map(s=>vb(n.ct,s));for(let s=0;s<e.mutations.length-1;++s){let o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){let a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}let r=e.mutations.map(s=>vb(n.ct,s)),i=et.fromMillis(e.localWriteTimeMs);return new Nd(e.batchId,i,t,r)}function yd(n){let e=Oo(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Oo(n.lastLimboFreeSnapshotVersion):ee.min(),r;return r=function(s){return s.documents!==void 0}(n.query)?function(s){return Z(s.documents.length===1),ln(Vc(sL(s.documents[0])))}(n.query):function(s){return ln(uL(s))}(n.query),new Sc(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,pt.fromBase64String(n.resumeToken))}function pL(n,e){let t=ko(e.snapshotVersion),r=ko(e.lastLimboFreeSnapshotVersion),i;i=Ym(e.target)?cL(n.ct,e.target):lL(n.ct,e.target)._t;let s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Po(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function K0(n){let e=uL({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Xm(e,e.limit,"L"):e}function kT(n,e){return new Pd(e.largestBatchId,vb(n.ct,e.overlayMutation))}function jO(n,e){let t=e.path.lastSegment();return[n,cn(e.path.popLast()),t]}function BO(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:ko(r.readTime),documentKey:cn(r.documentKey.path),largestBatchId:r.largestBatchId}}var wb=class{getBundleMetadata(e,t){return $O(e).get(t).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:Oo(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,t){return $O(e).put(function(i){return{bundleId:i.id,createTime:ko(ft(i.createTime)),version:i.version}}(t))}getNamedQuery(e,t){return HO(e).get(t).next(r=>{if(r)return function(s){return{name:s.name,query:K0(s.bundledQuery),readTime:Oo(s.readTime)}}(r)})}saveNamedQuery(e,t){return HO(e).put(function(i){return{name:i.name,readTime:ko(ft(i.readTime)),bundledQuery:i.bundledQuery}}(t))}};function $O(n){return At(n,"bundles")}function HO(n){return At(n,"namedQueries")}var ig=class n{constructor(e,t){this.serializer=e,this.userId=t}static lt(e,t){let r=t.uid||"";return new n(e,r)}getOverlay(e,t){return fd(e).get(jO(this.userId,t)).next(r=>r?kT(this.serializer,r):null)}getOverlays(e,t){let r=zr();return x.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){let i=[];return r.forEach((s,o)=>{let a=new Pd(t,o);i.push(this.ht(e,a))}),x.waitFor(i)}removeOverlaysForBatchId(e,t,r){let i=new Set;t.forEach(o=>i.add(cn(o.getCollectionPath())));let s=[];return i.forEach(o=>{let a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(fd(e).j("collectionPathOverlayIndex",a))}),x.waitFor(s)}getOverlaysForCollection(e,t,r){let i=zr(),s=cn(t),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return fd(e).U("collectionPathOverlayIndex",o).next(a=>{for(let c of a){let l=kT(this.serializer,c);i.set(l.getKey(),l)}return i})}getOverlaysForCollectionGroup(e,t,r,i){let s=zr(),o,a=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return fd(e).J({index:"collectionGroupOverlayIndex",range:a},(c,l,d)=>{let h=kT(this.serializer,l);s.size()<i||h.largestBatchId===o?(s.set(h.getKey(),h),o=h.largestBatchId):d.done()}).next(()=>s)}ht(e,t){return fd(e).put(function(i,s,o){let[a,c,l]=jO(s,o.mutation.key);return{userId:s,collectionPath:c,documentId:l,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:Ld(i.ct,o.mutation)}}(this.serializer,this.userId,t))}};function fd(n){return At(n,"documentOverlays")}var Ib=class{Pt(e){return At(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next(t=>{let r=t?.value;return r?pt.fromUint8Array(r):pt.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.Pt(e).put({name:"sessionToken",value:t.toUint8Array()})}};var bi=class{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(Qe(e.integerValue));else if("doubleValue"in e){let r=Qe(e.doubleValue);isNaN(r)?this.dt(t,13):(this.dt(t,15),Cd(r)?t.At(0):t.At(r))}else if("timestampValue"in e){let r=e.timestampValue;this.dt(t,20),typeof r=="string"&&(r=Di(r)),t.Rt(`${r.seconds||""}`),t.At(r.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(_s(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.dt(t,45),t.At(r.latitude||0),t.At(r.longitude||0)}else"mapValue"in e?x1(e)?this.dt(t,Number.MAX_SAFE_INTEGER):Vg(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):Y()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){let r=e.fields||{};this.dt(t,55);for(let i of Object.keys(r))this.Vt(i,t),this.Tt(r[i],t)}wt(e,t){var r,i;let s=e.fields||{};this.dt(t,53);let o="value",a=((i=(r=s[o].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.dt(t,15),t.At(Qe(a)),this.Vt(o,t),this.Tt(s[o],t)}bt(e,t){let r=e.values||[];this.dt(t,50);for(let i of r)this.Tt(i,t)}yt(e,t){this.dt(t,37),W.fromName(e).path.forEach(r=>{this.dt(t,60),this.Dt(r,t)})}dt(e,t){e.At(t)}ft(e){e.At(2)}};bi.vt=new bi;function d8(n){if(n===0)return 8;let e=0;return!(n>>4)&&(e+=4,n<<=4),!(n>>6)&&(e+=2,n<<=2),!(n>>7)&&(e+=1),e}function qO(n){let e=64-function(r){let i=0;for(let s=0;s<8;++s){let o=d8(255&r[s]);if(i+=o,o!==8)break}return i}(n);return Math.ceil(e/8)}var Eb=class{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){let t=e[Symbol.iterator](),r=t.next();for(;!r.done;)this.Ft(r.value),r=t.next();this.Mt()}xt(e){let t=e[Symbol.iterator](),r=t.next();for(;!r.done;)this.Ot(r.value),r=t.next();this.Nt()}Lt(e){for(let t of e){let r=t.charCodeAt(0);if(r<128)this.Ft(r);else if(r<2048)this.Ft(960|r>>>6),this.Ft(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ft(480|r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r);else{let i=t.codePointAt(0);this.Ft(240|i>>>18),this.Ft(128|63&i>>>12),this.Ft(128|63&i>>>6),this.Ft(128|63&i)}}this.Mt()}Bt(e){for(let t of e){let r=t.charCodeAt(0);if(r<128)this.Ot(r);else if(r<2048)this.Ot(960|r>>>6),this.Ot(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ot(480|r>>>12),this.Ot(128|63&r>>>6),this.Ot(128|63&r);else{let i=t.codePointAt(0);this.Ot(240|i>>>18),this.Ot(128|63&i>>>12),this.Ot(128|63&i>>>6),this.Ot(128|63&i)}}this.Nt()}kt(e){let t=this.qt(e),r=qO(t);this.Qt(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}Kt(e){let t=this.qt(e),r=qO(t);this.Qt(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){let t=function(s){let o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=(128&t[0])!=0;t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Ft(e){let t=255&e;t===0?(this.Ut(0),this.Ut(255)):t===255?(this.Ut(255),this.Ut(0)):this.Ut(t)}Ot(e){let t=255&e;t===0?(this.Gt(0),this.Gt(255)):t===255?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){let t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);let i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}},Tb=class{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}},bb=class{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}},Co=class{constructor(){this.jt=new Eb,this.Ht=new Tb(this.jt),this.Jt=new bb(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return e===0?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}};var Do=class n{constructor(e,t,r,i){this.indexId=e,this.documentKey=t,this.arrayValue=r,this.directionalValue=i}Zt(){let e=this.directionalValue.length,t=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.directionalValue,0),t!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new n(this.indexId,this.documentKey,this.arrayValue,r)}};function ls(n,e){let t=n.indexId-e.indexId;return t!==0?t:(t=zO(n.arrayValue,e.arrayValue),t!==0?t:(t=zO(n.directionalValue,e.directionalValue),t!==0?t:W.comparator(n.documentKey,e.documentKey)))}function zO(n,e){for(let t=0;t<n.length&&t<e.length;++t){let r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}var sg=class{constructor(e){this.Xt=new je((t,r)=>ht.comparator(t.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(let t of e.filters){let r=t;r.isInequality()?this.Xt=this.Xt.add(r):this.tn.push(r)}}get nn(){return this.Xt.size>1}rn(e){if(Z(e.collectionGroup===this.collectionId),this.nn)return!1;let t=zT(e);if(t!==void 0&&!this.sn(t))return!1;let r=Eo(e),i=new Set,s=0,o=0;for(;s<r.length&&this.sn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.Xt.size>0){let a=this.Xt.getIterator().getNext();if(!i.has(a.field.canonicalString())){let c=r[s];if(!this.on(a,c)||!this._n(this.en[o++],c))return!1}++s}for(;s<r.length;++s){let a=r[s];if(o>=this.en.length||!this._n(this.en[o++],a))return!1}return!0}an(){if(this.nn)return null;let e=new je(ht.comparator),t=[];for(let r of this.tn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new _c(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new _c(r.field,0))}for(let r of this.en)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new _c(r.field,r.dir==="asc"?0:1)));return new Ic(Ic.UNKNOWN_ID,this.collectionId,t,bd.empty())}sn(e){for(let t of this.tn)if(this.on(t,e))return!0;return!1}on(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;let r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}_n(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}};function mL(n){var e,t;if(Z(n instanceof we||n instanceof ke),n instanceof we){if(n instanceof Qm){let i=((t=(e=n.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(s=>we.create(n.field,"==",s)))||[];return ke.create(i,"or")}return n}let r=n.filters.map(i=>mL(i));return ke.create(r,n.op)}function h8(n){if(n.getFilters().length===0)return[];let e=Sb(mL(n));return Z(gL(e)),Cb(e)||Db(e)?[e]:e.getFilters()}function Cb(n){return n instanceof we}function Db(n){return n instanceof ke&&H0(n)}function gL(n){return Cb(n)||Db(n)||function(t){if(t instanceof ke&&ZT(t)){for(let r of t.getFilters())if(!Cb(r)&&!Db(r))return!1;return!0}return!1}(n)}function Sb(n){if(Z(n instanceof we||n instanceof ke),n instanceof we)return n;if(n.filters.length===1)return Sb(n.filters[0]);let e=n.filters.map(r=>Sb(r)),t=ke.create(e,n.op);return t=og(t),gL(t)?t:(Z(t instanceof ke),Z(Tc(t)),Z(t.filters.length>1),t.filters.reduce((r,i)=>Q0(r,i)))}function Q0(n,e){let t;return Z(n instanceof we||n instanceof ke),Z(e instanceof we||e instanceof ke),t=n instanceof we?e instanceof we?function(i,s){return ke.create([i,s],"and")}(n,e):WO(n,e):e instanceof we?WO(e,n):function(i,s){if(Z(i.filters.length>0&&s.filters.length>0),Tc(i)&&Tc(s))return O1(i,s.getFilters());let o=ZT(i)?i:s,a=ZT(i)?s:i,c=o.filters.map(l=>Q0(l,a));return ke.create(c,"or")}(n,e),og(t)}function WO(n,e){if(Tc(e))return O1(e,n.getFilters());{let t=e.filters.map(r=>Q0(n,r));return ke.create(t,"or")}}function og(n){if(Z(n instanceof we||n instanceof ke),n instanceof we)return n;let e=n.getFilters();if(e.length===1)return og(e[0]);if(M1(n))return n;let t=e.map(i=>og(i)),r=[];return t.forEach(i=>{i instanceof we?r.push(i):i instanceof ke&&(i.op===n.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:ke.create(r,n.op)}var Ab=class{constructor(){this.un=new Fd}addToCollectionParentIndex(e,t){return this.un.add(t),x.resolve()}getCollectionParents(e,t){return x.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return x.resolve()}deleteFieldIndex(e,t){return x.resolve()}deleteAllFieldIndexes(e){return x.resolve()}createTargetIndexes(e,t){return x.resolve()}getDocumentsMatchingTarget(e,t){return x.resolve(null)}getIndexType(e,t){return x.resolve(0)}getFieldIndexes(e,t){return x.resolve([])}getNextCollectionGroupToUpdate(e){return x.resolve(null)}getMinOffset(e,t){return x.resolve(Qn.min())}getMinOffsetFromCollectionGroup(e,t){return x.resolve(Qn.min())}updateCollectionGroup(e,t,r){return x.resolve()}updateIndexEntries(e,t){return x.resolve()}},Fd=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new je(De.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new je(De.comparator)).toArray()}};var Nm=new Uint8Array(0),Rb=class{constructor(e,t){this.databaseId=t,this.cn=new Fd,this.ln=new Jr(r=>Po(r),(r,i)=>Kd(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.cn.has(t)){let r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this.cn.add(t)});let s={collectionId:r,parent:cn(i)};return GO(e).put(s)}return x.resolve()}getCollectionParents(e,t){let r=[],i=IDBKeyRange.bound([t,""],[y1(t),""],!1,!0);return GO(e).U(i).next(s=>{for(let o of s){if(o.collectionId!==t)break;r.push(qr(o.parent))}return r})}addFieldIndex(e,t){let r=pd(e),i=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])}}(t);delete i.indexId;let s=r.add(i);if(t.indexState){let o=lc(e);return s.next(a=>{o.put(BO(a,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return s.next()}deleteFieldIndex(e,t){let r=pd(e),i=lc(e),s=cc(e);return r.delete(t.indexId).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){let t=pd(e),r=cc(e),i=lc(e);return t.j().next(()=>r.j()).next(()=>i.j())}createTargetIndexes(e,t){return x.forEach(this.hn(t),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){let s=new sg(r).an();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,t){let r=cc(e),i=!0,s=new Map;return x.forEach(this.hn(t),o=>this.Pn(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=he(),a=[];return x.forEach(s,(c,l)=>{V("IndexedDbIndexManager",`Using index ${function(j){return`id=${j.indexId}|cg=${j.collectionGroup}|f=${j.fields.map(Q=>`${Q.fieldPath}:${Q.kind}`).join(",")}`}(c)} to execute ${Po(t)}`);let d=function(j,Q){let se=zT(Q);if(se===void 0)return null;for(let J of Jm(j,se.fieldPath))switch(J.op){case"array-contains-any":return J.value.arrayValue.values||[];case"array-contains":return[J.value]}return null}(l,c),h=function(j,Q){let se=new Map;for(let J of Eo(Q))for(let T of Jm(j,J.fieldPath))switch(T.op){case"==":case"in":se.set(J.fieldPath.canonicalString(),T.value);break;case"not-in":case"!=":return se.set(J.fieldPath.canonicalString(),T.value),Array.from(se.values())}return null}(l,c),m=function(j,Q){let se=[],J=!0;for(let T of Eo(Q)){let v=T.kind===0?DO(j,T.fieldPath,j.startAt):SO(j,T.fieldPath,j.startAt);se.push(v.value),J&&(J=v.inclusive)}return new Yr(se,J)}(l,c),_=function(j,Q){let se=[],J=!0;for(let T of Eo(Q)){let v=T.kind===0?SO(j,T.fieldPath,j.endAt):DO(j,T.fieldPath,j.endAt);se.push(v.value),J&&(J=v.inclusive)}return new Yr(se,J)}(l,c),w=this.In(c,l,m),C=this.In(c,l,_),A=this.Tn(c,l,h),L=this.En(c.indexId,d,w,m.inclusive,C,_.inclusive,A);return x.forEach(L,H=>r.G(H,t.limit).next(j=>{j.forEach(Q=>{let se=W.fromSegments(Q.documentKey);o.has(se)||(o=o.add(se),a.push(se))})}))}).next(()=>a)}return x.resolve(null)})}hn(e){let t=this.ln.get(e);return t||(e.filters.length===0?t=[e]:t=h8(ke.create(e.filters,"and")).map(r=>cb(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.ln.set(e,t),t)}En(e,t,r,i,s,o,a){let c=(t!=null?t.length:1)*Math.max(r.length,s.length),l=c/(t!=null?t.length:1),d=[];for(let h=0;h<c;++h){let m=t?this.dn(t[h/l]):Nm,_=this.An(e,m,r[h%l],i),w=this.Rn(e,m,s[h%l],o),C=a.map(A=>this.An(e,m,A,!0));d.push(...this.createRange(_,w,C))}return d}An(e,t,r,i){let s=new Do(e,W.empty(),t,r);return i?s:s.Zt()}Rn(e,t,r,i){let s=new Do(e,W.empty(),t,r);return i?s.Zt():s}Pn(e,t){let r=new sg(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(let a of s)r.rn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,t){let r=2,i=this.hn(t);return x.forEach(i,s=>this.Pn(e,s).next(o=>{o?r!==0&&o.fields.length<function(c){let l=new je(ht.comparator),d=!1;for(let h of c.filters)for(let m of h.getFlattenedFilters())m.field.isKeyField()||(m.op==="array-contains"||m.op==="array-contains-any"?d=!0:l=l.add(m.field));for(let h of c.orderBy)h.field.isKeyField()||(l=l.add(h.field));return l.size+(d?1:0)}(s)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(t)&&i.length>1&&r===2?1:r)}Vn(e,t){let r=new Co;for(let i of Eo(e)){let s=t.data.field(i.fieldPath);if(s==null)return null;let o=r.Yt(i.kind);bi.vt.It(s,o)}return r.zt()}dn(e){let t=new Co;return bi.vt.It(e,t.Yt(0)),t.zt()}mn(e,t){let r=new Co;return bi.vt.It(xo(this.databaseId,t),r.Yt(function(s){let o=Eo(s);return o.length===0?0:o[o.length-1].kind}(e))),r.zt()}Tn(e,t,r){if(r===null)return[];let i=[];i.push(new Co);let s=0;for(let o of Eo(e)){let a=r[s++];for(let c of i)if(this.fn(t,o.fieldPath)&&Rd(a))i=this.gn(i,o,a);else{let l=c.Yt(o.kind);bi.vt.It(a,l)}}return this.pn(i)}In(e,t,r){return this.Tn(e,t,r.position)}pn(e){let t=[];for(let r=0;r<e.length;++r)t[r]=e[r].zt();return t}gn(e,t,r){let i=[...e],s=[];for(let o of r.arrayValue.values||[])for(let a of i){let c=new Co;c.seed(a.zt()),bi.vt.It(o,c.Yt(t.kind)),s.push(c)}return s}fn(e,t){return!!e.filters.find(r=>r instanceof we&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,t){let r=pd(e),i=lc(e);return(t?r.U("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.U()).next(s=>{let o=[];return x.forEach(s,a=>i.get([a.indexId,this.uid]).next(c=>{o.push(function(d,h){let m=h?new bd(h.sequenceNumber,new Qn(Oo(h.readTime),new W(qr(h.documentKey)),h.largestBatchId)):bd.empty(),_=d.fields.map(([w,C])=>new _c(ht.fromServerFormat(w),C));return new Ic(d.indexId,d.collectionGroup,_,m)}(a,c))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((r,i)=>{let s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:ae(r.collectionGroup,i.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){let i=pd(e),s=lc(e);return this.yn(e).next(o=>i.U("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(a=>x.forEach(a,c=>s.put(BO(c.indexId,this.uid,o,r)))))}updateIndexEntries(e,t){let r=new Map;return x.forEach(t,(i,s)=>{let o=r.get(i.collectionGroup);return(o?x.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),x.forEach(a,c=>this.wn(e,i,c).next(l=>{let d=this.Sn(s,c);return l.isEqual(d)?x.resolve():this.bn(e,s,c,l,d)}))))})}Dn(e,t,r,i){return cc(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.mn(r,t.key),documentKey:t.key.path.toArray()})}vn(e,t,r,i){return cc(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.mn(r,t.key),t.key.path.toArray()])}wn(e,t,r){let i=cc(e),s=new je(ls);return i.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.mn(r,t)])},(o,a)=>{s=s.add(new Do(r.indexId,t,a.arrayValue,a.directionalValue))}).next(()=>s)}Sn(e,t){let r=new je(ls),i=this.Vn(t,e);if(i==null)return r;let s=zT(t);if(s!=null){let o=e.data.field(s.fieldPath);if(Rd(o))for(let a of o.arrayValue.values||[])r=r.add(new Do(t.indexId,e.key,this.dn(a),i))}else r=r.add(new Do(t.indexId,e.key,Nm,i));return r}bn(e,t,r,i,s){V("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);let o=[];return function(c,l,d,h,m){let _=c.getIterator(),w=l.getIterator(),C=ac(_),A=ac(w);for(;C||A;){let L=!1,H=!1;if(C&&A){let j=d(C,A);j<0?H=!0:j>0&&(L=!0)}else C!=null?H=!0:L=!0;L?(h(A),A=ac(w)):H?(m(C),C=ac(_)):(C=ac(_),A=ac(w))}}(i,s,ls,a=>{o.push(this.Dn(e,t,r,a))},a=>{o.push(this.vn(e,t,r,a))}),x.waitFor(o)}yn(e){let t=1;return lc(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),t=i.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((o,a)=>ls(o,a)).filter((o,a,c)=>!a||ls(o,c[a-1])!==0);let i=[];i.push(e);for(let o of r){let a=ls(o,e),c=ls(o,t);if(a===0)i[0]=e.Zt();else if(a>0&&c<0)i.push(o),i.push(o.Zt());else if(c>0)break}i.push(t);let s=[];for(let o=0;o<i.length;o+=2){if(this.Cn(i[o],i[o+1]))return[];let a=[i[o].indexId,this.uid,i[o].arrayValue,i[o].directionalValue,Nm,[]],c=[i[o+1].indexId,this.uid,i[o+1].arrayValue,i[o+1].directionalValue,Nm,[]];s.push(IDBKeyRange.bound(a,c))}return s}Cn(e,t){return ls(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(KO)}getMinOffset(e,t){return x.mapArray(this.hn(t),r=>this.Pn(e,r).next(i=>i||Y())).next(KO)}};function GO(n){return At(n,"collectionParents")}function cc(n){return At(n,"indexEntries")}function pd(n){return At(n,"indexConfiguration")}function lc(n){return At(n,"indexState")}function KO(n){Z(n.length!==0);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){let i=n[r].indexState.offset;U0(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new Qn(e.readTime,e.documentKey,t)}var QO={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Gn=class n{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};function _L(n,e,t){let r=n.store("mutations"),i=n.store("documentMutations"),s=[],o=IDBKeyRange.only(t.batchId),a=0,c=r.J({range:o},(d,h,m)=>(a++,m.delete()));s.push(c.next(()=>{Z(a===1)}));let l=[];for(let d of t.mutations){let h=b1(e,d.key.path,t.batchId);s.push(i.delete(h)),l.push(d.key)}return x.waitFor(s).next(()=>l)}function ag(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw Y();e=n.noDocument}return JSON.stringify(e).length}Gn.DEFAULT_COLLECTION_PERCENTILE=10,Gn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Gn.DEFAULT=new Gn(41943040,Gn.DEFAULT_COLLECTION_PERCENTILE,Gn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Gn.DISABLED=new Gn(-1,0,0);var cg=class n{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.Fn={}}static lt(e,t,r,i){Z(e.uid!=="");let s=e.isAuthenticated()?e.uid:"";return new n(s,t,r,i)}checkEmpty(e){let t=!0,r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return us(e).J({index:"userMutationsIndex",range:r},(i,s,o)=>{t=!1,o.done()}).next(()=>t)}addMutationBatch(e,t,r,i){let s=mc(e),o=us(e);return o.add({}).next(a=>{Z(typeof a=="number");let c=new Nd(a,t,r,i),l=function(_,w,C){let A=C.baseMutations.map(H=>Ld(_.ct,H)),L=C.mutations.map(H=>Ld(_.ct,H));return{userId:w,batchId:C.batchId,localWriteTimeMs:C.localWriteTime.toMillis(),baseMutations:A,mutations:L}}(this.serializer,this.userId,c),d=[],h=new je((m,_)=>ae(m.canonicalString(),_.canonicalString()));for(let m of i){let _=b1(this.userId,m.key.path,a);h=h.add(m.key.path.popLast()),d.push(o.put(l)),d.push(s.put(_,y5))}return h.forEach(m=>{d.push(this.indexManager.addToCollectionParentIndex(e,m))}),e.addOnCommittedListener(()=>{this.Fn[a]=c.keys()}),x.waitFor(d).next(()=>c)})}lookupMutationBatch(e,t){return us(e).get(t).next(r=>r?(Z(r.userId===this.userId),bo(this.serializer,r)):null)}Mn(e,t){return this.Fn[t]?x.resolve(this.Fn[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){let i=r.keys();return this.Fn[t]=i,i}return null})}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]),s=null;return us(e).J({index:"userMutationsIndex",range:i},(o,a,c)=>{a.userId===this.userId&&(Z(a.batchId>=r),s=bo(this.serializer,a)),c.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){let t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return us(e).J({index:"userMutationsIndex",range:t,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){let t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return us(e).U("userMutationsIndex",t).next(r=>r.map(i=>bo(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,t){let r=Om(this.userId,t.path),i=IDBKeyRange.lowerBound(r),s=[];return mc(e).J({range:i},(o,a,c)=>{let[l,d,h]=o,m=qr(d);if(l===this.userId&&t.path.isEqual(m))return us(e).get(h).next(_=>{if(!_)throw Y();Z(_.userId===this.userId),s.push(bo(this.serializer,_))});c.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new je(ae),i=[];return t.forEach(s=>{let o=Om(this.userId,s.path),a=IDBKeyRange.lowerBound(o),c=mc(e).J({range:a},(l,d,h)=>{let[m,_,w]=l,C=qr(_);m===this.userId&&s.path.isEqual(C)?r=r.add(w):h.done()});i.push(c)}),x.waitFor(i).next(()=>this.xn(e,r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,s=Om(this.userId,r),o=IDBKeyRange.lowerBound(s),a=new je(ae);return mc(e).J({range:o},(c,l,d)=>{let[h,m,_]=c,w=qr(m);h===this.userId&&r.isPrefixOf(w)?w.length===i&&(a=a.add(_)):d.done()}).next(()=>this.xn(e,a))}xn(e,t){let r=[],i=[];return t.forEach(s=>{i.push(us(e).get(s).next(o=>{if(o===null)throw Y();Z(o.userId===this.userId),r.push(bo(this.serializer,o))}))}),x.waitFor(i).next(()=>r)}removeMutationBatch(e,t){return _L(e._e,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.On(t.batchId)}),x.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return x.resolve();let r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),i=[];return mc(e).J({range:r},(s,o,a)=>{if(s[0]===this.userId){let c=qr(s[1]);i.push(c)}else a.done()}).next(()=>{Z(i.length===0)})})}containsKey(e,t){return yL(e,this.userId,t)}Nn(e){return vL(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}};function yL(n,e,t){let r=Om(e,t.path),i=r[1],s=IDBKeyRange.lowerBound(r),o=!1;return mc(n).J({range:s,H:!0},(a,c,l)=>{let[d,h,m]=a;d===e&&h===i&&(o=!0),l.done()}).next(()=>o)}function us(n){return At(n,"mutations")}function mc(n){return At(n,"documentMutations")}function vL(n){return At(n,"mutationQueues")}var Ac=class n{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new n(0)}static kn(){return new n(-1)}};var xb=class{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.qn(e).next(t=>{let r=new Ac(t.highestTargetId);return t.highestTargetId=r.next(),this.Qn(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.qn(e).next(t=>ee.fromTimestamp(new et(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.qn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.qn(e).next(i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.Qn(e,i)))}addTargetData(e,t){return this.Kn(e,t).next(()=>this.qn(e).next(r=>(r.targetCount+=1,this.$n(t,r),this.Qn(e,r))))}updateTargetData(e,t){return this.Kn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>uc(e).delete(t.targetId)).next(()=>this.qn(e)).next(r=>(Z(r.targetCount>0),r.targetCount-=1,this.Qn(e,r)))}removeTargets(e,t,r){let i=0,s=[];return uc(e).J((o,a)=>{let c=yd(a);c.sequenceNumber<=t&&r.get(c.targetId)===null&&(i++,s.push(this.removeTargetData(e,c)))}).next(()=>x.waitFor(s)).next(()=>i)}forEachTarget(e,t){return uc(e).J((r,i)=>{let s=yd(i);t(s)})}qn(e){return YO(e).get("targetGlobalKey").next(t=>(Z(t!==null),t))}Qn(e,t){return YO(e).put("targetGlobalKey",t)}Kn(e,t){return uc(e).put(pL(this.serializer,t))}$n(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.qn(e).next(t=>t.targetCount)}getTargetData(e,t){let r=Po(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),s=null;return uc(e).J({range:i,index:"queryTargetsIndex"},(o,a,c)=>{let l=yd(a);Kd(t,l.target)&&(s=l,c.done())}).next(()=>s)}addMatchingKeys(e,t,r){let i=[],s=ds(e);return t.forEach(o=>{let a=cn(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),x.waitFor(i)}removeMatchingKeys(e,t,r){let i=ds(e);return x.forEach(t,s=>{let o=cn(s.path);return x.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,t){let r=ds(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){let r=IDBKeyRange.bound([t],[t+1],!1,!0),i=ds(e),s=he();return i.J({range:r,H:!0},(o,a,c)=>{let l=qr(o[1]),d=new W(l);s=s.add(d)}).next(()=>s)}containsKey(e,t){let r=cn(t.path),i=IDBKeyRange.bound([r],[y1(r)],!1,!0),s=0;return ds(e).J({index:"documentTargetsIndex",H:!0,range:i},([o,a],c,l)=>{o!==0&&(s++,l.done())}).next(()=>s>0)}ot(e,t){return uc(e).get(t).next(r=>r?yd(r):null)}};function uc(n){return At(n,"targets")}function YO(n){return At(n,"targetGlobal")}function ds(n){return At(n,"targetDocuments")}function JO([n,e],[t,r]){let i=ae(n,t);return i===0?ae(e,r):i}var Nb=class{constructor(e){this.Un=e,this.buffer=new je(JO),this.Wn=0}Gn(){return++this.Wn}zn(e){let t=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(t);else{let r=this.buffer.last();JO(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}},Pb=class{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return this.jn!==null}Hn(e){V("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>g(this,null,function*(){this.jn=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(t){Ds(t)?V("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t):yield Cs(t)}yield this.Hn(3e5)}))}},Mb=class{constructor(e,t){this.Jn=e,this.params=t}calculateTargetCount(e,t){return this.Jn.Yn(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return x.resolve(xn.oe);let r=new Nb(t);return this.Jn.forEachTarget(e,i=>r.zn(i.sequenceNumber)).next(()=>this.Jn.Zn(e,i=>r.zn(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.Jn.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Jn.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(V("LruGarbageCollector","Garbage collection skipped; disabled"),x.resolve(QO)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(V("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),QO):this.Xn(e,t))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,t){let r,i,s,o,a,c,l,d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(V("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),i=this.params.maximumSequenceNumbersToCollect):i=h,o=Date.now(),this.nthSequenceNumber(e,i))).next(h=>(r=h,a=Date.now(),this.removeTargets(e,r,t))).next(h=>(s=h,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(h=>(l=Date.now(),dc()<=me.DEBUG&&V("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(c-a)+`ms
	Removed ${h} documents in `+(l-c)+`ms
Total Duration: ${l-d}ms`),x.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:h})))}};function f8(n,e){return new Mb(n,e)}var kb=class{constructor(e,t){this.db=e,this.garbageCollector=f8(this,t)}Yn(e){let t=this.er(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}er(e){let t=0;return this.Zn(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Zn(e,t){return this.tr(e,(r,i)=>t(i))}addReference(e,t,r){return Pm(e,r)}removeReference(e,t,r){return Pm(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return Pm(e,t)}nr(e,t){return function(i,s){let o=!1;return vL(i).Y(a=>yL(i,a,s).next(c=>(c&&(o=!0),x.resolve(!c)))).next(()=>o)}(e,t)}removeOrphanedDocuments(e,t){let r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],s=0;return this.tr(e,(o,a)=>{if(a<=t){let c=this.nr(e,o).next(l=>{if(!l)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,ee.min()),ds(e).delete(function(h){return[0,cn(h.path)]}(o))))});i.push(c)}}).next(()=>x.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return Pm(e,t)}tr(e,t){let r=ds(e),i,s=xn.oe;return r.J({index:"documentTargetsIndex"},([o,a],{path:c,sequenceNumber:l})=>{o===0?(s!==xn.oe&&t(new W(qr(i)),s),s=l,i=c):s=xn.oe}).next(()=>{s!==xn.oe&&t(new W(qr(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}};function Pm(n,e){return ds(n).put(function(r,i){return{targetId:0,path:cn(r.path),sequenceNumber:i}}(e,n.currentSequenceNumber))}var lg=class{constructor(){this.changes=new Jr(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,bt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?x.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var Ob=class{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return Io(e).put(r)}removeEntry(e,t,r){return Io(e).delete(function(s,o){let a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],rg(o),a[a.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.rr(e,r)))}getEntry(e,t){let r=bt.newInvalidDocument(t);return Io(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(md(t))},(i,s)=>{r=this.ir(t,s)}).next(()=>r)}sr(e,t){let r={size:0,document:bt.newInvalidDocument(t)};return Io(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(md(t))},(i,s)=>{r={document:this.ir(t,s),size:ag(s)}}).next(()=>r)}getEntries(e,t){let r=In();return this._r(e,t,(i,s)=>{let o=this.ir(i,s);r=r.insert(i,o)}).next(()=>r)}ar(e,t){let r=In(),i=new Ke(W.comparator);return this._r(e,t,(s,o)=>{let a=this.ir(s,o);r=r.insert(s,a),i=i.insert(s,ag(o))}).next(()=>({documents:r,ur:i}))}_r(e,t,r){if(t.isEmpty())return x.resolve();let i=new je(e1);t.forEach(c=>i=i.add(c));let s=IDBKeyRange.bound(md(i.first()),md(i.last())),o=i.getIterator(),a=o.getNext();return Io(e).J({index:"documentKeyIndex",range:s},(c,l,d)=>{let h=W.fromSegments([...l.prefixPath,l.collectionGroup,l.documentId]);for(;a&&e1(a,h)<0;)r(a,null),a=o.getNext();a&&a.isEqual(h)&&(r(a,l),a=o.hasNext()?o.getNext():null),a?d.$(md(a)):d.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,t,r,i,s){let o=t.path,a=[o.popLast().toArray(),o.lastSegment(),rg(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],c=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Io(e).U(IDBKeyRange.bound(a,c,!0)).next(l=>{s?.incrementDocumentReadCount(l.length);let d=In();for(let h of l){let m=this.ir(W.fromSegments(h.prefixPath.concat(h.collectionGroup,h.documentId)),h);m.isFoundDocument()&&(Yd(t,m)||i.has(m.key))&&(d=d.insert(m.key,m))}return d})}getAllFromCollectionGroup(e,t,r,i){let s=In(),o=ZO(t,r),a=ZO(t,Qn.max());return Io(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(c,l,d)=>{let h=this.ir(W.fromSegments(l.prefixPath.concat(l.collectionGroup,l.documentId)),l);s=s.insert(h.key,h),s.size===i&&d.done()}).next(()=>s)}newChangeBuffer(e){return new Lb(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return XO(e).get("remoteDocumentGlobalKey").next(t=>(Z(!!t),t))}rr(e,t){return XO(e).put("remoteDocumentGlobalKey",t)}ir(e,t){if(t){let r=u8(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(ee.min())))return r}return bt.newInvalidDocument(e)}};function wL(n){return new Ob(n)}var Lb=class extends lg{constructor(e,t){super(),this.cr=e,this.trackRemovals=t,this.lr=new Jr(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){let t=[],r=0,i=new je((s,o)=>ae(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{let a=this.lr.get(s);if(t.push(this.cr.removeEntry(e,s,a.readTime)),o.isValidDocument()){let c=UO(this.cr.serializer,o);i=i.add(s.path.popLast());let l=ag(c);r+=l-a.size,t.push(this.cr.addEntry(e,s,c))}else if(r-=a.size,this.trackRemovals){let c=UO(this.cr.serializer,o.convertToNoDocument(ee.min()));t.push(this.cr.addEntry(e,s,c))}}),i.forEach(s=>{t.push(this.cr.indexManager.addToCollectionParentIndex(e,s))}),t.push(this.cr.updateMetadata(e,r)),x.waitFor(t)}getFromCache(e,t){return this.cr.sr(e,t).next(r=>(this.lr.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this.cr.ar(e,t).next(({documents:r,ur:i})=>(i.forEach((s,o)=>{this.lr.set(s,{size:o,readTime:r.get(s).readTime})}),r))}};function XO(n){return At(n,"remoteDocumentGlobal")}function Io(n){return At(n,"remoteDocumentsV14")}function md(n){let e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function ZO(n,e){let t=e.documentKey.path.toArray();return[n,rg(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function e1(n,e){let t=n.path.toArray(),r=e.path.toArray(),i=0;for(let s=0;s<t.length-2&&s<r.length-2;++s)if(i=ae(t[s],r[s]),i)return i;return i=ae(t.length,r.length),i||(i=ae(t[t.length-2],r[r.length-2]),i||ae(t[t.length-1],r[r.length-1]))}var Fb=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var ug=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&Id(r.mutation,i,Nn.empty(),et.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,he()).next(()=>r))}getLocalViewOfDocuments(e,t,r=he()){let i=zr();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let o=_d();return s.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){let r=zr();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,he()))}populateOverlays(e,t,r){let i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,r,i){let s=In(),o=wd(),a=function(){return wd()}();return t.forEach((c,l)=>{let d=r.get(l.key);i.has(l.key)&&(d===void 0||d.mutation instanceof gr)?s=s.insert(l.key,l):d!==void 0?(o.set(l.key,d.mutation.getFieldMask()),Id(d.mutation,l,d.mutation.getFieldMask(),et.now())):o.set(l.key,Nn.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((l,d)=>o.set(l,d)),t.forEach((l,d)=>{var h;return a.set(l,new Fb(d,(h=o.get(l))!==null&&h!==void 0?h:null))}),a))}recalculateAndSaveOverlays(e,t){let r=wd(),i=new Ke((o,a)=>o-a),s=he();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(let a of o)a.keys().forEach(c=>{let l=t.get(c);if(l===null)return;let d=r.get(c)||Nn.empty();d=a.applyToLocalView(l,d),r.set(c,d);let h=(i.get(a.batchId)||he()).add(c);i=i.insert(a.batchId,h)})}).next(()=>{let o=[],a=i.getReverseIterator();for(;a.hasNext();){let c=a.getNext(),l=c.key,d=c.value,h=q1();d.forEach(m=>{if(!s.has(m)){let _=J1(t.get(m),r.get(m));_!==null&&h.set(m,_),s=s.add(m)}}),o.push(this.documentOverlayCache.saveOverlays(e,l,h))}return x.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(o){return W.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):q0(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{let o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):x.resolve(zr()),a=-1,c=s;return o.next(l=>x.forEach(l,(d,h)=>(a<h.largestBatchId&&(a=h.largestBatchId),s.get(d)?x.resolve():this.remoteDocumentCache.getEntry(e,d).next(m=>{c=c.insert(d,m)}))).next(()=>this.populateOverlays(e,l,s)).next(()=>this.computeViews(e,c,l,he())).next(d=>({batchId:a,changes:H1(d)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new W(t)).next(r=>{let i=_d();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let s=t.collectionGroup,o=_d();return this.indexManager.getCollectionParents(e,s).next(a=>x.forEach(a,c=>{let l=function(h,m){return new mr(m,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(t,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,l,r,i).next(d=>{d.forEach((h,m)=>{o=o.insert(h,m)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i))).next(o=>{s.forEach((c,l)=>{let d=l.getKey();o.get(d)===null&&(o=o.insert(d,bt.newInvalidDocument(d)))});let a=_d();return o.forEach((c,l)=>{let d=s.get(c);d!==void 0&&Id(d.mutation,l,Nn.empty(),et.now()),Yd(t,l)&&(a=a.insert(c,l))}),a})}};var Vb=class{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return x.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:ft(i.createTime)}}(t)),x.resolve()}getNamedQuery(e,t){return x.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(i){return{name:i.name,query:K0(i.bundledQuery),readTime:ft(i.readTime)}}(t)),x.resolve()}};var Ub=class{constructor(){this.overlays=new Ke(W.comparator),this.Ir=new Map}getOverlay(e,t){return x.resolve(this.overlays.get(t))}getOverlays(e,t){let r=zr();return x.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.ht(e,t,s)}),x.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.Ir.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(r)),x.resolve()}getOverlaysForCollection(e,t,r){let i=zr(),s=t.length+1,o=new W(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){let c=a.getNext().value,l=c.getKey();if(!t.isPrefixOf(l.path))break;l.path.length===s&&c.largestBatchId>r&&i.set(c.getKey(),c)}return x.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new Ke((l,d)=>l-d),o=this.overlays.getIterator();for(;o.hasNext();){let l=o.getNext().value;if(l.getKey().getCollectionGroup()===t&&l.largestBatchId>r){let d=s.get(l.largestBatchId);d===null&&(d=zr(),s=s.insert(l.largestBatchId,d)),d.set(l.getKey(),l)}}let a=zr(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((l,d)=>a.set(l,d)),!(a.size()>=i)););return x.resolve(a)}ht(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let o=this.Ir.get(i.largestBatchId).delete(r.key);this.Ir.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new Pd(t,r));let s=this.Ir.get(t);s===void 0&&(s=he(),this.Ir.set(t,s)),this.Ir.set(t,s.add(r.key))}};var jb=class{constructor(){this.sessionToken=pt.EMPTY_BYTE_STRING}getSessionToken(e){return x.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,x.resolve()}};var Vd=class{constructor(){this.Tr=new je(It.Er),this.dr=new je(It.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){let r=new It(e,t);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Vr(new It(e,t))}mr(e,t){e.forEach(r=>this.removeReference(r,t))}gr(e){let t=new W(new De([])),r=new It(t,e),i=new It(t,e+1),s=[];return this.dr.forEachInRange([r,i],o=>{this.Vr(o),s.push(o.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){let t=new W(new De([])),r=new It(t,e),i=new It(t,e+1),s=he();return this.dr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){let t=new It(e,0),r=this.Tr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},It=class{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return W.comparator(e.key,t.key)||ae(e.wr,t.wr)}static Ar(e,t){return ae(e.wr,t.wr)||W.comparator(e.key,t.key)}};var Bb=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new je(It.Er)}checkEmpty(e){return x.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let o=new Nd(s,t,r,i);this.mutationQueue.push(o);for(let a of i)this.br=this.br.add(new It(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return x.resolve(o)}lookupMutationBatch(e,t){return x.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.vr(r),s=i<0?0:i;return x.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return x.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return x.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new It(t,0),i=new It(t,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([r,i],o=>{let a=this.Dr(o.wr);s.push(a)}),x.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new je(ae);return t.forEach(i=>{let s=new It(i,0),o=new It(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,o],a=>{r=r.add(a.wr)})}),x.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,s=r;W.isDocumentKey(s)||(s=s.child(""));let o=new It(new W(s),0),a=new je(ae);return this.br.forEachWhile(c=>{let l=c.key.path;return!!r.isPrefixOf(l)&&(l.length===i&&(a=a.add(c.wr)),!0)},o),x.resolve(this.Cr(a))}Cr(e){let t=[];return e.forEach(r=>{let i=this.Dr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){Z(this.Fr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return x.forEach(t.mutations,i=>{let s=new It(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,t){let r=new It(t,0),i=this.br.firstAfterOrEqual(r);return x.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,x.resolve()}Fr(e,t){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){let t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var $b=class{constructor(e){this.Mr=e,this.docs=function(){return new Ke(W.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),s=i?i.size:0,o=this.Mr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return x.resolve(r?r.document.mutableCopy():bt.newInvalidDocument(t))}getEntries(e,t){let r=In();return t.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():bt.newInvalidDocument(i))}),x.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=In(),o=t.path,a=new W(o.child("")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){let{key:l,value:{document:d}}=c.getNext();if(!o.isPrefixOf(l.path))break;l.path.length>o.length+1||U0(w1(d),r)<=0||(i.has(d.key)||Yd(t,d))&&(s=s.insert(d.key,d.mutableCopy()))}return x.resolve(s)}getAllFromCollectionGroup(e,t,r,i){Y()}Or(e,t){return x.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new Hb(this)}getSize(e){return x.resolve(this.size)}},Hb=class extends lg{constructor(e){super(),this.cr=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.cr.addEntry(e,i)):this.cr.removeEntry(r)}),x.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}};var qb=class{constructor(e){this.persistence=e,this.Nr=new Jr(t=>Po(t),Kd),this.lastRemoteSnapshotVersion=ee.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Vd,this.targetCount=0,this.kr=Ac.Bn()}forEachTarget(e,t){return this.Nr.forEach((r,i)=>t(i)),x.resolve()}getLastRemoteSnapshotVersion(e){return x.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return x.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),x.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Lr&&(this.Lr=t),x.resolve()}Kn(e){this.Nr.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.kr=new Ac(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,x.resolve()}updateTargetData(e,t){return this.Kn(t),x.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,x.resolve()}removeTargets(e,t,r){let i=0,s=[];return this.Nr.forEach((o,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.Nr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),x.waitFor(s).next(()=>i)}getTargetCount(e){return x.resolve(this.targetCount)}getTargetData(e,t){let r=this.Nr.get(t)||null;return x.resolve(r)}addMatchingKeys(e,t,r){return this.Br.Rr(t,r),x.resolve()}removeMatchingKeys(e,t,r){this.Br.mr(t,r);let i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),x.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),x.resolve()}getMatchingKeysForTargetId(e,t){let r=this.Br.yr(t);return x.resolve(r)}containsKey(e,t){return x.resolve(this.Br.containsKey(t))}};var dg=class{constructor(e,t){this.qr={},this.overlays={},this.Qr=new xn(0),this.Kr=!1,this.Kr=!0,this.$r=new jb,this.referenceDelegate=e(this),this.Ur=new qb(this),this.indexManager=new Ab,this.remoteDocumentCache=function(i){return new $b(i)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new ng(t),this.Gr=new Vb(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Ub,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.qr[e.toKey()];return r||(r=new Bb(t,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,r){V("MemoryPersistence","Starting transaction:",e);let i=new zb(this.Qr.next());return this.referenceDelegate.zr(),r(i).next(s=>this.referenceDelegate.jr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Hr(e,t){return x.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,t)))}},zb=class extends qm{constructor(e){super(),this.currentSequenceNumber=e}},hg=class n{constructor(e){this.persistence=e,this.Jr=new Vd,this.Yr=null}static Zr(e){return new n(e)}get Xr(){if(this.Yr)return this.Yr;throw Y()}addReference(e,t,r){return this.Jr.addReference(r,t),this.Xr.delete(r.toString()),x.resolve()}removeReference(e,t,r){return this.Jr.removeReference(r,t),this.Xr.add(r.toString()),x.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),x.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(i=>this.Xr.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.Xr.add(s.toString()))}).next(()=>r.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return x.forEach(this.Xr,r=>{let i=W.fromPath(r);return this.ei(e,i).next(s=>{s||t.removeEntry(i,ee.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(r=>{r?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return x.or([()=>x.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}};var Wb=class{constructor(e){this.serializer=e}O(e,t,r,i){let s=new zm("createOrUpgrade",t);r<1&&i>=1&&(function(c){c.createObjectStore("owner")}(e),function(c){c.createObjectStore("mutationQueues",{keyPath:"userId"}),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",gO,{unique:!0}),c.createObjectStore("documentMutations")}(e),t1(e),function(c){c.createObjectStore("remoteDocuments")}(e));let o=x.resolve();return r<3&&i>=3&&(r!==0&&(function(c){c.deleteObjectStore("targetDocuments"),c.deleteObjectStore("targets"),c.deleteObjectStore("targetGlobal")}(e),t1(e)),o=o.next(()=>function(c){let l=c.store("targetGlobal"),d={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:ee.min().toTimestamp(),targetCount:0};return l.put("targetGlobalKey",d)}(s))),r<4&&i>=4&&(r!==0&&(o=o.next(()=>function(c,l){return l.store("mutations").U().next(d=>{c.deleteObjectStore("mutations"),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",gO,{unique:!0});let h=l.store("mutations"),m=d.map(_=>h.put(_));return x.waitFor(m)})}(e,s))),o=o.next(()=>{(function(c){c.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(o=o.next(()=>this.ni(s))),r<6&&i>=6&&(o=o.next(()=>(function(c){c.createObjectStore("remoteDocumentGlobal")}(e),this.ri(s)))),r<7&&i>=7&&(o=o.next(()=>this.ii(s))),r<8&&i>=8&&(o=o.next(()=>this.si(e,s))),r<9&&i>=9&&(o=o.next(()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(o=o.next(()=>this.oi(s))),r<11&&i>=11&&(o=o.next(()=>{(function(c){c.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(c){c.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(o=o.next(()=>{(function(c){let l=c.createObjectStore("documentOverlays",{keyPath:x5});l.createIndex("collectionPathOverlayIndex",N5,{unique:!1}),l.createIndex("collectionGroupOverlayIndex",P5,{unique:!1})})(e)})),r<13&&i>=13&&(o=o.next(()=>function(c){let l=c.createObjectStore("remoteDocumentsV14",{keyPath:v5});l.createIndex("documentKeyIndex",w5),l.createIndex("collectionGroupIndex",I5)}(e)).next(()=>this._i(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(o=o.next(()=>this.ai(e,s))),r<15&&i>=15&&(o=o.next(()=>function(c){c.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),c.createObjectStore("indexState",{keyPath:D5}).createIndex("sequenceNumberIndex",S5,{unique:!1}),c.createObjectStore("indexEntries",{keyPath:A5}).createIndex("documentKeyIndex",R5,{unique:!1})}(e))),r<16&&i>=16&&(o=o.next(()=>{t.objectStore("indexState").clear()}).next(()=>{t.objectStore("indexEntries").clear()})),r<17&&i>=17&&(o=o.next(()=>{(function(c){c.createObjectStore("globals",{keyPath:"name"})})(e)})),o}ri(e){let t=0;return e.store("remoteDocuments").J((r,i)=>{t+=ag(i)}).next(()=>{let r={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}ni(e){let t=e.store("mutationQueues"),r=e.store("mutations");return t.U().next(i=>x.forEach(i,s=>{let o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.U("userMutationsIndex",o).next(a=>x.forEach(a,c=>{Z(c.userId===s.userId);let l=bo(this.serializer,c);return _L(e,s.userId,l).next(()=>{})}))}))}ii(e){let t=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{let s=[];return r.J((o,a)=>{let c=new De(o),l=function(h){return[0,cn(h)]}(c);s.push(t.get(l).next(d=>d?x.resolve():(h=>t.put({targetId:0,path:cn(h),sequenceNumber:i.highestListenSequenceNumber}))(c)))}).next(()=>x.waitFor(s))})}si(e,t){e.createObjectStore("collectionParents",{keyPath:C5});let r=t.store("collectionParents"),i=new Fd,s=o=>{if(i.add(o)){let a=o.lastSegment(),c=o.popLast();return r.put({collectionId:a,parent:cn(c)})}};return t.store("remoteDocuments").J({H:!0},(o,a)=>{let c=new De(o);return s(c.popLast())}).next(()=>t.store("documentMutations").J({H:!0},([o,a,c],l)=>{let d=qr(a);return s(d.popLast())}))}oi(e){let t=e.store("targets");return t.J((r,i)=>{let s=yd(i),o=pL(this.serializer,s);return t.put(o)})}_i(e,t){let r=t.store("remoteDocuments"),i=[];return r.J((s,o)=>{let a=t.store("remoteDocumentsV14"),c=function(h){return h.document?new W(De.fromString(h.document.name).popFirst(5)):h.noDocument?W.fromSegments(h.noDocument.path):h.unknownDocument?W.fromSegments(h.unknownDocument.path):Y()}(o).path.toArray(),l={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(a.put(l))}).next(()=>x.waitFor(i))}ai(e,t){let r=t.store("mutations"),i=wL(this.serializer),s=new dg(hg.Zr,this.serializer.ct);return r.U().next(o=>{let a=new Map;return o.forEach(c=>{var l;let d=(l=a.get(c.userId))!==null&&l!==void 0?l:he();bo(this.serializer,c).keys().forEach(h=>d=d.add(h)),a.set(c.userId,d)}),x.forEach(a,(c,l)=>{let d=new Et(l),h=ig.lt(this.serializer,d),m=s.getIndexManager(d),_=cg.lt(d,this.serializer,m,s.referenceDelegate);return new ug(i,_,h,m).recalculateAndSaveOverlaysForDocumentKeys(new Dd(t,xn.oe),c).next()})})}};function t1(n){n.createObjectStore("targetDocuments",{keyPath:T5}).createIndex("documentTargetsIndex",b5,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",E5,{unique:!0}),n.createObjectStore("targetGlobal")}var OT="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Gb=class n{constructor(e,t,r,i,s,o,a,c,l,d,h=17){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.ui=s,this.window=o,this.document=a,this.ci=l,this.li=d,this.hi=h,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=m=>Promise.resolve(),!n.D())throw new O(N.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new kb(this,i),this.Ai=t+"main",this.serializer=new ng(c),this.Ri=new gs(this.Ai,this.hi,new Wb(this.serializer)),this.$r=new Ib,this.Ur=new xb(this.referenceDelegate,this.serializer),this.remoteDocumentCache=wL(this.serializer),this.Gr=new wb,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,d===!1&&dt("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new O(N.FAILED_PRECONDITION,OT);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ur.getHighestSequenceNumber(e))}).then(e=>{this.Qr=new xn(e,this.ci)}).then(()=>{this.Kr=!0}).catch(e=>(this.Ri&&this.Ri.close(),Promise.reject(e)))}yi(e){return this.di=t=>g(this,null,function*(){if(this.started)return e(t)}),e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L(t=>g(this,null,function*(){t.newVersion===null&&(yield e())}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget(()=>g(this,null,function*(){this.started&&(yield this.mi())})))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Mm(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.wi(e).next(t=>{t||(this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)))})}).next(()=>this.Si(e)).next(t=>this.isPrimary&&!t?this.bi(e).next(()=>!1):!!t&&this.Di(e).next(()=>!0))).catch(e=>{if(Ds(e))return V("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return V("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ui.enqueueRetryable(()=>this.di(e)),this.isPrimary=e})}wi(e){return gd(e).get("owner").next(t=>x.resolve(this.vi(t)))}Ci(e){return Mm(e).delete(this.clientId)}Fi(){return g(this,null,function*(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();let e=yield this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{let r=At(t,"clientMetadata");return r.U().next(i=>{let s=this.xi(i,18e5),o=i.filter(a=>s.indexOf(a)===-1);return x.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Vi)for(let t of e)this.Vi.removeItem(this.Oi(t.clientId))}})}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.Fi()).then(()=>this.pi()))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?x.resolve(!0):gd(e).get("owner").next(t=>{if(t!==null&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)){if(this.vi(t)&&this.networkEnabled)return!0;if(!this.vi(t)){if(!t.allowTabSynchronization)throw new O(N.FAILED_PRECONDITION,OT);return!1}}return!(!this.networkEnabled||!this.inForeground)||Mm(e).U().next(r=>this.xi(r,5e3).find(i=>{if(this.clientId!==i.clientId){let s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(s||o&&a)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&V("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}shutdown(){return g(this,null,function*(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),yield this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{let t=new Dd(e,xn.oe);return this.bi(t).next(()=>this.Ci(t))}),this.Ri.close(),this.qi()})}xi(e,t){return e.filter(r=>this.Mi(r.updateTimeMs,t)&&!this.Ni(r.clientId))}Qi(){return this.runTransaction("getActiveClients","readonly",e=>Mm(e).U().next(t=>this.xi(t,18e5).map(r=>r.clientId)))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,t){return cg.lt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new Rb(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return ig.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,t,r){V("IndexedDbPersistence","Starting transaction:",e);let i=t==="readonly"?"readonly":"readwrite",s=function(c){return c===17?O5:c===16?k5:c===15?B0:c===14?S1:c===13?D1:c===12?M5:c===11?C1:void Y()}(this.hi),o;return this.Ri.runTransaction(e,i,s,a=>(o=new Dd(a,this.Qr?this.Qr.next():xn.oe),t==="readwrite-primary"?this.wi(o).next(c=>!!c||this.Si(o)).next(c=>{if(!c)throw dt(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)),new O(N.FAILED_PRECONDITION,I1);return r(o)}).next(c=>this.Di(o).next(()=>c)):this.Ki(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Ki(e){return gd(e).get("owner").next(t=>{if(t!==null&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)&&!this.vi(t)&&!(this.li||this.allowTabSynchronization&&t.allowTabSynchronization))throw new O(N.FAILED_PRECONDITION,OT)})}Di(e){let t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return gd(e).put("owner",t)}static D(){return gs.D()}bi(e){let t=gd(e);return t.get("owner").next(r=>this.vi(r)?(V("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):x.resolve())}Mi(e,t){let r=Date.now();return!(e<r-t)&&(!(e>r)||(dt(`Detected an update time that is in the future: ${e} > ${r}`),!1))}fi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ii=()=>{this.ui.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.mi()))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground=this.document.visibilityState==="visible")}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Pi=()=>{this.Li();let t=/(?:Version|Mobile)\/1[456]/;AI()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var t;try{let r=((t=this.Vi)===null||t===void 0?void 0:t.getItem(this.Oi(e)))!==null;return V("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return dt("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(e){dt("Failed to set zombie client id.",e)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch{}}Oi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}};function gd(n){return At(n,"owner")}function Mm(n){return At(n,"clientMetadata")}function Y0(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}var Kb=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.$i=r,this.Ui=i}static Wi(e,t){let r=he(),i=he();for(let s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new n(e,t.fromCache,r,i)}};var Qb=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var fg=class{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return AI()?8:E1(He())>0?6:4}()}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,r,i){let s={result:null};return this.Yi(e,t).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Zi(e,t,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;let o=new Qb;return this.Xi(e,t,o).next(a=>{if(s.result=a,this.zi)return this.es(e,t,o,a.size)})}).next(()=>s.result)}es(e,t,r,i){return r.documentReadCount<this.ji?(dc()<=me.DEBUG&&V("QueryEngine","SDK will not create cache indexes for query:",hc(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),x.resolve()):(dc()<=me.DEBUG&&V("QueryEngine","Query:",hc(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Hi*i?(dc()<=me.DEBUG&&V("QueryEngine","The SDK decides to create cache indexes for query:",hc(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ln(t))):x.resolve())}Yi(e,t){if(AO(t))return x.resolve(null);let r=ln(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=Xm(t,null,"F"),r=ln(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{let o=he(...s);return this.Ji.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(c=>{let l=this.ts(t,a);return this.ns(t,l,o,c.readTime)?this.Yi(e,Xm(t,null,"F")):this.rs(e,l,t,c)}))})))}Zi(e,t,r,i){return AO(t)||i.isEqual(ee.min())?x.resolve(null):this.Ji.getDocuments(e,r).next(s=>{let o=this.ts(t,s);return this.ns(t,o,r,i)?x.resolve(null):(dc()<=me.DEBUG&&V("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),hc(t)),this.rs(e,o,t,v1(i,-1)).next(a=>a))})}ts(e,t){let r=new je(B1(e));return t.forEach((i,s)=>{Yd(e,s)&&(r=r.add(s))}),r}ns(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Xi(e,t,r){return dc()<=me.DEBUG&&V("QueryEngine","Using full collection scan to execute query:",hc(t)),this.Ji.getDocumentsMatchingQuery(e,t,Qn.min(),r)}rs(e,t,r,i){return this.Ji.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}};var Yb=class{constructor(e,t,r,i){this.persistence=e,this.ss=t,this.serializer=i,this.os=new Ke(ae),this._s=new Jr(s=>Po(s),Kd),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new ug(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}};function IL(n,e,t,r){return new Yb(n,e,t,r)}function EL(n,e){return g(this,null,function*(){let t=z(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,t.ls(e),t.mutationQueue.getAllMutationBatches(r))).next(s=>{let o=[],a=[],c=he();for(let l of i){o.push(l.batchId);for(let d of l.mutations)c=c.add(d.key)}for(let l of s){a.push(l.batchId);for(let d of l.mutations)c=c.add(d.key)}return t.localDocuments.getDocuments(r,c).next(l=>({hs:l,removedBatchIds:o,addedBatchIds:a}))})})})}function p8(n,e){let t=z(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),s=t.cs.newChangeBuffer({trackRemovals:!0});return function(a,c,l,d){let h=l.batch,m=h.keys(),_=x.resolve();return m.forEach(w=>{_=_.next(()=>d.getEntry(c,w)).next(C=>{let A=l.docVersions.get(w);Z(A!==null),C.version.compareTo(A)<0&&(h.applyToRemoteDocument(C,l),C.isValidDocument()&&(C.setReadTime(l.commitVersion),d.addEntry(C)))})}),_.next(()=>a.mutationQueue.removeMutationBatch(c,h))}(t,r,e,s).next(()=>s.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let c=he();for(let l=0;l<a.mutationResults.length;++l)a.mutationResults[l].transformResults.length>0&&(c=c.add(a.batch.mutations[l].key));return c}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function TL(n){let e=z(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ur.getLastRemoteSnapshotVersion(t))}function m8(n,e){let t=z(n),r=e.snapshotVersion,i=t.os;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let o=t.cs.newChangeBuffer({trackRemovals:!0});i=t.os;let a=[];e.targetChanges.forEach((d,h)=>{let m=i.get(h);if(!m)return;a.push(t.Ur.removeMatchingKeys(s,d.removedDocuments,h).next(()=>t.Ur.addMatchingKeys(s,d.addedDocuments,h)));let _=m.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(h)!==null?_=_.withResumeToken(pt.EMPTY_BYTE_STRING,ee.min()).withLastLimboFreeSnapshotVersion(ee.min()):d.resumeToken.approximateByteSize()>0&&(_=_.withResumeToken(d.resumeToken,r)),i=i.insert(h,_),function(C,A,L){return C.resumeToken.approximateByteSize()===0||A.snapshotVersion.toMicroseconds()-C.snapshotVersion.toMicroseconds()>=3e8?!0:L.addedDocuments.size+L.modifiedDocuments.size+L.removedDocuments.size>0}(m,_,d)&&a.push(t.Ur.updateTargetData(s,_))});let c=In(),l=he();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(s,d))}),a.push(bL(s,o,e.documentUpdates).next(d=>{c=d.Ps,l=d.Is})),!r.isEqual(ee.min())){let d=t.Ur.getLastRemoteSnapshotVersion(s).next(h=>t.Ur.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(d)}return x.waitFor(a).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,c,l)).next(()=>c)}).then(s=>(t.os=i,s))}function bL(n,e,t){let r=he(),i=he();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let o=In();return t.forEach((a,c)=>{let l=s.get(a);c.isFoundDocument()!==l.isFoundDocument()&&(i=i.add(a)),c.isNoDocument()&&c.version.isEqual(ee.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!l.isValidDocument()||c.version.compareTo(l.version)>0||c.version.compareTo(l.version)===0&&l.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):V("LocalStore","Ignoring outdated watch update for ",a,". Current version:",l.version," Watch version:",c.version)}),{Ps:o,Is:i}})}function g8(n,e){let t=z(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Rc(n,e){let t=z(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Ur.getTargetData(r,e).next(s=>s?(i=s,x.resolve(i)):t.Ur.allocateTargetId(r).next(o=>(i=new Sc(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.Ur.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.os.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.os=t.os.insert(r.targetId,r),t._s.set(e,r.targetId)),r})}function xc(n,e,t){return g(this,null,function*(){let r=z(n),i=r.os.get(e),s=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!Ds(o))throw o;V("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.os=r.os.remove(e),r._s.delete(i.target)})}function pg(n,e,t){let r=z(n),i=ee.min(),s=he();return r.persistence.runTransaction("Execute query","readwrite",o=>function(c,l,d){let h=z(c),m=h._s.get(d);return m!==void 0?x.resolve(h.os.get(m)):h.Ur.getTargetData(l,d)}(r,o,ln(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(o,a.targetId).next(c=>{s=c})}).next(()=>r.ss.getDocumentsMatchingQuery(o,e,t?i:ee.min(),t?s:he())).next(a=>(SL(r,j1(e),a),{documents:a,Ts:s})))}function CL(n,e){let t=z(n),r=z(t.Ur),i=t.os.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",s=>r.ot(s,e).next(o=>o?o.target:null))}function DL(n,e){let t=z(n),r=t.us.get(e)||ee.min();return t.persistence.runTransaction("Get new document changes","readonly",i=>t.cs.getAllFromCollectionGroup(i,e,v1(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(SL(t,e,i),i))}function SL(n,e,t){let r=n.us.get(e)||ee.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.us.set(e,r)}function _8(n,e,t,r){return g(this,null,function*(){let i=z(n),s=he(),o=In();for(let l of t){let d=e.Es(l.metadata.name);l.document&&(s=s.add(d));let h=e.ds(l);h.setReadTime(e.As(l.metadata.readTime)),o=o.insert(d,h)}let a=i.cs.newChangeBuffer({trackRemovals:!0}),c=yield Rc(i,function(d){return ln(Vc(De.fromString(`__bundle__/docs/${d}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",l=>bL(l,a,o).next(d=>(a.apply(l),d)).next(d=>i.Ur.removeMatchingKeysForTargetId(l,c.targetId).next(()=>i.Ur.addMatchingKeys(l,s,c.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(l,d.Ps,d.Is)).next(()=>d.Ps)))})}function y8(r,i){return g(this,arguments,function*(n,e,t=he()){let s=yield Rc(n,ln(K0(e.bundledQuery))),o=z(n);return o.persistence.runTransaction("Save named query","readwrite",a=>{let c=ft(e.readTime);if(s.snapshotVersion.compareTo(c)>=0)return o.Gr.saveNamedQuery(a,e);let l=s.withResumeToken(pt.EMPTY_BYTE_STRING,c);return o.os=o.os.insert(l.targetId,l),o.Ur.updateTargetData(a,l).next(()=>o.Ur.removeMatchingKeysForTargetId(a,s.targetId)).next(()=>o.Ur.addMatchingKeys(a,t,s.targetId)).next(()=>o.Gr.saveNamedQuery(a,e))})})}function n1(n,e){return`firestore_clients_${n}_${e}`}function r1(n,e,t){let r=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function LT(n,e){return`firestore_targets_${n}_${e}`}var mg=class n{constructor(e,t,r,i){this.user=e,this.batchId=t,this.state=r,this.error=i}static Rs(e,t,r){let i=JSON.parse(r),s,o=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return o&&i.error&&(o=typeof i.error.message=="string"&&typeof i.error.code=="string",o&&(s=new O(i.error.code,i.error.message))),o?new n(e,t,i.state,s):(dt("SharedClientState",`Failed to parse mutation state for ID '${t}': ${r}`),null)}Vs(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},Ed=class n{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static Rs(e,t){let r=JSON.parse(t),i,s=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return s&&r.error&&(s=typeof r.error.message=="string"&&typeof r.error.code=="string",s&&(i=new O(r.error.code,r.error.message))),s?new n(e,r.state,i):(dt("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}Vs(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},gg=class n{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Rs(e,t){let r=JSON.parse(t),i=typeof r=="object"&&r.activeTargetIds instanceof Array,s=z0();for(let o=0;i&&o<r.activeTargetIds.length;++o)i=T1(r.activeTargetIds[o]),s=s.add(r.activeTargetIds[o]);return i?new n(e,s):(dt("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}},Jb=class n{constructor(e,t){this.clientId=e,this.onlineState=t}static Rs(e){let t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new n(t.clientId,t.onlineState):(dt("SharedClientState",`Failed to parse online state: ${e}`),null)}},Ud=class{constructor(){this.activeTargetIds=z0()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}},Td=class{constructor(e,t,r,i,s){this.window=e,this.ui=t,this.persistenceKey=r,this.ps=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ys=this.ws.bind(this),this.Ss=new Ke(ae),this.started=!1,this.bs=[];let o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.Ds=n1(this.persistenceKey,this.ps),this.vs=function(c){return`firestore_sequence_number_${c}`}(this.persistenceKey),this.Ss=this.Ss.insert(this.ps,new Ud),this.Cs=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.Fs=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Ms=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.xs=function(c){return`firestore_online_state_${c}`}(this.persistenceKey),this.Os=function(c){return`firestore_bundle_loaded_v2_${c}`}(this.persistenceKey),this.window.addEventListener("storage",this.ys)}static D(e){return!(!e||!e.localStorage)}start(){return g(this,null,function*(){let e=yield this.syncEngine.Qi();for(let r of e){if(r===this.ps)continue;let i=this.getItem(n1(this.persistenceKey,r));if(i){let s=gg.Rs(r,i);s&&(this.Ss=this.Ss.insert(s.clientId,s))}}this.Ns();let t=this.storage.getItem(this.xs);if(t){let r=this.Ls(t);r&&this.Bs(r)}for(let r of this.bs)this.ws(r);this.bs=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0})}writeSequenceNumber(e){this.setItem(this.vs,JSON.stringify(e))}getAllActiveQueryTargets(){return this.ks(this.Ss)}isActiveQueryTarget(e){let t=!1;return this.Ss.forEach((r,i)=>{i.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.qs(e,"pending")}updateMutationState(e,t,r){this.qs(e,t,r),this.Qs(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){let r=this.storage.getItem(LT(this.persistenceKey,e));if(r){let i=Ed.Rs(e,r);i&&(t=i.state)}}return this.Ks.fs(e),this.Ns(),t}removeLocalQueryTarget(e){this.Ks.gs(e),this.Ns()}isLocalQueryTarget(e){return this.Ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(LT(this.persistenceKey,e))}updateQueryState(e,t,r){this.$s(e,t,r)}handleUserChange(e,t,r){t.forEach(i=>{this.Qs(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Us(e)}notifyBundleLoaded(e){this.Ws(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.ys),this.removeItem(this.Ds),this.started=!1)}getItem(e){let t=this.storage.getItem(e);return V("SharedClientState","READ",e,t),t}setItem(e,t){V("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){V("SharedClientState","REMOVE",e),this.storage.removeItem(e)}ws(e){let t=e;if(t.storageArea===this.storage){if(V("SharedClientState","EVENT",t.key,t.newValue),t.key===this.Ds)return void dt("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ui.enqueueRetryable(()=>g(this,null,function*(){if(this.started){if(t.key!==null){if(this.Cs.test(t.key)){if(t.newValue==null){let r=this.Gs(t.key);return this.zs(r,null)}{let r=this.js(t.key,t.newValue);if(r)return this.zs(r.clientId,r)}}else if(this.Fs.test(t.key)){if(t.newValue!==null){let r=this.Hs(t.key,t.newValue);if(r)return this.Js(r)}}else if(this.Ms.test(t.key)){if(t.newValue!==null){let r=this.Ys(t.key,t.newValue);if(r)return this.Zs(r)}}else if(t.key===this.xs){if(t.newValue!==null){let r=this.Ls(t.newValue);if(r)return this.Bs(r)}}else if(t.key===this.vs){let r=function(s){let o=xn.oe;if(s!=null)try{let a=JSON.parse(s);Z(typeof a=="number"),o=a}catch(a){dt("SharedClientState","Failed to read sequence number from WebStorage",a)}return o}(t.newValue);r!==xn.oe&&this.sequenceNumberHandler(r)}else if(t.key===this.Os){let r=this.Xs(t.newValue);yield Promise.all(r.map(i=>this.syncEngine.eo(i)))}}}else this.bs.push(t)}))}}get Ks(){return this.Ss.get(this.ps)}Ns(){this.setItem(this.Ds,this.Ks.Vs())}qs(e,t,r){let i=new mg(this.currentUser,e,t,r),s=r1(this.persistenceKey,this.currentUser,e);this.setItem(s,i.Vs())}Qs(e){let t=r1(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Us(e){let t={clientId:this.ps,onlineState:e};this.storage.setItem(this.xs,JSON.stringify(t))}$s(e,t,r){let i=LT(this.persistenceKey,e),s=new Ed(e,t,r);this.setItem(i,s.Vs())}Ws(e){let t=JSON.stringify(Array.from(e));this.setItem(this.Os,t)}Gs(e){let t=this.Cs.exec(e);return t?t[1]:null}js(e,t){let r=this.Gs(e);return gg.Rs(r,t)}Hs(e,t){let r=this.Fs.exec(e),i=Number(r[1]),s=r[2]!==void 0?r[2]:null;return mg.Rs(new Et(s),i,t)}Ys(e,t){let r=this.Ms.exec(e),i=Number(r[1]);return Ed.Rs(i,t)}Ls(e){return Jb.Rs(e)}Xs(e){return JSON.parse(e)}Js(e){return g(this,null,function*(){if(e.user.uid===this.currentUser.uid)return this.syncEngine.no(e.batchId,e.state,e.error);V("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})}Zs(e){return this.syncEngine.ro(e.targetId,e.state,e.error)}zs(e,t){let r=t?this.Ss.insert(e,t):this.Ss.remove(e),i=this.ks(this.Ss),s=this.ks(r),o=[],a=[];return s.forEach(c=>{i.has(c)||o.push(c)}),i.forEach(c=>{s.has(c)||a.push(c)}),this.syncEngine.io(o,a).then(()=>{this.Ss=r})}Bs(e){this.Ss.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}ks(e){let t=z0();return e.forEach((r,i)=>{t=t.unionWith(i.activeTargetIds)}),t}},_g=class{constructor(){this.so=new Ud,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e){return this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,r){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new Ud,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var Xb=class{_o(e){}shutdown(){}};var yg=class{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){V("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.ho)e(0)}lo(){V("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var km=null;function FT(){return km===null?km=function(){return 268435456+Math.round(2147483648*Math.random())}():km++,"0x"+km.toString(16)}var v8={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var Zb=class{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}};var Yt="WebChannelConnection",e0=class extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;let r=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+t.host,this.vo=`projects/${i}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Fo(){return!1}Mo(t,r,i,s,o){let a=FT(),c=this.xo(t,r.toUriEncodedString());V("RestConnection",`Sending RPC '${t}' ${a}:`,c,i);let l={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(l,s,o),this.No(t,c,l,i).then(d=>(V("RestConnection",`Received RPC '${t}' ${a}: `,d),d),d=>{throw Kn("RestConnection",`RPC '${t}' ${a} failed with error: `,d,"url: ",c,"request:",i),d})}Lo(t,r,i,s,o,a){return this.Mo(t,r,i,s,o)}Oo(t,r,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Fc}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>t[o]=s),i&&i.headers.forEach((s,o)=>t[o]=s)}xo(t,r){let i=v8[t];return`${this.Do}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,r,i){let s=FT();return new Promise((o,a)=>{let c=new AT;c.setWithCredentials(!0),c.listenOnce(xT.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case hd.NO_ERROR:let d=c.getResponseJson();V(Yt,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(d)),o(d);break;case hd.TIMEOUT:V(Yt,`RPC '${e}' ${s} timed out`),a(new O(N.DEADLINE_EXCEEDED,"Request time out"));break;case hd.HTTP_ERROR:let h=c.getStatus();if(V(Yt,`RPC '${e}' ${s} failed with status:`,h,"response text:",c.getResponseText()),h>0){let m=c.getResponseJson();Array.isArray(m)&&(m=m[0]);let _=m?.error;if(_&&_.status&&_.message){let w=function(A){let L=A.toLowerCase().replace(/_/g,"-");return Object.values(N).indexOf(L)>=0?L:N.UNKNOWN}(_.status);a(new O(w,_.message))}else a(new O(N.UNKNOWN,"Server responded with status "+c.getStatus()))}else a(new O(N.UNAVAILABLE,"Connection failed."));break;default:Y()}}finally{V(Yt,`RPC '${e}' ${s} completed.`)}});let l=JSON.stringify(i);V(Yt,`RPC '${e}' ${s} sending request:`,i),c.send(t,"POST",l,r,15)})}Bo(e,t,r){let i=FT(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=MT(),a=PT(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(c.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(c.xmlHttpFactory=new RT({})),this.Oo(c.initMessageHeaders,t,r),c.encodeInitMessageHeaders=!0;let d=s.join("");V(Yt,`Creating RPC '${e}' stream ${i}: ${d}`,c);let h=o.createWebChannel(d,c),m=!1,_=!1,w=new Zb({Io:A=>{_?V(Yt,`Not sending because RPC '${e}' stream ${i} is closed:`,A):(m||(V(Yt,`Opening RPC '${e}' stream ${i} transport.`),h.open(),m=!0),V(Yt,`RPC '${e}' stream ${i} sending:`,A),h.send(A))},To:()=>h.close()}),C=(A,L,H)=>{A.listen(L,j=>{try{H(j)}catch(Q){setTimeout(()=>{throw Q},0)}})};return C(h,oc.EventType.OPEN,()=>{_||(V(Yt,`RPC '${e}' stream ${i} transport opened.`),w.yo())}),C(h,oc.EventType.CLOSE,()=>{_||(_=!0,V(Yt,`RPC '${e}' stream ${i} transport closed`),w.So())}),C(h,oc.EventType.ERROR,A=>{_||(_=!0,Kn(Yt,`RPC '${e}' stream ${i} transport errored:`,A),w.So(new O(N.UNAVAILABLE,"The operation could not be completed")))}),C(h,oc.EventType.MESSAGE,A=>{var L;if(!_){let H=A.data[0];Z(!!H);let j=H,Q=j.error||((L=j[0])===null||L===void 0?void 0:L.error);if(Q){V(Yt,`RPC '${e}' stream ${i} received error:`,Q);let se=Q.status,J=function(I){let b=wt[I];if(b!==void 0)return eL(b)}(se),T=Q.message;J===void 0&&(J=N.INTERNAL,T="Unknown error status: "+se+" with message "+Q.message),_=!0,w.So(new O(J,T)),h.close()}else V(Yt,`RPC '${e}' stream ${i} received:`,H),w.bo(H)}}),C(a,NT.STAT_EVENT,A=>{A.stat===xm.PROXY?V(Yt,`RPC '${e}' stream ${i} detected buffering proxy`):A.stat===xm.NOPROXY&&V(Yt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{w.wo()},0),w}};function AL(){return typeof window<"u"?window:null}function Um(){return typeof document<"u"?document:null}function Jd(n){return new mb(n,!0)}var jd=class{constructor(e,t,r=1e3,i=1.5,s=6e4){this.ui=e,this.timerId=t,this.ko=r,this.qo=i,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();let t=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),i=Math.max(0,t-r);i>0&&V("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}};var vg=class{constructor(e,t,r,i,s,o,a,c){this.ui=e,this.Ho=r,this.Jo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new jd(e,t)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}stop(){return g(this,null,function*(){this.n_()&&(yield this.close(0))})}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}__(){return g(this,null,function*(){if(this.r_())return this.close(0)})}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}close(e,t){return g(this,null,function*(){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():t&&t.code===N.RESOURCE_EXHAUSTED?(dt(t.toString()),dt("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===N.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.mo(t)})}l_(){}auth(){this.state=1;let e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Yo===t&&this.P_(r,i)},r=>{e(()=>{let i=new O(N.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(i)})})}P_(e,t){let r=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{r(()=>this.I_(i))}),this.stream.onMessage(i=>{r(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(()=>g(this,null,function*(){this.state=0,this.start()}))}I_(e){return V("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():(V("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},t0=class extends vg{constructor(e,t,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();let t=r8(this.serializer,e),r=function(s){if(!("targetChange"in s))return ee.min();let o=s.targetChange;return o.targetIds&&o.targetIds.length?ee.min():o.readTime?ft(o.readTime):ee.min()}(e);return this.listener.d_(t,r)}A_(e){let t={};t.database=yb(this.serializer),t.addTarget=function(s,o){let a,c=o.target;if(a=Ym(c)?{documents:cL(s,c)}:{query:lL(s,c)._t},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=nL(s,o.resumeToken);let l=gb(s,o.expectedCount);l!==null&&(a.expectedCount=l)}else if(o.snapshotVersion.compareTo(ee.min())>0){a.readTime=Dc(s,o.snapshotVersion.toTimestamp());let l=gb(s,o.expectedCount);l!==null&&(a.expectedCount=l)}return a}(this.serializer,e);let r=s8(this.serializer,e);r&&(t.labels=r),this.a_(t)}R_(e){let t={};t.database=yb(this.serializer),t.removeTarget=e,this.a_(t)}},n0=class extends vg{constructor(e,t,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return Z(!!e.streamToken),this.lastStreamToken=e.streamToken,Z(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){Z(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();let t=i8(e.writeResults,e.commitTime),r=ft(e.commitTime);return this.listener.g_(r,t)}p_(){let e={};e.database=yb(this.serializer),this.a_(e)}m_(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>Ld(this.serializer,r))};this.a_(t)}};var r0=class extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new O(N.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Mo(e,_b(t,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===N.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new O(N.UNKNOWN,s.toString())})}Lo(e,t,r,i,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Lo(e,_b(t,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===N.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new O(N.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}},i0=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(dt(t),this.D_=!1):V("OnlineStateTracker",t)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}};var s0=class{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(o=>{r.enqueueAndForget(()=>g(this,null,function*(){Ss(this)&&(V("RemoteStore","Restarting streams for network reachability change."),yield function(c){return g(this,null,function*(){let l=z(c);l.L_.add(4),yield Uc(l),l.q_.set("Unknown"),l.L_.delete(4),yield Xd(l)})}(this))}))}),this.q_=new i0(r,i)}};function Xd(n){return g(this,null,function*(){if(Ss(n))for(let e of n.B_)yield e(!0)})}function Uc(n){return g(this,null,function*(){for(let e of n.B_)yield e(!1)})}function Ug(n,e){let t=z(n);t.N_.has(e.targetId)||(t.N_.set(e.targetId,e),Z0(t)?X0(t):Bc(t).r_()&&J0(t,e))}function Nc(n,e){let t=z(n),r=Bc(t);t.N_.delete(e),r.r_()&&RL(t,e),t.N_.size===0&&(r.r_()?r.o_():Ss(t)&&t.q_.set("Unknown"))}function J0(n,e){if(n.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ee.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Bc(n).A_(e)}function RL(n,e){n.Q_.xe(e),Bc(n).R_(e)}function X0(n){n.Q_=new pb({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.N_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),Bc(n).start(),n.q_.v_()}function Z0(n){return Ss(n)&&!Bc(n).n_()&&n.N_.size>0}function Ss(n){return z(n).L_.size===0}function xL(n){n.Q_=void 0}function w8(n){return g(this,null,function*(){n.q_.set("Online")})}function I8(n){return g(this,null,function*(){n.N_.forEach((e,t)=>{J0(n,e)})})}function E8(n,e){return g(this,null,function*(){xL(n),Z0(n)?(n.q_.M_(e),X0(n)):n.q_.set("Unknown")})}function T8(n,e,t){return g(this,null,function*(){if(n.q_.set("Online"),e instanceof eg&&e.state===2&&e.cause)try{yield function(i,s){return g(this,null,function*(){let o=s.cause;for(let a of s.targetIds)i.N_.has(a)&&(yield i.remoteSyncer.rejectListen(a,o),i.N_.delete(a),i.Q_.removeTarget(a))})}(n,e)}catch(r){V("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield wg(n,r)}else if(e instanceof vc?n.Q_.Ke(e):e instanceof Zm?n.Q_.He(e):n.Q_.We(e),!t.isEqual(ee.min()))try{let r=yield TL(n.localStore);t.compareTo(r)>=0&&(yield function(s,o){let a=s.Q_.rt(o);return a.targetChanges.forEach((c,l)=>{if(c.resumeToken.approximateByteSize()>0){let d=s.N_.get(l);d&&s.N_.set(l,d.withResumeToken(c.resumeToken,o))}}),a.targetMismatches.forEach((c,l)=>{let d=s.N_.get(c);if(!d)return;s.N_.set(c,d.withResumeToken(pt.EMPTY_BYTE_STRING,d.snapshotVersion)),RL(s,c);let h=new Sc(d.target,c,l,d.sequenceNumber);J0(s,h)}),s.remoteSyncer.applyRemoteEvent(a)}(n,t))}catch(r){V("RemoteStore","Failed to raise snapshot:",r),yield wg(n,r)}})}function wg(n,e,t){return g(this,null,function*(){if(!Ds(e))throw e;n.L_.add(1),yield Uc(n),n.q_.set("Offline"),t||(t=()=>TL(n.localStore)),n.asyncQueue.enqueueRetryable(()=>g(this,null,function*(){V("RemoteStore","Retrying IndexedDB access"),yield t(),n.L_.delete(1),yield Xd(n)}))})}function NL(n,e){return e().catch(t=>wg(n,t,e))}function jc(n){return g(this,null,function*(){let e=z(n),t=bs(e),r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;b8(e);)try{let i=yield g8(e.localStore,r);if(i===null){e.O_.length===0&&t.o_();break}r=i.batchId,C8(e,i)}catch(i){yield wg(e,i)}PL(e)&&ML(e)})}function b8(n){return Ss(n)&&n.O_.length<10}function C8(n,e){n.O_.push(e);let t=bs(n);t.r_()&&t.V_&&t.m_(e.mutations)}function PL(n){return Ss(n)&&!bs(n).n_()&&n.O_.length>0}function ML(n){bs(n).start()}function D8(n){return g(this,null,function*(){bs(n).p_()})}function S8(n){return g(this,null,function*(){let e=bs(n);for(let t of n.O_)e.m_(t.mutations)})}function A8(n,e,t){return g(this,null,function*(){let r=n.O_.shift(),i=db.from(r,e,t);yield NL(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield jc(n)})}function R8(n,e){return g(this,null,function*(){e&&bs(n).V_&&(yield function(r,i){return g(this,null,function*(){if(function(o){return Z1(o)&&o!==N.ABORTED}(i.code)){let s=r.O_.shift();bs(r).s_(),yield NL(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),yield jc(r)}})}(n,e)),PL(n)&&ML(n)})}function i1(n,e){return g(this,null,function*(){let t=z(n);t.asyncQueue.verifyOperationInProgress(),V("RemoteStore","RemoteStore received new credentials");let r=Ss(t);t.L_.add(3),yield Uc(t),r&&t.q_.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.L_.delete(3),yield Xd(t)})}function o0(n,e){return g(this,null,function*(){let t=z(n);e?(t.L_.delete(2),yield Xd(t)):e||(t.L_.add(2),yield Uc(t),t.q_.set("Unknown"))})}function Bc(n){return n.K_||(n.K_=function(t,r,i){let s=z(t);return s.w_(),new t0(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Eo:w8.bind(null,n),Ro:I8.bind(null,n),mo:E8.bind(null,n),d_:T8.bind(null,n)}),n.B_.push(e=>g(this,null,function*(){e?(n.K_.s_(),Z0(n)?X0(n):n.q_.set("Unknown")):(yield n.K_.stop(),xL(n))}))),n.K_}function bs(n){return n.U_||(n.U_=function(t,r,i){let s=z(t);return s.w_(),new n0(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Eo:()=>Promise.resolve(),Ro:D8.bind(null,n),mo:R8.bind(null,n),f_:S8.bind(null,n),g_:A8.bind(null,n)}),n.B_.push(e=>g(this,null,function*(){e?(n.U_.s_(),yield jc(n)):(yield n.U_.stop(),n.O_.length>0&&(V("RemoteStore",`Stopping write stream with ${n.O_.length} pending writes`),n.O_=[]))}))),n.U_}var a0=class n{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Tt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){let o=Date.now()+r,a=new n(e,t,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new O(N.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function $c(n,e){if(dt("AsyncQueue",`${e}: ${n}`),Ds(n))return new O(N.UNAVAILABLE,`${e}: ${n}`);throw n}var Ig=class n{constructor(e){this.comparator=e?(t,r)=>e(t,r)||W.comparator(t.key,r.key):(t,r)=>W.comparator(t.key,r.key),this.keyedMap=_d(),this.sortedSet=new Ke(this.comparator)}static emptySet(e){return new n(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var Eg=class{constructor(){this.W_=new Ke(W.comparator)}track(e){let t=e.doc.key,r=this.W_.get(t);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(t,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(t):e.type===1&&r.type===2?this.W_=this.W_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):Y():this.W_=this.W_.insert(t,e)}G_(){let e=[];return this.W_.inorderTraversal((t,r)=>{e.push(r)}),e}},Pc=class n{constructor(e,t,r,i,s,o,a,c,l){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=l}static fromInitialDocuments(e,t,r,i,s){let o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new n(e,t,Ig.emptySet(t),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Qd(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var c0=class{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}},l0=class{constructor(){this.queries=s1(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(t,r){let i=z(t),s=i.queries;i.queries=s1(),s.forEach((o,a)=>{for(let c of a.j_)c.onError(r)})})(this,new O(N.ABORTED,"Firestore shutting down"))}};function s1(){return new Jr(n=>U1(n),Qd)}function eC(n,e){return g(this,null,function*(){let t=z(n),r=3,i=e.query,s=t.queries.get(i);s?!s.H_()&&e.J_()&&(r=2):(s=new c0,r=e.J_()?0:1);try{switch(r){case 0:s.z_=yield t.onListen(i,!0);break;case 1:s.z_=yield t.onListen(i,!1);break;case 2:yield t.onFirstRemoteStoreListen(i)}}catch(o){let a=$c(o,`Initialization of query '${hc(e.query)}' failed`);return void e.onError(a)}t.queries.set(i,s),s.j_.push(e),e.Z_(t.onlineState),s.z_&&e.X_(s.z_)&&nC(t)})}function tC(n,e){return g(this,null,function*(){let t=z(n),r=e.query,i=3,s=t.queries.get(r);if(s){let o=s.j_.indexOf(e);o>=0&&(s.j_.splice(o,1),s.j_.length===0?i=e.J_()?0:1:!s.H_()&&e.J_()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}})}function x8(n,e){let t=z(n),r=!1;for(let i of e){let s=i.query,o=t.queries.get(s);if(o){for(let a of o.j_)a.X_(i)&&(r=!0);o.z_=i}}r&&nC(t)}function N8(n,e,t){let r=z(n),i=r.queries.get(e);if(i)for(let s of i.j_)s.onError(t);r.queries.delete(e)}function nC(n){n.Y_.forEach(e=>{e.next()})}var u0,o1;(o1=u0||(u0={})).ea="default",o1.Cache="cache";var Bd=class{constructor(e,t,r){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new Pc(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache||!this.J_())return!0;let r=t!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ia(e){if(e.docChanges.length>0)return!0;let t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}oa(e){e=Pc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==u0.Cache}};var d0=class{constructor(e,t){this.aa=e,this.byteLength=t}ua(){return"metadata"in this.aa}};var Tg=class{constructor(e){this.serializer=e}Es(e){return Gr(this.serializer,e)}ds(e){return e.metadata.exists?aL(this.serializer,e.document,!1):bt.newNoDocument(this.Es(e.metadata.name),this.As(e.metadata.readTime))}As(e){return ft(e)}},h0=class{constructor(e,t,r){this.ca=e,this.localStore=t,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=kL(e)}la(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.aa.namedQuery)this.queries.push(e.aa.namedQuery);else if(e.aa.documentMetadata){this.documents.push({metadata:e.aa.documentMetadata}),e.aa.documentMetadata.exists||++t;let r=De.fromString(e.aa.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.aa.document&&(this.documents[this.documents.length-1].document=e.aa.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}ha(e){let t=new Map,r=new Tg(this.serializer);for(let i of e)if(i.metadata.queries){let s=r.Es(i.metadata.name);for(let o of i.metadata.queries){let a=(t.get(o)||he()).add(s);t.set(o,a)}}return t}complete(){return g(this,null,function*(){let e=yield _8(this.localStore,new Tg(this.serializer),this.documents,this.ca.id),t=this.ha(this.documents);for(let r of this.queries)yield y8(this.localStore,r,t.get(r.name));return this.progress.taskState="Success",{progress:this.progress,Pa:this.collectionGroups,Ia:e}})}};function kL(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}var bg=class{constructor(e){this.key=e}},Cg=class{constructor(e){this.key=e}},Dg=class{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=he(),this.mutatedKeys=he(),this.Aa=B1(e),this.Ra=new Ig(this.Aa)}get Va(){return this.Ta}ma(e,t){let r=t?t.fa:new Eg,i=t?t.Ra:this.Ra,s=t?t.mutatedKeys:this.mutatedKeys,o=i,a=!1,c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,l=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((d,h)=>{let m=i.get(d),_=Yd(this.query,h)?h:null,w=!!m&&this.mutatedKeys.has(m.key),C=!!_&&(_.hasLocalMutations||this.mutatedKeys.has(_.key)&&_.hasCommittedMutations),A=!1;m&&_?m.data.isEqual(_.data)?w!==C&&(r.track({type:3,doc:_}),A=!0):this.ga(m,_)||(r.track({type:2,doc:_}),A=!0,(c&&this.Aa(_,c)>0||l&&this.Aa(_,l)<0)&&(a=!0)):!m&&_?(r.track({type:0,doc:_}),A=!0):m&&!_&&(r.track({type:1,doc:m}),A=!0,(c||l)&&(a=!0)),A&&(_?(o=o.add(_),s=C?s.add(d):s.delete(d)):(o=o.delete(d),s=s.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){let d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),s=s.delete(d.key),r.track({type:1,doc:d})}return{Ra:o,fa:r,ns:a,mutatedKeys:s}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;let o=e.fa.G_();o.sort((d,h)=>function(_,w){let C=A=>{switch(A){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Y()}};return C(_)-C(w)}(d.type,h.type)||this.Aa(d.doc,h.doc)),this.pa(r),i=i!=null&&i;let a=t&&!i?this.ya():[],c=this.da.size===0&&this.current&&!i?1:0,l=c!==this.Ea;return this.Ea=c,o.length!==0||l?{snapshot:new Pc(this.query,e.Ra,s,o,e.mutatedKeys,c===0,l,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:a}:{wa:a}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new Eg,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(t=>this.Ta=this.Ta.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ta=this.Ta.delete(t)),this.current=e.current)}ya(){if(!this.current)return[];let e=this.da;this.da=he(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});let t=[];return e.forEach(r=>{this.da.has(r)||t.push(new Cg(r))}),this.da.forEach(r=>{e.has(r)||t.push(new bg(r))}),t}ba(e){this.Ta=e.Ts,this.da=he();let t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return Pc.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}},f0=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},p0=class{constructor(e){this.key=e,this.va=!1}},m0=class{constructor(e,t,r,i,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new Jr(a=>U1(a),Qd),this.Ma=new Map,this.xa=new Set,this.Oa=new Ke(W.comparator),this.Na=new Map,this.La=new Vd,this.Ba={},this.ka=new Map,this.qa=Ac.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}};function P8(n,e,t=!0){return g(this,null,function*(){let r=jg(n),i,s=r.Fa.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=yield OL(r,e,t,!0),i})}function M8(n,e){return g(this,null,function*(){let t=jg(n);yield OL(t,e,!0,!1)})}function OL(n,e,t,r){return g(this,null,function*(){let i=yield Rc(n.localStore,ln(e)),s=i.targetId,o=t?n.sharedClientState.addLocalQueryTarget(s):"not-current",a;return r&&(a=yield rC(n,e,s,o==="current",i.resumeToken)),n.isPrimaryClient&&t&&Ug(n.remoteStore,i),a})}function rC(n,e,t,r,i){return g(this,null,function*(){n.Ka=(h,m,_)=>function(C,A,L,H){return g(this,null,function*(){let j=A.view.ma(L);j.ns&&(j=yield pg(C.localStore,A.query,!1).then(({documents:T})=>A.view.ma(T,j)));let Q=H&&H.targetChanges.get(A.targetId),se=H&&H.targetMismatches.get(A.targetId)!=null,J=A.view.applyChanges(j,C.isPrimaryClient,Q,se);return g0(C,A.targetId,J.wa),J.snapshot})}(n,h,m,_);let s=yield pg(n.localStore,e,!0),o=new Dg(e,s.Ts),a=o.ma(s.documents),c=kd.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),l=o.applyChanges(a,n.isPrimaryClient,c);g0(n,t,l.wa);let d=new f0(e,t,o);return n.Fa.set(e,d),n.Ma.has(t)?n.Ma.get(t).push(e):n.Ma.set(t,[e]),l.snapshot})}function k8(n,e,t){return g(this,null,function*(){let r=z(n),i=r.Fa.get(e),s=r.Ma.get(i.targetId);if(s.length>1)return r.Ma.set(i.targetId,s.filter(o=>!Qd(o,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||(yield xc(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&Nc(r.remoteStore,i.targetId),Mc(r,i.targetId)}).catch(Cs))):(Mc(r,i.targetId),yield xc(r.localStore,i.targetId,!0))})}function O8(n,e){return g(this,null,function*(){let t=z(n),r=t.Fa.get(e),i=t.Ma.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),Nc(t.remoteStore,r.targetId))})}function L8(n,e,t){return g(this,null,function*(){let r=aC(n);try{let i=yield function(o,a){let c=z(o),l=et.now(),d=a.reduce((_,w)=>_.add(w.key),he()),h,m;return c.persistence.runTransaction("Locally write mutations","readwrite",_=>{let w=In(),C=he();return c.cs.getEntries(_,d).next(A=>{w=A,w.forEach((L,H)=>{H.isValidDocument()||(C=C.add(L))})}).next(()=>c.localDocuments.getOverlayedDocuments(_,w)).next(A=>{h=A;let L=[];for(let H of a){let j=Y5(H,h.get(H.key).overlayedDocument);j!=null&&L.push(new gr(H.key,j,P1(j.value.mapValue),ct.exists(!0)))}return c.mutationQueue.addMutationBatch(_,l,L,a)}).next(A=>{m=A;let L=A.applyToLocalDocumentSet(h,C);return c.documentOverlayCache.saveOverlays(_,A.batchId,L)})}).then(()=>({batchId:m.batchId,changes:H1(h)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,c){let l=o.Ba[o.currentUser.toKey()];l||(l=new Ke(ae)),l=l.insert(a,c),o.Ba[o.currentUser.toKey()]=l}(r,i.batchId,t),yield Ni(r,i.changes),yield jc(r.remoteStore)}catch(i){let s=$c(i,"Failed to persist write");t.reject(s)}})}function LL(n,e){return g(this,null,function*(){let t=z(n);try{let r=yield m8(t.localStore,e);e.targetChanges.forEach((i,s)=>{let o=t.Na.get(s);o&&(Z(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.va=!0:i.modifiedDocuments.size>0?Z(o.va):i.removedDocuments.size>0&&(Z(o.va),o.va=!1))}),yield Ni(t,r,e)}catch(r){yield Cs(r)}})}function a1(n,e,t){let r=z(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.Fa.forEach((s,o)=>{let a=o.view.Z_(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){let c=z(o);c.onlineState=a;let l=!1;c.queries.forEach((d,h)=>{for(let m of h.j_)m.Z_(a)&&(l=!0)}),l&&nC(c)}(r.eventManager,e),i.length&&r.Ca.d_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function F8(n,e,t){return g(this,null,function*(){let r=z(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r.Na.get(e),s=i&&i.key;if(s){let o=new Ke(W.comparator);o=o.insert(s,bt.newNoDocument(s,ee.min()));let a=he().add(s),c=new Md(ee.min(),new Map,new Ke(ae),o,a);yield LL(r,c),r.Oa=r.Oa.remove(s),r.Na.delete(e),oC(r)}else yield xc(r.localStore,e,!1).then(()=>Mc(r,e,t)).catch(Cs)})}function V8(n,e){return g(this,null,function*(){let t=z(n),r=e.batch.batchId;try{let i=yield p8(t.localStore,e);sC(t,r,null),iC(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield Ni(t,i)}catch(i){yield Cs(i)}})}function U8(n,e,t){return g(this,null,function*(){let r=z(n);try{let i=yield function(o,a){let c=z(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let d;return c.mutationQueue.lookupMutationBatch(l,a).next(h=>(Z(h!==null),d=h.keys(),c.mutationQueue.removeMutationBatch(l,h))).next(()=>c.mutationQueue.performConsistencyCheck(l)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(l,d,a)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,d)).next(()=>c.localDocuments.getDocuments(l,d))})}(r.localStore,e);sC(r,e,t),iC(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield Ni(r,i)}catch(i){yield Cs(i)}})}function j8(n,e){return g(this,null,function*(){let t=z(n);Ss(t.remoteStore)||V("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{let r=yield function(o){let a=z(o);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",c=>a.mutationQueue.getHighestUnacknowledgedBatchId(c))}(t.localStore);if(r===-1)return void e.resolve();let i=t.ka.get(r)||[];i.push(e),t.ka.set(r,i)}catch(r){let i=$c(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}})}function iC(n,e){(n.ka.get(e)||[]).forEach(t=>{t.resolve()}),n.ka.delete(e)}function sC(n,e,t){let r=z(n),i=r.Ba[r.currentUser.toKey()];if(i){let s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.Ba[r.currentUser.toKey()]=i}}function Mc(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.Ma.get(e))n.Fa.delete(r),t&&n.Ca.$a(r,t);n.Ma.delete(e),n.isPrimaryClient&&n.La.gr(e).forEach(r=>{n.La.containsKey(r)||FL(n,r)})}function FL(n,e){n.xa.delete(e.path.canonicalString());let t=n.Oa.get(e);t!==null&&(Nc(n.remoteStore,t),n.Oa=n.Oa.remove(e),n.Na.delete(t),oC(n))}function g0(n,e,t){for(let r of t)r instanceof bg?(n.La.addReference(r.key,e),B8(n,r)):r instanceof Cg?(V("SyncEngine","Document no longer in limbo: "+r.key),n.La.removeReference(r.key,e),n.La.containsKey(r.key)||FL(n,r.key)):Y()}function B8(n,e){let t=e.key,r=t.path.canonicalString();n.Oa.get(t)||n.xa.has(r)||(V("SyncEngine","New document in limbo: "+t),n.xa.add(r),oC(n))}function oC(n){for(;n.xa.size>0&&n.Oa.size<n.maxConcurrentLimboResolutions;){let e=n.xa.values().next().value;n.xa.delete(e);let t=new W(De.fromString(e)),r=n.qa.next();n.Na.set(r,new p0(t)),n.Oa=n.Oa.insert(t,r),Ug(n.remoteStore,new Sc(ln(Vc(t.path)),r,"TargetPurposeLimboResolution",xn.oe))}}function Ni(n,e,t){return g(this,null,function*(){let r=z(n),i=[],s=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach((a,c)=>{o.push(r.Ka(c,e,t).then(l=>{var d;if((l||t)&&r.isPrimaryClient){let h=l?!l.fromCache:(d=t?.targetChanges.get(c.targetId))===null||d===void 0?void 0:d.current;r.sharedClientState.updateQueryState(c.targetId,h?"current":"not-current")}if(l){i.push(l);let h=Kb.Wi(c.targetId,l);s.push(h)}}))}),yield Promise.all(o),r.Ca.d_(i),yield function(c,l){return g(this,null,function*(){let d=z(c);try{yield d.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>x.forEach(l,m=>x.forEach(m.$i,_=>d.persistence.referenceDelegate.addReference(h,m.targetId,_)).next(()=>x.forEach(m.Ui,_=>d.persistence.referenceDelegate.removeReference(h,m.targetId,_)))))}catch(h){if(!Ds(h))throw h;V("LocalStore","Failed to update sequence numbers: "+h)}for(let h of l){let m=h.targetId;if(!h.fromCache){let _=d.os.get(m),w=_.snapshotVersion,C=_.withLastLimboFreeSnapshotVersion(w);d.os=d.os.insert(m,C)}}})}(r.localStore,s))})}function $8(n,e){return g(this,null,function*(){let t=z(n);if(!t.currentUser.isEqual(e)){V("SyncEngine","User change. New user:",e.toKey());let r=yield EL(t.localStore,e);t.currentUser=e,function(s,o){s.ka.forEach(a=>{a.forEach(c=>{c.reject(new O(N.CANCELLED,o))})}),s.ka.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield Ni(t,r.hs)}})}function H8(n,e){let t=z(n),r=t.Na.get(e);if(r&&r.va)return he().add(r.key);{let i=he(),s=t.Ma.get(e);if(!s)return i;for(let o of s){let a=t.Fa.get(o);i=i.unionWith(a.view.Va)}return i}}function q8(n,e){return g(this,null,function*(){let t=z(n),r=yield pg(t.localStore,e.query,!0),i=e.view.ba(r);return t.isPrimaryClient&&g0(t,e.targetId,i.wa),i})}function z8(n,e){return g(this,null,function*(){let t=z(n);return DL(t.localStore,e).then(r=>Ni(t,r))})}function W8(n,e,t,r){return g(this,null,function*(){let i=z(n),s=yield function(a,c){let l=z(a),d=z(l.mutationQueue);return l.persistence.runTransaction("Lookup mutation documents","readonly",h=>d.Mn(h,c).next(m=>m?l.localDocuments.getDocuments(h,m):x.resolve(null)))}(i.localStore,e);s!==null?(t==="pending"?yield jc(i.remoteStore):t==="acknowledged"||t==="rejected"?(sC(i,e,r||null),iC(i,e),function(a,c){z(z(a).mutationQueue).On(c)}(i.localStore,e)):Y(),yield Ni(i,s)):V("SyncEngine","Cannot apply mutation batch with id: "+e)})}function G8(n,e){return g(this,null,function*(){let t=z(n);if(jg(t),aC(t),e===!0&&t.Qa!==!0){let r=t.sharedClientState.getAllActiveQueryTargets(),i=yield c1(t,r.toArray());t.Qa=!0,yield o0(t.remoteStore,!0);for(let s of i)Ug(t.remoteStore,s)}else if(e===!1&&t.Qa!==!1){let r=[],i=Promise.resolve();t.Ma.forEach((s,o)=>{t.sharedClientState.isLocalQueryTarget(o)?r.push(o):i=i.then(()=>(Mc(t,o),xc(t.localStore,o,!0))),Nc(t.remoteStore,o)}),yield i,yield c1(t,r),function(o){let a=z(o);a.Na.forEach((c,l)=>{Nc(a.remoteStore,l)}),a.La.pr(),a.Na=new Map,a.Oa=new Ke(W.comparator)}(t),t.Qa=!1,yield o0(t.remoteStore,!1)}})}function c1(n,e,t){return g(this,null,function*(){let r=z(n),i=[],s=[];for(let o of e){let a,c=r.Ma.get(o);if(c&&c.length!==0){a=yield Rc(r.localStore,ln(c[0]));for(let l of c){let d=r.Fa.get(l),h=yield q8(r,d);h.snapshot&&s.push(h.snapshot)}}else{let l=yield CL(r.localStore,o);a=yield Rc(r.localStore,l),yield rC(r,VL(l),o,!1,a.resumeToken)}i.push(a)}return r.Ca.d_(s),i})}function VL(n){return V1(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function K8(n){return function(t){return z(z(t).persistence).Qi()}(z(n).localStore)}function Q8(n,e,t,r){return g(this,null,function*(){let i=z(n);if(i.Qa)return void V("SyncEngine","Ignoring unexpected query state notification.");let s=i.Ma.get(e);if(s&&s.length>0)switch(t){case"current":case"not-current":{let o=yield DL(i.localStore,j1(s[0])),a=Md.createSynthesizedRemoteEventForCurrentChange(e,t==="current",pt.EMPTY_BYTE_STRING);yield Ni(i,o,a);break}case"rejected":yield xc(i.localStore,e,!0),Mc(i,e,r);break;default:Y()}})}function Y8(n,e,t){return g(this,null,function*(){let r=jg(n);if(r.Qa){for(let i of e){if(r.Ma.has(i)&&r.sharedClientState.isActiveQueryTarget(i)){V("SyncEngine","Adding an already active target "+i);continue}let s=yield CL(r.localStore,i),o=yield Rc(r.localStore,s);yield rC(r,VL(s),o.targetId,!1,o.resumeToken),Ug(r.remoteStore,o)}for(let i of t)r.Ma.has(i)&&(yield xc(r.localStore,i,!1).then(()=>{Nc(r.remoteStore,i),Mc(r,i)}).catch(Cs))}})}function jg(n){let e=z(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=LL.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=H8.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=F8.bind(null,e),e.Ca.d_=x8.bind(null,e.eventManager),e.Ca.$a=N8.bind(null,e.eventManager),e}function aC(n){let e=z(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=V8.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=U8.bind(null,e),e}function J8(n,e,t){let r=z(n);(function(s,o,a){return g(this,null,function*(){try{let c=yield o.getMetadata();if(yield function(_,w){let C=z(_),A=ft(w.createTime);return C.persistence.runTransaction("hasNewerBundle","readonly",L=>C.Gr.getBundleMetadata(L,w.id)).then(L=>!!L&&L.createTime.compareTo(A)>=0)}(s.localStore,c))return yield o.close(),a._completeWith(function(_){return{taskState:"Success",documentsLoaded:_.totalDocuments,bytesLoaded:_.totalBytes,totalDocuments:_.totalDocuments,totalBytes:_.totalBytes}}(c)),Promise.resolve(new Set);a._updateProgress(kL(c));let l=new h0(c,s.localStore,o.serializer),d=yield o.Ua();for(;d;){let m=yield l.la(d);m&&a._updateProgress(m),d=yield o.Ua()}let h=yield l.complete();return yield Ni(s,h.Ia,void 0),yield function(_,w){let C=z(_);return C.persistence.runTransaction("Save bundle","readwrite",A=>C.Gr.saveBundleMetadata(A,w))}(s.localStore,c),a._completeWith(h.progress),Promise.resolve(h.Pa)}catch(c){return Kn("SyncEngine",`Loading bundle failed with ${c}`),a._failWith(c),Promise.resolve(new Set)}})})(r,e,t).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}var $d=class{constructor(){this.synchronizeTabs=!1}initialize(e){return g(this,null,function*(){this.serializer=Jd(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),yield this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)})}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return IL(this.persistence,new fg,e.initialUser,this.serializer)}createPersistence(e){return new dg(hg.Zr,this.serializer)}createSharedClientState(e){return new _g}terminate(){return g(this,null,function*(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}};var Sg=class n extends $d{constructor(e,t,r){super(),this.Wa=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.synchronizeTabs=!1}initialize(e){return g(this,null,function*(){yield Er(n.prototype,this,"initialize").call(this,e),yield this.Wa.initialize(this,e),yield aC(this.Wa.syncEngine),yield jc(this.Wa.remoteStore),yield this.persistence.yi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))})}createLocalStore(e){return IL(this.persistence,new fg,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,t){let r=this.persistence.referenceDelegate.garbageCollector;return new Pb(r,e.asyncQueue,t)}createIndexBackfillerScheduler(e,t){let r=new QT(t,this.persistence);return new KT(e.asyncQueue,r)}createPersistence(e){let t=Y0(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Gn.withCacheSize(this.cacheSizeBytes):Gn.DEFAULT;return new Gb(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,AL(),Um(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new _g}},_0=class n extends Sg{constructor(e,t){super(e,t,!1),this.Wa=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}initialize(e){return g(this,null,function*(){yield Er(n.prototype,this,"initialize").call(this,e);let t=this.Wa.syncEngine;this.sharedClientState instanceof Td&&(this.sharedClientState.syncEngine={no:W8.bind(null,t),ro:Q8.bind(null,t),io:Y8.bind(null,t),Qi:K8.bind(null,t),eo:z8.bind(null,t)},yield this.sharedClientState.start()),yield this.persistence.yi(r=>g(this,null,function*(){yield G8(this.Wa.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())}))})}createSharedClientState(e){let t=AL();if(!Td.D(t))throw new O(N.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");let r=Y0(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Td(t,e.asyncQueue,r,e.clientId,e.initialUser)}},Hd=class{initialize(e,t){return g(this,null,function*(){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>a1(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=$8.bind(null,this.syncEngine),yield o0(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(e){return function(){return new l0}()}createDatastore(e){let t=Jd(e.databaseInfo.databaseId),r=function(s){return new e0(s)}(e.databaseInfo);return function(s,o,a,c){return new r0(s,o,a,c)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(r,i,s,o,a){return new s0(r,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,t=>a1(this.syncEngine,t,0),function(){return yg.D()?new yg:new Xb}())}createSyncEngine(e,t){return function(i,s,o,a,c,l,d){let h=new m0(i,s,o,a,c,l);return d&&(h.Qa=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return g(this,null,function*(){var e,t;yield function(i){return g(this,null,function*(){let s=z(i);V("RemoteStore","RemoteStore shutting down."),s.L_.add(5),yield Uc(s),s.k_.shutdown(),s.q_.set("Unknown")})}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()})}};function l1(n,e=10240){let t=0;return{read(){return g(this,null,function*(){if(t<n.byteLength){let i={value:n.slice(t,t+e),done:!1};return t+=e,i}return{done:!0}})},cancel(){return g(this,null,function*(){})},releaseLock(){},closed:Promise.resolve()}}var kc=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ga(this.observer.next,e)}error(e){this.observer.error?this.Ga(this.observer.error,e):dt("Uncaught Error in snapshot listener:",e.toString())}za(){this.muted=!0}Ga(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}};var y0=class{constructor(e,t){this.ja=e,this.serializer=t,this.metadata=new Tt,this.buffer=new Uint8Array,this.Ha=function(){return new TextDecoder("utf-8")}(),this.Ja().then(r=>{r&&r.ua()?this.metadata.resolve(r.aa.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r?.aa)}`))},r=>this.metadata.reject(r))}close(){return this.ja.cancel()}getMetadata(){return g(this,null,function*(){return this.metadata.promise})}Ua(){return g(this,null,function*(){return yield this.getMetadata(),this.Ja()})}Ja(){return g(this,null,function*(){let e=yield this.Ya();if(e===null)return null;let t=this.Ha.decode(e),r=Number(t);isNaN(r)&&this.Za(`length string (${t}) is not valid number`);let i=yield this.Xa(r);return new d0(JSON.parse(i),e.length+r)})}eu(){return this.buffer.findIndex(e=>e===123)}Ya(){return g(this,null,function*(){for(;this.eu()<0&&!(yield this.tu()););if(this.buffer.length===0)return null;let e=this.eu();e<0&&this.Za("Reached the end of bundle when a length string is expected.");let t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t})}Xa(e){return g(this,null,function*(){for(;this.buffer.length<e;)(yield this.tu())&&this.Za("Reached the end of bundle when more is expected.");let t=this.Ha.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t})}Za(e){throw this.ja.cancel(),new Error(`Invalid bundle format: ${e}`)}tu(){return g(this,null,function*(){let e=yield this.ja.read();if(!e.done){let t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done})}};var v0=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}lookup(e){return g(this,null,function*(){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new O(N.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;let t=yield function(i,s){return g(this,null,function*(){let o=z(i),a={documents:s.map(h=>Od(o.serializer,h))},c=yield o.Lo("BatchGetDocuments",o.serializer.databaseId,De.emptyPath(),a,s.length),l=new Map;c.forEach(h=>{let m=n8(o.serializer,h);l.set(m.key.toString(),m)});let d=[];return s.forEach(h=>{let m=l.get(h.toString());Z(!!m),d.push(m)}),d})}(this.datastore,e);return t.forEach(r=>this.recordVersion(r)),t})}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new Ts(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){return g(this,null,function*(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,r)=>{let i=W.fromPath(r);this.mutations.push(new xd(i,this.precondition(i)))}),yield function(r,i){return g(this,null,function*(){let s=z(r),o={writes:i.map(a=>Ld(s.serializer,a))};yield s.Mo("Commit",s.serializer.databaseId,De.emptyPath(),o)})}(this.datastore,this.mutations),this.committed=!0})}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw Y();t=ee.min()}let r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new O(N.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){let t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(ee.min())?ct.exists(!1):ct.updateTime(t):ct.none()}preconditionForUpdate(e){let t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(ee.min()))throw new O(N.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return ct.updateTime(t)}return ct.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};var w0=class{constructor(e,t,r,i,s){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=i,this.deferred=s,this.nu=r.maxAttempts,this.t_=new jd(this.asyncQueue,"transaction_retry")}ru(){this.nu-=1,this.iu()}iu(){this.t_.Go(()=>g(this,null,function*(){let e=new v0(this.datastore),t=this.su(e);t&&t.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.ou(i)}))}).catch(r=>{this.ou(r)})}))}su(e){try{let t=this.updateFunction(e);return!Gd(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}ou(e){this.nu>0&&this._u(e)?(this.nu-=1,this.asyncQueue.enqueueAndForget(()=>(this.iu(),Promise.resolve()))):this.deferred.reject(e)}_u(e){if(e.name==="FirebaseError"){let t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!Z1(t)}return!1}};var I0=class{constructor(e,t,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=Et.UNAUTHENTICATED,this.clientId=$m.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,s=>g(this,null,function*(){V("FirestoreClient","Received user=",s.uid),yield this.authCredentialListener(s),this.user=s})),this.appCheckCredentials.start(r,s=>(V("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new O(N.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();let e=new Tt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>g(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=$c(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function jm(n,e){return g(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),V("FirestoreClient","Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(i=>g(this,null,function*(){r.isEqual(i)||(yield EL(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e})}function E0(n,e){return g(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield cC(n);V("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>i1(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>i1(e.remoteStore,i)),n._onlineComponents=e})}function UL(n){return n.name==="FirebaseError"?n.code===N.FAILED_PRECONDITION||n.code===N.UNIMPLEMENTED:!(typeof DOMException<"u"&&n instanceof DOMException)||n.code===22||n.code===20||n.code===11}function cC(n){return g(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){V("FirestoreClient","Using user provided OfflineComponentProvider");try{yield jm(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!UL(t))throw t;Kn("Error using user provided cache. Falling back to memory cache: "+t),yield jm(n,new $d)}}else V("FirestoreClient","Using default OfflineComponentProvider"),yield jm(n,new $d);return n._offlineComponents})}function Bg(n){return g(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(V("FirestoreClient","Using user provided OnlineComponentProvider"),yield E0(n,n._uninitializedComponentsProvider._online)):(V("FirestoreClient","Using default OnlineComponentProvider"),yield E0(n,new Hd))),n._onlineComponents})}function jL(n){return cC(n).then(e=>e.persistence)}function lC(n){return cC(n).then(e=>e.localStore)}function BL(n){return Bg(n).then(e=>e.remoteStore)}function uC(n){return Bg(n).then(e=>e.syncEngine)}function X8(n){return Bg(n).then(e=>e.datastore)}function Oc(n){return g(this,null,function*(){let e=yield Bg(n),t=e.eventManager;return t.onListen=P8.bind(null,e.syncEngine),t.onUnlisten=k8.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=M8.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=O8.bind(null,e.syncEngine),t})}function Z8(n){return n.asyncQueue.enqueue(()=>g(this,null,function*(){let e=yield jL(n),t=yield BL(n);return e.setNetworkEnabled(!0),function(i){let s=z(i);return s.L_.delete(0),Xd(s)}(t)}))}function eK(n){return n.asyncQueue.enqueue(()=>g(this,null,function*(){let e=yield jL(n),t=yield BL(n);return e.setNetworkEnabled(!1),function(i){return g(this,null,function*(){let s=z(i);s.L_.add(0),yield Uc(s),s.q_.set("Offline")})}(t)}))}function tK(n,e){let t=new Tt;return n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(i,s,o){return g(this,null,function*(){try{let a=yield function(l,d){let h=z(l);return h.persistence.runTransaction("read document","readonly",m=>h.localDocuments.getDocument(m,d))}(i,s);a.isFoundDocument()?o.resolve(a):a.isNoDocument()?o.resolve(null):o.reject(new O(N.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){let c=$c(a,`Failed to get document '${s} from cache`);o.reject(c)}})}(yield lC(n),e,t)})),t.promise}function $L(n,e,t={}){let r=new Tt;return n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(s,o,a,c,l){let d=new kc({next:m=>{o.enqueueAndForget(()=>tC(s,h));let _=m.docs.has(a);!_&&m.fromCache?l.reject(new O(N.UNAVAILABLE,"Failed to get document because the client is offline.")):_&&m.fromCache&&c&&c.source==="server"?l.reject(new O(N.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):l.resolve(m)},error:m=>l.reject(m)}),h=new Bd(Vc(a.path),d,{includeMetadataChanges:!0,_a:!0});return eC(s,h)}(yield Oc(n),n.asyncQueue,e,t,r)})),r.promise}function nK(n,e){let t=new Tt;return n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(i,s,o){return g(this,null,function*(){try{let a=yield pg(i,s,!0),c=new Dg(s,a.Ts),l=c.ma(a.documents),d=c.applyChanges(l,!1);o.resolve(d.snapshot)}catch(a){let c=$c(a,`Failed to execute query '${s} against cache`);o.reject(c)}})}(yield lC(n),e,t)})),t.promise}function HL(n,e,t={}){let r=new Tt;return n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(s,o,a,c,l){let d=new kc({next:m=>{o.enqueueAndForget(()=>tC(s,h)),m.fromCache&&c.source==="server"?l.reject(new O(N.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):l.resolve(m)},error:m=>l.reject(m)}),h=new Bd(a,d,{includeMetadataChanges:!0,_a:!0});return eC(s,h)}(yield Oc(n),n.asyncQueue,e,t,r)})),r.promise}function rK(n,e){let t=new kc(e);return n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(i,s){z(i).Y_.add(s),s.next()}(yield Oc(n),t)})),()=>{t.za(),n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(i,s){z(i).Y_.delete(s)}(yield Oc(n),t)}))}}function iK(n,e,t,r){let i=function(o,a){let c;return c=typeof o=="string"?tL().encode(o):o,function(d,h){return new y0(d,h)}(function(d,h){if(d instanceof Uint8Array)return l1(d,h);if(d instanceof ArrayBuffer)return l1(new Uint8Array(d),h);if(d instanceof ReadableStream)return d.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(c),a)}(t,Jd(e));n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){J8(yield uC(n),i,r)}))}function sK(n,e){return n.asyncQueue.enqueue(()=>g(this,null,function*(){return function(r,i){let s=z(r);return s.persistence.runTransaction("Get named query","readonly",o=>s.Gr.getNamedQuery(o,i))}(yield lC(n),e)}))}function qL(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var u1=new Map;function dC(n,e,t){if(!t)throw new O(N.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function hC(n,e,t,r){if(e===!0&&r===!0)throw new O(N.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function d1(n){if(!W.isDocumentKey(n))throw new O(N.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function h1(n){if(W.isDocumentKey(n))throw new O(N.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function $g(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Y()}function Se(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new O(N.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=$g(n);throw new O(N.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function zL(n,e){if(e<=0)throw new O(N.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}var Ag=class{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new O(N.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new O(N.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}hC("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=qL((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new O(N.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new O(N.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new O(N.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},Lo=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Ag({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new O(N.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new O(N.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Ag(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new VT;switch(r.type){case"firstParty":return new $T(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new O(N.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let r=u1.get(t);r&&(V("ComponentProvider","Removing Datastore"),u1.delete(t),r.terminate())}(this),Promise.resolve()}};function WL(n,e,t,r={}){var i;let s=(n=Se(n,Lo))._getSettings(),o=`${e}:${t}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&Kn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let a,c;if(typeof r.mockUserToken=="string")a=r.mockUserToken,c=Et.MOCK_USER;else{a=qa(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);let l=r.mockUserToken.sub||r.mockUserToken.user_id;if(!l)throw new O(N.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new Et(l)}n._authCredentials=new UT(new Bm(a,c))}}var jt=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},qe=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Kr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}},Kr=class n extends jt{constructor(e,t,r){super(e,t,Vc(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new qe(this.firestore,null,new W(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function fC(n,e,...t){if(n=q(n),dC("collection","path",e),n instanceof Lo){let r=De.fromString(e,...t);return h1(r),new Kr(n,null,r)}{if(!(n instanceof qe||n instanceof Kr))throw new O(N.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(De.fromString(e,...t));return h1(r),new Kr(n.firestore,null,r)}}function GL(n,e){if(n=Se(n,Lo),dC("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new O(N.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new jt(n,null,function(r){return new mr(De.emptyPath(),r)}(e))}function Zd(n,e,...t){if(n=q(n),arguments.length===1&&(e=$m.newId()),dC("doc","path",e),n instanceof Lo){let r=De.fromString(e,...t);return d1(r),new qe(n,null,new W(r))}{if(!(n instanceof qe||n instanceof Kr))throw new O(N.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(De.fromString(e,...t));return d1(r),new qe(n.firestore,n instanceof Kr?n.converter:null,new W(r))}}function pC(n,e){return n=q(n),e=q(e),(n instanceof qe||n instanceof Kr)&&(e instanceof qe||e instanceof Kr)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function mC(n,e){return n=q(n),e=q(e),n instanceof jt&&e instanceof jt&&n.firestore===e.firestore&&Qd(n._query,e._query)&&n.converter===e.converter}var T0=class{constructor(){this.au=Promise.resolve(),this.uu=[],this.cu=!1,this.lu=[],this.hu=null,this.Pu=!1,this.Iu=!1,this.Tu=[],this.t_=new jd(this,"async_queue_retry"),this.Eu=()=>{let t=Um();t&&V("AsyncQueue","Visibility state changed to "+t.visibilityState),this.t_.jo()};let e=Um();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.Eu)}get isShuttingDown(){return this.cu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.du(),this.Au(e)}enterRestrictedMode(e){if(!this.cu){this.cu=!0,this.Iu=e||!1;let t=Um();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Eu)}}enqueue(e){if(this.du(),this.cu)return new Promise(()=>{});let t=new Tt;return this.Au(()=>this.cu&&this.Iu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.uu.push(e),this.Ru()))}Ru(){return g(this,null,function*(){if(this.uu.length!==0){try{yield this.uu[0](),this.uu.shift(),this.t_.reset()}catch(e){if(!Ds(e))throw e;V("AsyncQueue","Operation failed with retryable error: "+e)}this.uu.length>0&&this.t_.Go(()=>this.Ru())}})}Au(e){let t=this.au.then(()=>(this.Pu=!0,e().catch(r=>{this.hu=r,this.Pu=!1;let i=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw dt("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.Pu=!1,r))));return this.au=t,t}enqueueAfterDelay(e,t,r){this.du(),this.Tu.indexOf(e)>-1&&(t=0);let i=a0.createAndSchedule(this,e,t,r,s=>this.Vu(s));return this.lu.push(i),i}du(){this.hu&&Y()}verifyOperationInProgress(){}mu(){return g(this,null,function*(){let e;do e=this.au,yield e;while(e!==this.au)})}fu(e){for(let t of this.lu)if(t.timerId===e)return!0;return!1}gu(e){return this.mu().then(()=>{this.lu.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this.lu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.mu()})}pu(e){this.Tu.push(e)}Vu(e){let t=this.lu.indexOf(e);this.lu.splice(t,1)}};function b0(n){return function(t,r){if(typeof t!="object"||t===null)return!1;let i=t;for(let s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(n,["next","error","complete"])}var C0=class{constructor(){this._progressObserver={},this._taskCompletionResolver=new Tt,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}};var KL=-1,Ye=class extends Lo{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=function(){return new T0}(),this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||QL(this),this._firestoreClient.terminate()}};function Rt(n){return n._firestoreClient||QL(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function QL(n){var e,t,r;let i=n._freezeSettings(),s=function(a,c,l,d){return new YT(a,c,l,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,qL(d.experimentalLongPollingOptions),d.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._firestoreClient=new I0(n._authCredentials,n._appCheckCredentials,n._queue,s),!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}function YL(n,e){sF(n=Se(n,Ye));let t=Rt(n);if(t._uninitializedComponentsProvider)throw new O(N.FAILED_PRECONDITION,"SDK cache is already specified.");Kn("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let r=n._freezeSettings(),i=new Hd;return XL(t,i,new Sg(i,r.cacheSizeBytes,e?.forceOwnership))}function JL(n){sF(n=Se(n,Ye));let e=Rt(n);if(e._uninitializedComponentsProvider)throw new O(N.FAILED_PRECONDITION,"SDK cache is already specified.");Kn("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let t=n._freezeSettings(),r=new Hd;return XL(e,r,new _0(r,t.cacheSizeBytes))}function XL(n,e,t){let r=new Tt;return n.asyncQueue.enqueue(()=>g(this,null,function*(){try{yield jm(n,t),yield E0(n,e),r.resolve()}catch(i){let s=i;if(!UL(s))throw s;Kn("Error enabling indexeddb cache. Falling back to memory cache: "+s),r.reject(s)}})).then(()=>r.promise)}function ZL(n){if(n._initialized&&!n._terminated)throw new O(N.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");let e=new Tt;return n._queue.enqueueAndForgetEvenWhileRestricted(()=>g(this,null,function*(){try{yield function(r){return g(this,null,function*(){if(!gs.D())return Promise.resolve();let i=r+"main";yield gs.delete(i)})}(Y0(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}})),e.promise}function eF(n){return function(t){let r=new Tt;return t.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return j8(yield uC(t),r)})),r.promise}(Rt(n=Se(n,Ye)))}function tF(n){return Z8(Rt(n=Se(n,Ye)))}function nF(n){return eK(Rt(n=Se(n,Ye)))}function rF(n,e){let t=Rt(n=Se(n,Ye)),r=new C0;return iK(t,n._databaseId,e,r),r}function iF(n,e){return sK(Rt(n=Se(n,Ye)),e).then(t=>t?new jt(n,null,t.query):null)}function sF(n){if(n._initialized||n._terminated)throw new O(N.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var Xr=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(pt.fromBase64String(e))}catch(t){throw new O(N.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(pt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var _r=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new O(N.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ht(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var Ri=class{constructor(e){this._methodName=e}};var Fo=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new O(N.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new O(N.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ae(this._lat,e._lat)||ae(this._long,e._long)}};var qd=class{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}};var oK=/^__.*__$/,D0=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new gr(e,this.data,this.fieldMask,t,this.fieldTransforms):new Es(e,this.data,t,this.fieldTransforms)}},Rg=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new gr(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function oF(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Y()}}var xg=class n{constructor(e,t,r,i,s,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.yu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get wu(){return this.settings.wu}Su(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}bu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Su({path:r,Du:!1});return i.vu(e),i}Cu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Su({path:r,Du:!1});return i.yu(),i}Fu(e){return this.Su({path:void 0,Du:!0})}Mu(e){return Ng(e,this.settings.methodName,this.settings.xu||!1,this.path,this.settings.Ou)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}yu(){if(this.path)for(let e=0;e<this.path.length;e++)this.vu(this.path.get(e))}vu(e){if(e.length===0)throw this.Mu("Document fields must not be empty");if(oF(this.wu)&&oK.test(e))throw this.Mu('Document fields cannot begin and end with "__"')}},S0=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Jd(e)}Nu(e,t,r,i=!1){return new xg({wu:e,methodName:t,Ou:r,path:ht.emptyPath(),Du:!1,xu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function Bo(n){let e=n._freezeSettings(),t=Jd(n._databaseId);return new S0(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Hg(n,e,t,r,i,s={}){let o=n.Nu(s.merge||s.mergeFields?2:0,e,t,i);yC("Data must be an object, but it was:",o,r);let a=lF(r,o),c,l;if(s.merge)c=new Nn(o.fieldMask),l=o.fieldTransforms;else if(s.mergeFields){let d=[];for(let h of s.mergeFields){let m=P0(e,h,t);if(!o.contains(m))throw new O(N.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);dF(d,m)||d.push(m)}c=new Nn(d),l=o.fieldTransforms.filter(h=>c.covers(h.field))}else c=null,l=o.fieldTransforms;return new D0(new Jt(a),c,l)}var zd=class n extends Ri{_toFieldTransform(e){if(e.wu!==2)throw e.wu===1?e.Mu(`${this._methodName}() can only appear at the top level of your update data`):e.Mu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof n}};function aF(n,e,t){return new xg({wu:3,Ou:e.settings.Ou,methodName:n._methodName,Du:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}var A0=class n extends Ri{_toFieldTransform(e){return new Mo(e.path,new ws)}isEqual(e){return e instanceof n}},R0=class n extends Ri{constructor(e,t){super(e),this.Lu=t}_toFieldTransform(e){let t=aF(this,e,!0),r=this.Lu.map(s=>$o(s,t)),i=new Si(r);return new Mo(e.path,i)}isEqual(e){return e instanceof n&&Zi(this.Lu,e.Lu)}},x0=class n extends Ri{constructor(e,t){super(e),this.Lu=t}_toFieldTransform(e){let t=aF(this,e,!0),r=this.Lu.map(s=>$o(s,t)),i=new Ai(r);return new Mo(e.path,i)}isEqual(e){return e instanceof n&&Zi(this.Lu,e.Lu)}},N0=class n extends Ri{constructor(e,t){super(e),this.Bu=t}_toFieldTransform(e){let t=new Is(e.serializer,W1(e.serializer,this.Bu));return new Mo(e.path,t)}isEqual(e){return e instanceof n&&this.Bu===e.Bu}};function gC(n,e,t,r){let i=n.Nu(1,e,t);yC("Data must be an object, but it was:",i,r);let s=[],o=Jt.empty();jo(r,(c,l)=>{let d=vC(e,c,t);l=q(l);let h=i.Cu(d);if(l instanceof zd)s.push(d);else{let m=$o(l,h);m!=null&&(s.push(d),o.set(d,m))}});let a=new Nn(s);return new Rg(o,a,i.fieldTransforms)}function _C(n,e,t,r,i,s){let o=n.Nu(1,e,t),a=[P0(e,r,t)],c=[i];if(s.length%2!=0)throw new O(N.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<s.length;m+=2)a.push(P0(e,s[m])),c.push(s[m+1]);let l=[],d=Jt.empty();for(let m=a.length-1;m>=0;--m)if(!dF(l,a[m])){let _=a[m],w=c[m];w=q(w);let C=o.Cu(_);if(w instanceof zd)l.push(_);else{let A=$o(w,C);A!=null&&(l.push(_),d.set(_,A))}}let h=new Nn(l);return new Rg(d,h,o.fieldTransforms)}function cF(n,e,t,r=!1){return $o(t,n.Nu(r?4:3,e))}function $o(n,e){if(uF(n=q(n)))return yC("Unsupported field value:",e,n),lF(n,e);if(n instanceof Ri)return function(r,i){if(!oF(i.wu))throw i.Mu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Mu(`${r._methodName}() is not currently supported inside arrays`);let s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.Du&&e.wu!==4)throw e.Mu("Nested arrays are not supported");return function(r,i){let s=[],o=0;for(let a of r){let c=$o(a,i.Fu(o));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),o++}return{arrayValue:{values:s}}}(n,e)}return function(r,i){if((r=q(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return W1(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let s=et.fromDate(r);return{timestampValue:Dc(i.serializer,s)}}if(r instanceof et){let s=new et(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Dc(i.serializer,s)}}if(r instanceof Fo)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Xr)return{bytesValue:nL(i.serializer,r._byteString)};if(r instanceof qe){let s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Mu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:G0(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof qd)return function(o,a){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(c=>{if(typeof c!="number")throw a.Mu("VectorValues must only contain numeric values.");return W0(a.serializer,c)})}}}}}}(r,i);throw i.Mu(`Unsupported field value: ${$g(r)}`)}(n,e)}function lF(n,e){let t={};return A1(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):jo(n,(r,i)=>{let s=$o(i,e.bu(r));s!=null&&(t[r]=s)}),{mapValue:{fields:t}}}function uF(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof et||n instanceof Fo||n instanceof Xr||n instanceof qe||n instanceof Ri||n instanceof qd)}function yC(n,e,t){if(!uF(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){let r=$g(t);throw r==="an object"?e.Mu(n+" a custom object"):e.Mu(n+" "+r)}}function P0(n,e,t){if((e=q(e))instanceof _r)return e._internalPath;if(typeof e=="string")return vC(n,e);throw Ng("Field path arguments must be of type string or ",n,!1,void 0,t)}var aK=new RegExp("[~\\*/\\[\\]]");function vC(n,e,t){if(e.search(aK)>=0)throw Ng(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new _r(...e.split("."))._internalPath}catch{throw Ng(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Ng(n,e,t,r,i){let s=r&&!r.isEmpty(),o=i!==void 0,a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new O(N.INVALID_ARGUMENT,a+n+c)}function dF(n,e){return n.some(t=>t.isEqual(e))}var Vo=class{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new qe(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new M0(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(qg("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},M0=class extends Vo{data(){return super.data()}};function qg(n,e){return typeof e=="string"?vC(n,e):e instanceof _r?e._internalPath:e._delegate._internalPath}function hF(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new O(N.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Wd=class{},Uo=class extends Wd{};function Pi(n,e,...t){let r=[];e instanceof Wd&&r.push(e),r=r.concat(t),function(s){let o=s.filter(c=>c instanceof k0).length,a=s.filter(c=>c instanceof Pg).length;if(o>1||o>0&&a>0)throw new O(N.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(let i of r)n=i._apply(n);return n}var Pg=class n extends Uo{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=this._parse(e);return EF(e._query,t),new jt(e.firestore,e.converter,lb(e._query,t))}_parse(e){let t=Bo(e.firestore);return function(s,o,a,c,l,d,h){let m;if(l.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new O(N.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){p1(h,d);let _=[];for(let w of h)_.push(f1(c,s,w));m={arrayValue:{values:_}}}else m=f1(c,s,h)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||p1(h,d),m=cF(a,o,h,d==="in"||d==="not-in");return we.create(l,d,m)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};function fF(n,e,t){let r=e,i=qg("where",n);return Pg._create(i,r,t)}var k0=class n extends Wd{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:ke.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:(function(i,s){let o=i,a=s.getFlattenedFilters();for(let c of a)EF(o,c),o=lb(o,c)}(e._query,t),new jt(e.firestore,e.converter,lb(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var O0=class n extends Uo{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new n(e,t)}_apply(e){let t=function(i,s,o){if(i.startAt!==null)throw new O(N.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new O(N.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new No(s,o)}(e._query,this._field,this._direction);return new jt(e.firestore,e.converter,function(i,s){let o=i.explicitOrderBy.concat([s]);return new mr(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}};function pF(n,e="asc"){let t=e,r=qg("orderBy",n);return O0._create(r,t)}var Mg=class n extends Uo{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){return new jt(e.firestore,e.converter,Xm(e._query,this._limit,this._limitType))}};function mF(n){return zL("limit",n),Mg._create("limit",n,"F")}function gF(n){return zL("limitToLast",n),Mg._create("limitToLast",n,"L")}var kg=class n extends Uo{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=IF(e,this.type,this._docOrFields,this._inclusive);return new jt(e.firestore,e.converter,function(i,s){return new mr(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)}(e._query,t))}};function _F(...n){return kg._create("startAt",n,!0)}function yF(...n){return kg._create("startAfter",n,!1)}var Og=class n extends Uo{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=IF(e,this.type,this._docOrFields,this._inclusive);return new jt(e.firestore,e.converter,function(i,s){return new mr(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)}(e._query,t))}};function vF(...n){return Og._create("endBefore",n,!1)}function wF(...n){return Og._create("endAt",n,!0)}function IF(n,e,t,r){if(t[0]=q(t[0]),t[0]instanceof Vo)return function(s,o,a,c,l){if(!c)throw new O(N.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);let d=[];for(let h of yc(s))if(h.field.isKeyField())d.push(xo(o,c.key));else{let m=c.data.field(h.field);if(Fg(m))throw new O(N.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+h.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(m===null){let _=h.field.canonicalString();throw new O(N.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${_}' (used as the orderBy) does not exist.`)}d.push(m)}return new Yr(d,l)}(n._query,n.firestore._databaseId,e,t[0]._document,r);{let i=Bo(n.firestore);return function(o,a,c,l,d,h){let m=o.explicitOrderBy;if(d.length>m.length)throw new O(N.INVALID_ARGUMENT,`Too many arguments provided to ${l}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let _=[];for(let w=0;w<d.length;w++){let C=d[w];if(m[w].field.isKeyField()){if(typeof C!="string")throw new O(N.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${l}(), but got a ${typeof C}`);if(!q0(o)&&C.indexOf("/")!==-1)throw new O(N.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${l}() must be a plain document ID, but '${C}' contains a slash.`);let A=o.path.child(De.fromString(C));if(!W.isDocumentKey(A))throw new O(N.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${l}() must result in a valid document path, but '${A}' is not because it contains an odd number of segments.`);let L=new W(A);_.push(xo(a,L))}else{let A=cF(c,l,C);_.push(A)}}return new Yr(_,h)}(n._query,n.firestore._databaseId,i,e,t,r)}}function f1(n,e,t){if(typeof(t=q(t))=="string"){if(t==="")throw new O(N.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!q0(e)&&t.indexOf("/")!==-1)throw new O(N.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let r=e.path.child(De.fromString(t));if(!W.isDocumentKey(r))throw new O(N.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return xo(n,new W(r))}if(t instanceof qe)return xo(n,t._key);throw new O(N.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${$g(t)}.`)}function p1(n,e){if(!Array.isArray(n)||n.length===0)throw new O(N.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function EF(n,e){let t=function(i,s){for(let o of i)for(let a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new O(N.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new O(N.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}var Lc=class{convertValue(e,t="none"){switch(Ro(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Qe(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(_s(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Y()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return jo(e,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertVectorValue(e){var t,r,i;let s=(i=(r=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(o=>Qe(o.doubleValue));return new qd(s)}convertGeoPoint(e){return new Fo(Qe(e.latitude),Qe(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=$0(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Sd(e));default:return null}}convertTimestamp(e){let t=Di(e);return new et(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=De.fromString(e);Z(fL(r));let i=new ys(r.get(1),r.get(3)),s=new W(r.popFirst(5));return i.isEqual(t)||dt(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}};function zg(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}var L0=class extends Lc{constructor(e){super(),this.firestore=e}convertBytes(e){return new Xr(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new qe(this.firestore,null,t)}};var Ci=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},Yn=class extends Vo{constructor(e,t,r,i,s,o){super(e,t,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new ps(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(qg("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}},ps=class extends Yn{data(e={}){return super.data(e)}},yr=class{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Ci(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new ps(this._firestore,this._userDataWriter,r.key,r,new Ci(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new O(N.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{let c=new ps(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Ci(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{let c=new ps(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Ci(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter),l=-1,d=-1;return a.type!==0&&(l=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),d=o.indexOf(a.doc.key)),{type:cK(a.type),doc:c,oldIndex:l,newIndex:d}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function cK(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Y()}}function wC(n,e){return n instanceof Yn&&e instanceof Yn?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof yr&&e instanceof yr&&n._firestore===e._firestore&&mC(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}function TF(n){n=Se(n,qe);let e=Se(n.firestore,Ye);return $L(Rt(e),n._key).then(t=>bC(e,n,t))}var xi=class extends Lc{constructor(e){super(),this.firestore=e}convertBytes(e){return new Xr(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new qe(this.firestore,null,t)}};function bF(n){n=Se(n,qe);let e=Se(n.firestore,Ye),t=Rt(e),r=new xi(e);return tK(t,n._key).then(i=>new Yn(e,r,n._key,i,new Ci(i!==null&&i.hasLocalMutations,!0),n.converter))}function CF(n){n=Se(n,qe);let e=Se(n.firestore,Ye);return $L(Rt(e),n._key,{source:"server"}).then(t=>bC(e,n,t))}function DF(n){n=Se(n,jt);let e=Se(n.firestore,Ye),t=Rt(e),r=new xi(e);return hF(n._query),HL(t,n._query).then(i=>new yr(e,r,n,i))}function SF(n){n=Se(n,jt);let e=Se(n.firestore,Ye),t=Rt(e),r=new xi(e);return nK(t,n._query).then(i=>new yr(e,r,n,i))}function AF(n){n=Se(n,jt);let e=Se(n.firestore,Ye),t=Rt(e),r=new xi(e);return HL(t,n._query,{source:"server"}).then(i=>new yr(e,r,n,i))}function IC(n,e,t){n=Se(n,qe);let r=Se(n.firestore,Ye),i=zg(n.converter,e,t);return Hc(r,[Hg(Bo(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,ct.none())])}function EC(n,e,t,...r){n=Se(n,qe);let i=Se(n.firestore,Ye),s=Bo(i),o;return o=typeof(e=q(e))=="string"||e instanceof _r?_C(s,"updateDoc",n._key,e,t,r):gC(s,"updateDoc",n._key,e),Hc(i,[o.toMutation(n._key,ct.exists(!0))])}function RF(n){return Hc(Se(n.firestore,Ye),[new Ts(n._key,ct.none())])}function xF(n,e){let t=Se(n.firestore,Ye),r=Zd(n),i=zg(n.converter,e);return Hc(t,[Hg(Bo(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,ct.exists(!1))]).then(()=>r)}function TC(n,...e){var t,r,i;n=q(n);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||b0(e[o])||(s=e[o],o++);let a={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(b0(e[o])){let h=e[o];e[o]=(t=h.next)===null||t===void 0?void 0:t.bind(h),e[o+1]=(r=h.error)===null||r===void 0?void 0:r.bind(h),e[o+2]=(i=h.complete)===null||i===void 0?void 0:i.bind(h)}let c,l,d;if(n instanceof qe)l=Se(n.firestore,Ye),d=Vc(n._key.path),c={next:h=>{e[o]&&e[o](bC(l,n,h))},error:e[o+1],complete:e[o+2]};else{let h=Se(n,jt);l=Se(h.firestore,Ye),d=h._query;let m=new xi(l);c={next:_=>{e[o]&&e[o](new yr(l,m,h,_))},error:e[o+1],complete:e[o+2]},hF(n._query)}return function(m,_,w,C){let A=new kc(C),L=new Bd(_,A,w);return m.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return eC(yield Oc(m),L)})),()=>{A.za(),m.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return tC(yield Oc(m),L)}))}}(Rt(l),d,a,c)}function NF(n,e){return rK(Rt(n=Se(n,Ye)),b0(e)?e:{next:e})}function Hc(n,e){return function(r,i){let s=new Tt;return r.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return L8(yield uC(r),i,s)})),s.promise}(Rt(n),e)}function bC(n,e,t){let r=t.docs.get(e._key),i=new xi(n);return new Yn(n,i,e._key,r,new Ci(t.hasPendingWrites,t.fromCache),e.converter)}var lK={maxAttempts:5};var Lg=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Bo(e)}set(e,t,r){this._verifyNotCommitted();let i=hs(e,this._firestore),s=zg(i.converter,t,r),o=Hg(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,r);return this._mutations.push(o.toMutation(i._key,ct.none())),this}update(e,t,r,...i){this._verifyNotCommitted();let s=hs(e,this._firestore),o;return o=typeof(t=q(t))=="string"||t instanceof _r?_C(this._dataReader,"WriteBatch.update",s._key,t,r,i):gC(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(o.toMutation(s._key,ct.exists(!0))),this}delete(e){this._verifyNotCommitted();let t=hs(e,this._firestore);return this._mutations=this._mutations.concat(new Ts(t._key,ct.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new O(N.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function hs(n,e){if((n=q(n)).firestore!==e)throw new O(N.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}var F0=class extends class{constructor(t,r){this._firestore=t,this._transaction=r,this._dataReader=Bo(t)}get(t){let r=hs(t,this._firestore),i=new L0(this._firestore);return this._transaction.lookup([r._key]).then(s=>{if(!s||s.length!==1)return Y();let o=s[0];if(o.isFoundDocument())return new Vo(this._firestore,i,o.key,o,r.converter);if(o.isNoDocument())return new Vo(this._firestore,i,r._key,null,r.converter);throw Y()})}set(t,r,i){let s=hs(t,this._firestore),o=zg(s.converter,r,i),a=Hg(this._dataReader,"Transaction.set",s._key,o,s.converter!==null,i);return this._transaction.set(s._key,a),this}update(t,r,i,...s){let o=hs(t,this._firestore),a;return a=typeof(r=q(r))=="string"||r instanceof _r?_C(this._dataReader,"Transaction.update",o._key,r,i,s):gC(this._dataReader,"Transaction.update",o._key,r),this._transaction.update(o._key,a),this}delete(t){let r=hs(t,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){let t=hs(e,this._firestore),r=new xi(this._firestore);return super.get(e).then(i=>new Yn(this._firestore,r,t._key,i._document,new Ci(!1,!1),t.converter))}};function PF(n,e,t){n=Se(n,Ye);let r=Object.assign(Object.assign({},lK),t);return function(s){if(s.maxAttempts<1)throw new O(N.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(s,o,a){let c=new Tt;return s.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){let l=yield X8(s);new w0(s.asyncQueue,l,a,o,c).ru()})),c.promise}(Rt(n),i=>e(new F0(n,i)),r)}function MF(){return new zd("deleteField")}function kF(){return new A0("serverTimestamp")}function OF(...n){return new R0("arrayUnion",n)}function LF(...n){return new x0("arrayRemove",n)}function FF(n){return new N0("increment",n)}(function(e,t=!0){(function(i){Fc=i})(an),on(new Le("firestore",(r,{instanceIdentifier:i,options:s})=>{let o=r.getProvider("app").getImmediate(),a=new Ye(new jT(r.getProvider("auth-internal")),new qT(r.getProvider("app-check-internal")),function(l,d){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new O(N.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ys(l.options.projectId,d)}(o,i),o);return s=Object.assign({useFetchStreams:t},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),ut(fO,"4.7.1",e),ut(fO,"4.7.1","esm2017")})();var uK="@firebase/firestore-compat",dK="0.3.36";function xC(n,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new O("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}function VF(){if(typeof Uint8Array>"u")throw new O("unimplemented","Uint8Arrays are not available in this environment.")}function UF(){if(!R1())throw new O("unimplemented","Blobs are unavailable in Firestore in this environment.")}var Wg=class n{constructor(e){this._delegate=e}static fromBase64String(e){return UF(),new n(Xr.fromBase64String(e))}static fromUint8Array(e){return VF(),new n(Xr.fromUint8Array(e))}toBase64(){return UF(),this._delegate.toBase64()}toUint8Array(){return VF(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};function CC(n){return hK(n,["next","error","complete"])}function hK(n,e){if(typeof n!="object"||n===null)return!1;let t=n;for(let r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}var DC=class{enableIndexedDbPersistence(e,t){return YL(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return JL(e._delegate)}clearIndexedDbPersistence(e){return ZL(e._delegate)}},Gg=class{constructor(e,t,r){this._delegate=t,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof ys||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){let t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&Kn("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},t),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,t,r={}){WL(this._delegate,e,t,r)}enableNetwork(){return tF(this._delegate)}disableNetwork(){return nF(this._delegate)}enablePersistence(e){let t=!1,r=!1;return e&&(t=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,hC("synchronizeTabs",t,"experimentalForceOwningTab",r)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return eF(this._delegate)}onSnapshotsInSync(e){return NF(this._delegate,e)}get app(){if(!this._appCompat)throw new O("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new Wc(this,fC(this._delegate,e))}catch(t){throw un(t,"collection()","Firestore.collection()")}}doc(e){try{return new Zr(this,Zd(this._delegate,e))}catch(t){throw un(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new Wo(this,GL(this._delegate,e))}catch(t){throw un(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return PF(this._delegate,t=>e(new Kg(this,t)))}batch(){return Rt(this._delegate),new Qg(new Lg(this._delegate,e=>Hc(this._delegate,e)))}loadBundle(e){return rF(this._delegate,e)}namedQuery(e){return iF(this._delegate,e).then(t=>t?new Wo(this,t):null)}},qc=class extends Lc{constructor(e){super(),this.firestore=e}convertBytes(e){return new Wg(new Xr(e))}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return Zr.forKey(t,this.firestore,null)}};function fK(n){g1(n)}var Kg=class{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new qc(e)}get(e){let t=Ho(e);return this._delegate.get(t).then(r=>new qo(this._firestore,new Yn(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,t.converter)))}set(e,t,r){let i=Ho(e);return r?(xC("Transaction.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){let s=Ho(e);return arguments.length===2?this._delegate.update(s,t):this._delegate.update(s,t,r,...i),this}delete(e){let t=Ho(e);return this._delegate.delete(t),this}},Qg=class{constructor(e){this._delegate=e}set(e,t,r){let i=Ho(e);return r?(xC("WriteBatch.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){let s=Ho(e);return arguments.length===2?this._delegate.update(s,t):this._delegate.update(s,t,r,...i),this}delete(e){let t=Ho(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}},zc=class n{constructor(e,t,r){this._firestore=e,this._userDataWriter=t,this._delegate=r}fromFirestore(e,t){let r=new ps(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new zo(this._firestore,r),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){let r=n.INSTANCES,i=r.get(e);i||(i=new WeakMap,r.set(e,i));let s=i.get(t);return s||(s=new n(e,new qc(e),t),i.set(t,s)),s}};zc.INSTANCES=new WeakMap;var Zr=class n{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new qc(e)}static forPath(e,t,r){if(e.length%2!==0)throw new O("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new n(t,new qe(t._delegate,r,new W(e)))}static forKey(e,t,r){return new n(t,new qe(t._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new Wc(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Wc(this.firestore,fC(this._delegate,e))}catch(t){throw un(t,"collection()","DocumentReference.collection()")}}isEqual(e){return e=q(e),e instanceof qe?pC(this._delegate,e):!1}set(e,t){t=xC("DocumentReference.set",t);try{return t?IC(this._delegate,e,t):IC(this._delegate,e)}catch(r){throw un(r,"setDoc()","DocumentReference.set()")}}update(e,t,...r){try{return arguments.length===1?EC(this._delegate,e):EC(this._delegate,e,t,...r)}catch(i){throw un(i,"updateDoc()","DocumentReference.update()")}}delete(){return RF(this._delegate)}onSnapshot(...e){let t=jF(e),r=BF(e,i=>new qo(this.firestore,new Yn(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return TC(this._delegate,t,r)}get(e){let t;return e?.source==="cache"?t=bF(this._delegate):e?.source==="server"?t=CF(this._delegate):t=TF(this._delegate),t.then(r=>new qo(this.firestore,new Yn(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(zc.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function un(n,e,t){return n.message=n.message.replace(e,t),n}function jF(n){for(let e of n)if(typeof e=="object"&&!CC(e))return e;return{}}function BF(n,e){var t,r;let i;return CC(n[0])?i=n[0]:CC(n[1])?i=n[1]:typeof n[0]=="function"?i={next:n[0],error:n[1],complete:n[2]}:i={next:n[1],error:n[2],complete:n[3]},{next:s=>{i.next&&i.next(e(s))},error:(t=i.error)===null||t===void 0?void 0:t.bind(i),complete:(r=i.complete)===null||r===void 0?void 0:r.bind(i)}}var qo=class{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new Zr(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return wC(this._delegate,e._delegate)}},zo=class extends qo{data(e){let t=this._delegate.data(e);return this._delegate._converter||_1(t!==void 0,"Document in a QueryDocumentSnapshot should exist"),t}},Wo=class n{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new qc(e)}where(e,t,r){try{return new n(this.firestore,Pi(this._delegate,fF(e,t,r)))}catch(i){throw un(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new n(this.firestore,Pi(this._delegate,pF(e,t)))}catch(r){throw un(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new n(this.firestore,Pi(this._delegate,mF(e)))}catch(t){throw un(t,"limit()","Query.limit()")}}limitToLast(e){try{return new n(this.firestore,Pi(this._delegate,gF(e)))}catch(t){throw un(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new n(this.firestore,Pi(this._delegate,_F(...e)))}catch(t){throw un(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new n(this.firestore,Pi(this._delegate,yF(...e)))}catch(t){throw un(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new n(this.firestore,Pi(this._delegate,vF(...e)))}catch(t){throw un(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new n(this.firestore,Pi(this._delegate,wF(...e)))}catch(t){throw un(t,"endAt()","Query.endAt()")}}isEqual(e){return mC(this._delegate,e._delegate)}get(e){let t;return e?.source==="cache"?t=SF(this._delegate):e?.source==="server"?t=AF(this._delegate):t=DF(this._delegate),t.then(r=>new eh(this.firestore,new yr(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){let t=jF(e),r=BF(e,i=>new eh(this.firestore,new yr(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return TC(this._delegate,t,r)}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(zc.getInstance(this.firestore,e)):this._delegate.withConverter(null))}},SC=class{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new zo(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}},eh=class{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new Wo(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new zo(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new SC(this._firestore,t))}forEach(e,t){this._delegate.forEach(r=>{e.call(t,new zo(this._firestore,r))})}isEqual(e){return wC(this._delegate,e._delegate)}},Wc=class n extends Wo{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){let e=this._delegate.parent;return e?new Zr(this.firestore,e):null}doc(e){try{return e===void 0?new Zr(this.firestore,Zd(this._delegate)):new Zr(this.firestore,Zd(this._delegate,e))}catch(t){throw un(t,"doc()","CollectionReference.doc()")}}add(e){return xF(this._delegate,e).then(t=>new Zr(this.firestore,t))}isEqual(e){return pC(this._delegate,e._delegate)}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(zc.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function Ho(n){return Se(n,qe)}var AC=class n{constructor(...e){this._delegate=new _r(...e)}static documentId(){return new n(ht.keyField().canonicalString())}isEqual(e){return e=q(e),e instanceof _r?this._delegate._internalPath.isEqual(e._internalPath):!1}};var RC=class n{constructor(e){this._delegate=e}static serverTimestamp(){let e=kF();return e._methodName="FieldValue.serverTimestamp",new n(e)}static delete(){let e=MF();return e._methodName="FieldValue.delete",new n(e)}static arrayUnion(...e){let t=OF(...e);return t._methodName="FieldValue.arrayUnion",new n(t)}static arrayRemove(...e){let t=LF(...e);return t._methodName="FieldValue.arrayRemove",new n(t)}static increment(e){let t=FF(e);return t._methodName="FieldValue.increment",new n(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}};var pK={Firestore:Gg,GeoPoint:Fo,Timestamp:et,Blob:Wg,Transaction:Kg,WriteBatch:Qg,DocumentReference:Zr,DocumentSnapshot:qo,Query:Wo,QueryDocumentSnapshot:zo,QuerySnapshot:eh,CollectionReference:Wc,FieldPath:AC,FieldValue:RC,setLogLevel:fK,CACHE_SIZE_UNLIMITED:KL};function mK(n,e){n.INTERNAL.registerComponent(new Le("firestore-compat",t=>{let r=t.getProvider("app-compat").getImmediate(),i=t.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},pK)))}function gK(n){mK(n,(e,t)=>new Gg(e,t,new DC)),n.registerVersion(uK,dK)}gK(Fe);var YF="firebasestorage.googleapis.com",JF="storageBucket",_K=2*60*1e3,yK=10*60*1e3,vK=1e3;var tt=class n extends st{constructor(e,t,r=0){super(NC(e),`Firebase Storage: ${t} (${NC(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,n.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return NC(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}},Je=function(n){return n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment",n}(Je||{});function NC(n){return"storage/"+n}function UC(){let n="An unknown error occurred, please check the error payload for server response.";return new tt(Je.UNKNOWN,n)}function wK(n){return new tt(Je.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}function IK(n){return new tt(Je.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function EK(){let n="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new tt(Je.UNAUTHENTICATED,n)}function TK(){return new tt(Je.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function bK(n){return new tt(Je.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}function XF(){return new tt(Je.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function ZF(){return new tt(Je.CANCELED,"User canceled the upload/download.")}function CK(n){return new tt(Je.INVALID_URL,"Invalid URL '"+n+"'.")}function DK(n){return new tt(Je.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function SK(){return new tt(Je.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+JF+"' property when initializing the app?")}function eV(){return new tt(Je.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function AK(){return new tt(Je.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}function RK(){return new tt(Je.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function xK(n){return new tt(Je.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Go(n){return new tt(Je.INVALID_ARGUMENT,n)}function tV(){return new tt(Je.APP_DELETED,"The Firebase app was deleted.")}function jC(n){return new tt(Je.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function nh(n,e){return new tt(Je.INVALID_FORMAT,"String does not match format '"+n+"': "+e)}function th(n){throw new tt(Je.INTERNAL_ERROR,"Internal error: "+n)}var dn=class n{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){let e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let r;try{r=n.makeFromUrl(e,t)}catch{return new n(e,"")}if(r.path==="")return r;throw DK(e)}static makeFromUrl(e,t){let r=null,i="([A-Za-z0-9.\\-_]+)";function s(Q){Q.path.charAt(Q.path.length-1)==="/"&&(Q.path_=Q.path_.slice(0,-1))}let o="(/(.*))?$",a=new RegExp("^gs://"+i+o,"i"),c={bucket:1,path:3};function l(Q){Q.path_=decodeURIComponent(Q.path)}let d="v[A-Za-z0-9_]+",h=t.replace(/[.]/g,"\\."),m="(/([^?#]*).*)?$",_=new RegExp(`^https?://${h}/${d}/b/${i}/o${m}`,"i"),w={bucket:1,path:3},C=t===YF?"(?:storage.googleapis.com|storage.cloud.google.com)":t,A="([^?#]*)",L=new RegExp(`^https?://${C}/${i}/${A}`,"i"),j=[{regex:a,indices:c,postModify:s},{regex:_,indices:w,postModify:l},{regex:L,indices:{bucket:1,path:2},postModify:l}];for(let Q=0;Q<j.length;Q++){let se=j[Q],J=se.regex.exec(e);if(J){let T=J[se.indices.bucket],v=J[se.indices.path];v||(v=""),r=new n(T,v),se.postModify(r);break}}if(r==null)throw CK(e);return r}},MC=class{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}};function NK(n,e,t){let r=1,i=null,s=null,o=!1,a=0;function c(){return a===2}let l=!1;function d(...A){l||(l=!0,e.apply(null,A))}function h(A){i=setTimeout(()=>{i=null,n(_,c())},A)}function m(){s&&clearTimeout(s)}function _(A,...L){if(l){m();return}if(A){m(),d.call(null,A,...L);return}if(c()||o){m(),d.call(null,A,...L);return}r<64&&(r*=2);let j;a===1?(a=2,j=0):j=(r+Math.random())*1e3,h(j)}let w=!1;function C(A){w||(w=!0,m(),!l&&(i!==null?(A||(a=2),clearTimeout(i),h(0)):A||(a=1)))}return h(0),s=setTimeout(()=>{o=!0,C(!0)},t),C}function PK(n){n(!1)}function MK(n){return n!==void 0}function kK(n){return typeof n=="function"}function OK(n){return typeof n=="object"&&!Array.isArray(n)}function Xg(n){return typeof n=="string"||n instanceof String}function $F(n){return BC()&&n instanceof Blob}function BC(){return typeof Blob<"u"}function kC(n,e,t,r){if(r<e)throw Go(`Invalid value for '${n}'. Expected ${e} or greater.`);if(r>t)throw Go(`Invalid value for '${n}'. Expected ${t} or less.`)}function As(n,e,t){let r=e;return t==null&&(r=`https://${e}`),`${t}://${r}/v0${n}`}function nV(n){let e=encodeURIComponent,t="?";for(let r in n)if(n.hasOwnProperty(r)){let i=e(r)+"="+e(n[r]);t=t+i+"&"}return t=t.slice(0,-1),t}var Qc=function(n){return n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT",n}(Qc||{});function rV(n,e){let t=n>=500&&n<600,i=[408,429].indexOf(n)!==-1,s=e.indexOf(n)!==-1;return t||i||s}var OC=class{constructor(e,t,r,i,s,o,a,c,l,d,h,m=!0){this.url_=e,this.method_=t,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=c,this.timeout_=l,this.progressCallback_=d,this.connectionFactory_=h,this.retry=m,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((_,w)=>{this.resolve_=_,this.reject_=w,this.start_()})}start_(){let e=(r,i)=>{if(i){r(!1,new Kc(!1,null,!0));return}let s=this.connectionFactory_();this.pendingConnection_=s;let o=a=>{let c=a.loaded,l=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,l)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;let a=s.getErrorCode()===Qc.NO_ERROR,c=s.getStatus();if(!a||rV(c,this.additionalRetryCodes_)&&this.retry){let d=s.getErrorCode()===Qc.ABORT;r(!1,new Kc(!1,null,d));return}let l=this.successCodes_.indexOf(c)!==-1;r(!0,new Kc(l,s))})},t=(r,i)=>{let s=this.resolve_,o=this.reject_,a=i.connection;if(i.wasSuccessCode)try{let c=this.callback_(a,a.getResponse());MK(c)?s(c):s()}catch(c){o(c)}else if(a!==null){let c=UC();c.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,c)):o(c)}else if(i.canceled){let c=this.appDelete_?tV():ZF();o(c)}else{let c=XF();o(c)}};this.canceled_?t(!1,new Kc(!1,null,!0)):this.backoffId_=NK(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&PK(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}},Kc=class{constructor(e,t,r){this.wasSuccessCode=e,this.connection=t,this.canceled=!!r}};function LK(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function FK(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function VK(n,e){e&&(n["X-Firebase-GMPID"]=e)}function UK(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function jK(n,e,t,r,i,s,o=!0){let a=nV(n.urlParams),c=n.url+a,l=Object.assign({},n.headers);return VK(l,e),LK(l,t),FK(l,s),UK(l,r),new OC(c,n.method,l,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,i,o)}function BK(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function $K(...n){let e=BK();if(e!==void 0){let t=new e;for(let r=0;r<n.length;r++)t.append(n[r]);return t.getBlob()}else{if(BC())return new Blob(n);throw new tt(Je.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function HK(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}function qK(n){if(typeof atob>"u")throw xK("base-64");return atob(n)}var Pn={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"},rh=class{constructor(e,t){this.data=e,this.contentType=t||null}};function $C(n,e){switch(n){case Pn.RAW:return new rh(iV(e));case Pn.BASE64:case Pn.BASE64URL:return new rh(sV(n,e));case Pn.DATA_URL:return new rh(WK(e),GK(e))}throw UC()}function iV(n){let e=[];for(let t=0;t<n.length;t++){let r=n.charCodeAt(t);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(t<n.length-1&&(n.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{let s=r,o=n.charCodeAt(++t);r=65536|(s&1023)<<10|o&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function zK(n){let e;try{e=decodeURIComponent(n)}catch{throw nh(Pn.DATA_URL,"Malformed data URL.")}return iV(e)}function sV(n,e){switch(n){case Pn.BASE64:{let i=e.indexOf("-")!==-1,s=e.indexOf("_")!==-1;if(i||s)throw nh(n,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case Pn.BASE64URL:{let i=e.indexOf("+")!==-1,s=e.indexOf("/")!==-1;if(i||s)throw nh(n,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=qK(e)}catch(i){throw i.message.includes("polyfill")?i:nh(n,"Invalid character found")}let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}var Jg=class{constructor(e){this.base64=!1,this.contentType=null;let t=e.match(/^data:([^,]+)?,/);if(t===null)throw nh(Pn.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");let r=t[1]||null;r!=null&&(this.base64=KK(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}};function WK(n){let e=new Jg(n);return e.base64?sV(Pn.BASE64,e.rest):zK(e.rest)}function GK(n){return new Jg(n).contentType}function KK(n,e){return n.length>=e.length?n.substring(n.length-e.length)===e:!1}var Yc=class n{constructor(e,t){let r=0,i="";$F(e)?(this.data_=e,r=e.size,i=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,t){if($F(this.data_)){let r=this.data_,i=HK(r,e,t);return i===null?null:new n(i)}else{let r=new Uint8Array(this.data_.buffer,e,t-e);return new n(r,!0)}}static getBlob(...e){if(BC()){let t=e.map(r=>r instanceof n?r.data_:r);return new n($K.apply(null,t))}else{let t=e.map(o=>Xg(o)?$C(Pn.RAW,o).data:o.data_),r=0;t.forEach(o=>{r+=o.byteLength});let i=new Uint8Array(r),s=0;return t.forEach(o=>{for(let a=0;a<o.length;a++)i[s++]=o[a]}),new n(i,!0)}}uploadData(){return this.data_}};function HC(n){let e;try{e=JSON.parse(n)}catch{return null}return OK(e)?e:null}function QK(n){if(n.length===0)return null;let e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function YK(n,e){let t=e.split("/").filter(r=>r.length>0).join("/");return n.length===0?t:n+"/"+t}function oV(n){let e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}function JK(n,e){return e}var Bt=class{constructor(e,t,r,i){this.server=e,this.local=t||e,this.writable=!!r,this.xform=i||JK}},Yg=null;function XK(n){return!Xg(n)||n.length<2?n:oV(n)}function Zg(){if(Yg)return Yg;let n=[];n.push(new Bt("bucket")),n.push(new Bt("generation")),n.push(new Bt("metageneration")),n.push(new Bt("name","fullPath",!0));function e(s,o){return XK(o)}let t=new Bt("name");t.xform=e,n.push(t);function r(s,o){return o!==void 0?Number(o):o}let i=new Bt("size");return i.xform=r,n.push(i),n.push(new Bt("timeCreated")),n.push(new Bt("updated")),n.push(new Bt("md5Hash",null,!0)),n.push(new Bt("cacheControl",null,!0)),n.push(new Bt("contentDisposition",null,!0)),n.push(new Bt("contentEncoding",null,!0)),n.push(new Bt("contentLanguage",null,!0)),n.push(new Bt("contentType",null,!0)),n.push(new Bt("metadata","customMetadata",!0)),Yg=n,Yg}function ZK(n,e){function t(){let r=n.bucket,i=n.fullPath,s=new dn(r,i);return e._makeStorageReference(s)}Object.defineProperty(n,"ref",{get:t})}function e7(n,e,t){let r={};r.type="file";let i=t.length;for(let s=0;s<i;s++){let o=t[s];r[o.local]=o.xform(r,e[o.server])}return ZK(r,n),r}function aV(n,e,t){let r=HC(e);return r===null?null:e7(n,r,t)}function t7(n,e,t,r){let i=HC(e);if(i===null||!Xg(i.downloadTokens))return null;let s=i.downloadTokens;if(s.length===0)return null;let o=encodeURIComponent;return s.split(",").map(l=>{let d=n.bucket,h=n.fullPath,m="/b/"+o(d)+"/o/"+o(h),_=As(m,t,r),w=nV({alt:"media",token:l});return _+w})[0]}function qC(n,e){let t={},r=e.length;for(let i=0;i<r;i++){let s=e[i];s.writable&&(t[s.server]=n[s.local])}return JSON.stringify(t)}var HF="prefixes",qF="items";function n7(n,e,t){let r={prefixes:[],items:[],nextPageToken:t.nextPageToken};if(t[HF])for(let i of t[HF]){let s=i.replace(/\/$/,""),o=n._makeStorageReference(new dn(e,s));r.prefixes.push(o)}if(t[qF])for(let i of t[qF]){let s=n._makeStorageReference(new dn(e,i.name));r.items.push(s)}return r}function r7(n,e,t){let r=HC(t);return r===null?null:n7(n,e,r)}var vr=class{constructor(e,t,r,i){this.url=e,this.method=t,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}};function ti(n){if(!n)throw UC()}function e_(n,e){function t(r,i){let s=aV(n,i,e);return ti(s!==null),s}return t}function i7(n,e){function t(r,i){let s=r7(n,e,i);return ti(s!==null),s}return t}function s7(n,e){function t(r,i){let s=aV(n,i,e);return ti(s!==null),t7(s,i,n.host,n._protocol)}return t}function Zc(n){function e(t,r){let i;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?i=TK():i=EK():t.getStatus()===402?i=IK(n.bucket):t.getStatus()===403?i=bK(n.path):i=r,i.status=t.getStatus(),i.serverResponse=r.serverResponse,i}return e}function t_(n){let e=Zc(n);function t(r,i){let s=e(r,i);return r.getStatus()===404&&(s=wK(n.path)),s.serverResponse=i.serverResponse,s}return t}function cV(n,e,t){let r=e.fullServerUrl(),i=As(r,n.host,n._protocol),s="GET",o=n.maxOperationRetryTime,a=new vr(i,s,e_(n,t),o);return a.errorHandler=t_(e),a}function o7(n,e,t,r,i){let s={};e.isRoot?s.prefix="":s.prefix=e.path+"/",t&&t.length>0&&(s.delimiter=t),r&&(s.pageToken=r),i&&(s.maxResults=i);let o=e.bucketOnlyServerUrl(),a=As(o,n.host,n._protocol),c="GET",l=n.maxOperationRetryTime,d=new vr(a,c,i7(n,e.bucket),l);return d.urlParams=s,d.errorHandler=Zc(e),d}function a7(n,e,t){let r=e.fullServerUrl(),i=As(r,n.host,n._protocol),s="GET",o=n.maxOperationRetryTime,a=new vr(i,s,s7(n,t),o);return a.errorHandler=t_(e),a}function c7(n,e,t,r){let i=e.fullServerUrl(),s=As(i,n.host,n._protocol),o="PATCH",a=qC(t,r),c={"Content-Type":"application/json; charset=utf-8"},l=n.maxOperationRetryTime,d=new vr(s,o,e_(n,r),l);return d.headers=c,d.body=a,d.errorHandler=t_(e),d}function l7(n,e){let t=e.fullServerUrl(),r=As(t,n.host,n._protocol),i="DELETE",s=n.maxOperationRetryTime;function o(c,l){}let a=new vr(r,i,o,s);return a.successCodes=[200,204],a.errorHandler=t_(e),a}function u7(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}function lV(n,e,t){let r=Object.assign({},t);return r.fullPath=n.path,r.size=e.size(),r.contentType||(r.contentType=u7(null,e)),r}function d7(n,e,t,r,i){let s=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let j="";for(let Q=0;Q<2;Q++)j=j+Math.random().toString().slice(2);return j}let c=a();o["Content-Type"]="multipart/related; boundary="+c;let l=lV(e,r,i),d=qC(l,t),h="--"+c+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+d+`\r
--`+c+`\r
Content-Type: `+l.contentType+`\r
\r
`,m=`\r
--`+c+"--",_=Yc.getBlob(h,r,m);if(_===null)throw eV();let w={name:l.fullPath},C=As(s,n.host,n._protocol),A="POST",L=n.maxUploadRetryTime,H=new vr(C,A,e_(n,t),L);return H.urlParams=w,H.headers=o,H.body=_.uploadData(),H.errorHandler=Zc(e),H}var Jc=class{constructor(e,t,r,i){this.current=e,this.total=t,this.finalized=!!r,this.metadata=i||null}};function zC(n,e){let t=null;try{t=n.getResponseHeader("X-Goog-Upload-Status")}catch{ti(!1)}return ti(!!t&&(e||["active"]).indexOf(t)!==-1),t}function h7(n,e,t,r,i){let s=e.bucketOnlyServerUrl(),o=lV(e,r,i),a={name:o.fullPath},c=As(s,n.host,n._protocol),l="POST",d={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${r.size()}`,"X-Goog-Upload-Header-Content-Type":o.contentType,"Content-Type":"application/json; charset=utf-8"},h=qC(o,t),m=n.maxUploadRetryTime;function _(C){zC(C);let A;try{A=C.getResponseHeader("X-Goog-Upload-URL")}catch{ti(!1)}return ti(Xg(A)),A}let w=new vr(c,l,_,m);return w.urlParams=a,w.headers=d,w.body=h,w.errorHandler=Zc(e),w}function f7(n,e,t,r){let i={"X-Goog-Upload-Command":"query"};function s(l){let d=zC(l,["active","final"]),h=null;try{h=l.getResponseHeader("X-Goog-Upload-Size-Received")}catch{ti(!1)}h||ti(!1);let m=Number(h);return ti(!isNaN(m)),new Jc(m,r.size(),d==="final")}let o="POST",a=n.maxUploadRetryTime,c=new vr(t,o,s,a);return c.headers=i,c.errorHandler=Zc(e),c}var zF=256*1024;function p7(n,e,t,r,i,s,o,a){let c=new Jc(0,0);if(o?(c.current=o.current,c.total=o.total):(c.current=0,c.total=r.size()),r.size()!==c.total)throw AK();let l=c.total-c.current,d=l;i>0&&(d=Math.min(d,i));let h=c.current,m=h+d,_="";d===0?_="finalize":l===d?_="upload, finalize":_="upload";let w={"X-Goog-Upload-Command":_,"X-Goog-Upload-Offset":`${c.current}`},C=r.slice(h,m);if(C===null)throw eV();function A(Q,se){let J=zC(Q,["active","final"]),T=c.current+d,v=r.size(),I;return J==="final"?I=e_(e,s)(Q,se):I=null,new Jc(T,v,J==="final",I)}let L="POST",H=e.maxUploadRetryTime,j=new vr(t,L,A,H);return j.headers=w,j.body=C.uploadData(),j.progressCallback=a||null,j.errorHandler=Zc(n),j}var uV={STATE_CHANGED:"state_changed"},Xt={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function PC(n){switch(n){case"running":case"pausing":case"canceling":return Xt.RUNNING;case"paused":return Xt.PAUSED;case"success":return Xt.SUCCESS;case"canceled":return Xt.CANCELED;case"error":return Xt.ERROR;default:return Xt.ERROR}}var LC=class{constructor(e,t,r){if(kK(e)||t!=null||r!=null)this.next=e,this.error=t??void 0,this.complete=r??void 0;else{let s=e;this.next=s.next,this.error=s.error,this.complete=s.complete}}};function Gc(n){return(...e)=>{Promise.resolve().then(()=>n(...e))}}var WF=null,FC=class{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Qc.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Qc.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Qc.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,r,i){if(this.sent_)throw th("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(t,e,!0),i!==void 0)for(let s in i)i.hasOwnProperty(s)&&this.xhr_.setRequestHeader(s,i[s].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw th("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw th("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw th("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw th("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}},VC=class extends FC{initXhr(){this.xhr_.responseType="text"}};function ei(){return WF?WF():new VC}var ih=class{constructor(e,t,r=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=t,this._metadata=r,this._mappings=Zg(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=i=>{if(this._request=void 0,this._chunkMultiplier=1,i._codeEquals(Je.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{let s=this.isExponentialBackoffExpired();if(rV(i.status,[]))if(s)i=XF();else{this.sleepTime=Math.max(this.sleepTime*2,vK),this._needToFetchStatus=!0,this.completeTransitions_();return}this._error=i,this._transition("error")}},this._metadataErrorHandler=i=>{this._request=void 0,i._codeEquals(Je.CANCELED)?this.completeTransitions_():(this._error=i,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((i,s)=>{this._resolve=i,this._reject=s,this._start()}),this._promise.then(null,()=>{})}isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}_makeProgressCallback(){let e=this._transferred;return t=>this._updateProgress(e+t)}_shouldDoResumable(e){return e.size()>256*1024}_start(){this._state==="running"&&this._request===void 0&&(this._resumable?this._uploadUrl===void 0?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([t,r])=>{switch(this._state){case"running":e(t,r);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused");break}})}_createResumable(){this._resolveToken((e,t)=>{let r=h7(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,ei,e,t);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._uploadUrl=s,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){let e=this._uploadUrl;this._resolveToken((t,r)=>{let i=f7(this._ref.storage,this._ref._location,e,this._blob),s=this._ref.storage._makeRequest(i,ei,t,r);this._request=s,s.getPromise().then(o=>{o=o,this._request=void 0,this._updateProgress(o.current),this._needToFetchStatus=!1,o.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){let e=zF*this._chunkMultiplier,t=new Jc(this._transferred,this._blob.size()),r=this._uploadUrl;this._resolveToken((i,s)=>{let o;try{o=p7(this._ref._location,this._ref.storage,r,this._blob,e,this._mappings,t,this._makeProgressCallback())}catch(c){this._error=c,this._transition("error");return}let a=this._ref.storage._makeRequest(o,ei,i,s,!1);this._request=a,a.getPromise().then(c=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(c.current),c.finalized?(this._metadata=c.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){zF*this._chunkMultiplier*2<32*1024*1024&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,t)=>{let r=cV(this._ref.storage,this._ref._location,this._mappings),i=this._ref.storage._makeRequest(r,ei,e,t);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._metadata=s,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,t)=>{let r=d7(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,ei,e,t);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._metadata=s,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){let t=this._transferred;this._transferred=e,this._transferred!==t&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,this._request!==void 0?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":let t=this._state==="paused";this._state=e,t&&(this._notifyObservers(),this._start());break;case"paused":this._state=e,this._notifyObservers();break;case"canceled":this._error=ZF(),this._state=e,this._notifyObservers();break;case"error":this._state=e,this._notifyObservers();break;case"success":this._state=e,this._notifyObservers();break}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start();break}}get snapshot(){let e=PC(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,t,r,i){let s=new LC(t||void 0,r||void 0,i||void 0);return this._addObserver(s),()=>{this._removeObserver(s)}}then(e,t){return this._promise.then(e,t)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){let t=this._observers.indexOf(e);t!==-1&&this._observers.splice(t,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(t=>{this._notifyObserver(t)})}_finishPromise(){if(this._resolve!==void 0){let e=!0;switch(PC(this._state)){case Xt.SUCCESS:Gc(this._resolve.bind(null,this.snapshot))();break;case Xt.CANCELED:case Xt.ERROR:let t=this._reject;Gc(t.bind(null,this._error))();break;default:e=!1;break}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(PC(this._state)){case Xt.RUNNING:case Xt.PAUSED:e.next&&Gc(e.next.bind(e,this.snapshot))();break;case Xt.SUCCESS:e.complete&&Gc(e.complete.bind(e))();break;case Xt.CANCELED:case Xt.ERROR:e.error&&Gc(e.error.bind(e,this._error))();break;default:e.error&&Gc(e.error.bind(e,this._error))()}}resume(){let e=this._state==="paused"||this._state==="pausing";return e&&this._transition("running"),e}pause(){let e=this._state==="running";return e&&this._transition("pausing"),e}cancel(){let e=this._state==="running"||this._state==="pausing";return e&&this._transition("canceling"),e}};var Xc=class n{constructor(e,t){this._service=e,t instanceof dn?this._location=t:this._location=dn.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new n(e,t)}get root(){let e=new dn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return oV(this._location.path)}get storage(){return this._service}get parent(){let e=QK(this._location.path);if(e===null)return null;let t=new dn(this._location.bucket,e);return new n(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw jC(e)}};function m7(n,e,t){return n._throwIfRoot("uploadBytesResumable"),new ih(n,new Yc(e),t)}function g7(n){let e={prefixes:[],items:[]};return dV(n,e).then(()=>e)}function dV(n,e,t){return g(this,null,function*(){let i=yield hV(n,{pageToken:t});e.prefixes.push(...i.prefixes),e.items.push(...i.items),i.nextPageToken!=null&&(yield dV(n,e,i.nextPageToken))})}function hV(n,e){e!=null&&typeof e.maxResults=="number"&&kC("options.maxResults",1,1e3,e.maxResults);let t=e||{},r=o7(n.storage,n._location,"/",t.pageToken,t.maxResults);return n.storage.makeRequestWithTokens(r,ei)}function _7(n){n._throwIfRoot("getMetadata");let e=cV(n.storage,n._location,Zg());return n.storage.makeRequestWithTokens(e,ei)}function y7(n,e){n._throwIfRoot("updateMetadata");let t=c7(n.storage,n._location,e,Zg());return n.storage.makeRequestWithTokens(t,ei)}function v7(n){n._throwIfRoot("getDownloadURL");let e=a7(n.storage,n._location,Zg());return n.storage.makeRequestWithTokens(e,ei).then(t=>{if(t===null)throw RK();return t})}function w7(n){n._throwIfRoot("deleteObject");let e=l7(n.storage,n._location);return n.storage.makeRequestWithTokens(e,ei)}function fV(n,e){let t=YK(n._location.path,e),r=new dn(n._location.bucket,t);return new Xc(n.storage,r)}function I7(n){return/^[A-Za-z]+:\/\//.test(n)}function E7(n,e){return new Xc(n,e)}function pV(n,e){if(n instanceof sh){let t=n;if(t._bucket==null)throw SK();let r=new Xc(t,t._bucket);return e!=null?pV(r,e):r}else return e!==void 0?fV(n,e):n}function T7(n,e){if(e&&I7(e)){if(n instanceof sh)return E7(n,e);throw Go("To use ref(service, url), the first argument must be a Storage instance.")}else return pV(n,e)}function GF(n,e){let t=e?.[JF];return t==null?null:dn.makeFromBucketSpec(t,n)}function b7(n,e,t,r={}){n.host=`${e}:${t}`,n._protocol="http";let{mockUserToken:i}=r;i&&(n._overrideAuthToken=typeof i=="string"?i:qa(i,n.app.options.projectId))}var sh=class{constructor(e,t,r,i,s){this.app=e,this._authProvider=t,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._bucket=null,this._host=YF,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=_K,this._maxUploadRetryTime=yK,this._requests=new Set,i!=null?this._bucket=dn.makeFromBucketSpec(i,this._host):this._bucket=GF(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=dn.makeFromBucketSpec(this._url,e):this._bucket=GF(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){kC("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){kC("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}_getAuthToken(){return g(this,null,function*(){if(this._overrideAuthToken)return this._overrideAuthToken;let e=this._authProvider.getImmediate({optional:!0});if(e){let t=yield e.getToken();if(t!==null)return t.accessToken}return null})}_getAppCheckToken(){return g(this,null,function*(){let e=this._appCheckProvider.getImmediate({optional:!0});return e?(yield e.getToken()).token:null})}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Xc(this,e)}_makeRequest(e,t,r,i,s=!0){if(this._deleted)return new MC(tV());{let o=jK(e,this._appId,r,i,t,this._firebaseVersion,s);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}makeRequestWithTokens(e,t){return g(this,null,function*(){let[r,i]=yield Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,r,i).getPromise()})}},KF="@firebase/storage",QF="0.13.1";var C7="storage";function mV(n,e,t){return n=q(n),m7(n,e,t)}function gV(n){return n=q(n),_7(n)}function _V(n,e){return n=q(n),y7(n,e)}function yV(n,e){return n=q(n),hV(n,e)}function vV(n){return n=q(n),g7(n)}function wV(n){return n=q(n),v7(n)}function IV(n){return n=q(n),w7(n)}function WC(n,e){return n=q(n),T7(n,e)}function EV(n,e){return fV(n,e)}function TV(n,e,t,r={}){b7(n,e,t,r)}function D7(n,{instanceIdentifier:e}){let t=n.getProvider("app").getImmediate(),r=n.getProvider("auth-internal"),i=n.getProvider("app-check-internal");return new sh(t,r,i,e,an)}function S7(){on(new Le(C7,D7,"PUBLIC").setMultipleInstances(!0)),ut(KF,QF,""),ut(KF,QF,"esm2017")}S7();var el=class{constructor(e,t,r){this._delegate=e,this.task=t,this.ref=r}get bytesTransferred(){return this._delegate.bytesTransferred}get metadata(){return this._delegate.metadata}get state(){return this._delegate.state}get totalBytes(){return this._delegate.totalBytes}};var n_=class{constructor(e,t){this._delegate=e,this._ref=t,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}get snapshot(){return new el(this._delegate.snapshot,this,this._ref)}then(e,t){return this._delegate.then(r=>{if(e)return e(new el(r,this,this._ref))},t)}on(e,t,r,i){let s;return t&&(typeof t=="function"?s=o=>t(new el(o,this,this._ref)):s={next:t.next?o=>t.next(new el(o,this,this._ref)):void 0,complete:t.complete||void 0,error:t.error||void 0}),this._delegate.on(e,s,r||void 0,i||void 0)}},r_=class{constructor(e,t){this._delegate=e,this._service=t}get prefixes(){return this._delegate.prefixes.map(e=>new Ko(e,this._service))}get items(){return this._delegate.items.map(e=>new Ko(e,this._service))}get nextPageToken(){return this._delegate.nextPageToken||null}};var Ko=class n{constructor(e,t){this._delegate=e,this.storage=t}get name(){return this._delegate.name}get bucket(){return this._delegate.bucket}get fullPath(){return this._delegate.fullPath}toString(){return this._delegate.toString()}child(e){let t=EV(this._delegate,e);return new n(t,this.storage)}get root(){return new n(this._delegate.root,this.storage)}get parent(){let e=this._delegate.parent;return e==null?null:new n(e,this.storage)}put(e,t){return this._throwIfRoot("put"),new n_(mV(this._delegate,e,t),this)}putString(e,t=Pn.RAW,r){this._throwIfRoot("putString");let i=$C(t,e),s=Object.assign({},r);return s.contentType==null&&i.contentType!=null&&(s.contentType=i.contentType),new n_(new ih(this._delegate,new Yc(i.data,!0),s),this)}listAll(){return vV(this._delegate).then(e=>new r_(e,this.storage))}list(e){return yV(this._delegate,e||void 0).then(t=>new r_(t,this.storage))}getMetadata(){return gV(this._delegate)}updateMetadata(e){return _V(this._delegate,e)}getDownloadURL(){return wV(this._delegate)}delete(){return this._throwIfRoot("delete"),IV(this._delegate)}_throwIfRoot(e){if(this._delegate._location.path==="")throw jC(e)}};var i_=class{constructor(e,t){this.app=e,this._delegate=t}get maxOperationRetryTime(){return this._delegate.maxOperationRetryTime}get maxUploadRetryTime(){return this._delegate.maxUploadRetryTime}ref(e){if(bV(e))throw Go("ref() expected a child path but got a URL, use refFromURL instead.");return new Ko(WC(this._delegate,e),this)}refFromURL(e){if(!bV(e))throw Go("refFromURL() expected a full URL but got a child path, use ref() instead.");try{dn.makeFromUrl(e,this._delegate.host)}catch{throw Go("refFromUrl() expected a valid full URL but got an invalid one.")}return new Ko(WC(this._delegate,e),this)}setMaxUploadRetryTime(e){this._delegate.maxUploadRetryTime=e}setMaxOperationRetryTime(e){this._delegate.maxOperationRetryTime=e}useEmulator(e,t,r={}){TV(this._delegate,e,t,r)}};function bV(n){return/^[A-Za-z]+:\/\//.test(n)}var A7="@firebase/storage-compat",R7="0.3.11";var x7="storage-compat";function N7(n,{instanceIdentifier:e}){let t=n.getProvider("app-compat").getImmediate(),r=n.getProvider("storage").getImmediate({identifier:e});return new i_(t,r)}function P7(n){let e={TaskState:Xt,TaskEvent:uV,StringFormat:Pn,Storage:i_,Reference:Ko};n.INTERNAL.registerComponent(new Le(x7,N7,"PUBLIC").setServiceProps(e).setMultipleInstances(!0)),n.registerVersion(A7,R7)}P7(Fe);var CV="@firebase/database",DV="1.0.7";var iS="";function sS(n){iS=n}var eD=class{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){t==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),gt(t))}get(e){let t=this.domStorage_.getItem(this.prefixedName_(e));return t==null?null:$a(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}};var tD=class{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){t==null?delete this.cache_[e]:this.cache_[e]=t}get(e){return sn(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}};var r2=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){let e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new eD(e)}}catch{}return new tD},Yo=r2("localStorage"),nD=r2("sessionStorage");var il=new vn("@firebase/database"),i2=function(){let n=1;return function(){return n++}}(),s2=function(n){let e=LM(n),t=new qp;t.update(e);let r=t.digest();return zp.encodeByteArray(r)},Rh=function(...n){let e="";for(let t=0;t<n.length;t++){let r=n[t];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=Rh.apply(null,r):typeof r=="object"?e+=gt(r):e+=r,e+=" "}return e},Jo=null,SV=!0,o2=function(n,e){B(!e||n===!0||n===!1,"Can't turn on custom loggers persistently."),n===!0?(il.logLevel=me.VERBOSE,Jo=il.log.bind(il),e&&nD.set("logging_enabled",!0)):typeof n=="function"?Jo=n:(Jo=null,nD.remove("logging_enabled"))},kt=function(...n){if(SV===!0&&(SV=!1,Jo===null&&nD.get("logging_enabled")===!0&&o2(!0)),Jo){let e=Rh.apply(null,n);Jo(e)}},xh=function(n){return function(...e){kt(n,...e)}},rD=function(...n){let e="FIREBASE INTERNAL ERROR: "+Rh(...n);il.error(e)},ii=function(...n){let e=`FIREBASE FATAL ERROR: ${Rh(...n)}`;throw il.error(e),new Error(e)},Zt=function(...n){let e="FIREBASE WARNING: "+Rh(...n);il.warn(e)},M7=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Zt("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},P_=function(n){return typeof n=="number"&&(n!==n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},k7=function(n){if(Lr()||document.readyState==="complete")n();else{let e=!1,t=function(){if(!document.body){setTimeout(t,Math.floor(10));return}e||(e=!0,n())};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&t()}),window.attachEvent("onload",t))}},Ps="[MIN_NAME]",Mi="[MAX_NAME]",Zo=function(n,e){if(n===e)return 0;if(n===Ps||e===Mi)return-1;if(e===Ps||n===Mi)return 1;{let t=AV(n),r=AV(e);return t!==null?r!==null?t-r===0?n.length-e.length:t-r:-1:r!==null?1:n<e?-1:1}},O7=function(n,e){return n===e?0:n<e?-1:1},oh=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+gt(e))},oS=function(n){if(typeof n!="object"||n===null)return gt(n);let e=[];for(let r in n)e.push(r);e.sort();let t="{";for(let r=0;r<e.length;r++)r!==0&&(t+=","),t+=gt(e[r]),t+=":",t+=oS(n[e[r]]);return t+="}",t},a2=function(n,e){let t=n.length;if(t<=e)return[n];let r=[];for(let i=0;i<t;i+=e)i+e>t?r.push(n.substring(i,t)):r.push(n.substring(i,i+e));return r};function Ot(n,e){for(let t in n)n.hasOwnProperty(t)&&e(t,n[t])}var c2=function(n){B(!P_(n),"Invalid JSON number");let e=11,t=52,r=(1<<e-1)-1,i,s,o,a,c;n===0?(s=0,o=0,i=1/n===-1/0?1:0):(i=n<0,n=Math.abs(n),n>=Math.pow(2,1-r)?(a=Math.min(Math.floor(Math.log(n)/Math.LN2),r),s=a+r,o=Math.round(n*Math.pow(2,t-a)-Math.pow(2,t))):(s=0,o=Math.round(n/Math.pow(2,1-r-t))));let l=[];for(c=t;c;c-=1)l.push(o%2?1:0),o=Math.floor(o/2);for(c=e;c;c-=1)l.push(s%2?1:0),s=Math.floor(s/2);l.push(i?1:0),l.reverse();let d=l.join(""),h="";for(c=0;c<64;c+=8){let m=parseInt(d.substr(c,8),2).toString(16);m.length===1&&(m="0"+m),h=h+m}return h.toLowerCase()},L7=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},F7=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function V7(n,e){let t="Unknown Error";n==="too_big"?t="The data requested exceeds the maximum size that can be accessed with a single request.":n==="permission_denied"?t="Client doesn't have permission to access the desired data.":n==="unavailable"&&(t="The service is unavailable");let r=new Error(n+" at "+e._path.toString()+": "+t);return r.code=n.toUpperCase(),r}var U7=new RegExp("^-?(0*)\\d{1,10}$"),j7=-2147483648,B7=2147483647,AV=function(n){if(U7.test(n)){let e=Number(n);if(e>=j7&&e<=B7)return e}return null},fl=function(n){try{n()}catch(e){setTimeout(()=>{let t=e.stack||"";throw Zt("Exception was thrown by user callback.",t),e},Math.floor(0))}},$7=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},uh=function(n,e){let t=setTimeout(n,e);return typeof t=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):typeof t=="object"&&t.unref&&t.unref(),t};var iD=class{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=t?.getImmediate({optional:!0}),this.appCheck||t?.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((t,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){var t;(t=this.appCheckProvider)===null||t===void 0||t.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){Zt(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}};var sD=class{constructor(e,t,r){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&t.code==="auth/token-not-initialized"?(kt("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Zt(e)}},dh=(()=>{class n{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}n.OWNER="owner";return n})(),o_="5",l2="v",u2="s",d2="r",h2="f",f2=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,p2="ls",m2="p",oD="ac",g2="websocket",_2="long_polling";var a_=class{constructor(e,t,r,i,s=!1,o="",a=!1,c=!1){this.secure=t,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=c,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Yo.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Yo.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){let e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}};function H7(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams}function y2(n,e,t){B(typeof e=="string","typeof type must == string"),B(typeof t=="object","typeof params must == object");let r;if(e===g2)r=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else if(e===_2)r=(n.secure?"https://":"http://")+n.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);H7(n)&&(t.ns=n.namespace);let i=[];return Ot(t,(s,o)=>{i.push(s+"="+o)}),r+i.join("&")}var aD=class{constructor(){this.counters_={}}incrementCounter(e,t=1){sn(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return RM(this.counters_)}};var GC={},KC={};function aS(n){let e=n.toString();return GC[e]||(GC[e]=new aD),GC[e]}function q7(n,e){let t=n.toString();return KC[t]||(KC[t]=e()),KC[t]}var cD=class{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){let r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&fl(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}};var RV="start",z7="close",W7="pLPCommand",G7="pRTLPCB",v2="id",w2="pw",I2="ser",K7="cb",Q7="seg",Y7="ts",J7="d",X7="dframe",E2=1870,T2=30,Z7=E2-T2,eQ=25e3,tQ=3e4,mh=class n{constructor(e,t,r,i,s,o,a){this.connId=e,this.repoInfo=t,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=xh(e),this.stats_=aS(t),this.urlFn=c=>(this.appCheckToken&&(c[oD]=this.appCheckToken),y2(t,_2,c))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new cD(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(tQ)),k7(()=>{if(this.isClosed_)return;this.scriptTagHolder=new lD((...s)=>{let[o,a,c,l,d]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===RV)this.id=a,this.password=c;else if(o===z7)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...s)=>{let[o,a]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);let r={};r[RV]="t",r[I2]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[K7]=this.scriptTagHolder.uniqueCallbackIdentifier),r[l2]=o_,this.transportSessionId&&(r[u2]=this.transportSessionId),this.lastSessionId&&(r[p2]=this.lastSessionId),this.applicationId&&(r[m2]=this.applicationId),this.appCheckToken&&(r[oD]=this.appCheckToken),typeof location<"u"&&location.hostname&&f2.test(location.hostname)&&(r[d2]=h2);let i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){n.forceAllow_=!0}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){return Lr()?!1:n.forceAllow_?!0:!n.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!L7()&&!F7()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){let t=gt(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);let r=TI(t),i=a2(r,Z7);for(let s=0;s<i.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[s]),this.curSegmentNum++}addDisconnectPingFrame(e,t){if(Lr())return;this.myDisconnFrame=document.createElement("iframe");let r={};r[X7]="t",r[v2]=e,r[w2]=t,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){let t=gt(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}},lD=class n{constructor(e,t,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0,Lr())this.commandCB=e,this.onMessageCB=t;else{this.uniqueCallbackIdentifier=i2(),window[W7+this.uniqueCallbackIdentifier]=e,window[G7+this.uniqueCallbackIdentifier]=t,this.myIFrame=n.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');let o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){kt("frame writing exception"),a.stack&&kt(a.stack),kt(a)}}}static createIFrame_(){let e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||kt("No IE domain setting required")}catch{let r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));let e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;let e={};e[v2]=this.myID,e[w2]=this.myPW,e[I2]=this.currentSerial;let t=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+T2+r.length<=E2;){let o=this.pendingSegs.shift();r=r+"&"+Q7+i+"="+o.seg+"&"+Y7+i+"="+o.ts+"&"+J7+i+"="+o.d,i++}return t=t+r,this.addLongPollTag_(t,this.currentSerial),!0}else return!1}enqueueSegment(e,t,r){this.pendingSegs.push({seg:e,ts:t,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);let r=()=>{this.outstandingRequests.delete(t),this.newRequest_()},i=setTimeout(r,Math.floor(eQ)),s=()=>{clearTimeout(i),r()};this.addTag(e,s)}addTag(e,t){Lr()?this.doNodeLongPoll(e,t):setTimeout(()=>{try{if(!this.sendNewPolls)return;let r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){let i=r.readyState;(!i||i==="loaded"||i==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=()=>{kt("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}};var nQ=16384,rQ=45e3,c_=null;typeof MozWebSocket<"u"?c_=MozWebSocket:typeof WebSocket<"u"&&(c_=WebSocket);var nl=(()=>{class n{constructor(t,r,i,s,o,a,c){this.connId=t,this.applicationId=i,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=xh(this.connId),this.stats_=aS(r),this.connURL=n.connectionURL_(r,a,c,s,i),this.nodeAdmin=r.nodeAdmin}static connectionURL_(t,r,i,s,o){let a={};return a[l2]=o_,!Lr()&&typeof location<"u"&&location.hostname&&f2.test(location.hostname)&&(a[d2]=h2),r&&(a[u2]=r),i&&(a[p2]=i),s&&(a[oD]=s),o&&(a[m2]=o),y2(t,g2,a)}open(t,r){this.onDisconnect=r,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Yo.set("previous_websocket_failure",!0);try{let i;if(Lr()){let s=this.nodeAdmin?"AdminNode":"Node";i={headers:{"User-Agent":`Firebase/${o_}/${iS}/${process.platform}/${s}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(i.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(i.headers["X-Firebase-AppCheck"]=this.appCheckToken);let o=process.env,a=this.connURL.indexOf("wss://")===0?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;a&&(i.proxy={origin:a})}this.mySock=new c_(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){let t=!1;if(typeof navigator<"u"&&navigator.userAgent){let r=/Android ([0-9]{0,}\.[0-9]{0,})/,i=navigator.userAgent.match(r);i&&i.length>1&&parseFloat(i[1])<4.4&&(t=!0)}return!t&&c_!==null&&!n.forceDisallow_}static previouslyFailed(){return Yo.isInMemoryStorage||Yo.get("previous_websocket_failure")===!0}markConnectionHealthy(){Yo.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){let r=this.frames.join("");this.frames=null;let i=$a(r);this.onMessage(i)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if(B(this.frames===null,"We already have a frame buffer"),t.length<=6){let r=Number(t);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(this.mySock===null)return;let r=t.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(r);else{let i=this.extractFrameCount_(r);i!==null&&this.appendFrame_(i)}}send(t){this.resetKeepAlive();let r=gt(t);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);let i=a2(r,nQ);i.length>1&&this.sendString_(String(i.length));for(let s=0;s<i.length;s++)this.sendString_(i[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(rQ))}sendString_(t){try{this.mySock.send(t)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}n.responsesRequiredToBeHealthy=2,n.healthyTimeout=3e4;return n})(),b2=(()=>{class n{constructor(t){this.initTransports_(t)}static get ALL_TRANSPORTS(){return[mh,nl]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(t){let r=nl&&nl.isAvailable(),i=r&&!nl.previouslyFailed();if(t.webSocketOnly&&(r||Zt("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[nl];else{let s=this.transports_=[];for(let o of n.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);n.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}n.globalTransportInitialized_=!1;return n})(),iQ=6e4,sQ=5e3,oQ=10*1024,aQ=100*1024,QC="t",xV="d",cQ="s",NV="r",lQ="e",PV="o",MV="a",kV="n",OV="p",uQ="h",uD=class{constructor(e,t,r,i,s,o,a,c,l,d){this.id=e,this.repoInfo_=t,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=s,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=c,this.onKill_=l,this.lastSessionId=d,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=xh("c:"+this.id+":"),this.transportManager_=new b2(t),this.log_("Connection created"),this.start_()}start_(){let e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let t=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,r)},Math.floor(0));let i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=uh(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>aQ?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>oQ?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){let t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(QC in e){let t=e[QC];t===MV?this.upgradeIfSecondaryHealthy_():t===NV?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):t===PV&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){let t=oh("t",e),r=oh("d",e);if(t==="c")this.onSecondaryControl_(r);else if(t==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+t)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:OV,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:MV,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:kV,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){let t=oh("t",e),r=oh("d",e);t==="c"?this.onControl_(r):t==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){let t=oh(QC,e);if(xV in e){let r=e[xV];if(t===uQ){let i=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(t===kV){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===cQ?this.onConnectionShutdown_(r):t===NV?this.onReset_(r):t===lQ?rD("Server Error: "+r):t===PV?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):rD("Unknown control packet command: "+t)}}onHandshake_(e){let t=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),o_!==r&&Zt("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){let e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let t=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,r),uh(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(iQ))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):uh(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(sQ))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:OV,d:{}}}))}onSecondaryConnectionLost_(){let e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Yo.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}};var l_=class{put(e,t,r,i){}merge(e,t,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,r){}onDisconnectMerge(e,t,r){}onDisconnectCancel(e,t){}reportStats(e){}};var u_=class{constructor(e){this.allowedEvents_=e,this.listeners_={},B(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){let r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,t)}}on(e,t,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:r});let i=this.getInitialEvent(e);i&&t.apply(r,i)}off(e,t,r){this.validateEventType_(e);let i=this.listeners_[e]||[];for(let s=0;s<i.length;s++)if(i[s].callback===t&&(!r||r===i[s].context)){i.splice(s,1);return}}validateEventType_(e){B(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}};var d_=class n extends u_{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!Vu()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new n}getInitialEvent(e){return B(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}};var LV=32,FV=768,xe=class{constructor(e,t){if(t===void 0){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)this.pieces_[t]!==""&&(e+="/"+this.pieces_[t]);return e||"/"}};function Re(){return new xe("")}function ge(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function Ms(n){return n.pieces_.length-n.pieceNum_}function Be(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new xe(n.pieces_,e)}function cS(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function dQ(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)n.pieces_[t]!==""&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}function gh(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function C2(n){if(n.pieceNum_>=n.pieces_.length)return null;let e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new xe(e,0)}function Xe(n,e){let t=[];for(let r=n.pieceNum_;r<n.pieces_.length;r++)t.push(n.pieces_[r]);if(e instanceof xe)for(let r=e.pieceNum_;r<e.pieces_.length;r++)t.push(e.pieces_[r]);else{let r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&t.push(r[i])}return new xe(t,0)}function _e(n){return n.pieceNum_>=n.pieces_.length}function hn(n,e){let t=ge(n),r=ge(e);if(t===null)return e;if(t===r)return hn(Be(n),Be(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function hQ(n,e){let t=gh(n,0),r=gh(e,0);for(let i=0;i<t.length&&i<r.length;i++){let s=Zo(t[i],r[i]);if(s!==0)return s}return t.length===r.length?0:t.length<r.length?-1:1}function lS(n,e){if(Ms(n)!==Ms(e))return!1;for(let t=n.pieceNum_,r=e.pieceNum_;t<=n.pieces_.length;t++,r++)if(n.pieces_[t]!==e.pieces_[r])return!1;return!0}function Jn(n,e){let t=n.pieceNum_,r=e.pieceNum_;if(Ms(n)>Ms(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[r])return!1;++t,++r}return!0}var dD=class{constructor(e,t){this.errorPrefix_=t,this.parts_=gh(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=ju(this.parts_[r]);D2(this)}};function fQ(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=ju(e),D2(n)}function pQ(n){let e=n.parts_.pop();n.byteLength_-=ju(e),n.parts_.length>0&&(n.byteLength_-=1)}function D2(n){if(n.byteLength_>FV)throw new Error(n.errorPrefix_+"has a key path longer than "+FV+" bytes ("+n.byteLength_+").");if(n.parts_.length>LV)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+LV+") or object contains a cycle "+Qo(n))}function Qo(n){return n.parts_.length===0?"":"in property '"+n.parts_.join(".")+"'"}var hD=class n extends u_{constructor(){super(["visible"]);let e,t;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{let r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new n}getInitialEvent(e){return B(e==="visible","Unknown event type: "+e),[this.visible_]}};var ah=1e3,mQ=60*5*1e3,VV=30*1e3,gQ=1.3,_Q=3e4,yQ="server_kill",UV=3,uS=(()=>{class n extends l_{constructor(t,r,i,s,o,a,c,l){if(super(),this.repoInfo_=t,this.applicationId_=r,this.onDataUpdate_=i,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=a,this.appCheckTokenProvider_=c,this.authOverride_=l,this.id=n.nextPersistentConnectionId_++,this.log_=xh("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=ah,this.maxReconnectDelay_=mQ,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,l&&!Lr())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");hD.getInstance().on("visible",this.onVisible_,this),t.host.indexOf("fblocal")===-1&&d_.getInstance().on("online",this.onOnline_,this)}sendRequest(t,r,i){let s=++this.requestNumber_,o={r:s,a:t,b:r};this.log_(gt(o)),B(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),i&&(this.requestCBHash_[s]=i)}get(t){this.initConnection_();let r=new Dt,s={action:"g",request:{p:t._path.toString(),q:t._queryObject},onComplete:a=>{let c=a.d;a.s==="ok"?r.resolve(c):r.reject(c)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;let o=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(o),r.promise}listen(t,r,i,s){this.initConnection_();let o=t._queryIdentifier,a=t._path.toString();this.log_("Listen called for "+a+" "+o),this.listens.has(a)||this.listens.set(a,new Map),B(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),B(!this.listens.get(a).has(o),"listen() called twice for same path/queryId.");let c={onComplete:s,hashFn:r,query:t,tag:i};this.listens.get(a).set(o,c),this.connected_&&this.sendListen_(c)}sendGet_(t){let r=this.outstandingGets_[t];this.sendRequest("g",r.request,i=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(i)})}sendListen_(t){let r=t.query,i=r._path.toString(),s=r._queryIdentifier;this.log_("Listen on "+i+" for "+s);let o={p:i},a="q";t.tag&&(o.q=r._queryObject,o.t=t.tag),o.h=t.hashFn(),this.sendRequest(a,o,c=>{let l=c.d,d=c.s;n.warnOnListenWarnings_(l,r),(this.listens.get(i)&&this.listens.get(i).get(s))===t&&(this.log_("listen response",c),d!=="ok"&&this.removeListen_(i,s),t.onComplete&&t.onComplete(d,l))})}static warnOnListenWarnings_(t,r){if(t&&typeof t=="object"&&sn(t,"w")){let i=Xi(t,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){let s='".indexOn": "'+r._queryParams.getIndex().toString()+'"',o=r._path.toString();Zt(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&t.length===40||OM(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=VV)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){let t=this.authToken_,r=kM(t)?"auth":"gauth",i={cred:t};this.authOverride_===null?i.noauth=!0:typeof this.authOverride_=="object"&&(i.authvar=this.authOverride_),this.sendRequest(r,i,s=>{let o=s.s,a=s.d||"error";this.authToken_===t&&(o==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},t=>{let r=t.s,i=t.d||"error";r==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,i)})}unlisten(t,r){let i=t._path.toString(),s=t._queryIdentifier;this.log_("Unlisten called for "+i+" "+s),B(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,s)&&this.connected_&&this.sendUnlisten_(i,s,t._queryObject,r)}sendUnlisten_(t,r,i,s){this.log_("Unlisten on "+t+" for "+r);let o={p:t},a="n";s&&(o.q=i,o.t=s),this.sendRequest(a,o)}onDisconnectPut(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:r,onComplete:i})}onDisconnectMerge(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:r,onComplete:i})}onDisconnectCancel(t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(t,r,i,s){let o={p:r,d:i};this.log_("onDisconnect "+t,o),this.sendRequest(t,o,a=>{s&&setTimeout(()=>{s(a.s,a.d)},Math.floor(0))})}put(t,r,i,s){this.putInternal("p",t,r,i,s)}merge(t,r,i,s){this.putInternal("m",t,r,i,s)}putInternal(t,r,i,s,o){this.initConnection_();let a={p:r,d:i};o!==void 0&&(a.h=o),this.outstandingPuts_.push({action:t,request:a,onComplete:s}),this.outstandingPutCount_++;let c=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(c):this.log_("Buffering put: "+r)}sendPut_(t){let r=this.outstandingPuts_[t].action,i=this.outstandingPuts_[t].request,s=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(r,i,o=>{this.log_(r+" response",o),delete this.outstandingPuts_[t],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(t){if(this.connected_){let r={c:t};this.log_("reportStats",r),this.sendRequest("s",r,i=>{if(i.s!=="ok"){let o=i.d;this.log_("reportStats","Error sending stats: "+o)}})}}onDataMessage_(t){if("r"in t){this.log_("from server: "+gt(t));let r=t.r,i=this.requestCBHash_[r];i&&(delete this.requestCBHash_[r],i(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,r){this.log_("handleServerMessage",t,r),t==="d"?this.onDataUpdate_(r.p,r.d,!1,r.t):t==="m"?this.onDataUpdate_(r.p,r.d,!0,r.t):t==="c"?this.onListenRevoked_(r.p,r.q):t==="ac"?this.onAuthRevoked_(r.s,r.d):t==="apc"?this.onAppCheckRevoked_(r.s,r.d):t==="sd"?this.onSecurityDebugPacket_(r):rD("Unrecognized action received from server: "+gt(t)+`
Are you using the latest client?`)}onReady_(t,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(t),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){B(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=ah,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=ah,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>_Q&&(this.reconnectDelay_=ah),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());let t=new Date().getTime()-this.lastConnectionAttemptTime_,r=Math.max(0,this.reconnectDelay_-t);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*gQ)}this.onConnectStatus_(!1)}establishConnection_(){return g(this,null,function*(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;let t=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+n.nextConnectionId_++,o=this.lastSessionId,a=!1,c=null,l=function(){c?c.close():(a=!0,i())},d=function(m){B(c,"sendRequest call when we're not connected not allowed."),c.sendRequest(m)};this.realtime_={close:l,sendRequest:d};let h=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{let[m,_]=yield Promise.all([this.authTokenProvider_.getToken(h),this.appCheckTokenProvider_.getToken(h)]);a?kt("getToken() completed but was canceled"):(kt("getToken() completed. Creating connection."),this.authToken_=m&&m.accessToken,this.appCheckToken_=_&&_.token,c=new uD(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,t,r,i,w=>{Zt(w+" ("+this.repoInfo_.toString()+")"),this.interrupt(yQ)},o))}catch(m){this.log_("Failed to get token: "+m),a||(this.repoInfo_.nodeAdmin&&Zt(m),l())}}})}interrupt(t){kt("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){kt("Resuming connection for reason: "+t),delete this.interruptReasons_[t],za(this.interruptReasons_)&&(this.reconnectDelay_=ah,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){let r=t-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){let r=this.outstandingPuts_[t];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(t,r){let i;r?i=r.map(o=>oS(o)).join("$"):i="default";let s=this.removeListen_(t,i);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(t,r){let i=new xe(t).toString(),s;if(this.listens.has(i)){let o=this.listens.get(i);s=o.get(r),o.delete(r),o.size===0&&this.listens.delete(i)}else s=void 0;return s}onAuthRevoked_(t,r){kt("Auth token revoked: "+t+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(t==="invalid_token"||t==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=UV&&(this.reconnectDelay_=VV,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,r){kt("App check token revoked: "+t+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(t==="invalid_token"||t==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=UV&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(let t of this.listens.values())for(let r of t.values())this.sendListen_(r);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){let t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){let t={},r="js";Lr()&&(this.repoInfo_.nodeAdmin?r="admin_node":r="node"),t["sdk."+r+"."+iS.replace(/\./g,"-")]=1,Vu()?t["framework.cordova"]=1:so()&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){let t=d_.getInstance().currentlyOnline();return za(this.interruptReasons_)&&t}}n.nextPersistentConnectionId_=0,n.nextConnectionId_=0;return n})(),ve=class n{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new n(e,t)}};var sl=class{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){let r=new ve(Ps,e),i=new ve(Ps,t);return this.compare(r,i)!==0}minPost(){return ve.MIN}};var s_,h_=class extends sl{static get __EMPTY_NODE(){return s_}static set __EMPTY_NODE(e){s_=e}compare(e,t){return Zo(e.name,t.name)}isDefinedOn(e){throw io("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return ve.MIN}maxPost(){return new ve(Mi,s_)}makePost(e,t){return B(typeof e=="string","KeyIndex indexValue must always be a string."),new ve(e,s_)}toString(){return".key"}},ri=new h_;var rl=class{constructor(e,t,r,i,s=null){this.isReverse_=i,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=t?r(e.key,t):1,i&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),t;if(this.resultGenerator_?t=this.resultGenerator_(e.key,e.value):t={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}},wr=(()=>{class n{constructor(t,r,i,s,o){this.key=t,this.value=r,this.color=i??n.RED,this.left=s??Xn.EMPTY_NODE,this.right=o??Xn.EMPTY_NODE}copy(t,r,i,s,o){return new n(t??this.key,r??this.value,i??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,r,i){let s=this,o=i(t,s.key);return o<0?s=s.copy(null,null,null,s.left.insert(t,r,i),null):o===0?s=s.copy(null,r,null,null,null):s=s.copy(null,null,null,null,s.right.insert(t,r,i)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return Xn.EMPTY_NODE;let t=this;return!t.left.isRed_()&&!t.left.left.isRed_()&&(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,r){let i,s;if(i=this,r(t,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(t,r),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),r(t,i.key)===0){if(i.right.isEmpty())return Xn.EMPTY_NODE;s=i.right.min_(),i=i.copy(s.key,s.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(t,r))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){let t=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight_(){let t=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip_(){let t=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,r)}checkMaxDepth_(){let t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");let t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}return n.RED=!0,n.BLACK=!1,n})(),fD=class{copy(e,t,r,i,s){return this}insert(e,t,r){return new wr(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}},Xn=class n{constructor(e,t=n.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new n(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,wr.BLACK,null,null))}remove(e){return new n(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,wr.BLACK,null,null))}get(e){let t,r=this.root_;for(;!r.isEmpty();){if(t=this.comparator_(e,r.key),t===0)return r.value;t<0?r=r.left:t>0&&(r=r.right)}return null}getPredecessorKey(e){let t,r=this.root_,i=null;for(;!r.isEmpty();)if(t=this.comparator_(e,r.key),t===0){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else t<0?r=r.left:t>0&&(i=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new rl(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new rl(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new rl(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new rl(this.root_,null,this.comparator_,!0,e)}};Xn.EMPTY_NODE=new fD;function vQ(n,e){return Zo(n.name,e.name)}function dS(n,e){return Zo(n,e)}var pD;function wQ(n){pD=n}var S2=function(n){return typeof n=="number"?"number:"+c2(n):"string:"+n},A2=function(n){if(n.isLeafNode()){let e=n.val();B(typeof e=="string"||typeof e=="number"||typeof e=="object"&&sn(e,".sv"),"Priority must be a string or number.")}else B(n===pD||n.isEmpty(),"priority of unexpected type.");B(n===pD||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};var jV,ol=(()=>{class n{constructor(t,r=n.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=r,this.lazyHash_=null,B(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),A2(this.priorityNode_)}static set __childrenNodeConstructor(t){jV=t}static get __childrenNodeConstructor(){return jV}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(t){return new n(this.value_,t)}getImmediateChild(t){return t===".priority"?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}getChild(t){return _e(t)?this:ge(t)===".priority"?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,r){return null}updateImmediateChild(t,r){return t===".priority"?this.updatePriority(r):r.isEmpty()&&t!==".priority"?this:n.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,r).updatePriority(this.priorityNode_)}updateChild(t,r){let i=ge(t);return i===null?r:r.isEmpty()&&i!==".priority"?this:(B(i!==".priority"||Ms(t)===1,".priority must be the last token in a path"),this.updateImmediateChild(i,n.__childrenNodeConstructor.EMPTY_NODE.updateChild(Be(t),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,r){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+S2(this.priorityNode_.val())+":");let r=typeof this.value_;t+=r+":",r==="number"?t+=c2(this.value_):t+=this.value_,this.lazyHash_=s2(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===n.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof n.__childrenNodeConstructor?-1:(B(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){let r=typeof t.value_,i=typeof this.value_,s=n.VALUE_TYPE_ORDER.indexOf(r),o=n.VALUE_TYPE_ORDER.indexOf(i);return B(s>=0,"Unknown leaf type: "+r),B(o>=0,"Unknown leaf type: "+i),s===o?i==="object"?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(t){if(t===this)return!0;if(t.isLeafNode()){let r=t;return this.value_===r.value_&&this.priorityNode_.equals(r.priorityNode_)}else return!1}}n.VALUE_TYPE_ORDER=["object","boolean","number","string"];return n})(),R2,x2;function IQ(n){R2=n}function EQ(n){x2=n}var mD=class extends sl{compare(e,t){let r=e.node.getPriority(),i=t.node.getPriority(),s=r.compareTo(i);return s===0?Zo(e.name,t.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return ve.MIN}maxPost(){return new ve(Mi,new ol("[PRIORITY-POST]",x2))}makePost(e,t){let r=R2(e);return new ve(t,new ol("[PRIORITY-POST]",r))}toString(){return".priority"}},ze=new mD;var TQ=Math.log(2),gD=class{constructor(e){let t=s=>parseInt(Math.log(s)/TQ,10),r=s=>parseInt(Array(s+1).join("1"),2);this.count=t(e+1),this.current_=this.count-1;let i=r(this.count);this.bits_=e+1&i}nextBitIsOne(){let e=!(this.bits_&1<<this.current_);return this.current_--,e}},f_=function(n,e,t,r){n.sort(e);let i=function(c,l){let d=l-c,h,m;if(d===0)return null;if(d===1)return h=n[c],m=t?t(h):h,new wr(m,h.node,wr.BLACK,null,null);{let _=parseInt(d/2,10)+c,w=i(c,_),C=i(_+1,l);return h=n[_],m=t?t(h):h,new wr(m,h.node,wr.BLACK,w,C)}},s=function(c){let l=null,d=null,h=n.length,m=function(w,C){let A=h-w,L=h;h-=w;let H=i(A+1,L),j=n[A],Q=t?t(j):j;_(new wr(Q,j.node,C,null,H))},_=function(w){l?(l.left=w,l=w):(d=w,l=w)};for(let w=0;w<c.count;++w){let C=c.nextBitIsOne(),A=Math.pow(2,c.count-(w+1));C?m(A,wr.BLACK):(m(A,wr.BLACK),m(A,wr.RED))}return d},o=new gD(n.length),a=s(o);return new Xn(r||e,a)};var YC,tl={},al=class n{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return B(tl&&ze,"ChildrenNode.ts has not been loaded"),YC=YC||new n({".priority":tl},{".priority":ze}),YC}get(e){let t=Xi(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof Xn?t:null}hasIndex(e){return sn(this.indexSet_,e.toString())}addIndex(e,t){B(e!==ri,"KeyIndex always exists and isn't meant to be added to the IndexMap.");let r=[],i=!1,s=t.getIterator(ve.Wrap),o=s.getNext();for(;o;)i=i||e.isDefinedOn(o.node),r.push(o),o=s.getNext();let a;i?a=f_(r,e.getCompare()):a=tl;let c=e.toString(),l=Object.assign({},this.indexSet_);l[c]=e;let d=Object.assign({},this.indexes_);return d[c]=a,new n(d,l)}addToIndexes(e,t){let r=Uu(this.indexes_,(i,s)=>{let o=Xi(this.indexSet_,s);if(B(o,"Missing index implementation for "+s),i===tl)if(o.isDefinedOn(e.node)){let a=[],c=t.getIterator(ve.Wrap),l=c.getNext();for(;l;)l.name!==e.name&&a.push(l),l=c.getNext();return a.push(e),f_(a,o.getCompare())}else return tl;else{let a=t.get(e.name),c=i;return a&&(c=c.remove(new ve(e.name,a))),c.insert(e,e.node)}});return new n(r,this.indexSet_)}removeFromIndexes(e,t){let r=Uu(this.indexes_,i=>{if(i===tl)return i;{let s=t.get(e.name);return s?i.remove(new ve(e.name,s)):i}});return new n(r,this.indexSet_)}};var ch,de=(()=>{class n{constructor(t,r,i){this.children_=t,this.priorityNode_=r,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&A2(this.priorityNode_),this.children_.isEmpty()&&B(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return ch||(ch=new n(new Xn(dS),null,al.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||ch}updatePriority(t){return this.children_.isEmpty()?this:new n(this.children_,t,this.indexMap_)}getImmediateChild(t){if(t===".priority")return this.getPriority();{let r=this.children_.get(t);return r===null?ch:r}}getChild(t){let r=ge(t);return r===null?this:this.getImmediateChild(r).getChild(Be(t))}hasChild(t){return this.children_.get(t)!==null}updateImmediateChild(t,r){if(B(r,"We should always be passing snapshot nodes"),t===".priority")return this.updatePriority(r);{let i=new ve(t,r),s,o;r.isEmpty()?(s=this.children_.remove(t),o=this.indexMap_.removeFromIndexes(i,this.children_)):(s=this.children_.insert(t,r),o=this.indexMap_.addToIndexes(i,this.children_));let a=s.isEmpty()?ch:this.priorityNode_;return new n(s,a,o)}}updateChild(t,r){let i=ge(t);if(i===null)return r;{B(ge(t)!==".priority"||Ms(t)===1,".priority must be the last token in a path");let s=this.getImmediateChild(i).updateChild(Be(t),r);return this.updateImmediateChild(i,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(t){if(this.isEmpty())return null;let r={},i=0,s=0,o=!0;if(this.forEachChild(ze,(a,c)=>{r[a]=c.val(t),i++,o&&n.INTEGER_REGEXP_.test(a)?s=Math.max(s,Number(a)):o=!1}),!t&&o&&s<2*i){let a=[];for(let c in r)a[c]=r[c];return a}else return t&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(this.lazyHash_===null){let t="";this.getPriority().isEmpty()||(t+="priority:"+S2(this.getPriority().val())+":"),this.forEachChild(ze,(r,i)=>{let s=i.hash();s!==""&&(t+=":"+r+":"+s)}),this.lazyHash_=t===""?"":s2(t)}return this.lazyHash_}getPredecessorChildName(t,r,i){let s=this.resolveIndex_(i);if(s){let o=s.getPredecessorKey(new ve(t,r));return o?o.name:null}else return this.children_.getPredecessorKey(t)}getFirstChildName(t){let r=this.resolveIndex_(t);if(r){let i=r.minKey();return i&&i.name}else return this.children_.minKey()}getFirstChild(t){let r=this.getFirstChildName(t);return r?new ve(r,this.children_.get(r)):null}getLastChildName(t){let r=this.resolveIndex_(t);if(r){let i=r.maxKey();return i&&i.name}else return this.children_.maxKey()}getLastChild(t){let r=this.getLastChildName(t);return r?new ve(r,this.children_.get(r)):null}forEachChild(t,r){let i=this.resolveIndex_(t);return i?i.inorderTraversal(s=>r(s.name,s.node)):this.children_.inorderTraversal(r)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,r){let i=this.resolveIndex_(r);if(i)return i.getIteratorFrom(t,s=>s);{let s=this.children_.getIteratorFrom(t.name,ve.Wrap),o=s.peek();for(;o!=null&&r.compare(o,t)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,r){let i=this.resolveIndex_(r);if(i)return i.getReverseIteratorFrom(t,s=>s);{let s=this.children_.getReverseIteratorFrom(t.name,ve.Wrap),o=s.peek();for(;o!=null&&r.compare(o,t)>0;)s.getNext(),o=s.peek();return s}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===Nh?-1:0}withIndex(t){if(t===ri||this.indexMap_.hasIndex(t))return this;{let r=this.indexMap_.addIndex(t,this.children_);return new n(this.children_,this.priorityNode_,r)}}isIndexed(t){return t===ri||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{let r=t;if(this.getPriority().equals(r.getPriority()))if(this.children_.count()===r.children_.count()){let i=this.getIterator(ze),s=r.getIterator(ze),o=i.getNext(),a=s.getNext();for(;o&&a;){if(o.name!==a.name||!o.node.equals(a.node))return!1;o=i.getNext(),a=s.getNext()}return o===null&&a===null}else return!1;else return!1}}resolveIndex_(t){return t===ri?null:this.indexMap_.get(t.toString())}}return n.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,n})(),_D=class extends de{constructor(){super(new Xn(dS),de.EMPTY_NODE,al.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return de.EMPTY_NODE}isEmpty(){return!1}},Nh=new _D;Object.defineProperties(ve,{MIN:{value:new ve(Ps,de.EMPTY_NODE)},MAX:{value:new ve(Mi,Nh)}});h_.__EMPTY_NODE=de.EMPTY_NODE;ol.__childrenNodeConstructor=de;wQ(Nh);EQ(Nh);var bQ=!0;function nt(n,e=null){if(n===null)return de.EMPTY_NODE;if(typeof n=="object"&&".priority"in n&&(e=n[".priority"]),B(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof n=="object"&&".value"in n&&n[".value"]!==null&&(n=n[".value"]),typeof n!="object"||".sv"in n){let t=n;return new ol(t,nt(e))}if(!(n instanceof Array)&&bQ){let t=[],r=!1;if(Ot(n,(o,a)=>{if(o.substring(0,1)!=="."){let c=nt(a);c.isEmpty()||(r=r||!c.getPriority().isEmpty(),t.push(new ve(o,c)))}}),t.length===0)return de.EMPTY_NODE;let s=f_(t,vQ,o=>o.name,dS);if(r){let o=f_(t,ze.getCompare());return new de(s,nt(e),new al({".priority":o},{".priority":ze}))}else return new de(s,nt(e),al.Default)}else{let t=de.EMPTY_NODE;return Ot(n,(r,i)=>{if(sn(n,r)&&r.substring(0,1)!=="."){let s=nt(i);(s.isLeafNode()||!s.isEmpty())&&(t=t.updateImmediateChild(r,s))}}),t.updatePriority(nt(e))}}IQ(nt);var _h=class extends sl{constructor(e){super(),this.indexPath_=e,B(!_e(e)&&ge(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){let r=this.extractChild(e.node),i=this.extractChild(t.node),s=r.compareTo(i);return s===0?Zo(e.name,t.name):s}makePost(e,t){let r=nt(e),i=de.EMPTY_NODE.updateChild(this.indexPath_,r);return new ve(t,i)}maxPost(){let e=de.EMPTY_NODE.updateChild(this.indexPath_,Nh);return new ve(Mi,e)}toString(){return gh(this.indexPath_,0).join("/")}};var yD=class extends sl{compare(e,t){let r=e.node.compareTo(t.node);return r===0?Zo(e.name,t.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return ve.MIN}maxPost(){return ve.MAX}makePost(e,t){let r=nt(e);return new ve(t,r)}toString(){return".value"}},hS=new yD;function N2(n){return{type:"value",snapshotNode:n}}function cl(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function yh(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function vh(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}function CQ(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}var wh=class{constructor(e){this.index_=e}updateChild(e,t,r,i,s,o){B(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");let a=e.getImmediateChild(t);return a.getChild(i).equals(r.getChild(i))&&a.isEmpty()===r.isEmpty()||(o!=null&&(r.isEmpty()?e.hasChild(t)?o.trackChildChange(yh(t,a)):B(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(cl(t,r)):o.trackChildChange(vh(t,r,a))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(t,r).withIndex(this.index_)}updateFullNode(e,t,r){return r!=null&&(e.isLeafNode()||e.forEachChild(ze,(i,s)=>{t.hasChild(i)||r.trackChildChange(yh(i,s))}),t.isLeafNode()||t.forEachChild(ze,(i,s)=>{if(e.hasChild(i)){let o=e.getImmediateChild(i);o.equals(s)||r.trackChildChange(vh(i,s,o))}else r.trackChildChange(cl(i,s))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?de.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}};var p_=class n{constructor(e){this.indexedFilter_=new wh(e.getIndex()),this.index_=e.getIndex(),this.startPost_=n.getStartPost_(e),this.endPost_=n.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){let t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&r}updateChild(e,t,r,i,s,o){return this.matches(new ve(t,r))||(r=de.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,r,i,s,o)}updateFullNode(e,t,r){t.isLeafNode()&&(t=de.EMPTY_NODE);let i=t.withIndex(this.index_);i=i.updatePriority(de.EMPTY_NODE);let s=this;return t.forEachChild(ze,(o,a)=>{s.matches(new ve(o,a))||(i=i.updateImmediateChild(o,de.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){let t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){let t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}else return e.getIndex().maxPost()}};var vD=class{constructor(e){this.withinDirectionalStart=t=>this.reverse_?this.withinEndPost(t):this.withinStartPost(t),this.withinDirectionalEnd=t=>this.reverse_?this.withinStartPost(t):this.withinEndPost(t),this.withinStartPost=t=>{let r=this.index_.compare(this.rangedFilter_.getStartPost(),t);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=t=>{let r=this.index_.compare(t,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new p_(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,r,i,s,o){return this.rangedFilter_.matches(new ve(t,r))||(r=de.EMPTY_NODE),e.getImmediateChild(t).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,r,i,s,o):this.fullLimitUpdateChild_(e,t,r,s,o)}updateFullNode(e,t,r){let i;if(t.isLeafNode()||t.isEmpty())i=de.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<t.numChildren()&&t.isIndexed(this.index_)){i=de.EMPTY_NODE.withIndex(this.index_);let s;this.reverse_?s=t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):s=t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;s.hasNext()&&o<this.limit_;){let a=s.getNext();if(this.withinDirectionalStart(a))if(this.withinDirectionalEnd(a))i=i.updateImmediateChild(a.name,a.node),o++;else break;else continue}}else{i=t.withIndex(this.index_),i=i.updatePriority(de.EMPTY_NODE);let s;this.reverse_?s=i.getReverseIterator(this.index_):s=i.getIterator(this.index_);let o=0;for(;s.hasNext();){let a=s.getNext();o<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?o++:i=i.updateImmediateChild(a.name,de.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,r,i,s){let o;if(this.reverse_){let h=this.index_.getCompare();o=(m,_)=>h(_,m)}else o=this.index_.getCompare();let a=e;B(a.numChildren()===this.limit_,"");let c=new ve(t,r),l=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),d=this.rangedFilter_.matches(c);if(a.hasChild(t)){let h=a.getImmediateChild(t),m=i.getChildAfterChild(this.index_,l,this.reverse_);for(;m!=null&&(m.name===t||a.hasChild(m.name));)m=i.getChildAfterChild(this.index_,m,this.reverse_);let _=m==null?1:o(m,c);if(d&&!r.isEmpty()&&_>=0)return s?.trackChildChange(vh(t,r,h)),a.updateImmediateChild(t,r);{s?.trackChildChange(yh(t,h));let C=a.updateImmediateChild(t,de.EMPTY_NODE);return m!=null&&this.rangedFilter_.matches(m)?(s?.trackChildChange(cl(m.name,m.node)),C.updateImmediateChild(m.name,m.node)):C}}else return r.isEmpty()?e:d&&o(l,c)>=0?(s!=null&&(s.trackChildChange(yh(l.name,l.node)),s.trackChildChange(cl(t,r))),a.updateImmediateChild(t,r).updateImmediateChild(l.name,de.EMPTY_NODE)):e}};var Ih=class n{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=ze}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return B(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return B(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Ps}hasEnd(){return this.endSet_}getIndexEndValue(){return B(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return B(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Mi}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return B(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===ze}copy(){let e=new n;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}};function DQ(n){return n.loadsAllData()?new wh(n.getIndex()):n.hasLimit()?new vD(n):new p_(n)}function SQ(n,e){let t=n.copy();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="l",t}function AQ(n,e){let t=n.copy();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="r",t}function wD(n,e,t){let r=n.copy();return r.startSet_=!0,e===void 0&&(e=null),r.indexStartValue_=e,t!=null?(r.startNameSet_=!0,r.indexStartName_=t):(r.startNameSet_=!1,r.indexStartName_=""),r}function RQ(n,e,t){let r;return n.index_===ri||t?r=wD(n,e,t):r=wD(n,e,Mi),r.startAfterSet_=!0,r}function ID(n,e,t){let r=n.copy();return r.endSet_=!0,e===void 0&&(e=null),r.indexEndValue_=e,t!==void 0?(r.endNameSet_=!0,r.indexEndName_=t):(r.endNameSet_=!1,r.indexEndName_=""),r}function xQ(n,e,t){let r;return n.index_===ri||t?r=ID(n,e,t):r=ID(n,e,Ps),r.endBeforeSet_=!0,r}function M_(n,e){let t=n.copy();return t.index_=e,t}function BV(n){let e={};if(n.isDefault())return e;let t;if(n.index_===ze?t="$priority":n.index_===hS?t="$value":n.index_===ri?t="$key":(B(n.index_ instanceof _h,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=gt(t),n.startSet_){let r=n.startAfterSet_?"startAfter":"startAt";e[r]=gt(n.indexStartValue_),n.startNameSet_&&(e[r]+=","+gt(n.indexStartName_))}if(n.endSet_){let r=n.endBeforeSet_?"endBefore":"endAt";e[r]=gt(n.indexEndValue_),n.endNameSet_&&(e[r]+=","+gt(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function $V(n){let e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_),e.sin=!n.startAfterSet_),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_),e.ein=!n.endBeforeSet_),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;t===""&&(n.isViewFromLeft()?t="l":t="r"),e.vf=t}return n.index_!==ze&&(e.i=n.index_.toString()),e}var ED=class n extends l_{constructor(e,t,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=xh("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return t!==void 0?"tag$"+t:(B(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,r,i){let s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);let o=n.getListenId_(e,r),a={};this.listens_[o]=a;let c=BV(e._queryParams);this.restRequest_(s+".json",c,(l,d)=>{let h=d;if(l===404&&(h=null,l=null),l===null&&this.onDataUpdate_(s,h,!1,r),Xi(this.listens_,o)===a){let m;l?l===401?m="permission_denied":m="rest_error:"+l:m="ok",i(m,null)}})}unlisten(e,t){let r=n.getListenId_(e,t);delete this.listens_[r]}get(e){let t=BV(e._queryParams),r=e._path.toString(),i=new Dt;return this.restRequest_(r+".json",t,(s,o)=>{let a=o;s===404&&(a=null,s=null),s===null?(this.onDataUpdate_(r,a,!1,null),i.resolve(a)):i.reject(new Error(a))}),i.promise}refreshAuthToken(e){}restRequest_(e,t={},r){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,s])=>{i&&i.accessToken&&(t.auth=i.accessToken),s&&s.token&&(t.ac=s.token);let o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+yi(t);this.log_("Sending REST request for "+o);let a=new XMLHttpRequest;a.onreadystatechange=()=>{if(r&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let c=null;if(a.status>=200&&a.status<300){try{c=$a(a.responseText)}catch{Zt("Failed to parse JSON response for "+o+": "+a.responseText)}r(null,c)}else a.status!==401&&a.status!==404&&Zt("Got unsuccessful REST response for "+o+" Status: "+a.status),r(a.status);r=null}},a.open("GET",o,!0),a.send()})}};var TD=class{constructor(){this.rootNode_=de.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}};function m_(){return{value:null,children:new Map}}function pl(n,e,t){if(_e(e))n.value=t,n.children.clear();else if(n.value!==null)n.value=n.value.updateChild(e,t);else{let r=ge(e);n.children.has(r)||n.children.set(r,m_());let i=n.children.get(r);e=Be(e),pl(i,e,t)}}function bD(n,e){if(_e(e))return n.value=null,n.children.clear(),!0;if(n.value!==null){if(n.value.isLeafNode())return!1;{let t=n.value;return n.value=null,t.forEachChild(ze,(r,i)=>{pl(n,new xe(r),i)}),bD(n,e)}}else if(n.children.size>0){let t=ge(e);return e=Be(e),n.children.has(t)&&bD(n.children.get(t),e)&&n.children.delete(t),n.children.size===0}else return!0}function CD(n,e,t){n.value!==null?t(e,n.value):NQ(n,(r,i)=>{let s=new xe(e.toString()+"/"+r);CD(i,s,t)})}function NQ(n,e){n.children.forEach((t,r)=>{e(r,t)})}var DD=class{constructor(e){this.collection_=e,this.last_=null}get(){let e=this.collection_.get(),t=Object.assign({},e);return this.last_&&Ot(this.last_,(r,i)=>{t[r]=t[r]-i}),this.last_=e,t}};var HV=10*1e3,PQ=30*1e3,MQ=5*60*1e3,SD=class{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new DD(e);let r=HV+(PQ-HV)*Math.random();uh(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){let e=this.statsListener_.get(),t={},r=!1;Ot(e,(i,s)=>{s>0&&sn(this.statsToReport_,i)&&(t[i]=s,r=!0)}),r&&this.server_.reportStats(t),uh(this.reportStats_.bind(this),Math.floor(Math.random()*2*MQ))}};var ni=function(n){return n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",n}(ni||{});function fS(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function pS(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function mS(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}var AD=class n{constructor(e,t,r){this.path=e,this.affectedTree=t,this.revert=r,this.type=ni.ACK_USER_WRITE,this.source=fS()}operationForChild(e){if(_e(this.path)){if(this.affectedTree.value!=null)return B(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{let t=this.affectedTree.subtree(new xe(e));return new n(Re(),t,this.revert)}}else return B(ge(this.path)===e,"operationForChild called for unrelated child."),new n(Be(this.path),this.affectedTree,this.revert)}};var g_=class n{constructor(e,t){this.source=e,this.path=t,this.type=ni.LISTEN_COMPLETE}operationForChild(e){return _e(this.path)?new n(this.source,Re()):new n(this.source,Be(this.path))}};var ll=class n{constructor(e,t,r){this.source=e,this.path=t,this.snap=r,this.type=ni.OVERWRITE}operationForChild(e){return _e(this.path)?new n(this.source,Re(),this.snap.getImmediateChild(e)):new n(this.source,Be(this.path),this.snap)}};var Eh=class n{constructor(e,t,r){this.source=e,this.path=t,this.children=r,this.type=ni.MERGE}operationForChild(e){if(_e(this.path)){let t=this.children.subtree(new xe(e));return t.isEmpty()?null:t.value?new ll(this.source,Re(),t.value):new n(this.source,Re(),t)}else return B(ge(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new n(this.source,Be(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}};var si=class{constructor(e,t,r){this.node_=e,this.fullyInitialized_=t,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(_e(e))return this.isFullyInitialized()&&!this.filtered_;let t=ge(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}};var RD=class{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}};function kQ(n,e,t,r){let i=[],s=[];return e.forEach(o=>{o.type==="child_changed"&&n.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(CQ(o.childName,o.snapshotNode))}),lh(n,i,"child_removed",e,r,t),lh(n,i,"child_added",e,r,t),lh(n,i,"child_moved",s,r,t),lh(n,i,"child_changed",e,r,t),lh(n,i,"value",e,r,t),i}function lh(n,e,t,r,i,s){let o=r.filter(a=>a.type===t);o.sort((a,c)=>LQ(n,a,c)),o.forEach(a=>{let c=OQ(n,a,s);i.forEach(l=>{l.respondsTo(a.type)&&e.push(l.createEvent(c,n.query_))})})}function OQ(n,e,t){return e.type==="value"||e.type==="child_removed"||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}function LQ(n,e,t){if(e.childName==null||t.childName==null)throw io("Should only compare child_ events.");let r=new ve(e.childName,e.snapshotNode),i=new ve(t.childName,t.snapshotNode);return n.index_.compare(r,i)}function k_(n,e){return{eventCache:n,serverCache:e}}function hh(n,e,t,r){return k_(new si(e,t,r),n.serverCache)}function P2(n,e,t,r){return k_(n.eventCache,new si(e,t,r))}function __(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function Xo(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}var JC,FQ=()=>(JC||(JC=new Xn(O7)),JC),fn=class n{constructor(e,t=FQ()){this.value=e,this.children=t}static fromObject(e){let t=new n(null);return Ot(e,(r,i)=>{t=t.set(new xe(r),i)}),t}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(this.value!=null&&t(this.value))return{path:Re(),value:this.value};if(_e(e))return null;{let r=ge(e),i=this.children.get(r);if(i!==null){let s=i.findRootMostMatchingPathAndValue(Be(e),t);return s!=null?{path:Xe(new xe(r),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(_e(e))return this;{let t=ge(e),r=this.children.get(t);return r!==null?r.subtree(Be(e)):new n(null)}}set(e,t){if(_e(e))return new n(t,this.children);{let r=ge(e),s=(this.children.get(r)||new n(null)).set(Be(e),t),o=this.children.insert(r,s);return new n(this.value,o)}}remove(e){if(_e(e))return this.children.isEmpty()?new n(null):new n(null,this.children);{let t=ge(e),r=this.children.get(t);if(r){let i=r.remove(Be(e)),s;return i.isEmpty()?s=this.children.remove(t):s=this.children.insert(t,i),this.value===null&&s.isEmpty()?new n(null):new n(this.value,s)}else return this}}get(e){if(_e(e))return this.value;{let t=ge(e),r=this.children.get(t);return r?r.get(Be(e)):null}}setTree(e,t){if(_e(e))return t;{let r=ge(e),s=(this.children.get(r)||new n(null)).setTree(Be(e),t),o;return s.isEmpty()?o=this.children.remove(r):o=this.children.insert(r,s),new n(this.value,o)}}fold(e){return this.fold_(Re(),e)}fold_(e,t){let r={};return this.children.inorderTraversal((i,s)=>{r[i]=s.fold_(Xe(e,i),t)}),t(e,this.value,r)}findOnPath(e,t){return this.findOnPath_(e,Re(),t)}findOnPath_(e,t,r){let i=this.value?r(t,this.value):!1;if(i)return i;if(_e(e))return null;{let s=ge(e),o=this.children.get(s);return o?o.findOnPath_(Be(e),Xe(t,s),r):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,Re(),t)}foreachOnPath_(e,t,r){if(_e(e))return this;{this.value&&r(t,this.value);let i=ge(e),s=this.children.get(i);return s?s.foreachOnPath_(Be(e),Xe(t,i),r):new n(null)}}foreach(e){this.foreach_(Re(),e)}foreach_(e,t){this.children.inorderTraversal((r,i)=>{i.foreach_(Xe(e,r),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,r)=>{r.value&&e(t,r.value)})}};var Ir=class n{constructor(e){this.writeTree_=e}static empty(){return new n(new fn(null))}};function fh(n,e,t){if(_e(e))return new Ir(new fn(t));{let r=n.writeTree_.findRootMostValueAndPath(e);if(r!=null){let i=r.path,s=r.value,o=hn(i,e);return s=s.updateChild(o,t),new Ir(n.writeTree_.set(i,s))}else{let i=new fn(t),s=n.writeTree_.setTree(e,i);return new Ir(s)}}}function xD(n,e,t){let r=n;return Ot(t,(i,s)=>{r=fh(r,Xe(e,i),s)}),r}function qV(n,e){if(_e(e))return Ir.empty();{let t=n.writeTree_.setTree(e,new fn(null));return new Ir(t)}}function ND(n,e){return ea(n,e)!=null}function ea(n,e){let t=n.writeTree_.findRootMostValueAndPath(e);return t!=null?n.writeTree_.get(t.path).getChild(hn(t.path,e)):null}function zV(n){let e=[],t=n.writeTree_.value;return t!=null?t.isLeafNode()||t.forEachChild(ze,(r,i)=>{e.push(new ve(r,i))}):n.writeTree_.children.inorderTraversal((r,i)=>{i.value!=null&&e.push(new ve(r,i.value))}),e}function xs(n,e){if(_e(e))return n;{let t=ea(n,e);return t!=null?new Ir(new fn(t)):new Ir(n.writeTree_.subtree(e))}}function PD(n){return n.writeTree_.isEmpty()}function ul(n,e){return M2(Re(),n.writeTree_,e)}function M2(n,e,t){if(e.value!=null)return t.updateChild(n,e.value);{let r=null;return e.children.inorderTraversal((i,s)=>{i===".priority"?(B(s.value!==null,"Priority writes must always be leaf nodes"),r=s.value):t=M2(Xe(n,i),s,t)}),!t.getChild(n).isEmpty()&&r!==null&&(t=t.updateChild(Xe(n,".priority"),r)),t}}function O_(n,e){return F2(e,n)}function VQ(n,e,t,r,i){B(r>n.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),n.allWrites.push({path:e,snap:t,writeId:r,visible:i}),i&&(n.visibleWrites=fh(n.visibleWrites,e,t)),n.lastWriteId=r}function UQ(n,e,t,r){B(r>n.lastWriteId,"Stacking an older merge on top of newer ones"),n.allWrites.push({path:e,children:t,writeId:r,visible:!0}),n.visibleWrites=xD(n.visibleWrites,e,t),n.lastWriteId=r}function jQ(n,e){for(let t=0;t<n.allWrites.length;t++){let r=n.allWrites[t];if(r.writeId===e)return r}return null}function BQ(n,e){let t=n.allWrites.findIndex(a=>a.writeId===e);B(t>=0,"removeWrite called with nonexistent writeId.");let r=n.allWrites[t];n.allWrites.splice(t,1);let i=r.visible,s=!1,o=n.allWrites.length-1;for(;i&&o>=0;){let a=n.allWrites[o];a.visible&&(o>=t&&$Q(a,r.path)?i=!1:Jn(r.path,a.path)&&(s=!0)),o--}if(i){if(s)return HQ(n),!0;if(r.snap)n.visibleWrites=qV(n.visibleWrites,r.path);else{let a=r.children;Ot(a,c=>{n.visibleWrites=qV(n.visibleWrites,Xe(r.path,c))})}return!0}else return!1}function $Q(n,e){if(n.snap)return Jn(n.path,e);for(let t in n.children)if(n.children.hasOwnProperty(t)&&Jn(Xe(n.path,t),e))return!0;return!1}function HQ(n){n.visibleWrites=k2(n.allWrites,qQ,Re()),n.allWrites.length>0?n.lastWriteId=n.allWrites[n.allWrites.length-1].writeId:n.lastWriteId=-1}function qQ(n){return n.visible}function k2(n,e,t){let r=Ir.empty();for(let i=0;i<n.length;++i){let s=n[i];if(e(s)){let o=s.path,a;if(s.snap)Jn(t,o)?(a=hn(t,o),r=fh(r,a,s.snap)):Jn(o,t)&&(a=hn(o,t),r=fh(r,Re(),s.snap.getChild(a)));else if(s.children){if(Jn(t,o))a=hn(t,o),r=xD(r,a,s.children);else if(Jn(o,t))if(a=hn(o,t),_e(a))r=xD(r,Re(),s.children);else{let c=Xi(s.children,ge(a));if(c){let l=c.getChild(Be(a));r=fh(r,Re(),l)}}}else throw io("WriteRecord should have .snap or .children")}}return r}function O2(n,e,t,r,i){if(!r&&!i){let s=ea(n.visibleWrites,e);if(s!=null)return s;{let o=xs(n.visibleWrites,e);if(PD(o))return t;if(t==null&&!ND(o,Re()))return null;{let a=t||de.EMPTY_NODE;return ul(o,a)}}}else{let s=xs(n.visibleWrites,e);if(!i&&PD(s))return t;if(!i&&t==null&&!ND(s,Re()))return null;{let o=function(l){return(l.visible||i)&&(!r||!~r.indexOf(l.writeId))&&(Jn(l.path,e)||Jn(e,l.path))},a=k2(n.allWrites,o,e),c=t||de.EMPTY_NODE;return ul(a,c)}}}function zQ(n,e,t){let r=de.EMPTY_NODE,i=ea(n.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(ze,(s,o)=>{r=r.updateImmediateChild(s,o)}),r;if(t){let s=xs(n.visibleWrites,e);return t.forEachChild(ze,(o,a)=>{let c=ul(xs(s,new xe(o)),a);r=r.updateImmediateChild(o,c)}),zV(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}else{let s=xs(n.visibleWrites,e);return zV(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}}function WQ(n,e,t,r,i){B(r||i,"Either existingEventSnap or existingServerSnap must exist");let s=Xe(e,t);if(ND(n.visibleWrites,s))return null;{let o=xs(n.visibleWrites,s);return PD(o)?i.getChild(t):ul(o,i.getChild(t))}}function GQ(n,e,t,r){let i=Xe(e,t),s=ea(n.visibleWrites,i);if(s!=null)return s;if(r.isCompleteForChild(t)){let o=xs(n.visibleWrites,i);return ul(o,r.getNode().getImmediateChild(t))}else return null}function KQ(n,e){return ea(n.visibleWrites,e)}function QQ(n,e,t,r,i,s,o){let a,c=xs(n.visibleWrites,e),l=ea(c,Re());if(l!=null)a=l;else if(t!=null)a=ul(c,t);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){let d=[],h=o.getCompare(),m=s?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o),_=m.getNext();for(;_&&d.length<i;)h(_,r)!==0&&d.push(_),_=m.getNext();return d}else return[]}function YQ(){return{visibleWrites:Ir.empty(),allWrites:[],lastWriteId:-1}}function y_(n,e,t,r){return O2(n.writeTree,n.treePath,e,t,r)}function gS(n,e){return zQ(n.writeTree,n.treePath,e)}function WV(n,e,t,r){return WQ(n.writeTree,n.treePath,e,t,r)}function v_(n,e){return KQ(n.writeTree,Xe(n.treePath,e))}function JQ(n,e,t,r,i,s){return QQ(n.writeTree,n.treePath,e,t,r,i,s)}function _S(n,e,t){return GQ(n.writeTree,n.treePath,e,t)}function L2(n,e){return F2(Xe(n.treePath,e),n.writeTree)}function F2(n,e){return{treePath:n,writeTree:e}}var MD=class{constructor(){this.changeMap=new Map}trackChildChange(e){let t=e.type,r=e.childName;B(t==="child_added"||t==="child_changed"||t==="child_removed","Only child changes supported for tracking"),B(r!==".priority","Only non-priority child changes can be tracked.");let i=this.changeMap.get(r);if(i){let s=i.type;if(t==="child_added"&&s==="child_removed")this.changeMap.set(r,vh(r,e.snapshotNode,i.snapshotNode));else if(t==="child_removed"&&s==="child_added")this.changeMap.delete(r);else if(t==="child_removed"&&s==="child_changed")this.changeMap.set(r,yh(r,i.oldSnap));else if(t==="child_changed"&&s==="child_added")this.changeMap.set(r,cl(r,e.snapshotNode));else if(t==="child_changed"&&s==="child_changed")this.changeMap.set(r,vh(r,e.snapshotNode,i.oldSnap));else throw io("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}};var kD=class{getCompleteChild(e){return null}getChildAfterChild(e,t,r){return null}},V2=new kD,Th=class{constructor(e,t,r=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=r}getCompleteChild(e){let t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{let r=this.optCompleteServerCache_!=null?new si(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return _S(this.writes_,e,r)}}getChildAfterChild(e,t,r){let i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Xo(this.viewCache_),s=JQ(this.writes_,i,t,1,r,e);return s.length===0?null:s[0]}};function XQ(n){return{filter:n}}function ZQ(n,e){B(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),B(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}function eY(n,e,t,r,i){let s=new MD,o,a;if(t.type===ni.OVERWRITE){let l=t;l.source.fromUser?o=OD(n,e,l.path,l.snap,r,i,s):(B(l.source.fromServer,"Unknown source."),a=l.source.tagged||e.serverCache.isFiltered()&&!_e(l.path),o=w_(n,e,l.path,l.snap,r,i,a,s))}else if(t.type===ni.MERGE){let l=t;l.source.fromUser?o=nY(n,e,l.path,l.children,r,i,s):(B(l.source.fromServer,"Unknown source."),a=l.source.tagged||e.serverCache.isFiltered(),o=LD(n,e,l.path,l.children,r,i,a,s))}else if(t.type===ni.ACK_USER_WRITE){let l=t;l.revert?o=sY(n,e,l.path,r,i,s):o=rY(n,e,l.path,l.affectedTree,r,i,s)}else if(t.type===ni.LISTEN_COMPLETE)o=iY(n,e,t.path,r,s);else throw io("Unknown operation type: "+t.type);let c=s.getChanges();return tY(e,o,c),{viewCache:o,changes:c}}function tY(n,e,t){let r=e.eventCache;if(r.isFullyInitialized()){let i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=__(n);(t.length>0||!n.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&t.push(N2(__(e)))}}function U2(n,e,t,r,i,s){let o=e.eventCache;if(v_(r,t)!=null)return e;{let a,c;if(_e(t))if(B(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){let l=Xo(e),d=l instanceof de?l:de.EMPTY_NODE,h=gS(r,d);a=n.filter.updateFullNode(e.eventCache.getNode(),h,s)}else{let l=y_(r,Xo(e));a=n.filter.updateFullNode(e.eventCache.getNode(),l,s)}else{let l=ge(t);if(l===".priority"){B(Ms(t)===1,"Can't have a priority with additional path components");let d=o.getNode();c=e.serverCache.getNode();let h=WV(r,t,d,c);h!=null?a=n.filter.updatePriority(d,h):a=o.getNode()}else{let d=Be(t),h;if(o.isCompleteForChild(l)){c=e.serverCache.getNode();let m=WV(r,t,o.getNode(),c);m!=null?h=o.getNode().getImmediateChild(l).updateChild(d,m):h=o.getNode().getImmediateChild(l)}else h=_S(r,l,e.serverCache);h!=null?a=n.filter.updateChild(o.getNode(),l,h,d,i,s):a=o.getNode()}}return hh(e,a,o.isFullyInitialized()||_e(t),n.filter.filtersNodes())}}function w_(n,e,t,r,i,s,o,a){let c=e.serverCache,l,d=o?n.filter:n.filter.getIndexedFilter();if(_e(t))l=d.updateFullNode(c.getNode(),r,null);else if(d.filtersNodes()&&!c.isFiltered()){let _=c.getNode().updateChild(t,r);l=d.updateFullNode(c.getNode(),_,null)}else{let _=ge(t);if(!c.isCompleteForPath(t)&&Ms(t)>1)return e;let w=Be(t),A=c.getNode().getImmediateChild(_).updateChild(w,r);_===".priority"?l=d.updatePriority(c.getNode(),A):l=d.updateChild(c.getNode(),_,A,w,V2,null)}let h=P2(e,l,c.isFullyInitialized()||_e(t),d.filtersNodes()),m=new Th(i,h,s);return U2(n,h,t,i,m,a)}function OD(n,e,t,r,i,s,o){let a=e.eventCache,c,l,d=new Th(i,e,s);if(_e(t))l=n.filter.updateFullNode(e.eventCache.getNode(),r,o),c=hh(e,l,!0,n.filter.filtersNodes());else{let h=ge(t);if(h===".priority")l=n.filter.updatePriority(e.eventCache.getNode(),r),c=hh(e,l,a.isFullyInitialized(),a.isFiltered());else{let m=Be(t),_=a.getNode().getImmediateChild(h),w;if(_e(m))w=r;else{let C=d.getCompleteChild(h);C!=null?cS(m)===".priority"&&C.getChild(C2(m)).isEmpty()?w=C:w=C.updateChild(m,r):w=de.EMPTY_NODE}if(_.equals(w))c=e;else{let C=n.filter.updateChild(a.getNode(),h,w,m,d,o);c=hh(e,C,a.isFullyInitialized(),n.filter.filtersNodes())}}}return c}function GV(n,e){return n.eventCache.isCompleteForChild(e)}function nY(n,e,t,r,i,s,o){let a=e;return r.foreach((c,l)=>{let d=Xe(t,c);GV(e,ge(d))&&(a=OD(n,a,d,l,i,s,o))}),r.foreach((c,l)=>{let d=Xe(t,c);GV(e,ge(d))||(a=OD(n,a,d,l,i,s,o))}),a}function KV(n,e,t){return t.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function LD(n,e,t,r,i,s,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let c=e,l;_e(t)?l=r:l=new fn(null).setTree(t,r);let d=e.serverCache.getNode();return l.children.inorderTraversal((h,m)=>{if(d.hasChild(h)){let _=e.serverCache.getNode().getImmediateChild(h),w=KV(n,_,m);c=w_(n,c,new xe(h),w,i,s,o,a)}}),l.children.inorderTraversal((h,m)=>{let _=!e.serverCache.isCompleteForChild(h)&&m.value===null;if(!d.hasChild(h)&&!_){let w=e.serverCache.getNode().getImmediateChild(h),C=KV(n,w,m);c=w_(n,c,new xe(h),C,i,s,o,a)}}),c}function rY(n,e,t,r,i,s,o){if(v_(i,t)!=null)return e;let a=e.serverCache.isFiltered(),c=e.serverCache;if(r.value!=null){if(_e(t)&&c.isFullyInitialized()||c.isCompleteForPath(t))return w_(n,e,t,c.getNode().getChild(t),i,s,a,o);if(_e(t)){let l=new fn(null);return c.getNode().forEachChild(ri,(d,h)=>{l=l.set(new xe(d),h)}),LD(n,e,t,l,i,s,a,o)}else return e}else{let l=new fn(null);return r.foreach((d,h)=>{let m=Xe(t,d);c.isCompleteForPath(m)&&(l=l.set(d,c.getNode().getChild(m)))}),LD(n,e,t,l,i,s,a,o)}}function iY(n,e,t,r,i){let s=e.serverCache,o=P2(e,s.getNode(),s.isFullyInitialized()||_e(t),s.isFiltered());return U2(n,o,t,r,V2,i)}function sY(n,e,t,r,i,s){let o;if(v_(r,t)!=null)return e;{let a=new Th(r,e,i),c=e.eventCache.getNode(),l;if(_e(t)||ge(t)===".priority"){let d;if(e.serverCache.isFullyInitialized())d=y_(r,Xo(e));else{let h=e.serverCache.getNode();B(h instanceof de,"serverChildren would be complete if leaf node"),d=gS(r,h)}d=d,l=n.filter.updateFullNode(c,d,s)}else{let d=ge(t),h=_S(r,d,e.serverCache);h==null&&e.serverCache.isCompleteForChild(d)&&(h=c.getImmediateChild(d)),h!=null?l=n.filter.updateChild(c,d,h,Be(t),a,s):e.eventCache.getNode().hasChild(d)?l=n.filter.updateChild(c,d,de.EMPTY_NODE,Be(t),a,s):l=c,l.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=y_(r,Xo(e)),o.isLeafNode()&&(l=n.filter.updateFullNode(l,o,s)))}return o=e.serverCache.isFullyInitialized()||v_(r,Re())!=null,hh(e,l,o,n.filter.filtersNodes())}}var FD=class{constructor(e,t){this.query_=e,this.eventRegistrations_=[];let r=this.query_._queryParams,i=new wh(r.getIndex()),s=DQ(r);this.processor_=XQ(s);let o=t.serverCache,a=t.eventCache,c=i.updateFullNode(de.EMPTY_NODE,o.getNode(),null),l=s.updateFullNode(de.EMPTY_NODE,a.getNode(),null),d=new si(c,o.isFullyInitialized(),i.filtersNodes()),h=new si(l,a.isFullyInitialized(),s.filtersNodes());this.viewCache_=k_(h,d),this.eventGenerator_=new RD(this.query_)}get query(){return this.query_}};function oY(n){return n.viewCache_.serverCache.getNode()}function aY(n){return __(n.viewCache_)}function cY(n,e){let t=Xo(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!_e(e)&&!t.getImmediateChild(ge(e)).isEmpty())?t.getChild(e):null}function QV(n){return n.eventRegistrations_.length===0}function lY(n,e){n.eventRegistrations_.push(e)}function YV(n,e,t){let r=[];if(t){B(e==null,"A cancel should cancel all event registrations.");let i=n.query._path;n.eventRegistrations_.forEach(s=>{let o=s.createCancelEvent(t,i);o&&r.push(o)})}if(e){let i=[];for(let s=0;s<n.eventRegistrations_.length;++s){let o=n.eventRegistrations_[s];if(!o.matches(e))i.push(o);else if(e.hasAnyCallback()){i=i.concat(n.eventRegistrations_.slice(s+1));break}}n.eventRegistrations_=i}else n.eventRegistrations_=[];return r}function JV(n,e,t,r){e.type===ni.MERGE&&e.source.queryId!==null&&(B(Xo(n.viewCache_),"We should always have a full cache before handling merges"),B(__(n.viewCache_),"Missing event cache, even though we have a server cache"));let i=n.viewCache_,s=eY(n.processor_,i,e,t,r);return ZQ(n.processor_,s.viewCache),B(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=s.viewCache,j2(n,s.changes,s.viewCache.eventCache.getNode(),null)}function uY(n,e){let t=n.viewCache_.eventCache,r=[];return t.getNode().isLeafNode()||t.getNode().forEachChild(ze,(s,o)=>{r.push(cl(s,o))}),t.isFullyInitialized()&&r.push(N2(t.getNode())),j2(n,r,t.getNode(),e)}function j2(n,e,t,r){let i=r?[r]:n.eventRegistrations_;return kQ(n.eventGenerator_,e,t,i)}var I_,E_=class{constructor(){this.views=new Map}};function dY(n){B(!I_,"__referenceConstructor has already been defined"),I_=n}function hY(){return B(I_,"Reference.ts has not been loaded"),I_}function fY(n){return n.views.size===0}function yS(n,e,t,r){let i=e.source.queryId;if(i!==null){let s=n.views.get(i);return B(s!=null,"SyncTree gave us an op for an invalid query."),JV(s,e,t,r)}else{let s=[];for(let o of n.views.values())s=s.concat(JV(o,e,t,r));return s}}function B2(n,e,t,r,i){let s=e._queryIdentifier,o=n.views.get(s);if(!o){let a=y_(t,i?r:null),c=!1;a?c=!0:r instanceof de?(a=gS(t,r),c=!1):(a=de.EMPTY_NODE,c=!1);let l=k_(new si(a,c,!1),new si(r,i,!1));return new FD(e,l)}return o}function pY(n,e,t,r,i,s){let o=B2(n,e,r,i,s);return n.views.has(e._queryIdentifier)||n.views.set(e._queryIdentifier,o),lY(o,t),uY(o,t)}function mY(n,e,t,r){let i=e._queryIdentifier,s=[],o=[],a=ks(n);if(i==="default")for(let[c,l]of n.views.entries())o=o.concat(YV(l,t,r)),QV(l)&&(n.views.delete(c),l.query._queryParams.loadsAllData()||s.push(l.query));else{let c=n.views.get(i);c&&(o=o.concat(YV(c,t,r)),QV(c)&&(n.views.delete(i),c.query._queryParams.loadsAllData()||s.push(c.query)))}return a&&!ks(n)&&s.push(new(hY())(e._repo,e._path)),{removed:s,events:o}}function $2(n){let e=[];for(let t of n.views.values())t.query._queryParams.loadsAllData()||e.push(t);return e}function Ns(n,e){let t=null;for(let r of n.views.values())t=t||cY(r,e);return t}function H2(n,e){if(e._queryParams.loadsAllData())return L_(n);{let r=e._queryIdentifier;return n.views.get(r)}}function q2(n,e){return H2(n,e)!=null}function ks(n){return L_(n)!=null}function L_(n){for(let e of n.views.values())if(e.query._queryParams.loadsAllData())return e;return null}var T_;function gY(n){B(!T_,"__referenceConstructor has already been defined"),T_=n}function _Y(){return B(T_,"Reference.ts has not been loaded"),T_}var yY=1,b_=class{constructor(e){this.listenProvider_=e,this.syncPointTree_=new fn(null),this.pendingWriteTree_=YQ(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}};function vS(n,e,t,r,i){return VQ(n.pendingWriteTree_,e,t,r,i),i?ml(n,new ll(fS(),e,t)):[]}function vY(n,e,t,r){UQ(n.pendingWriteTree_,e,t,r);let i=fn.fromObject(t);return ml(n,new Eh(fS(),e,i))}function Rs(n,e,t=!1){let r=jQ(n.pendingWriteTree_,e);if(BQ(n.pendingWriteTree_,e)){let s=new fn(null);return r.snap!=null?s=s.set(Re(),!0):Ot(r.children,o=>{s=s.set(new xe(o),!0)}),ml(n,new AD(r.path,s,t))}else return[]}function Ph(n,e,t){return ml(n,new ll(pS(),e,t))}function wY(n,e,t){let r=fn.fromObject(t);return ml(n,new Eh(pS(),e,r))}function IY(n,e){return ml(n,new g_(pS(),e))}function EY(n,e,t){let r=wS(n,t);if(r){let i=IS(r),s=i.path,o=i.queryId,a=hn(s,e),c=new g_(mS(o),a);return ES(n,s,c)}else return[]}function C_(n,e,t,r,i=!1){let s=e._path,o=n.syncPointTree_.get(s),a=[];if(o&&(e._queryIdentifier==="default"||q2(o,e))){let c=mY(o,e,t,r);fY(o)&&(n.syncPointTree_=n.syncPointTree_.remove(s));let l=c.removed;if(a=c.events,!i){let d=l.findIndex(m=>m._queryParams.loadsAllData())!==-1,h=n.syncPointTree_.findOnPath(s,(m,_)=>ks(_));if(d&&!h){let m=n.syncPointTree_.subtree(s);if(!m.isEmpty()){let _=CY(m);for(let w=0;w<_.length;++w){let C=_[w],A=C.query,L=K2(n,C);n.listenProvider_.startListening(ph(A),bh(n,A),L.hashFn,L.onComplete)}}}!h&&l.length>0&&!r&&(d?n.listenProvider_.stopListening(ph(e),null):l.forEach(m=>{let _=n.queryToTagMap.get(V_(m));n.listenProvider_.stopListening(ph(m),_)}))}DY(n,l)}return a}function z2(n,e,t,r){let i=wS(n,r);if(i!=null){let s=IS(i),o=s.path,a=s.queryId,c=hn(o,e),l=new ll(mS(a),c,t);return ES(n,o,l)}else return[]}function TY(n,e,t,r){let i=wS(n,r);if(i){let s=IS(i),o=s.path,a=s.queryId,c=hn(o,e),l=fn.fromObject(t),d=new Eh(mS(a),c,l);return ES(n,o,d)}else return[]}function VD(n,e,t,r=!1){let i=e._path,s=null,o=!1;n.syncPointTree_.foreachOnPath(i,(m,_)=>{let w=hn(m,i);s=s||Ns(_,w),o=o||ks(_)});let a=n.syncPointTree_.get(i);a?(o=o||ks(a),s=s||Ns(a,Re())):(a=new E_,n.syncPointTree_=n.syncPointTree_.set(i,a));let c;s!=null?c=!0:(c=!1,s=de.EMPTY_NODE,n.syncPointTree_.subtree(i).foreachChild((_,w)=>{let C=Ns(w,Re());C&&(s=s.updateImmediateChild(_,C))}));let l=q2(a,e);if(!l&&!e._queryParams.loadsAllData()){let m=V_(e);B(!n.queryToTagMap.has(m),"View does not exist, but we have a tag");let _=SY();n.queryToTagMap.set(m,_),n.tagToQueryMap.set(_,m)}let d=O_(n.pendingWriteTree_,i),h=pY(a,e,t,d,s,c);if(!l&&!o&&!r){let m=H2(a,e);h=h.concat(AY(n,e,m))}return h}function F_(n,e,t){let i=n.pendingWriteTree_,s=n.syncPointTree_.findOnPath(e,(o,a)=>{let c=hn(o,e),l=Ns(a,c);if(l)return l});return O2(i,e,s,t,!0)}function bY(n,e){let t=e._path,r=null;n.syncPointTree_.foreachOnPath(t,(l,d)=>{let h=hn(l,t);r=r||Ns(d,h)});let i=n.syncPointTree_.get(t);i?r=r||Ns(i,Re()):(i=new E_,n.syncPointTree_=n.syncPointTree_.set(t,i));let s=r!=null,o=s?new si(r,!0,!1):null,a=O_(n.pendingWriteTree_,e._path),c=B2(i,e,a,s?o.getNode():de.EMPTY_NODE,s);return aY(c)}function ml(n,e){return W2(e,n.syncPointTree_,null,O_(n.pendingWriteTree_,Re()))}function W2(n,e,t,r){if(_e(n.path))return G2(n,e,t,r);{let i=e.get(Re());t==null&&i!=null&&(t=Ns(i,Re()));let s=[],o=ge(n.path),a=n.operationForChild(o),c=e.children.get(o);if(c&&a){let l=t?t.getImmediateChild(o):null,d=L2(r,o);s=s.concat(W2(a,c,l,d))}return i&&(s=s.concat(yS(i,n,r,t))),s}}function G2(n,e,t,r){let i=e.get(Re());t==null&&i!=null&&(t=Ns(i,Re()));let s=[];return e.children.inorderTraversal((o,a)=>{let c=t?t.getImmediateChild(o):null,l=L2(r,o),d=n.operationForChild(o);d&&(s=s.concat(G2(d,a,c,l)))}),i&&(s=s.concat(yS(i,n,r,t))),s}function K2(n,e){let t=e.query,r=bh(n,t);return{hashFn:()=>(oY(e)||de.EMPTY_NODE).hash(),onComplete:i=>{if(i==="ok")return r?EY(n,t._path,r):IY(n,t._path);{let s=V7(i,t);return C_(n,t,null,s)}}}}function bh(n,e){let t=V_(e);return n.queryToTagMap.get(t)}function V_(n){return n._path.toString()+"$"+n._queryIdentifier}function wS(n,e){return n.tagToQueryMap.get(e)}function IS(n){let e=n.indexOf("$");return B(e!==-1&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new xe(n.substr(0,e))}}function ES(n,e,t){let r=n.syncPointTree_.get(e);B(r,"Missing sync point for query tag that we're tracking");let i=O_(n.pendingWriteTree_,e);return yS(r,t,i,null)}function CY(n){return n.fold((e,t,r)=>{if(t&&ks(t))return[L_(t)];{let i=[];return t&&(i=$2(t)),Ot(r,(s,o)=>{i=i.concat(o)}),i}})}function ph(n){return n._queryParams.loadsAllData()&&!n._queryParams.isDefault()?new(_Y())(n._repo,n._path):n}function DY(n,e){for(let t=0;t<e.length;++t){let r=e[t];if(!r._queryParams.loadsAllData()){let i=V_(r),s=n.queryToTagMap.get(i);n.queryToTagMap.delete(i),n.tagToQueryMap.delete(s)}}}function SY(){return yY++}function AY(n,e,t){let r=e._path,i=bh(n,e),s=K2(n,t),o=n.listenProvider_.startListening(ph(e),i,s.hashFn,s.onComplete),a=n.syncPointTree_.subtree(r);if(i)B(!ks(a.value),"If we're adding a query, it shouldn't be shadowed");else{let c=a.fold((l,d,h)=>{if(!_e(l)&&d&&ks(d))return[L_(d).query];{let m=[];return d&&(m=m.concat($2(d).map(_=>_.query))),Ot(h,(_,w)=>{m=m.concat(w)}),m}});for(let l=0;l<c.length;++l){let d=c[l];n.listenProvider_.stopListening(ph(d),bh(n,d))}}return o}var UD=class n{constructor(e){this.node_=e}getImmediateChild(e){let t=this.node_.getImmediateChild(e);return new n(t)}node(){return this.node_}},jD=class n{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){let t=Xe(this.path_,e);return new n(this.syncTree_,t)}node(){return F_(this.syncTree_,this.path_)}},RY=function(n){return n=n||{},n.timestamp=n.timestamp||new Date().getTime(),n},XV=function(n,e,t){if(!n||typeof n!="object")return n;if(B(".sv"in n,"Unexpected leaf node or priority contents"),typeof n[".sv"]=="string")return xY(n[".sv"],e,t);if(typeof n[".sv"]=="object")return NY(n[".sv"],e);B(!1,"Unexpected server value: "+JSON.stringify(n,null,2))},xY=function(n,e,t){switch(n){case"timestamp":return t.timestamp;default:B(!1,"Unexpected server value: "+n)}},NY=function(n,e,t){n.hasOwnProperty("increment")||B(!1,"Unexpected server value: "+JSON.stringify(n,null,2));let r=n.increment;typeof r!="number"&&B(!1,"Unexpected increment value: "+r);let i=e.node();if(B(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;let o=i.getValue();return typeof o!="number"?r:o+r},Q2=function(n,e,t,r){return bS(e,new jD(t,n),r)},TS=function(n,e,t){return bS(n,new UD(e),t)};function bS(n,e,t){let r=n.getPriority().val(),i=XV(r,e.getImmediateChild(".priority"),t),s;if(n.isLeafNode()){let o=n,a=XV(o.getValue(),e,t);return a!==o.getValue()||i!==o.getPriority().val()?new ol(a,nt(i)):n}else{let o=n;return s=o,i!==o.getPriority().val()&&(s=s.updatePriority(new ol(i))),o.forEachChild(ze,(a,c)=>{let l=bS(c,e.getImmediateChild(a),t);l!==c&&(s=s.updateImmediateChild(a,l))}),s}}var Ch=class{constructor(e="",t=null,r={children:{},childCount:0}){this.name=e,this.parent=t,this.node=r}};function U_(n,e){let t=e instanceof xe?e:new xe(e),r=n,i=ge(t);for(;i!==null;){let s=Xi(r.node.children,i)||{children:{},childCount:0};r=new Ch(i,r,s),t=Be(t),i=ge(t)}return r}function ta(n){return n.node.value}function CS(n,e){n.node.value=e,BD(n)}function Y2(n){return n.node.childCount>0}function PY(n){return ta(n)===void 0&&!Y2(n)}function j_(n,e){Ot(n.node.children,(t,r)=>{e(new Ch(t,n,r))})}function J2(n,e,t,r){t&&!r&&e(n),j_(n,i=>{J2(i,e,!0,r)}),t&&r&&e(n)}function MY(n,e,t){let r=t?n:n.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function Mh(n){return new xe(n.parent===null?n.name:Mh(n.parent)+"/"+n.name)}function BD(n){n.parent!==null&&kY(n.parent,n.name,n)}function kY(n,e,t){let r=PY(t),i=sn(n.node.children,e);r&&i?(delete n.node.children[e],n.node.childCount--,BD(n)):!r&&!i&&(n.node.children[e]=t.node,n.node.childCount++,BD(n))}var OY=/[\[\].#$\/\u0000-\u001F\u007F]/,LY=/[\[\].#$\u0000-\u001F\u007F]/,XC=10*1024*1024,B_=function(n){return typeof n=="string"&&n.length!==0&&!OY.test(n)},X2=function(n){return typeof n=="string"&&n.length!==0&&!LY.test(n)},FY=function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),X2(n)},Dh=function(n){return n===null||typeof n=="string"||typeof n=="number"&&!P_(n)||n&&typeof n=="object"&&sn(n,".sv")},oi=function(n,e,t,r){r&&e===void 0||kh(Kt(n,"value"),e,t)},kh=function(n,e,t){let r=t instanceof xe?new dD(t,n):t;if(e===void 0)throw new Error(n+"contains undefined "+Qo(r));if(typeof e=="function")throw new Error(n+"contains a function "+Qo(r)+" with contents = "+e.toString());if(P_(e))throw new Error(n+"contains "+e.toString()+" "+Qo(r));if(typeof e=="string"&&e.length>XC/3&&ju(e)>XC)throw new Error(n+"contains a string greater than "+XC+" utf8 bytes "+Qo(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,s=!1;if(Ot(e,(o,a)=>{if(o===".value")i=!0;else if(o!==".priority"&&o!==".sv"&&(s=!0,!B_(o)))throw new Error(n+" contains an invalid key ("+o+") "+Qo(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);fQ(r,o),kh(n,a,r),pQ(r)}),i&&s)throw new Error(n+' contains ".value" child '+Qo(r)+" in addition to actual children.")}},VY=function(n,e){let t,r;for(t=0;t<e.length;t++){r=e[t];let s=gh(r);for(let o=0;o<s.length;o++)if(!(s[o]===".priority"&&o===s.length-1)){if(!B_(s[o]))throw new Error(n+"contains an invalid key ("+s[o]+") in path "+r.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(hQ);let i=null;for(t=0;t<e.length;t++){if(r=e[t],i!==null&&Jn(i,r))throw new Error(n+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}},Z2=function(n,e,t,r){if(r&&e===void 0)return;let i=Kt(n,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");let s=[];Ot(e,(o,a)=>{let c=new xe(o);if(kh(i,a,Xe(t,c)),cS(c)===".priority"&&!Dh(a))throw new Error(i+"contains an invalid value for '"+c.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(c)}),VY(i,s)},DS=function(n,e,t){if(!(t&&e===void 0)){if(P_(e))throw new Error(Kt(n,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!Dh(e))throw new Error(Kt(n,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},Oh=function(n,e,t,r){if(!(r&&t===void 0)&&!B_(t))throw new Error(Kt(n,e)+'was an invalid key = "'+t+`".  Firebase keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]").`)},gl=function(n,e,t,r){if(!(r&&t===void 0)&&!X2(t))throw new Error(Kt(n,e)+'was an invalid path = "'+t+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},UY=function(n,e,t,r){t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),gl(n,e,t,r)},Mn=function(n,e){if(ge(e)===".info")throw new Error(n+" failed = Can't modify data under /.info/")},eU=function(n,e){let t=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!B_(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||t.length!==0&&!FY(t))throw new Error(Kt(n,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};var $D=class{constructor(){this.eventLists_=[],this.recursionDepth_=0}};function $_(n,e){let t=null;for(let r=0;r<e.length;r++){let i=e[r],s=i.getPath();t!==null&&!lS(s,t.path)&&(n.eventLists_.push(t),t=null),t===null&&(t={events:[],path:s}),t.events.push(i)}t&&n.eventLists_.push(t)}function tU(n,e,t){$_(n,t),nU(n,r=>lS(r,e))}function kn(n,e,t){$_(n,t),nU(n,r=>Jn(r,e)||Jn(e,r))}function nU(n,e){n.recursionDepth_++;let t=!0;for(let r=0;r<n.eventLists_.length;r++){let i=n.eventLists_[r];if(i){let s=i.path;e(s)?(jY(n.eventLists_[r]),n.eventLists_[r]=null):t=!1}}t&&(n.eventLists_=[]),n.recursionDepth_--}function jY(n){for(let e=0;e<n.events.length;e++){let t=n.events[e];if(t!==null){n.events[e]=null;let r=t.getEventRunner();Jo&&kt("event: "+t.toString()),fl(r)}}}var rU="repo_interrupt",BY=25,HD=class{constructor(e,t,r,i){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new $D,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=m_(),this.transactionQueueTree_=new Ch,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}};function $Y(n,e,t){if(n.stats_=aS(n.repoInfo_),n.forceRestClient_||$7())n.server_=new ED(n.repoInfo_,(r,i,s,o)=>{ZV(n,r,i,s,o)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>e2(n,!0),0);else{if(typeof t<"u"&&t!==null){if(typeof t!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{gt(t)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}n.persistentConnection_=new uS(n.repoInfo_,e,(r,i,s,o)=>{ZV(n,r,i,s,o)},r=>{e2(n,r)},r=>{HY(n,r)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(r=>{n.server_.refreshAuthToken(r)}),n.appCheckProvider_.addTokenChangeListener(r=>{n.server_.refreshAppCheckToken(r.token)}),n.statsReporter_=q7(n.repoInfo_,()=>new SD(n.stats_,n.server_)),n.infoData_=new TD,n.infoSyncTree_=new b_({startListening:(r,i,s,o)=>{let a=[],c=n.infoData_.getNode(r._path);return c.isEmpty()||(a=Ph(n.infoSyncTree_,r._path,c),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),SS(n,"connected",!1),n.serverSyncTree_=new b_({startListening:(r,i,s,o)=>(n.server_.listen(r,s,i,(a,c)=>{let l=o(a,c);kn(n.eventQueue_,r._path,l)}),[]),stopListening:(r,i)=>{n.server_.unlisten(r,i)}})}function iU(n){let t=n.infoData_.getNode(new xe(".info/serverTimeOffset")).val()||0;return new Date().getTime()+t}function Lh(n){return RY({timestamp:iU(n)})}function ZV(n,e,t,r,i){n.dataUpdateCount++;let s=new xe(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let o=[];if(i)if(r){let c=Uu(t,l=>nt(l));o=TY(n.serverSyncTree_,s,c,i)}else{let c=nt(t);o=z2(n.serverSyncTree_,s,c,i)}else if(r){let c=Uu(t,l=>nt(l));o=wY(n.serverSyncTree_,s,c)}else{let c=nt(t);o=Ph(n.serverSyncTree_,s,c)}let a=s;o.length>0&&(a=dl(n,s)),kn(n.eventQueue_,a,o)}function e2(n,e){SS(n,"connected",e),e===!1&&WY(n)}function HY(n,e){Ot(e,(t,r)=>{SS(n,t,r)})}function SS(n,e,t){let r=new xe("/.info/"+e),i=nt(t);n.infoData_.updateSnapshot(r,i);let s=Ph(n.infoSyncTree_,r,i);kn(n.eventQueue_,r,s)}function H_(n){return n.nextWriteId_++}function qY(n,e,t){let r=bY(n.serverSyncTree_,e);return r!=null?Promise.resolve(r):n.server_.get(e).then(i=>{let s=nt(i).withIndex(e._queryParams.getIndex());VD(n.serverSyncTree_,e,t,!0);let o;if(e._queryParams.loadsAllData())o=Ph(n.serverSyncTree_,e._path,s);else{let a=bh(n.serverSyncTree_,e);o=z2(n.serverSyncTree_,e._path,s,a)}return kn(n.eventQueue_,e._path,o),C_(n.serverSyncTree_,e,t,null,!0),s},i=>(_l(n,"get for query "+gt(e)+" failed: "+i),Promise.reject(new Error(i))))}function AS(n,e,t,r,i){_l(n,"set",{path:e.toString(),value:t,priority:r});let s=Lh(n),o=nt(t,r),a=F_(n.serverSyncTree_,e),c=TS(o,a,s),l=H_(n),d=vS(n.serverSyncTree_,e,c,l,!0);$_(n.eventQueue_,d),n.server_.put(e.toString(),o.val(!0),(m,_)=>{let w=m==="ok";w||Zt("set at "+e+" failed: "+m);let C=Rs(n.serverSyncTree_,l,!w);kn(n.eventQueue_,e,C),Os(n,i,m,_)});let h=xS(n,e);dl(n,h),kn(n.eventQueue_,h,[])}function zY(n,e,t,r){_l(n,"update",{path:e.toString(),value:t});let i=!0,s=Lh(n),o={};if(Ot(t,(a,c)=>{i=!1,o[a]=Q2(Xe(e,a),nt(c),n.serverSyncTree_,s)}),i)kt("update() called with empty data.  Don't do anything."),Os(n,r,"ok",void 0);else{let a=H_(n),c=vY(n.serverSyncTree_,e,o,a);$_(n.eventQueue_,c),n.server_.merge(e.toString(),t,(l,d)=>{let h=l==="ok";h||Zt("update at "+e+" failed: "+l);let m=Rs(n.serverSyncTree_,a,!h),_=m.length>0?dl(n,e):e;kn(n.eventQueue_,_,m),Os(n,r,l,d)}),Ot(t,l=>{let d=xS(n,Xe(e,l));dl(n,d)}),kn(n.eventQueue_,e,[])}}function WY(n){_l(n,"onDisconnectEvents");let e=Lh(n),t=m_();CD(n.onDisconnect_,Re(),(i,s)=>{let o=Q2(i,s,n.serverSyncTree_,e);pl(t,i,o)});let r=[];CD(t,Re(),(i,s)=>{r=r.concat(Ph(n.serverSyncTree_,i,s));let o=xS(n,i);dl(n,o)}),n.onDisconnect_=m_(),kn(n.eventQueue_,Re(),r)}function GY(n,e,t){n.server_.onDisconnectCancel(e.toString(),(r,i)=>{r==="ok"&&bD(n.onDisconnect_,e),Os(n,t,r,i)})}function t2(n,e,t,r){let i=nt(t);n.server_.onDisconnectPut(e.toString(),i.val(!0),(s,o)=>{s==="ok"&&pl(n.onDisconnect_,e,i),Os(n,r,s,o)})}function KY(n,e,t,r,i){let s=nt(t,r);n.server_.onDisconnectPut(e.toString(),s.val(!0),(o,a)=>{o==="ok"&&pl(n.onDisconnect_,e,s),Os(n,i,o,a)})}function QY(n,e,t,r){if(za(t)){kt("onDisconnect().update() called with empty data.  Don't do anything."),Os(n,r,"ok",void 0);return}n.server_.onDisconnectMerge(e.toString(),t,(i,s)=>{i==="ok"&&Ot(t,(o,a)=>{let c=nt(a);pl(n.onDisconnect_,Xe(e,o),c)}),Os(n,r,i,s)})}function YY(n,e,t){let r;ge(e._path)===".info"?r=VD(n.infoSyncTree_,e,t):r=VD(n.serverSyncTree_,e,t),tU(n.eventQueue_,e._path,r)}function qD(n,e,t){let r;ge(e._path)===".info"?r=C_(n.infoSyncTree_,e,t):r=C_(n.serverSyncTree_,e,t),tU(n.eventQueue_,e._path,r)}function sU(n){n.persistentConnection_&&n.persistentConnection_.interrupt(rU)}function JY(n){n.persistentConnection_&&n.persistentConnection_.resume(rU)}function _l(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),kt(t,...e)}function Os(n,e,t,r){e&&fl(()=>{if(t==="ok")e(null);else{let i=(t||"error").toUpperCase(),s=i;r&&(s+=": "+r);let o=new Error(s);o.code=i,e(o)}})}function XY(n,e,t,r,i,s){_l(n,"transaction on "+e);let o={path:e,update:t,onComplete:r,status:null,order:i2(),applyLocally:s,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},a=RS(n,e,void 0);o.currentInputSnapshot=a;let c=o.update(a.val());if(c===void 0)o.unwatcher(),o.currentOutputSnapshotRaw=null,o.currentOutputSnapshotResolved=null,o.onComplete&&o.onComplete(null,!1,o.currentInputSnapshot);else{kh("transaction failed: Data returned ",c,o.path),o.status=0;let l=U_(n.transactionQueueTree_,e),d=ta(l)||[];d.push(o),CS(l,d);let h;typeof c=="object"&&c!==null&&sn(c,".priority")?(h=Xi(c,".priority"),B(Dh(h),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):h=(F_(n.serverSyncTree_,e)||de.EMPTY_NODE).getPriority().val();let m=Lh(n),_=nt(c,h),w=TS(_,a,m);o.currentOutputSnapshotRaw=_,o.currentOutputSnapshotResolved=w,o.currentWriteId=H_(n);let C=vS(n.serverSyncTree_,e,w,o.currentWriteId,o.applyLocally);kn(n.eventQueue_,e,C),q_(n,n.transactionQueueTree_)}}function RS(n,e,t){return F_(n.serverSyncTree_,e,t)||de.EMPTY_NODE}function q_(n,e=n.transactionQueueTree_){if(e||z_(n,e),ta(e)){let t=aU(n,e);B(t.length>0,"Sending zero length transaction queue"),t.every(i=>i.status===0)&&ZY(n,Mh(e),t)}else Y2(e)&&j_(e,t=>{q_(n,t)})}function ZY(n,e,t){let r=t.map(l=>l.currentWriteId),i=RS(n,e,r),s=i,o=i.hash();for(let l=0;l<t.length;l++){let d=t[l];B(d.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),d.status=1,d.retryCount++;let h=hn(e,d.path);s=s.updateChild(h,d.currentOutputSnapshotRaw)}let a=s.val(!0),c=e;n.server_.put(c.toString(),a,l=>{_l(n,"transaction put response",{path:c.toString(),status:l});let d=[];if(l==="ok"){let h=[];for(let m=0;m<t.length;m++)t[m].status=2,d=d.concat(Rs(n.serverSyncTree_,t[m].currentWriteId)),t[m].onComplete&&h.push(()=>t[m].onComplete(null,!0,t[m].currentOutputSnapshotResolved)),t[m].unwatcher();z_(n,U_(n.transactionQueueTree_,e)),q_(n,n.transactionQueueTree_),kn(n.eventQueue_,e,d);for(let m=0;m<h.length;m++)fl(h[m])}else{if(l==="datastale")for(let h=0;h<t.length;h++)t[h].status===3?t[h].status=4:t[h].status=0;else{Zt("transaction at "+c.toString()+" failed: "+l);for(let h=0;h<t.length;h++)t[h].status=4,t[h].abortReason=l}dl(n,e)}},o)}function dl(n,e){let t=oU(n,e),r=Mh(t),i=aU(n,t);return eJ(n,i,r),r}function eJ(n,e,t){if(e.length===0)return;let r=[],i=[],o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){let c=e[a],l=hn(t,c.path),d=!1,h;if(B(l!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),c.status===4)d=!0,h=c.abortReason,i=i.concat(Rs(n.serverSyncTree_,c.currentWriteId,!0));else if(c.status===0)if(c.retryCount>=BY)d=!0,h="maxretry",i=i.concat(Rs(n.serverSyncTree_,c.currentWriteId,!0));else{let m=RS(n,c.path,o);c.currentInputSnapshot=m;let _=e[a].update(m.val());if(_!==void 0){kh("transaction failed: Data returned ",_,c.path);let w=nt(_);typeof _=="object"&&_!=null&&sn(_,".priority")||(w=w.updatePriority(m.getPriority()));let A=c.currentWriteId,L=Lh(n),H=TS(w,m,L);c.currentOutputSnapshotRaw=w,c.currentOutputSnapshotResolved=H,c.currentWriteId=H_(n),o.splice(o.indexOf(A),1),i=i.concat(vS(n.serverSyncTree_,c.path,H,c.currentWriteId,c.applyLocally)),i=i.concat(Rs(n.serverSyncTree_,A,!0))}else d=!0,h="nodata",i=i.concat(Rs(n.serverSyncTree_,c.currentWriteId,!0))}kn(n.eventQueue_,t,i),i=[],d&&(e[a].status=2,function(m){setTimeout(m,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(h==="nodata"?r.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):r.push(()=>e[a].onComplete(new Error(h),!1,null))))}z_(n,n.transactionQueueTree_);for(let a=0;a<r.length;a++)fl(r[a]);q_(n,n.transactionQueueTree_)}function oU(n,e){let t,r=n.transactionQueueTree_;for(t=ge(e);t!==null&&ta(r)===void 0;)r=U_(r,t),e=Be(e),t=ge(e);return r}function aU(n,e){let t=[];return cU(n,e,t),t.sort((r,i)=>r.order-i.order),t}function cU(n,e,t){let r=ta(e);if(r)for(let i=0;i<r.length;i++)t.push(r[i]);j_(e,i=>{cU(n,i,t)})}function z_(n,e){let t=ta(e);if(t){let r=0;for(let i=0;i<t.length;i++)t[i].status!==2&&(t[r]=t[i],r++);t.length=r,CS(e,t.length>0?t:void 0)}j_(e,r=>{z_(n,r)})}function xS(n,e){let t=Mh(oU(n,e)),r=U_(n.transactionQueueTree_,e);return MY(r,i=>{ZC(n,i)}),ZC(n,r),J2(r,i=>{ZC(n,i)}),t}function ZC(n,e){let t=ta(e);if(t){let r=[],i=[],s=-1;for(let o=0;o<t.length;o++)t[o].status===3||(t[o].status===1?(B(s===o-1,"All SENT items should be at beginning of queue."),s=o,t[o].status=3,t[o].abortReason="set"):(B(t[o].status===0,"Unexpected transaction status in abort"),t[o].unwatcher(),i=i.concat(Rs(n.serverSyncTree_,t[o].currentWriteId,!0)),t[o].onComplete&&r.push(t[o].onComplete.bind(null,new Error("set"),!1,null))));s===-1?CS(e,void 0):t.length=s+1,kn(n.eventQueue_,Mh(e),i);for(let o=0;o<r.length;o++)fl(r[o])}}function tJ(n){let e="",t=n.split("/");for(let r=0;r<t.length;r++)if(t[r].length>0){let i=t[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function nJ(n){let e={};n.charAt(0)==="?"&&(n=n.substring(1));for(let t of n.split("&")){if(t.length===0)continue;let r=t.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):Zt(`Invalid query segment '${t}' in query '${n}'`)}return e}var zD=function(n,e){let t=rJ(n),r=t.namespace;t.domain==="firebase.com"&&ii(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&t.domain!=="localhost"&&ii("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||M7();let i=t.scheme==="ws"||t.scheme==="wss";return{repoInfo:new a_(t.host,t.secure,r,i,e,"",r!==t.subdomain),path:new xe(t.pathString)}},rJ=function(n){let e="",t="",r="",i="",s="",o=!0,a="https",c=443;if(typeof n=="string"){let l=n.indexOf("//");l>=0&&(a=n.substring(0,l-1),n=n.substring(l+2));let d=n.indexOf("/");d===-1&&(d=n.length);let h=n.indexOf("?");h===-1&&(h=n.length),e=n.substring(0,Math.min(d,h)),d<h&&(i=tJ(n.substring(d,h)));let m=nJ(n.substring(Math.min(n.length,h)));l=e.indexOf(":"),l>=0?(o=a==="https"||a==="wss",c=parseInt(e.substring(l+1),10)):l=e.length;let _=e.slice(0,l);if(_.toLowerCase()==="localhost")t="localhost";else if(_.split(".").length<=2)t=_;else{let w=e.indexOf(".");r=e.substring(0,w).toLowerCase(),t=e.substring(w+1),s=r}"ns"in m&&(s=m.ns)}return{host:e,port:c,domain:t,subdomain:r,secure:o,scheme:a,pathString:i,namespace:s}};var n2="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",iJ=function(){let n=0,e=[];return function(t){let r=t===n;n=t;let i,s=new Array(8);for(i=7;i>=0;i--)s[i]=n2.charAt(t%64),t=Math.floor(t/64);B(t===0,"Cannot push at time == 0");let o=s.join("");if(r){for(i=11;i>=0&&e[i]===63;i--)e[i]=0;e[i]++}else for(i=0;i<12;i++)e[i]=Math.floor(Math.random()*64);for(i=0;i<12;i++)o+=n2.charAt(e[i]);return B(o.length===20,"nextPushId: Length should be 20."),o}}();var D_=class{constructor(e,t,r,i){this.eventType=e,this.eventRegistration=t,this.snapshot=r,this.prevName=i}getPath(){let e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+gt(this.snapshot.exportVal())}},S_=class{constructor(e,t,r){this.eventRegistration=e,this.error=t,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}};var Sh=class{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return B(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}};var A_=class{constructor(e,t){this._repo=e,this._path=t}cancel(){let e=new Dt;return GY(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){Mn("OnDisconnect.remove",this._path);let e=new Dt;return t2(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){Mn("OnDisconnect.set",this._path),oi("OnDisconnect.set",e,this._path,!1);let t=new Dt;return t2(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}setWithPriority(e,t){Mn("OnDisconnect.setWithPriority",this._path),oi("OnDisconnect.setWithPriority",e,this._path,!1),DS("OnDisconnect.setWithPriority",t,!1);let r=new Dt;return KY(this._repo,this._path,e,t,r.wrapCallback(()=>{})),r.promise}update(e){Mn("OnDisconnect.update",this._path),Z2("OnDisconnect.update",e,this._path,!1);let t=new Dt;return QY(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}};var pn=class n{constructor(e,t,r,i){this._repo=e,this._path=t,this._queryParams=r,this._orderByCalled=i}get key(){return _e(this._path)?null:cS(this._path)}get ref(){return new On(this._repo,this._path)}get _queryIdentifier(){let e=$V(this._queryParams),t=oS(e);return t==="{}"?"default":t}get _queryObject(){return $V(this._queryParams)}isEqual(e){if(e=q(e),!(e instanceof n))return!1;let t=this._repo===e._repo,r=lS(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return t&&r&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+dQ(this._path)}};function W_(n,e){if(n._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function Fs(n){let e=null,t=null;if(n.hasStart()&&(e=n.getIndexStartValue()),n.hasEnd()&&(t=n.getIndexEndValue()),n.getIndex()===ri){let r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(n.hasStart()){if(n.getIndexStartName()!==Ps)throw new Error(r);if(typeof e!="string")throw new Error(i)}if(n.hasEnd()){if(n.getIndexEndName()!==Mi)throw new Error(r);if(typeof t!="string")throw new Error(i)}}else if(n.getIndex()===ze){if(e!=null&&!Dh(e)||t!=null&&!Dh(t))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(B(n.getIndex()instanceof _h||n.getIndex()===hS,"unknown index type."),e!=null&&typeof e=="object"||t!=null&&typeof t=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function G_(n){if(n.hasStart()&&n.hasEnd()&&n.hasLimit()&&!n.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}var On=class n extends pn{constructor(e,t){super(e,t,new Ih,!1)}get parent(){let e=C2(this._path);return e===null?null:new n(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}},hl=class n{constructor(e,t,r){this._node=e,this.ref=t,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){let t=new xe(e),r=Ls(this.ref,e);return new n(this._node.getChild(t),r,ze)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(r,i)=>e(new n(i,Ls(this.ref,r),ze)))}hasChild(e){let t=new xe(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}};function NS(n,e){return n=q(n),n._checkNotDeleted("ref"),e!==void 0?Ls(n._root,e):n._root}function PS(n,e){n=q(n),n._checkNotDeleted("refFromURL");let t=zD(e,n._repo.repoInfo_.nodeAdmin);eU("refFromURL",t);let r=t.repoInfo;return!n._repo.repoInfo_.isCustomHost()&&r.host!==n._repo.repoInfo_.host&&ii("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+n._repo.repoInfo_.host+")"),NS(n,t.path.toString())}function Ls(n,e){return n=q(n),ge(n._path)===null?UY("child","path",e,!1):gl("child","path",e,!1),new On(n._repo,Xe(n._path,e))}function lU(n,e){n=q(n),Mn("push",n._path),oi("push",e,n._path,!0);let t=iU(n._repo),r=iJ(t),i=Ls(n,r),s=Ls(n,r),o;return e!=null?o=K_(s,e).then(()=>s):o=Promise.resolve(s),i.then=o.then.bind(o),i.catch=o.then.bind(o,void 0),i}function uU(n){return Mn("remove",n._path),K_(n,null)}function K_(n,e){n=q(n),Mn("set",n._path),oi("set",e,n._path,!1);let t=new Dt;return AS(n._repo,n._path,e,null,t.wrapCallback(()=>{})),t.promise}function dU(n,e){n=q(n),Mn("setPriority",n._path),DS("setPriority",e,!1);let t=new Dt;return AS(n._repo,Xe(n._path,".priority"),e,null,t.wrapCallback(()=>{})),t.promise}function hU(n,e,t){if(Mn("setWithPriority",n._path),oi("setWithPriority",e,n._path,!1),DS("setWithPriority",t,!1),n.key===".length"||n.key===".keys")throw"setWithPriority failed: "+n.key+" is a read-only object.";let r=new Dt;return AS(n._repo,n._path,e,t,r.wrapCallback(()=>{})),r.promise}function fU(n,e){Z2("update",e,n._path,!1);let t=new Dt;return zY(n._repo,n._path,e,t.wrapCallback(()=>{})),t.promise}function pU(n){n=q(n);let e=new Sh(()=>{}),t=new Ah(e);return qY(n._repo,n,t).then(r=>new hl(r,new On(n._repo,n._path),n._queryParams.getIndex()))}var Ah=class n{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,t){let r=t._queryParams.getIndex();return new D_("value",this,new hl(e.snapshotNode,new On(t._repo,t._path),r))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new S_(this,e,t):null}matches(e){return e instanceof n?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}},R_=class n{constructor(e,t){this.eventType=e,this.callbackContext=t}respondsTo(e){let t=e==="children_added"?"child_added":e;return t=t==="children_removed"?"child_removed":t,this.eventType===t}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new S_(this,e,t):null}createEvent(e,t){B(e.childName!=null,"Child events should have a childName.");let r=Ls(new On(t._repo,t._path),e.childName),i=t._queryParams.getIndex();return new D_(e.type,this,new hl(e.snapshotNode,r,i),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof n?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}};function Fh(n,e,t,r,i){let s;if(typeof r=="object"&&(s=void 0,i=r),typeof r=="function"&&(s=r),i&&i.onlyOnce){let c=t,l=(d,h)=>{qD(n._repo,n,a),c(d,h)};l.userCallback=t.userCallback,l.context=t.context,t=l}let o=new Sh(t,s||void 0),a=e==="value"?new Ah(o):new R_(e,o);return YY(n._repo,n,a),()=>qD(n._repo,n,a)}function Q_(n,e,t,r){return Fh(n,"value",e,t,r)}function MS(n,e,t,r){return Fh(n,"child_added",e,t,r)}function kS(n,e,t,r){return Fh(n,"child_changed",e,t,r)}function OS(n,e,t,r){return Fh(n,"child_moved",e,t,r)}function LS(n,e,t,r){return Fh(n,"child_removed",e,t,r)}function FS(n,e,t){let r=null,i=t?new Sh(t):null;e==="value"?r=new Ah(i):e&&(r=new R_(e,i)),qD(n._repo,n,r)}var Ln=class{},x_=class extends Ln{constructor(e,t){super(),this._value=e,this._key=t,this.type="endAt"}_apply(e){oi("endAt",this._value,e._path,!0);let t=ID(e._queryParams,this._value,this._key);if(G_(t),Fs(t),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new pn(e._repo,e._path,t,e._orderByCalled)}};function mU(n,e){return Oh("endAt","key",e,!0),new x_(n,e)}var WD=class extends Ln{constructor(e,t){super(),this._value=e,this._key=t,this.type="endBefore"}_apply(e){oi("endBefore",this._value,e._path,!1);let t=xQ(e._queryParams,this._value,this._key);if(G_(t),Fs(t),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new pn(e._repo,e._path,t,e._orderByCalled)}};function gU(n,e){return Oh("endBefore","key",e,!0),new WD(n,e)}var N_=class extends Ln{constructor(e,t){super(),this._value=e,this._key=t,this.type="startAt"}_apply(e){oi("startAt",this._value,e._path,!0);let t=wD(e._queryParams,this._value,this._key);if(G_(t),Fs(t),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new pn(e._repo,e._path,t,e._orderByCalled)}};function _U(n=null,e){return Oh("startAt","key",e,!0),new N_(n,e)}var GD=class extends Ln{constructor(e,t){super(),this._value=e,this._key=t,this.type="startAfter"}_apply(e){oi("startAfter",this._value,e._path,!1);let t=RQ(e._queryParams,this._value,this._key);if(G_(t),Fs(t),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new pn(e._repo,e._path,t,e._orderByCalled)}};function yU(n,e){return Oh("startAfter","key",e,!0),new GD(n,e)}var KD=class extends Ln{constructor(e){super(),this._limit=e,this.type="limitToFirst"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new pn(e._repo,e._path,SQ(e._queryParams,this._limit),e._orderByCalled)}};function vU(n){if(typeof n!="number"||Math.floor(n)!==n||n<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new KD(n)}var QD=class extends Ln{constructor(e){super(),this._limit=e,this.type="limitToLast"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new pn(e._repo,e._path,AQ(e._queryParams,this._limit),e._orderByCalled)}};function wU(n){if(typeof n!="number"||Math.floor(n)!==n||n<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new QD(n)}var YD=class extends Ln{constructor(e){super(),this._path=e,this.type="orderByChild"}_apply(e){W_(e,"orderByChild");let t=new xe(this._path);if(_e(t))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");let r=new _h(t),i=M_(e._queryParams,r);return Fs(i),new pn(e._repo,e._path,i,!0)}};function IU(n){if(n==="$key")throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if(n==="$priority")throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if(n==="$value")throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return gl("orderByChild","path",n,!1),new YD(n)}var JD=class extends Ln{constructor(){super(...arguments),this.type="orderByKey"}_apply(e){W_(e,"orderByKey");let t=M_(e._queryParams,ri);return Fs(t),new pn(e._repo,e._path,t,!0)}};function EU(){return new JD}var XD=class extends Ln{constructor(){super(...arguments),this.type="orderByPriority"}_apply(e){W_(e,"orderByPriority");let t=M_(e._queryParams,ze);return Fs(t),new pn(e._repo,e._path,t,!0)}};function TU(){return new XD}var ZD=class extends Ln{constructor(){super(...arguments),this.type="orderByValue"}_apply(e){W_(e,"orderByValue");let t=M_(e._queryParams,hS);return Fs(t),new pn(e._repo,e._path,t,!0)}};function bU(){return new ZD}var eS=class extends Ln{constructor(e,t){super(),this._value=e,this._key=t,this.type="equalTo"}_apply(e){if(oi("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new x_(this._value,this._key)._apply(new N_(this._value,this._key)._apply(e))}};function CU(n,e){return Oh("equalTo","key",e,!0),new eS(n,e)}function Zn(n,...e){let t=q(n);for(let r of e)t=r._apply(t);return t}dY(On);gY(On);var sJ="FIREBASE_DATABASE_EMULATOR_HOST",tS={},oJ=!1;function aJ(n,e,t,r){n.repoInfo_=new a_(`${e}:${t}`,!1,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0),r&&(n.authTokenProvider_=r)}function VS(n,e,t,r,i){let s=r||n.options.databaseURL;s===void 0&&(n.options.projectId||ii("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),kt("Using default host for project ",n.options.projectId),s=`${n.options.projectId}-default-rtdb.firebaseio.com`);let o=zD(s,i),a=o.repoInfo,c,l;typeof process<"u"&&process.env&&(l=process.env[sJ]),l?(c=!0,s=`http://${l}?ns=${a.namespace}`,o=zD(s,i),a=o.repoInfo):c=!o.repoInfo.secure;let d=i&&c?new dh(dh.OWNER):new sD(n.name,n.options,e);eU("Invalid Firebase Database URL",o),_e(o.path)||ii("Database URL must point to the root of a Firebase Database (not including a child path).");let h=lJ(a,n,d,new iD(n.name,t));return new nS(h,n)}function cJ(n,e){let t=tS[e];(!t||t[n.key]!==n)&&ii(`Database ${e}(${n.repoInfo_}) has already been deleted.`),sU(n),delete t[n.key]}function lJ(n,e,t,r){let i=tS[e.name];i||(i={},tS[e.name]=i);let s=i[n.toURLString()];return s&&ii("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new HD(n,oJ,t,r),i[n.toURLString()]=s,s}var nS=class{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||($Y(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new On(this._repo,Re())),this._rootInternal}_delete(){return this._rootInternal!==null&&(cJ(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&ii("Cannot call "+e+" on a deleted database.")}};function DU(){b2.IS_TRANSPORT_INITIALIZED&&Zt("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function SU(){DU(),mh.forceDisallow()}function AU(){DU(),nl.forceDisallow(),mh.forceAllow()}function RU(n,e,t,r={}){n=q(n),n._checkNotDeleted("useEmulator"),n._instanceStarted&&ii("Cannot call useEmulator() after instance has already been initialized.");let i=n._repoInternal,s;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&ii('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new dh(dh.OWNER);else if(r.mockUserToken){let o=typeof r.mockUserToken=="string"?r.mockUserToken:qa(r.mockUserToken,n.app.options.projectId);s=new dh(o)}aJ(i,e,t,s)}function xU(n){n=q(n),n._checkNotDeleted("goOffline"),sU(n._repo)}function NU(n){n=q(n),n._checkNotDeleted("goOnline"),JY(n._repo)}function PU(n,e){o2(n,e)}function uJ(n){sS(an),on(new Le("database",(e,{instanceIdentifier:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return VS(r,i,s,t)},"PUBLIC").setMultipleInstances(!0)),ut(CV,DV,n),ut(CV,DV,"esm2017")}var dJ={".sv":"timestamp"};function MU(){return dJ}function kU(n){return{".sv":{increment:n}}}var rS=class{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}};function OU(n,e,t){var r;if(n=q(n),Mn("Reference.transaction",n._path),n.key===".length"||n.key===".keys")throw"Reference.transaction failed: "+n.key+" is a read-only object.";let i=(r=t?.applyLocally)!==null&&r!==void 0?r:!0,s=new Dt,o=(c,l,d)=>{let h=null;c?s.reject(c):(h=new hl(d,new On(n._repo,n._path),ze),s.resolve(new rS(l,h)))},a=Q_(n,()=>{});return XY(n._repo,n._path,e,o,a,i),s.promise}uS.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)};uS.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)};uJ();var hJ="@firebase/database-compat",fJ="1.0.7";var pJ=new vn("@firebase/database-compat"),LU=function(n){let e="FIREBASE WARNING: "+n;pJ.warn(e)};var mJ=function(n,e,t,r){if(!(r&&t===void 0)&&typeof t!="boolean")throw new Error(Kt(n,e)+"must be a boolean.")},gJ=function(n,e,t){if(!(t&&e===void 0))switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(Kt(n,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}};var US=class{constructor(e){this._delegate=e}cancel(e){re("OnDisconnect.cancel",0,1,arguments.length),St("OnDisconnect.cancel","onComplete",e,!0);let t=this._delegate.cancel();return e&&t.then(()=>e(null),r=>e(r)),t}remove(e){re("OnDisconnect.remove",0,1,arguments.length),St("OnDisconnect.remove","onComplete",e,!0);let t=this._delegate.remove();return e&&t.then(()=>e(null),r=>e(r)),t}set(e,t){re("OnDisconnect.set",1,2,arguments.length),St("OnDisconnect.set","onComplete",t,!0);let r=this._delegate.set(e);return t&&r.then(()=>t(null),i=>t(i)),r}setWithPriority(e,t,r){re("OnDisconnect.setWithPriority",2,3,arguments.length),St("OnDisconnect.setWithPriority","onComplete",r,!0);let i=this._delegate.setWithPriority(e,t);return r&&i.then(()=>r(null),s=>r(s)),i}update(e,t){if(re("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){let i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,LU("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}St("OnDisconnect.update","onComplete",t,!0);let r=this._delegate.update(e);return t&&r.then(()=>t(null),i=>t(i)),r}};var jS=class{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return re("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}};var na=class n{constructor(e,t){this._database=e,this._delegate=t}val(){return re("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return re("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return re("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return re("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return re("DataSnapshot.child",0,1,arguments.length),e=String(e),gl("DataSnapshot.child","path",e,!1),new n(this._database,this._delegate.child(e))}hasChild(e){return re("DataSnapshot.hasChild",1,1,arguments.length),gl("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return re("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return re("DataSnapshot.forEach",1,1,arguments.length),St("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(t=>e(new n(this._database,t)))}hasChildren(){return re("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return re("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return re("DataSnapshot.ref",0,0,arguments.length),new ki(this._database,this._delegate.ref)}get ref(){return this.getRef()}},Y_=class n{constructor(e,t){this.database=e,this._delegate=t}on(e,t,r,i){var s;re("Query.on",2,4,arguments.length),St("Query.on","callback",t,!1);let o=n.getCancelAndContextArgs_("Query.on",r,i),a=(l,d)=>{t.call(o.context,new na(this.database,l),d)};a.userCallback=t,a.context=o.context;let c=(s=o.cancel)===null||s===void 0?void 0:s.bind(o.context);switch(e){case"value":return Q_(this._delegate,a,c),t;case"child_added":return MS(this._delegate,a,c),t;case"child_removed":return LS(this._delegate,a,c),t;case"child_changed":return kS(this._delegate,a,c),t;case"child_moved":return OS(this._delegate,a,c),t;default:throw new Error(Kt("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,t,r){if(re("Query.off",0,3,arguments.length),gJ("Query.off",e,!0),St("Query.off","callback",t,!0),RI("Query.off","context",r,!0),t){let i=()=>{};i.userCallback=t,i.context=r,FS(this._delegate,e,i)}else FS(this._delegate,e)}get(){return pU(this._delegate).then(e=>new na(this.database,e))}once(e,t,r,i){re("Query.once",1,4,arguments.length),St("Query.once","callback",t,!0);let s=n.getCancelAndContextArgs_("Query.once",r,i),o=new Dt,a=(l,d)=>{let h=new na(this.database,l);t&&t.call(s.context,h,d),o.resolve(h)};a.userCallback=t,a.context=s.context;let c=l=>{s.cancel&&s.cancel.call(s.context,l),o.reject(l)};switch(e){case"value":Q_(this._delegate,a,c,{onlyOnce:!0});break;case"child_added":MS(this._delegate,a,c,{onlyOnce:!0});break;case"child_removed":LS(this._delegate,a,c,{onlyOnce:!0});break;case"child_changed":kS(this._delegate,a,c,{onlyOnce:!0});break;case"child_moved":OS(this._delegate,a,c,{onlyOnce:!0});break;default:throw new Error(Kt("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return o.promise}limitToFirst(e){return re("Query.limitToFirst",1,1,arguments.length),new n(this.database,Zn(this._delegate,vU(e)))}limitToLast(e){return re("Query.limitToLast",1,1,arguments.length),new n(this.database,Zn(this._delegate,wU(e)))}orderByChild(e){return re("Query.orderByChild",1,1,arguments.length),new n(this.database,Zn(this._delegate,IU(e)))}orderByKey(){return re("Query.orderByKey",0,0,arguments.length),new n(this.database,Zn(this._delegate,EU()))}orderByPriority(){return re("Query.orderByPriority",0,0,arguments.length),new n(this.database,Zn(this._delegate,TU()))}orderByValue(){return re("Query.orderByValue",0,0,arguments.length),new n(this.database,Zn(this._delegate,bU()))}startAt(e=null,t){return re("Query.startAt",0,2,arguments.length),new n(this.database,Zn(this._delegate,_U(e,t)))}startAfter(e=null,t){return re("Query.startAfter",0,2,arguments.length),new n(this.database,Zn(this._delegate,yU(e,t)))}endAt(e=null,t){return re("Query.endAt",0,2,arguments.length),new n(this.database,Zn(this._delegate,mU(e,t)))}endBefore(e=null,t){return re("Query.endBefore",0,2,arguments.length),new n(this.database,Zn(this._delegate,gU(e,t)))}equalTo(e,t){return re("Query.equalTo",1,2,arguments.length),new n(this.database,Zn(this._delegate,CU(e,t)))}toString(){return re("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return re("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if(re("Query.isEqual",1,1,arguments.length),!(e instanceof n)){let t="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(t)}return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,t,r){let i={cancel:void 0,context:void 0};if(t&&r)i.cancel=t,St(e,"cancel",i.cancel,!0),i.context=r,RI(e,"context",i.context,!0);else if(t)if(typeof t=="object"&&t!==null)i.context=t;else if(typeof t=="function")i.cancel=t;else throw new Error(Kt(e,"cancelOrContext")+" must either be a cancel callback or a context object.");return i}get ref(){return new ki(this.database,new On(this._delegate._repo,this._delegate._path))}},ki=class n extends Y_{constructor(e,t){super(e,new pn(t._repo,t._path,new Ih,!1)),this.database=e,this._delegate=t}getKey(){return re("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return re("Reference.child",1,1,arguments.length),typeof e=="number"&&(e=String(e)),new n(this.database,Ls(this._delegate,e))}getParent(){re("Reference.parent",0,0,arguments.length);let e=this._delegate.parent;return e?new n(this.database,e):null}getRoot(){return re("Reference.root",0,0,arguments.length),new n(this.database,this._delegate.root)}set(e,t){re("Reference.set",1,2,arguments.length),St("Reference.set","onComplete",t,!0);let r=K_(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}update(e,t){if(re("Reference.update",1,2,arguments.length),Array.isArray(e)){let i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,LU("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Mn("Reference.update",this._delegate._path),St("Reference.update","onComplete",t,!0);let r=fU(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}setWithPriority(e,t,r){re("Reference.setWithPriority",2,3,arguments.length),St("Reference.setWithPriority","onComplete",r,!0);let i=hU(this._delegate,e,t);return r&&i.then(()=>r(null),s=>r(s)),i}remove(e){re("Reference.remove",0,1,arguments.length),St("Reference.remove","onComplete",e,!0);let t=uU(this._delegate);return e&&t.then(()=>e(null),r=>e(r)),t}transaction(e,t,r){re("Reference.transaction",1,3,arguments.length),St("Reference.transaction","transactionUpdate",e,!1),St("Reference.transaction","onComplete",t,!0),mJ("Reference.transaction","applyLocally",r,!0);let i=OU(this._delegate,e,{applyLocally:r}).then(s=>new jS(s.committed,new na(this.database,s.snapshot)));return t&&i.then(s=>t(null,s.committed,s.snapshot),s=>t(s,!1,null)),i}setPriority(e,t){re("Reference.setPriority",1,2,arguments.length),St("Reference.setPriority","onComplete",t,!0);let r=dU(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}push(e,t){re("Reference.push",0,2,arguments.length),St("Reference.push","onComplete",t,!0);let r=lU(this._delegate,e),i=r.then(o=>new n(this.database,o));t&&i.then(()=>t(null),o=>t(o));let s=new n(this.database,r);return s.then=i.then.bind(i),s.catch=i.catch.bind(i,void 0),s}onDisconnect(){return Mn("Reference.onDisconnect",this._delegate._path),new US(new A_(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}};var ra=class{constructor(e,t){this._delegate=e,this.app=t,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:SU,forceLongPolling:AU}}useEmulator(e,t,r={}){RU(this._delegate,e,t,r)}ref(e){if(re("database.ref",0,1,arguments.length),e instanceof ki){let t=PS(this._delegate,e.toString());return new ki(this,t)}else{let t=NS(this._delegate,e);return new ki(this,t)}}refFromURL(e){re("database.refFromURL",1,1,arguments.length);let r=PS(this._delegate,e);return new ki(this,r)}goOffline(){return re("database.goOffline",0,0,arguments.length),xU(this._delegate)}goOnline(){return re("database.goOnline",0,0,arguments.length),NU(this._delegate)}};ra.ServerValue={TIMESTAMP:MU(),increment:n=>kU(n)};function _J({app:n,url:e,version:t,customAuthImpl:r,customAppCheckImpl:i,namespace:s,nodeAdmin:o=!1}){sS(t);let a=new ts("database-standalone"),c=new ao("auth-internal",a);c.setComponent(new Le("auth-internal",()=>r,"PRIVATE"));let l;return i&&(l=new ao("app-check-internal",a),l.setComponent(new Le("app-check-internal",()=>i,"PRIVATE"))),{instance:new ra(VS(n,c,l,e,o),n),namespace:s}}var yJ=Object.freeze({__proto__:null,initStandalone:_J});var vJ=ra.ServerValue;function wJ(n){n.INTERNAL.registerComponent(new Le("database-compat",(e,{instanceIdentifier:t})=>{let r=e.getProvider("app-compat").getImmediate(),i=e.getProvider("database").getImmediate({identifier:t});return new ra(i,r)},"PUBLIC").setServiceProps({Reference:ki,Query:Y_,Database:ra,DataSnapshot:na,enableLogging:PU,INTERNAL:yJ,ServerValue:vJ}).setMultipleInstances(!0)),n.registerVersion(hJ,fJ)}wJ(Fe);var FU=(()=>{let e=class e{constructor(){}ngOnInit(){this.checkBookedTables(),this.checkIfEsternoIsEnabled()}checkPeopleLimit(){let r=document.getElementById("numero-persone-prenotazione-input");Number(r.value)>4&&(r.value="",alert("Per effettuare una prenotazione per pi\xF9 di 4 persone contattaci al numero: 040 233 46 09"))}reserveTable(r,i){let s=new Date,o=new Date(s.getFullYear(),s.getMonth(),s.getDate()+1).getTime();Fe.database().ref("tables/"+i+r).once("value",c=>{if(c.exists()){let l=c.val();console.log("Timestamp salvato:",l),console.log("Timestamp di mezzanotte:",o),l<o?alert("Non puoi prenotare questo tavolo perch\xE9 \xE8 gi\xE0 prenotato"):this.sendBookEmail(i,r)}else this.sendBookEmail(i,r)})}sendBookEmail(r,i){if(confirm("Sei sicuro di voler prenotare il tavolo "+i+" nella zona "+r+"?")){document.getElementById("numero-tavolo-prenotazione-input").value=i+"",document.getElementById("zona-tavolo-prenotazione-input").value=r+"";let s=document.getElementById("form"),o=document.getElementById("result");Fe.database().ref("tables/").update({[r+i]:Fe.database.ServerValue.TIMESTAMP});let a=new FormData(s),c={};a.forEach((d,h)=>{c[h]=d});let l=JSON.stringify(c);o.innerHTML="Please wait...",fetch("https://api.web3forms.com/submit",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:l}).then(d=>g(this,null,function*(){let h=yield d.json();d.status==200?(o.innerHTML="Form submitted successfully",alert("Prenotazione confermata con successo")):(console.log(d),o.innerHTML=h.message)})).catch(d=>{console.log(d),o.innerHTML="Something went wrong!"}).then(function(){s.reset(),setTimeout(()=>{o.style.display="none"},3e3)})}}checkBookedTables(){let r=new Date,i=new Date(r.getFullYear(),r.getMonth(),r.getDate()).getTime();Fe.database().ref("tables").on("value",s=>{s.forEach(o=>{o.val()>i&&(document.getElementById(o.key).style.background="red")})})}checkIfEsternoIsEnabled(){Fe.database().ref("admin/esterno").on("value",r=>{console.log(r.val()),r.val()==!1?document.getElementById("esterno-table-selector").style.display="none":document.getElementById("esterno-table-selector").style.display="flex"})}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=Nt({type:e,selectors:[["app-prenota"]],decls:170,vars:0,consts:[[2,"width","100%","height","100%","display","none","flex-direction","column","align-items","center","justify-content","center"],[2,"height","100%","display","flex","flex-direction","column","align-items","center","overflow-y","auto","overflow-x","hidden"],[2,"margin-top","4rem","width","100%"],[2,"width","100%","max-width","50rem","display","flex","flex-direction","row","justify-content","start"],["src","assets\\svg\\Osteria logo jj_sono ghirigori.svg",2,"width","14rem","height","5rem","object-fit","cover","margin-left","-3rem"],[2,"width","calc(100% - 2rem)","max-width","50rem","display","flex","flex-direction","column","gap","1rem","margin-left","1rem","margin-right","1rem"],[2,"margin-bottom","0rem","width","100%","text-align","center","font-size","2.2rem"],[2,"margin-top","0.5rem","color","aliceblue","width","100%","text-align","center","font-size","1.5rem","margin-bottom","0rem"],[2,"margin-top","0.5rem","color","aliceblue","width","100%","text-align","center","font-size","0.9rem"],["method","POST","id","form"],["type","hidden","name","access_key","value","c21d3c4e-0d2f-417c-a5e8-e23a2a8f83fc"],["type","checkbox","name","botcheck",1,"hidden",2,"display","none"],["id","result"],[2,"width","100%","display","flex","flex-direction","row","gap","1rem","flex-wrap","wrap"],[2,"display","flex","flex-direction","column","flex","1","min-width","5rem"],["for","nome-prenotazione-input"],["id","nome-prenotazione-input","type","text","name","Nome","placeholder","James",1,"input"],["for","cognome-prenotazione-input"],["id","cognome-prenotazione-input","type","text","name","Cognome","placeholder","Joyce",1,"input"],["type","text","name","Numero Tavolo","id","numero-tavolo-prenotazione-input",2,"display","none"],["type","text","name","Zona Tavolo","id","zona-tavolo-prenotazione-input",2,"display","none"],["for","inizio-prenotazione-input"],["type","date","name","Giorno","placeholder","Giorno",1,"input"],["id","inizio-prenotazione-input","name","Orario","type","time","placeholder","Inizio",1,"input"],["for","numero-persone-prenotazione-input"],["id","numero-persone-prenotazione-input","name","Numero Persone","type","number",1,"input",3,"change"],[2,"display","flex","flex-direction","column","flex","1","min-width","10rem"],["for","telefono-prenotazione-input"],["id","telefono-prenotazione-input","name","Telefono","type","text","placeholder","",1,"input"],["for","email-prenotazione-input"],["id","email-prenotazione-input","type","email","name","email","placeholder","",1,"input"],[2,"margin-bottom","0rem"],[2,"display","flex","flex-direction","row","flex-wrap","wrap","gap","2rem"],[2,"width","100%"],[1,"desktop-responsive-summary",2,"height","13rem"],[2,"width","100%","display","flex","flex-direction","column"],["src","assets\\imgs\\vetrate\\tempImagexNSzRP.jpg","alt","Slide 1",1,"desktop-responsive-image",2,"height","10rem","object-fit","cover","object-position","bottom"],[2,"max-width","18rem","width","100%","display","flex","flex-direction","column","gap","3rem","border","1px solid white","overflow-x","hidden","margin-top","1rem","border-radius","0.5rem","padding","0.4rem","max-width","18rem","width","100%"],[2,"display","flex","flex-direction","row"],[2,"margin-top","1rem","margin-left","3rem"],["id","SalaPrincipale1",1,"table",2,"width","3rem","height","6rem",3,"click"],[2,"flex","1"],[2,"display","flex","flex-direction","row","gap","2rem","margin-top","1rem"],["id","SalaPrincipale2",1,"table",2,"width","3rem","height","3rem",3,"click"],["id","SalaPrincipale3",1,"table",2,"width","3rem","height","3rem",3,"click"],[2,"display","flex","flex-direction","row","gap","1rem"],["id","SalaPrincipale4",1,"table",2,"width","6rem","height","3rem",3,"click"],[2,"display","flex","flex-direction","row","gap","2rem"],["id","SalaPrincipale5",1,"table",2,"width","3rem","height","3rem",3,"click"],["id","SalaPrincipale6",1,"table",2,"width","3rem","height","3rem",3,"click"],[2,"display","flex","flex-direction","row","gap","1.5rem"],[2,"display","flex","flex-direction","row","justify-content","center"],["id","SalaPrincipale7",1,"table",2,"width","6rem","height","3rem",3,"click"],[2,"display","flex","flex-direction","row","justify-content","center","transform","rotateZ(45deg)","margin-top","2rem","margin-right","2rem"],["id","SalaPrincipale8",1,"table",2,"width","6rem","height","3rem",3,"click"],[2,"display","flex","flex-direction","row","justify-content","end"],[2,"display","flex","flex-direction","row","justify-content","center","margin-top","2rem"],[1,"table",2,"width","14rem","height","11rem","border-start-start-radius","6rem","border-end-start-radius","6rem","display","flex","align-items","center","justify-content","center","border-right","10px solid brown"],[2,"transform","rotateZ(-90deg)"],[2,"width","2px","height","100%","border-left","1px solid brown"],["src","assets\\imgs\\fronte-banco\\tempImageFApL2m.jpg","alt","Slide 1",1,"desktop-responsive-image",2,"height","10rem","object-fit","cover"],[2,"width","100%","display","flex","flex-direction","column","gap","3rem","border","1px solid white","margin-top","1rem","border-radius","0.5rem","padding-top","2rem","max-width","18rem","width","100%"],[2,"display","flex","flex-direction","row","align-items","center","justify-content","center","gap","5rem"],["id","Pianoforte9",1,"table",2,"width","4rem","height","4rem","transform","rotateZ(45deg)",3,"click"],["id","Pianoforte10",1,"table",2,"width","4rem","height","4rem","transform","rotateZ(45deg)",3,"click"],[2,"display","flex","flex-direction","row","display","flex","align-items","center","justify-content","center"],["id","Pianoforte11",1,"table",2,"width","4rem","height","4rem","margin-left","2rem","transform","rotateZ(45deg)",3,"click"],[1,"table",2,"width","100%","height","5rem","border-start-start-radius","8rem","border-start-end-radius","8rem","display","flex","align-items","center","justify-content","center"],["id","esterno-table-selector",2,"width","100%"],["src","assets\\imgs\\esterno\\tempImageOEU8vP.jpg","alt","Slide 1",1,"desktop-responsive-image",2,"height","10rem","object-fit","cover"],[2,"width","100%","display","flex","flex-direction","column","gap","3rem","border","1px solid white","margin-top","1rem","border-radius","0.5rem","padding","0.4rem","max-width","18rem","width","100%"],["id","Esterno1",1,"table",2,"width","8rem","height","4rem",3,"click"],["id","Esterno2",1,"table",2,"width","4rem","height","4rem",3,"click"],["id","Esterno3",1,"table",2,"width","8rem","height","4rem",3,"click"],["id","Esterno4",1,"table",2,"width","4rem","height","4rem",3,"click"],[2,"display","flex","flex-direction","row","margin-top","2rem"],["id","Esterno5",1,"table",2,"width","8rem","height","4rem",3,"click"],["id","Esterno6",1,"table",2,"width","4rem","height","4rem",3,"click"],["id","Esterno7",1,"table",2,"width","8rem","height","4rem",3,"click"],[2,"height","4rem","width","1rem","background","brown","display","flex","align-items","center","justify-content","center"],[2,"transform","rotateZ(-90deg)","margin-right","1rem","margin-top","0rem","margin-bottom","0rem"],["id","Esterno8",1,"table",2,"width","8rem","height","4rem",3,"click"],["id","Esterno9",1,"table",2,"width","4rem","height","4rem","margin-top","0.5rem",3,"click"],["id","Esterno10",1,"table",2,"width","8rem","height","4rem",3,"click"],["id","Esterno11",1,"table",2,"width","8rem","height","4rem",3,"click"],["id","Esterno12",1,"table",2,"width","4rem","height","4rem","margin-bottom","0.5rem",3,"click"],[2,"width","100%","max-width","50rem","display","flex","flex-direction","row","justify-content","end","margin-bottom","4rem"],["src","assets\\svg\\Osteria logo jj_sono ghirigori.svg",2,"width","14rem","height","5rem","object-fit","cover","margin-right","-1.8rem"],[2,"background","black","padding-top","2rem","width","100%"],[2,"margin-left","-1rem","width","100%"]],template:function(i,s){i&1&&(k(0,"div",0)(1,"p"),F(2,"Working Progress"),M()(),k(3,"div",1),K(4,"div",2),k(5,"div",3),K(6,"img",4),M(),k(7,"div",5)(8,"div")(9,"h1",6),F(10,"NUOVA PRENOTAZIONE"),M(),k(11,"p",7),F(12,"Prenota il tuo tavolo direttamente da qui:"),M(),k(13,"p",8),F(14,"*Massimo 4 persone per prenotazione sul sito, contattaci per estendere questo limite"),M()(),k(15,"form",9),K(16,"input",10)(17,"input",11)(18,"div",12),k(19,"div",13)(20,"div",14)(21,"label",15),F(22,"Nome"),M(),K(23,"input",16),M(),k(24,"div",14)(25,"label",17),F(26,"Cognome"),M(),K(27,"input",18),M()(),K(28,"input",19)(29,"input",20),k(30,"div",13)(31,"div",14)(32,"label",21),F(33,"Data"),M(),K(34,"input",22),M(),k(35,"div",14)(36,"label",21),F(37,"Orario"),M(),K(38,"input",23),M()(),k(39,"div",13)(40,"div",14)(41,"label",24),F(42,"Numero persone"),M(),k(43,"input",25),fe("change",function(){return s.checkPeopleLimit()}),M()()(),k(44,"div",13)(45,"div",26)(46,"label",27),F(47,"Telefono"),M(),K(48,"input",28),M(),k(49,"div",26)(50,"label",29),F(51,"Email"),M(),K(52,"input",30),M()()(),k(53,"h2",31),F(54,"Zone"),M(),k(55,"div",32)(56,"details",33)(57,"summary",34)(58,"div",35),K(59,"img",36),k(60,"h3"),F(61,"Sala Principale"),M()()(),k(62,"div",37)(63,"div",38)(64,"div",39)(65,"div",40),fe("click",function(){return s.reserveTable(1,"SalaPrincipale")}),F(66,"1"),M()(),K(67,"div",41),k(68,"div",42)(69,"div",43),fe("click",function(){return s.reserveTable(2,"SalaPrincipale")}),F(70,"2"),M(),k(71,"div",44),fe("click",function(){return s.reserveTable(3,"SalaPrincipale")}),F(72,"3"),M()()(),k(73,"div",45)(74,"div",38)(75,"div",46),fe("click",function(){return s.reserveTable(4,"SalaPrincipale")}),F(76,"4"),M()(),K(77,"div",41),k(78,"div",47)(79,"div",48),fe("click",function(){return s.reserveTable(5,"SalaPrincipale")}),F(80,"5"),M(),k(81,"div",49),fe("click",function(){return s.reserveTable(6,"SalaPrincipale")}),F(82,"6"),M()()(),k(83,"div",50)(84,"div",51)(85,"div",52),fe("click",function(){return s.reserveTable(7,"SalaPrincipale")}),F(86,"7"),M()(),K(87,"div",41),k(88,"div",53)(89,"div",54),fe("click",function(){return s.reserveTable(8,"SalaPrincipale")}),F(90,"8"),M()()(),k(91,"div",55)(92,"div",56)(93,"div",57)(94,"p",58),F(95,"Banco"),M(),K(96,"div",59),k(97,"p",58),F(98,"Entrata"),M()()()()()(),k(99,"details",33)(100,"summary",34)(101,"div",35),K(102,"img",60),k(103,"h3"),F(104,"Pianoforte"),M()()(),k(105,"div",61)(106,"div",62)(107,"div",63),fe("click",function(){return s.reserveTable(9,"Pianoforte")}),F(108,"9"),M(),k(109,"div",64),fe("click",function(){return s.reserveTable(10,"Pianoforte")}),F(110,"10"),M()(),k(111,"div",65)(112,"div",66),fe("click",function(){return s.reserveTable(11,"Pianoforte")}),F(113,"11"),M()(),k(114,"div",51)(115,"div",67)(116,"p"),F(117,"Pianoforte"),M()()()()(),k(118,"details",68)(119,"summary",34)(120,"div",35),K(121,"img",69),k(122,"h3"),F(123,"Esterno"),M()()(),k(124,"div",70)(125,"div",38)(126,"div",71),fe("click",function(){return s.reserveTable(1,"Esterno")}),F(127,"1"),M(),K(128,"div",41),k(129,"div",72),fe("click",function(){return s.reserveTable(2,"Esterno")}),F(130,"2"),M()(),k(131,"div",38)(132,"div",73),fe("click",function(){return s.reserveTable(3,"Esterno")}),F(133,"3"),M(),K(134,"div",41),k(135,"div",74),fe("click",function(){return s.reserveTable(4,"Esterno")}),F(136,"4"),M()(),k(137,"div",75)(138,"div",76),fe("click",function(){return s.reserveTable(5,"Esterno")}),F(139,"5"),M(),K(140,"div",41),k(141,"div",77),fe("click",function(){return s.reserveTable(6,"Esterno")}),F(142,"6"),M()(),k(143,"div",38)(144,"div",78),fe("click",function(){return s.reserveTable(7,"Esterno")}),F(145,"7"),M(),K(146,"div",41),k(147,"div",79)(148,"p",80),F(149,"Ingresso"),M()()(),k(150,"div",75)(151,"div",81),fe("click",function(){return s.reserveTable(8,"Esterno")}),F(152,"8"),M(),K(153,"div",41),k(154,"div",82),fe("click",function(){return s.reserveTable(9,"Esterno")}),F(155,"9"),M()(),k(156,"div",51)(157,"div",83),fe("click",function(){return s.reserveTable(10,"Esterno")}),F(158,"10"),M(),K(159,"div",41),M(),k(160,"div",75)(161,"div",84),fe("click",function(){return s.reserveTable(11,"Esterno")}),F(162,"11"),M(),K(163,"div",41),k(164,"div",85),fe("click",function(){return s.reserveTable(12,"Esterno")}),F(165,"12"),M()()()()()(),k(166,"div",86),K(167,"img",87),M(),k(168,"div",88),K(169,"app-footer",89),M()())},dependencies:[Or]});let n=e;return n})();var VU=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=Nt({type:e,selectors:[["app-menu"]],decls:38,vars:0,consts:[[2,"width","100%","height","100%","overflow-y","auto","overflow-x","hidden"],[2,"margin-top","7rem","font-size","3rem","width","100%","text-align","center","margin-bottom","0rem"],[2,"width","100%","font-size","1.2rem","text-align","center","margin-top","0.5rem"],[2,"width","100%","display","flex","flex-direction","column","align-items","center","margin-top","4rem","gap","3rem"],[2,"max-width","30rem","width","100%","display","flex","flex-direction","column","gap","1rem"],[2,"width","100%","margin-bottom","0.5rem"],[1,"details"],[1,"summary"],[2,"font-size","1.8rem"],[2,"display","flex","flex-direction","column","gap","0.8rem","padding-top","0.8rem","padding-left","2rem"],["src",ou`assets\\pdf\\ita\\Menu-.html`,"frameborder","0",2,"max-width","30rem","width","100%","height","30rem","overflow-y","auto","overflow-x","hidden","zoom","200%"],["src",ou`assets\\pdf\\ita\\Menu-Dessert.html`,"frameborder","0",2,"max-width","30rem","width","100%","height","30rem","overflow-y","auto","overflow-x","hidden","zoom","200%"],[2,"max-width","30rem","width","100%","display","none","flex-direction","column","gap","1rem"],[2,"width","100%","margin-top","2rem"],["src",ou`assets\\pdf\\eng\\menu-_Inglese_.html`,"frameborder","0",2,"max-width","30rem","width","100%","height","30rem","overflow-y","auto","overflow-x","hidden","zoom","200%"],["src",ou`assets\\pdf\\eng\\Dessert-Inglese.-pdf.html`,"frameborder","0",2,"max-width","30rem","width","100%","height","30rem","overflow-y","auto","overflow-x","hidden","zoom","200%"],[2,"width","100%","padding-top","4rem","background","black","margin-top","5rem"]],template:function(i,s){i&1&&(k(0,"div",0)(1,"h1",1),F(2,"MEN\xD9"),M(),k(3,"p",2),F(4,"Scopri i sapori dell'osteria James Joyce"),M(),k(5,"div",3)(6,"div",4)(7,"h3",5),F(8,"Italian"),M(),k(9,"details",6)(10,"summary",7)(11,"h3",8),F(12,"RISTORANTE"),M()(),K(13,"div",9)(14,"iframe",10),M(),k(15,"details",6)(16,"summary",7)(17,"h3",8),F(18,"DESSERT"),M()(),K(19,"div",9)(20,"iframe",11),M()(),k(21,"div",12)(22,"h3",13),F(23,"English"),M(),k(24,"details",6)(25,"summary",7)(26,"h3",8),F(27,"RESTURANT"),M()(),K(28,"div",9)(29,"iframe",14),M(),k(30,"details",6)(31,"summary",7)(32,"h3",8),F(33,"DESSERT"),M()(),K(34,"div",9)(35,"iframe",15),M()()(),k(36,"div",16),K(37,"app-footer"),M()())},dependencies:[Or]});let n=e;return n})();var UU=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=Nt({type:e,selectors:[["app-lavora-con-noi"]],decls:15,vars:0,consts:[[2,"width","100%","height","100%","overflow-y","auto","overflow-x","hidden"],[2,"height","8rem","width","100%"],[2,"width","100%","display","flex","flex-direction","row","flex-wrap","wrap","align-items","center","justify-content","center","gap","5rem"],["src","assets\\imgs\\Jj 1 .jpg",2,"width","18rem","object-fit","cover","object-position","center","border-radius","1rem"],[2,"display","flex","flex-direction","column","align-items","center","max-width","20rem","padding-left","1rem"],[2,"width","100%"],[2,"width","100%","margin-top","0rem"],["href","mailto:info@osteriajamesjoyce.it",1,"a1",2,"font-size","1rem"]],template:function(i,s){i&1&&(k(0,"div",0),K(1,"div",1),k(2,"div",2),K(3,"img",3),k(4,"div",4)(5,"h1",5),F(6,"Lavora con noi"),M(),k(7,"p",5),F(8,"Cerchiamo collaboratori che condividano i nostri valori di ospitalit\xE0, passione e professionalit\xE0 nel lavoro."),M(),k(9,"p",6),F(10,"Se anche tu vuoi entrare a far palte del team invia una mail con il tuo CV all'indirizzo "),k(11,"a",7),F(12,"info@osteriajamesjoyce.it"),M()()()(),K(13,"div",1)(14,"app-footer"),M())},dependencies:[Or]});let n=e;return n})();var jU=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=Nt({type:e,selectors:[["app-contattaci"]],decls:19,vars:0,consts:[[2,"width","100%","height","100%","overflow-y","auto","overflow-x","hidden"],[2,"height","8rem","width","100%"],[1,"column-reverse-responsive-div",2,"display","flex","flex-direction","row","align-items","center","justify-content","center","gap","5rem"],["src","assets\\imgs\\tempImageFEw6QP.jpg",2,"width","18rem","border-radius","1rem"],[1,"responsive-margin-left"],[2,"margin-bottom","0rem"],[2,"max-width","20rem","margin-top","0.5rem","margin-right","1rem"],[2,"width","100%","display","flex","flex-direction","row","align-items","center","gap","1rem","flex-wrap","wrap"],["href","tel:+390402334609",1,"button-a"],["href","mailto:lavorocristian9@gmail.com",1,"button-a"],["href","https://www.instagram.com/osteria_jamesjoyce?igsh=MTZseGsxcmpneWd2OQ%3D%3D&utm_source=qr",1,"button-a"],[2,"width","100%","background","black","padding-top","4rem"]],template:function(i,s){i&1&&(k(0,"div",0),K(1,"div",1),k(2,"div",2),K(3,"img",3),k(4,"div",4)(5,"h1",5),F(6,"Contattaci"),M(),k(7,"p",6),F(8,"Contattaci e seguici sui nostri canali per restare aggiornato"),M(),k(9,"div",7)(10,"a",8),F(11,"+39 040 233 4609"),M(),k(12,"a",9),F(13,"Email"),M(),k(14,"a",10),F(15,"Instagram"),M()()()(),K(16,"div",1),k(17,"div",11),K(18,"app-footer"),M()())},dependencies:[Or]});let n=e;return n})();var BU=(()=>{let e=class e{constructor(r){this.router=r}ngOnInit(){Fe.auth().onAuthStateChanged(r=>{r?(document.getElementById("admin-email-display").innerText=r.email,document.getElementById("admin-div").style.display="flex",document.getElementById("login-div").style.display="none",this.checkIfAdminEsternoIsEnabled()):(document.getElementById("admin-div").style.display="none",document.getElementById("login-div").style.display="flex")})}login(){let r=document.getElementById("login-email-input"),i=document.getElementById("login-password-input");Fe.auth().signInWithEmailAndPassword(r.value,i.value).then(s=>{document.getElementById("admin-div").style.display="flex"}).catch(s=>{document.getElementById("admin-div").style.display="none",alert("Accesso fallito: "+s.message)})}logout(){confirm("Sei sicuro di volerti disconnettere?")&&Fe.auth().signOut().then(()=>{this.router.navigate(["/home"]),alert("Disconnesso con successo")}).catch(r=>{alert("Errore durante il logout: "+r.message)})}changeEsternoCheckbox(){let r=document.getElementById("show-esterno-checkbox");r.checked?confirm("Sei sicuro di ATTIVARE la parte esterna del ristorante per le prenotazioni?")?Fe.database().ref("admin").update({esterno:!0}):r.checked=!1:confirm("Sei sicuro di DISATTIVARE la parte esterna del ristorante per le prenotazioni?")?Fe.database().ref("admin").update({esterno:!1}):r.checked=!0}checkIfAdminEsternoIsEnabled(){let r=document.getElementById("show-esterno-checkbox");Fe.database().ref("admin/esterno").on("value",i=>{i.val()==!1?r.checked=!1:r.checked=!0})}};e.\u0275fac=function(i){return new(i||e)($n(kr))},e.\u0275cmp=Nt({type:e,selectors:[["app-admin"]],decls:21,vars:0,consts:[["id","login-div",2,"height","100%","width","100%","display","none","flex-direction","column","align-items","center","overflow-y","auto","overflow-x","hidden","gap","1rem"],[2,"height","5rem"],["id","login-email-input","type","text","placeholder","Email",1,"input",2,"width","100%","max-width","18rem"],["id","login-password-input","type","text","placeholder","Password",1,"input",2,"width","100%","max-width","18rem"],[1,"button-a",2,"width","8rem",3,"click"],["id","admin-div",2,"height","100%","width","100%","display","none","flex-direction","column","align-items","center","overflow-y","auto","overflow-x","hidden","gap","1rem"],["id","admin-email-display"],[2,"width","100%","display","flex","flex-direction","row","align-items","center","justify-content","center","gap","0.5rem"],["type","checkbox","id","show-esterno-checkbox",2,"height","1.5rem","width","1.5rem",3,"change"],["for","show-esterno-checkbox",2,"font-size","1.2rem"],[2,"flex","1"],[1,"button-a",3,"click"]],template:function(i,s){i&1&&(k(0,"div",0),K(1,"div",1),k(2,"h3"),F(3,"Bentornato, effettua l'accesso"),M(),K(4,"input",2)(5,"input",3),k(6,"button",4),fe("click",function(){return s.login()}),F(7,"Login"),M()(),k(8,"div",5),K(9,"div",1),k(10,"h3"),F(11,"Bentornato, "),K(12,"span",6),M(),k(13,"div",7)(14,"input",8),fe("change",function(){return s.changeEsternoCheckbox()}),M(),k(15,"label",9),F(16,"Esterno"),M()(),K(17,"div",10),k(18,"button",11),fe("click",function(){return s.logout()}),F(19,"Disconnetti"),M(),K(20,"div",1),M())}});let n=e;return n})();var IJ=[{path:"",redirectTo:"home",pathMatch:"full"},{path:"home",component:DM},{path:"prenota",component:FU},{path:"menu",component:VU},{path:"lavora_con_noi",component:UU},{path:"contattaci",component:jU},{path:"admin",component:BU}],$U=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=ar({type:e}),e.\u0275inj=or({providers:[{provide:dr,useClass:Ip}],imports:[_I.forRoot(IJ),_I]});let n=e;return n})();var HU=(()=>{let e=class e{constructor(){}openCloseMenu(){let r=document.getElementById("sidebar-menu");r.style.display=="none"?r.style.display="flex":r.style.display="none"}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();var qU=(()=>{let e=class e{constructor(r){this.generalService=r,this.title="james-joice"}ngOnInit(){this.initFirebase()}initFirebase(){let r={apiKey:"AIzaSyAVsXi4sifLsUe4KUZWTjrZGuD2H7eWd1Y",authDomain:"jjpp-80634.firebaseapp.com",databaseURL:"https://jjpp-80634-default-rtdb.europe-west1.firebasedatabase.app",projectId:"jjpp-80634",storageBucket:"jjpp-80634.appspot.com",messagingSenderId:"157051003839",appId:"1:157051003839:web:5f3fe851d3f34b5544b70a",measurementId:"G-41NRX2HZEY"};Fe.initializeApp(r)}openCloseMenu(){this.generalService.openCloseMenu()}closeSidebar(){document.getElementById("sidebar-menu").style.display="none"}};e.\u0275fac=function(i){return new(i||e)($n(HU))},e.\u0275cmp=Nt({type:e,selectors:[["app-root"]],decls:41,vars:0,consts:[[1,"header-strip"],[2,"height","100%","display","flex","flex-direction","row","align-items","center","justify-content","center","gap","1.5rem"],[1,"material-symbols-outlined","notranslate",2,"font-size","2.5rem","color","white","cursor","pointer","margin-left","1rem",3,"click"],[2,"flex","1"],[1,"desktop-element",2,"display","flex","flex-direction","row","align-items","center","gap","1.5rem"],["routerLink","/home",1,"a1"],["routerLink","/menu",1,"a1"],["routerLink","/home","src","assets\\svg\\solo jj.svg",2,"width","5rem","cursor","pointer"],["routerLink","/prenota",1,"a1"],["routerLink","/contattaci",1,"a1"],[2,"width","3.5rem","height","100%","flex-shrink","0"],["id","sidebar-menu"],[2,"display","flex","flex-direction","column"],[2,"width","100%","display","flex","flex-direction","row","align-items","center","gap","0.5rem","padding-left","1.8rem","margin-top","1rem"],[1,"material-symbols-outlined","notranslate",2,"font-size","2.5rem","color","white","cursor","pointer",3,"click"],[2,"margin-bottom","0rem","margin-top","0rem"],["src","assets\\svg\\solo jj.svg",2,"width","10rem","height","5rem","object-fit","cover","margin-top","2rem","margin-left","-1.8rem"],[2,"display","flex","flex-direction","column","padding-left","1.8rem","padding-bottom","1rem","height","100%"],["routerLink","/home",1,"a1",3,"click"],["routerLink","/menu",1,"a1",3,"click"],["routerLink","/prenota",1,"a1",3,"click"],["routerLink","/contattaci",1,"a1",3,"click"],["routerLink","/lavora_con_noi",1,"a1",3,"click"],["routerLink","/admin",1,"a1",3,"click"]],template:function(i,s){i&1&&(k(0,"div",0)(1,"div",1)(2,"span",2),fe("click",function(){return s.openCloseMenu()}),F(3,"menu"),M(),K(4,"div",3),k(5,"div",4)(6,"a",5),F(7,"Home"),M(),k(8,"a",6),F(9,"Men\xF9"),M()(),K(10,"img",7),k(11,"div",4)(12,"a",8),F(13,"Prenota"),M(),k(14,"a",9),F(15,"Contattaci"),M()(),K(16,"div",3)(17,"div",10),M()(),k(18,"div",11)(19,"div",12)(20,"div",13)(21,"span",14),fe("click",function(){return s.openCloseMenu()}),F(22,"menu"),M(),k(23,"h2",15),F(24,"Indice"),M()(),K(25,"img",16),k(26,"div",17)(27,"a",18),fe("click",function(){return s.closeSidebar()}),F(28,"Home"),M(),k(29,"a",19),fe("click",function(){return s.closeSidebar()}),F(30,"Men\xF9"),M(),k(31,"a",20),fe("click",function(){return s.closeSidebar()}),F(32,"Prenota"),M(),k(33,"a",21),fe("click",function(){return s.closeSidebar()}),F(34,"Contattaci"),M(),k(35,"a",22),fe("click",function(){return s.closeSidebar()}),F(36,"Lavora con noi"),M(),K(37,"div",3),k(38,"a",23),fe("click",function(){return s.closeSidebar()}),F(39,"Admin"),M()()()(),K(40,"router-outlet"))},dependencies:[uI,Hp]});let n=e;return n})();var zU=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=ar({type:e,bootstrap:[qU]}),e.\u0275inj=or({imports:[OP,$U]});let n=e;return n})();kP().bootstrapModule(zU).catch(n=>console.error(n));
